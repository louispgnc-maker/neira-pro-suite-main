import { AppLayout } from "@/components/layout/AppLayout";
import { Button } from "@/components/ui/button";
import { Eye, Search, MoreHorizontal, Trash2, Plus, ArrowRight, Upload } from "lucide-react";
import { useLocation, useNavigate } from "react-router-dom";
import { useAuth } from "@/contexts/AuthContext";
import { useEffect, useState } from "react";
import { supabase } from "@/lib/supabaseClient";
import { NOTAIRE_CONTRACT_CATEGORIES } from "@/components/dashboard/ContractSelectorNotaire";
import { AVOCAT_CONTRACT_CATEGORIES } from "@/components/dashboard/ContractSelectorAvocat";
import { Input } from "@/components/ui/input";
import { Badge } from "@/components/ui/badge";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
  DropdownMenuSub,
  DropdownMenuSubTrigger,
  DropdownMenuSubContent,
} from "@/components/ui/dropdown-menu";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogHeader,
  DialogTitle,
} from "@/components/ui/dialog";
import { Label } from "@/components/ui/label";
import { Textarea } from "@/components/ui/textarea";
import { RadioGroup, RadioGroupItem } from "@/components/ui/radio-group";
import { Checkbox } from "@/components/ui/checkbox";
import { toast } from "sonner";
import { ShareToCollaborativeDialog } from "@/components/cabinet/ShareToCollaborativeDialog";

type ContratRow = {
  id: string;
  name: string;
  category: string;
  type: string;
  created_at: string;
  updated_at: string;
};

// Cat√©gories filtrage dynamiques selon le r√¥le
const categoriesNotaire = [
  "Tous",
  "Immobilier",
  "Famille & Patrimoine",
  "Succession",
  "Procurations & Actes divers"
];

const categoriesAvocat = [
  "Tous",
  "Droit des affaires / Commercial",
  "Droit du travail",
  "Droit immobilier",
  "Droit civil / Vie priv√©e",
  "Propri√©t√© intellectuelle & Num√©rique",
];

// Composant r√©utilisable pour upload multiple de fichiers
interface FileWithMetadata extends File {
  _autoLoaded?: boolean;
  _clientName?: string;
}

interface MultiFileUploadProps {
  label: string;
  files: File[];
  onFilesChange: (files: File[]) => void;
  required?: boolean;
  accept?: string;
  role?: 'notaire' | 'avocat';
}

function ClientSelector({ clients, selectedClientId, onClientChange, label = "S√©lectionner votre client" }: { clients: Array<{id: string, nom: string, prenom: string}>; selectedClientId: string; onClientChange: (clientId: string) => void; label?: string }) {
  return (
    <div className="space-y-2">
      <Label htmlFor="client-select">
        {label} <span className="text-red-500">*</span>
      </Label>
      <Select value={selectedClientId} onValueChange={onClientChange}>
        <SelectTrigger id="client-select">
          <SelectValue placeholder="Choisir un client" />
        </SelectTrigger>
        <SelectContent>
          {clients.map((client) => (
            <SelectItem key={client.id} value={client.id}>
              {client.prenom} {client.nom}
            </SelectItem>
          ))}
        </SelectContent>
      </Select>
    </div>
  );
}

// Composant SubmitButton standardis√©
interface SubmitButtonProps {
  onClick: () => void;
  label: string;
  role: 'notaire' | 'avocat';
  disabled?: boolean;
}

function SubmitButton({ onClick, label, role, disabled = false }: SubmitButtonProps) {
  const bgColor = role === 'notaire' ? 'bg-orange-600 hover:bg-orange-700' : 'bg-blue-600 hover:bg-blue-700';
  
  return (
    <Button
      onClick={onClick}
      disabled={disabled}
      className={`w-full py-6 text-lg font-semibold ${bgColor} text-white`}
    >
      <ArrowRight className="mr-2 h-5 w-5" />
      {label}
    </Button>
  );
}

function MultiFileUpload({ label, files, onFilesChange, required = false, accept, role = 'notaire' }: MultiFileUploadProps) {
  const inputId = `upload-${label.replace(/\s+/g, '-').toLowerCase()}`;
  
  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {
    if (e.target.files) {
      const newFiles = Array.from(e.target.files);
      onFilesChange([...files, ...newFiles]);
    }
  };
  
  const removeFile = (index: number) => {
    onFilesChange(files.filter((_, i) => i !== index));
  };
  
  return (
    <div className="space-y-2">
      <Label>
        {label} {required && <span className="text-red-500">*</span>}
      </Label>
      <button
        type="button"
        onClick={() => document.getElementById(inputId)?.click()}
        className={`w-full p-3 border-2 border-dashed rounded-lg text-sm flex items-center justify-center gap-2 transition-colors ${role === 'notaire' ? 'hover:bg-orange-50' : 'hover:bg-blue-50'}`}
        style={{
          borderColor: files.length > 0 ? "#22c55e" : (role === 'notaire' ? "#fb923c" : "#3b82f6"),
          backgroundColor: files.length > 0 ? "#f0fdf4" : "white"
        }}
      >
        {files.length > 0 ? (
          <svg className="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
            <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
          </svg>
        ) : (
          <svg className={`w-5 h-5 ${role === 'notaire' ? 'text-orange-500' : 'text-blue-500'}`} fill="currentColor" viewBox="0 0 20 20">
            <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
          </svg>
        )}
        <span className={files.length > 0 ? "text-green-700 font-medium" : (role === 'notaire' ? "text-orange-700" : "text-blue-700")}>
          {files.length > 0 ? `${files.length} fichier(s) charg√©(s) - Cliquer pour en ajouter` : "Aucune pi√®ce charg√©e - Cliquer pour ajouter"}
        </span>
      </button>
      <Input
        id={inputId}
        type="file"
        className="hidden"
        multiple
        accept={accept}
        onChange={handleFileSelect}
      />
      {files.length > 0 && (
        <div className="mt-2 space-y-1">
          {files.map((file, index) => {
            const fileWithMeta = file as FileWithMetadata;
            const isAutoLoaded = fileWithMeta._autoLoaded === true;
            
            return (
              <div key={index} className="space-y-1">
                <div className="flex items-center justify-between p-2 bg-gray-50 rounded border text-sm">
                  <div className="flex items-center gap-2 flex-1 min-w-0">
                    <svg className="w-4 h-4 text-gray-500 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                      <path fillRule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z" clipRule="evenodd" />
                    </svg>
                    <span className="truncate" title={file.name}>{file.name}</span>
                    <span className="text-gray-400 text-xs flex-shrink-0">
                      ({(file.size / 1024).toFixed(0)} KB)
                    </span>
                  </div>
                  <button
                    type="button"
                    onClick={() => removeFile(index)}
                    className="ml-2 p-1 text-red-600 hover:bg-red-50 rounded flex-shrink-0"
                    title="Supprimer"
                  >
                    <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                      <path fillRule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clipRule="evenodd" />
                    </svg>
                  </button>
                </div>
                {isAutoLoaded && (
                  <div className="flex items-center gap-1 px-2 py-1 text-xs text-blue-600 bg-blue-50 rounded">
                    <svg className="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                      <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clipRule="evenodd" />
                    </svg>
                    <span>Pi√®ce du client {fileWithMeta._clientName || ''} charg√©e automatiquement</span>
                  </div>
                )}
              </div>
            );
          })}
        </div>
      )}
    </div>
  );
}

// Composant SingleFileUpload pour un seul document avec bouton int√©gr√©
interface SingleFileUploadProps {
  label: string;
  file: File | null;
  onFileChange: (file: File | null) => void;
  required?: boolean;
  accept?: string;
  role?: 'notaire' | 'avocat';
}

function SingleFileUpload({ label, file, onFileChange, required = false, accept, role = 'notaire' }: SingleFileUploadProps) {
  const inputId = `upload-single-${label.replace(/\s+/g, '-').toLowerCase()}`;
  
  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {
    if (e.target.files && e.target.files[0]) {
      onFileChange(e.target.files[0]);
    }
  };
  
  const removeFile = () => {
    onFileChange(null);
  };
  
  return (
    <div className="flex items-center gap-3">
      <div className="flex-1">
        <Label className="text-sm font-normal">
          {label} {required && <span className="text-red-500">*</span>}
        </Label>
      </div>
      <div className="flex items-center gap-2">
        {file ? (
          <>
            <div className="flex items-center gap-2 px-3 py-1.5 bg-green-50 border border-green-200 rounded text-xs text-green-700">
              <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
              </svg>
              <span className="truncate max-w-[150px]" title={file.name}>{file.name}</span>
              <button
                type="button"
                onClick={removeFile}
                className="p-0.5 text-red-600 hover:bg-red-100 rounded"
                title="Supprimer"
              >
                <svg className="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 20 20">
                  <path fillRule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clipRule="evenodd" />
                </svg>
              </button>
            </div>
          </>
        ) : (
          <>
            <button
              type="button"
              onClick={() => document.getElementById(inputId)?.click()}
              className={`px-4 py-1.5 text-xs font-medium text-white rounded transition-colors ${role === 'notaire' ? 'bg-orange-500 hover:bg-orange-600' : 'bg-blue-500 hover:bg-blue-600'}`}
            >
              üìé Ajouter
            </button>
          </>
        )}
        <Input
          id={inputId}
          type="file"
          className="hidden"
          accept={accept}
          onChange={handleFileSelect}
        />
      </div>
    </div>
  );
}

export default function Contrats() {
  const { user } = useAuth();
  const location = useLocation();
  const [loading, setLoading] = useState(true);
  const [contrats, setContrats] = useState<ContratRow[]>([]);
  const [search, setSearch] = useState("");
  const [categoryFilter, setCategoryFilter] = useState("Tous");
  const [debounced, setDebounced] = useState("");

  // Dialog questionnaire pour compromis de vente
  const [showQuestionDialog, setShowQuestionDialog] = useState(false);
  const [pendingContractType, setPendingContractType] = useState<string>("");
  const [pendingCategory, setPendingCategory] = useState<string>("");
  const [selectedClientId, setSelectedClientId] = useState<string>("");
  const [genericDescription, setGenericDescription] = useState<string>("");
  const [clients, setClients] = useState<Array<{id: string, nom: string, prenom: string, adresse: string, telephone?: string, email?: string, date_naissance?: string, lieu_naissance?: string, nationalite?: string, profession?: string, situation_matrimoniale?: string, situation_familiale?: string | {regime_matrimonial?: string, nombre_enfants?: string, personne_a_charge?: any}, type_identite?: string, numero_identite?: string, date_expiration_identite?: string, id_doc_path?: string}>>([]);
  
  // √âtats s√©par√©s pour chaque partie des contrats
  const [prestationPrestataireClientId, setPrestationPrestataireClientId] = useState<string>("");
  const [prestationClientClientId, setPrestationClientClientId] = useState<string>("");
  const [venteB2BFournisseurClientId, setVenteB2BFournisseurClientId] = useState<string>("");
  const [venteB2BDistributeurClientId, setVenteB2BDistributeurClientId] = useState<string>("");
  const [cgvVendeurClientId, setCgvVendeurClientId] = useState<string>("");

  // States pour les fichiers upload√©s
  const [compromisClientIdentiteUrl, setCompromisClientIdentiteUrl] = useState<string | null>(null); // URL du document du client
  const [compromisAutrePartieFiles, setCompromisAutrePartieFiles] = useState<File[]>([]); // Fichiers de l'autre partie
  const [compromisDiagnosticsFiles, setCompromisDiagnosticsFiles] = useState<File[]>([]);
  const [acteClientIdentiteUrl, setActeClientIdentiteUrl] = useState<string | null>(null); // URL du document du client acte
  const [bailClientIdentiteUrl, setBailClientIdentiteUrl] = useState<string | null>(null); // URL du document du client bail
  const [bailCommercialBailleurClientIdentiteUrl, setBailCommercialBailleurClientIdentiteUrl] = useState<string | null>(null); // URL du document du bailleur bail commercial
  const [bailCommercialPreneurClientIdentiteUrl, setBailCommercialPreneurClientIdentiteUrl] = useState<string | null>(null); // URL du document du preneur bail commercial
  const [acteAutrePartieFiles, setActeAutrePartieFiles] = useState<File[]>([]); // Fichiers de l'autre partie acte
  const [acteVendeurFiles, setActeVendeurFiles] = useState<File[]>([]); // Fichiers suppl√©mentaires vendeur
  const [acteAcheteurFiles, setActeAcheteurFiles] = useState<File[]>([]); // Fichiers suppl√©mentaires acheteur
  const [acteDiagnosticsFiles, setActeDiagnosticsFiles] = useState<File[]>([]);
  const [locataireDocsFiles, setLocataireDocsFiles] = useState<File[]>([]);
  const [bailleurIdFiles, setBailleurIdFiles] = useState<File[]>([]); // Pi√®ce d'identit√© bailleur
  const [locataireIdFiles, setLocataireIdFiles] = useState<File[]>([]); // Documents locataire
  const [inventaireMobilierFiles, setInventaireMobilierFiles] = useState<File[]>([]); // Inventaire mobilier PDF/images
  const [bailCommercialBailleurFiles, setBailCommercialBailleurFiles] = useState<File[]>([]); // Kbis/ID bailleur commercial
  const [bailCommercialLocataireFiles, setBailCommercialLocataireFiles] = useState<File[]>([]); // Kbis/ID locataire commercial
  
  // States pour cession de parts sociales
  const [cessionStatutsFiles, setCessionStatutsFiles] = useState<File[]>([]); // Statuts soci√©t√©
  const [cessionKbisFiles, setCessionKbisFiles] = useState<File[]>([]); // Kbis
  const [cessionComptesFiles, setCessionComptesFiles] = useState<File[]>([]); // Comptes annuels
  const [cessionRegistreFiles, setCessionRegistreFiles] = useState<File[]>([]); // Registre associ√©s
  const [cessionPacteFiles, setCessionPacteFiles] = useState<File[]>([]); // Pacte d'associ√©s
  const [cessionCedantIdFiles, setCessionCedantIdFiles] = useState<File[]>([]); // ID c√©dant
  const [cessionCedantMariageFiles, setCessionCedantMariageFiles] = useState<File[]>([]); // Contrat mariage c√©dant
  const [cessionExpertiseFiles, setCessionExpertiseFiles] = useState<File[]>([]); // Expertise parts
  const [cessionCCAFiles, setCessionCCAFiles] = useState<File[]>([]); // Justificatif CCA
  const [cessionCessionnaireIdFiles, setCessionCessionnaireIdFiles] = useState<File[]>([]); // ID cessionnaire
  const [cessionCessionnaireDomicileFiles, setCessionCessionnaireDomicileFiles] = useState<File[]>([]); // Justif domicile
  const [cessionCessionnaireKbisFiles, setCessionCessionnaireKbisFiles] = useState<File[]>([]); // Kbis cessionnaire
  const [cessionOrigineFondsFiles, setCessionOrigineFondsFiles] = useState<File[]>([]); // Origine fonds
  const [cessionPVAgrementFiles, setCessionPVAgrementFiles] = useState<File[]>([]); // PV agr√©ment
  
  // States pour Contrat de prestation de services (avocats)
  const [prestationData, setPrestationData] = useState({
    // 1. Identification Prestataire
    prestataireDenomination: "",
    prestataireFormeJuridique: "",
    prestataireRCS: "",
    prestataireSiegeSocial: "",
    prestataireRepresentant: "",
    prestataireFonctionSignataire: "",
    prestataireEmail: "",
    prestataireTelephone: "",
    prestataireAssuranceRC: "", // oui/non
    prestataireNumeroAssurance: "",
    
    // 2. Identification Client
    clientDenomination: "",
    clientFormeJuridique: "",
    clientAdresse: "",
    clientRCS: "",
    clientRepresentant: "",
    clientFonction: "",
    clientContactOperationnel: "",
    clientEmail: "",
    clientTelephone: "",
    
    // 3. Objet du contrat
    naturePrestation: "",
    descriptionDetaillee: "",
    perimetreIntervention: "",
    inclusionsPrestations: "",
    exclusionsPrestations: "",
    resultatsAttendus: "",
    typeObligation: "", // moyens / resultat
    competencesTechniques: "",
    referentTechniquePrestataire: "",
    referentTechniqueClient: "",
    
    // 4. Dur√©e
    typeDuree: "", // determinee / ponctuelle / indeterminee
    dateDebut: "",
    dateFin: "",
    reconductionTacite: "", // oui / non
    dureeMinimale: "",
    
    // 5. Modalit√©s de r√©alisation
    lieuExecution: "", // teletravail / locaux_client / locaux_prestataire / mixte
    conditionsIntervention: "",
    horairesImpose: "", // oui / non
    detailsHoraires: "",
    materielMisADisposition: "",
    obligationsClient: "",
    delaisRealisation: "",
    planning: "",
    criteresAcceptation: "",
    
    // 6. Prix et conditions financi√®res
    modeFacturation: "", // forfait / horaire / journalier / livrable / abonnement / performance
    montantHT: "",
    tva: "",
    modalitesVariation: "",
    fraisAnnexes: "",
    modalitesPaiement: "", // comptant / 30j / 45j / 60j
    acompte: "",
    echeancier: "",
    facturationElectronique: "", // oui / non
    penalitesRetard: "",
    indemniteLegale: "",
    suspensionImpaye: "", // oui / non
    
    // 6. Propri√©t√© intellectuelle
    droitsCreationsPrestataire: "", // licence / cession / reserves
    limitationDroits: "",
    droitsCreationsClient: "",
    proprietaireCode: "", // prestataire / client
    droitsReproduction: "",
    garantiesContrefacon: "",
    
    // 7. Confidentialit√©
    definitionInfosConfidentielles: "",
    dureeConfidentialite: "5", // 5 ans par d√©faut
    exceptionsConfidentialite: "",
    sanctionsViolation: "",
    
    // 8. RGPD
    prestataireSousTraitant: "", // oui / non
    clientResponsableTraitement: "", // oui / non
    natureDonnees: "",
    finalitesTraitement: "",
    mesuresSecurite: "",
    dureeConservation: "",
    clauseDataBreach: "",
    dpaRequis: "", // oui / non
    
    // 9. Sous-traitance
    sousTraitanceAutorisee: "", // oui / non / avec_validation
    validationPrealable: "", // oui / non
    responsabilitePrestataire: "",
    
    // 10. Responsabilit√©
    plafondResponsabilite: "",
    exclusionsDommages: "",
    forceMajeure: "",
    responsabiliteNonConformite: "",
    montantCouverture: "",
    
    // 11. R√©siliation
    resiliationPreavis: "",
    resiliationImmediate: "", // faute / non_paiement / non_respect
    effetsResiliation: "",
    
    // 12. R√©versibilit√©
    restitutionDonnees: "",
    restitutionDocuments: "",
    continuationTransition: "",
    assistanceMigration: "",
    coutReversibilite: "",
    
    // 13. Litiges
    loiApplicable: "France",
    tribunalCompetent: "",
    mediationArbitrage: "", // oui / non
    clauseAmiable: "", // oui / non
    
    // 14. Clauses compl√©mentaires essentielles
    dateEffetContrat: "", // Date d'entr√©e en vigueur
    independanceParties: "", // oui / non
    absenceSubordination: "", // oui / non
    liberteOrganisation: "", // oui / non
    exclusivite: "", // oui / non / non
    precisionExclusivite: "",
    nonDebauchage: "", // oui / non
    dureeNonDebauchage: "",
    penaliteNonDebauchage: "",
    modificationAvenant: "", // oui (par d√©faut)
    clauseTolerance: "", // oui (par d√©faut)
    clauseNullitePartielle: "", // oui (par d√©faut)
  });
  
  const [prestationPrestataireFiles, setPrestationPrestataireFiles] = useState<File[]>([]); // Kbis, assurance, etc.
  const [prestationClientFiles, setPrestationClientFiles] = useState<File[]>([]); // Docs client
  const [prestationAnnexesFiles, setPrestationAnnexesFiles] = useState<File[]>([]); // Cahier des charges, etc.
  
  // States pour Contrat de vente B2B
  const [venteB2BData, setVenteB2BData] = useState({
    // 1. Identification Fournisseur/Vendeur
    fournisseurDenomination: "",
    fournisseurFormeJuridique: "",
    fournisseurCapital: "",
    fournisseurRCS: "",
    fournisseurSiegeSocial: "",
    fournisseurRepresentant: "",
    fournisseurEmail: "",
    fournisseurTelephone: "",
    fournisseurAssurancePro: "", // oui/non
    fournisseurNumeroAssurance: "",
    
    // Acheteur/Distributeur
    acheteurDenomination: "",
    acheteurFormeJuridique: "",
    acheteurRCS: "",
    acheteurAdresse: "",
    acheteurRepresentant: "",
    acheteurEmail: "",
    acheteurTelephone: "",
    acheteurZoneGeographique: "",
    acheteurStatutCommercial: "", // revendeur/agent/importateur/grossiste
    
    // 2. Objet du contrat
    natureProduits: "",
    categoriesProduits: "",
    perimetreDistribution: "", // vente_simple/distribution_generale/exclusive/selective/franchise
    obligationsMinimalesDistributeur: "",
    canauxVenteAutorises: "", // boutique/en_ligne/marketplace/export
    
    // 3A. Tarifs
    prixUnitaire: "",
    grilleTarifaire: "",
    remises: "",
    revisionsPrix: "",
    conditionsPreferentielles: "",
    
    // 3B. Commandes
    modalitesPassationCommande: "",
    minimumsCommande: "",
    delaisCommande: "",
    confirmationCommande: "", // automatique/manuelle
    conditionsAnnulation: "",
    
    // 3C. Livraison
    incoterms: "", // EXW/DDP/FCA/FOB
    transporteur: "",
    transfertRisques: "",
    delaisLivraison: "",
    penalitesRetardLivraison: "",
    modalitesReception: "",
    
    // 3D. Paiement
    modePaiement: "", // virement/prelevement/LCR
    delaisPaiement: "", // comptant/30j/60j
    acomptePaiement: "",
    penalitesRetardPaiement: "",
    indemniteLegaleRecouvrement: "",
    suspensionLivraisonImpaye: "", // oui/non
    
    // 4. Obligations fournisseur
    obligationConformite: true,
    respectNormesCertifications: true,
    garantieDisponibilite: true,
    assuranceQualite: true,
    remplacementDefectueux: true,
    formationDistributeur: "", // oui/non
    assistanceTechnique: "", // oui/non
    obligationInformation: true,
    
    // 5. Obligations acheteur/distributeur
    commercialisationImageMarque: true,
    respectPrixRecommandes: "", // oui/non
    promotionActive: true,
    stockMinimum: "",
    reportingMarche: true,
    respectNormesLocales: true,
    serviceClientRetours: true,
    formationPersonnel: "", // oui/non
    
    // 6. Exclusivit√©
    exclusiviteTerritoriale: "", // oui/non
    exclusivitePays: "",
    exclusiviteRegion: "",
    dureeExclusivite: "",
    volumeMinimalExclusivite: "",
    exclusiviteProduit: "", // oui/non
    objectifsVenteExclusivite: "",
    sanctionsEchecExclusivite: "",
    
    // 7. Distribution s√©lective
    distributionSelective: "", // oui/non
    criteresAgrement: "",
    exigencesPresentationProduits: "",
    qualiteMinimalePointVente: "",
    conditionsFormationPersonnel: "",
    interdictionReventeHorsReseau: "", // oui/non
    
    // 8. Propri√©t√© intellectuelle
    droitUtilisationMarque: "", // oui/non
    conditionsUtilisationLogos: "",
    interdictionModificationProduits: "", // oui/non
    proprietaireDocumentsMarketing: "", // fournisseur/acheteur
    interdictionDepotMarque: "", // oui/non
    clauseContreContrefacon: "",
    
    // 9. Garanties
    garantieLegaleConformite: true,
    garantieLegaleVicesCaches: true,
    garantieCommercialeDuree: "",
    garantieCommercialeEtendue: "",
    garantieCommercialeExclusions: "",
    conditionsRetour: "",
    procedureSAV: "",
    
    // 10. Responsabilit√©
    limitationResponsabiliteFournisseur: "",
    exclusionDommagesIndirects: "", // oui/non
    plafondIndemnitaire: "",
    casForceMajeure: "",
    responsabiliteDistributeurClients: "",
    
    // 11. Non-concurrence & Confidentialit√©
    interdictionProduitsConcurrents: "", // oui/non
    dureeNonConcurrence: "",
    sanctionsNonConcurrence: "",
    confidentialiteDuree: "",
    natureInformationsConfidentielles: "",
    
    // 12. Dur√©e & R√©siliation
    dureeContrat: "", // determinee/indeterminee
    dateEntreeVigueur: "", // Date d'entr√©e en vigueur
    dateDebutContrat: "",
    dateFinContrat: "",
    reconductionTacite: "", // oui/non
    preavisResiliation: "",
    resiliationImmediateMotifs: "",
    fautesGravesDefautPaiement: true,
    fautesGravesAtteintemarque: true,
    fautesGravesNonRespectExclusivite: true,
    fautesGravesViolationPI: true,
    effetsResiliation: "",
    indemniteFinContrat: "", // oui/non/exclusion
    montantIndemniteFinContrat: "",
    
    // Nouvelle section: Clauses sp√©cifiques B2B
    reservePropriete: "", // oui/non
    reserveProprietePrecisions: "",
    nonSollicitationSalaries: "", // oui/non
    dureeNonSollicitation: "",
    penaliteNonSollicitation: "",
    cessionContratAutorisee: "", // oui/non
    cessionContratAccordPrealable: "", // oui/non
    clausesSurvieConfidentialite: true,
    clausesSurviePI: true,
    clausesSurvieResponsabilite: true,
    clausesSurvieNonConcurrence: true,
    
    // 13. Compliance
    loiApplicable: "France",
    tribunalCompetent: "",
    clauseMediation: "", // oui/non
    clauseAntiCorruption: "", // oui/non
    clauseRGPD: "", // oui/non
    clauseConformiteExportImport: "",
  });
  
  const [venteB2BFournisseurFiles, setVenteB2BFournisseurFiles] = useState<File[]>([]); // Kbis, statuts, assurance, fiches techniques
  const [venteB2BDistributeurFiles, setVenteB2BDistributeurFiles] = useState<File[]>([]); // Kbis, assurance, points de vente
  const [venteB2BAnnexesFiles, setVenteB2BAnnexesFiles] = useState<File[]>([]); // CGV, grilles tarifaires, guides
  
  // States pour Conditions G√©n√©rales de Vente (CGV)
  const [cgvData, setCgvData] = useState({
    // 1. Identification du vendeur
    vendeurDenomination: "",
    vendeurFormeJuridique: "",
    vendeurCapitalSocial: "",
    vendeurAdresseSiege: "",
    vendeurSIREN: "",
    vendeurRCS: "",
    vendeurTVAIntracommunautaire: "",
    vendeurEmail: "",
    vendeurTelephone: "",
    vendeurResponsableLegal: "",
    vendeurProfessionReglementee: "", // oui/non
    vendeurPrecisionProfession: "",
    vendeurAssurancePro: "", // oui/non
    vendeurNumeroAssurance: "",
    
    // 2. Champ d'application
    typesProduitsServices: "",
    typesClients: [] as string[], // B2C, B2B, mixte
    canalVente: [] as string[], // e-commerce, physique, marketplace, contrat cadre
    canalAutrePrecision: "",
    
    // 3. D√©finitions (texte libre pour chaque)
    definitionProduit: "",
    definitionService: "",
    definitionClient: "",
    definitionCommande: "",
    definitionCompteUtilisateur: "",
    definitionLivraison: "",
    definitionAbonnement: "",
    definitionPrix: "",
    definitionForceMajeure: "",
    definitionContrat: "",
    
    // 4. Caract√©ristiques produits/services
    descriptionProduits: "",
    visuelsDisponibles: "", // oui/non
    specificationstechniques: "",
    disponibilites: "", // stock / sur devis / sur mesure
    restrictionsUsage: "",
    conditionsPrealables: "",
    
    // 5. Processus de commande
    creationCompteObligatoire: "", // oui/non
    etapesCommande: "",
    validationDoubleClick: true, // obligatoire e-commerce
    confirmationEmail: true,
    annulationAvantExpedition: "", // oui/non
    commandesSurDevis: "", // oui/non
    
    // 6. Prix
    prixAffichesTTC: "", // TTC/HT
    tvaApplicable: "",
    variationPrix: "",
    fraisSupplementaires: "",
    remisesReductions: "",
    devisDureeValidite: "",
    devisRevision: "",
    
    // 7. Conditions de paiement
    modesPaiement: [] as string[], // carte, virement, sepa, paypal, plusieurs fois
    paiementImmediatDiffere: "", // immediat/differe
    acompteArrhes: "", // acompte/arrhes/engagement
    montantAcompte: "",
    securisationPaiement: "",
    fraisPaiement: "",
    facturesElectroniques: "", // oui/non
    paiementB2BEcheance: "", // 30j/45j/60j
    penalitesRetardTaux: "",
    indemniteRecouvrementB2B: "40", // 40‚Ç¨ par d√©faut
    
    // 8. Livraison
    zonesLivrees: "",
    modeLivraison: "",
    delaisLivraison: "",
    fraisLivraison: "",
    transfertRisquesB2C: "reception", // r√©ception par d√©faut
    transfertRisquesB2B: "transporteur", // remise transporteur par d√©faut
    retardsLivraison: "",
    casForceMajeureLivraison: "",
    
    // 9. Ex√©cution du service (si prestation)
    calendrierService: "",
    etapesRealisation: "",
    obligationMoyensResultat: "", // moyens/resultat
    validationLivrables: "",
    reportAnnulationService: "",
    
    // 10. Droit de r√©tractation (B2C uniquement)
    droitRetractation14jours: true, // obligatoire B2C
    exceptionsRetractation: [] as string[], // sur mesure, num√©riques, services ex√©cut√©s, etc.
    procedureRetractation: "",
    formulaireRetractation: true, // obligatoire
    remboursementDelais: "",
    remboursementMethode: "",
    
    // 11. Retours & Remboursements
    conditionsRetour: "",
    fraisRetour: "",
    etatProduits: "",
    delaisRetour: "",
    produitsNonConformes: "",
    sav: "",
    
    // 12. Garanties l√©gales (obligatoire B2C)
    garantieLegaleConformite: true, // 2 ans
    garantieVicesCaches: true, // 2 ans apr√®s d√©couverte
    garantieCommerciale: "", // oui/non
    garantieCommercialeDuree: "",
    garantieCommercialeConditions: "",
    
    // 13. Transfert de propri√©t√© & risques
    transfertPropriete: "paiement-complet", // paiement-complet/livraison
    reservePropriete: "", // oui/non
    transfertRisques: "",
    
    // 14. Responsabilit√©
    limitationResponsabilite: "",
    exclusionDommagesIndirects: "", // oui/non
    plafondIndemnisation: "",
    casForceMajeureResponsabilite: "",
    responsabiliteDefautInfo: "",
    
    // 15. Propri√©t√© intellectuelle
    marquesLogos: "",
    interdictionReproduction: true,
    licenceClient: "",
    contenusNumeriquesProteges: "",
    clauseContreContrefacon: "",
    
    // 16. Donn√©es personnelles / RGPD
    natureDonneesCollectees: "",
    finalites: "",
    responsableTraitement: "",
    dureeConservation: "",
    droitsPersonnes: "",
    transfertHorsUE: "", // oui/non
    traitementsLiesPaiement: "",
    cookiePolicy: "",
    
    // 17. Service client & M√©diation
    contactServiceClient: "",
    procedureReclamation: "",
    serviceMediation: "", // obligatoire B2C
    coordonneesMediateur: "",
    
    // 18. R√©siliation services / Abonnements
    dureeAbonnement: "",
    reconductionTacite: "", // oui/non + Loi Chatel
    procedureResiliation: "",
    preavisResiliation: "",
    restitutionDonnees: "",
    suppressionCompte: "",
    
    // 19. Loi applicable & Tribunal
    loiApplicable: "France",
    tribunalCompetent: "",
    clauseMediation: "", // oui/non
    clauseArbitrage: "", // oui/non si B2B
    
    // 20. Annexes
    formulaireRetractationAnnexe: true,
    politiqueConfidentialite: true,
    politiqueCookies: "", // oui/non
    grilleTarifaire: "", // oui/non
    descriptifTechnique: "", // oui/non
    procedureSAV: "", // oui/non
    noticeUtilisation: "", // oui/non
  });
  
  const [cgvVendeurFiles, setCgvVendeurFiles] = useState<File[]>([]); // Kbis, mentions l√©gales, RC Pro
  const [cgvProduitsFiles, setCgvProduitsFiles] = useState<File[]>([]); // Certificats produits, fiches techniques
  const [cgvAnnexesFiles, setCgvAnnexesFiles] = useState<File[]>([]); // Formulaires, politiques, grilles tarifaires
  
  // States pour CGU (Conditions G√©n√©rales d'Utilisation)
  const [cguVendeurClientId, setCguVendeurClientId] = useState<string>("");
  const [cguData, setCguData] = useState({
    // 1. Identification √©diteur
    editeurNom: "",
    editeurDenomination: "",
    editeurFormeJuridique: "",
    editeurCapitalSocial: "",
    editeurSiegeSocial: "",
    editeurSIREN: "",
    editeurRCS: "",
    editeurTVA: "",
    editeurDirecteurPublication: "",
    editeurEmail: "",
    editeurTelephone: "",
    hebergeurNom: "",
    hebergeurCoordonnees: "",
    secteurReglemente: "", // oui/non
    secteurReglementeAutorite: "",
    
    // 2. Objet des CGU
    serviceFourni: "",
    typePlateforme: [] as string[], // SaaS, App mobile, Marketplace, R√©seau social, Service info, Plateforme √©change
    limitesService: "",
    exclusionsExplicites: "",
    
    // 3. D√©finitions
    defUtilisateur: "",
    defCompteUtilisateur: "",
    defService: "",
    defContenu: "",
    defContenuUtilisateur: "",
    defDonneesPersonnelles: "",
    defPlateforme: "",
    defEspaceClient: "",
    defModeration: "",
    defForceMajeure: "",
    defAcceptationCGU: "",
    
    // 4. Acc√®s au site / Compte utilisateur
    champsCreeCompteNom: false,
    champsCreeComptePrenom: false,
    champsCreeCompteEmail: false,
    champsCreeCompteTelephone: false,
    champsCreeCompteMotDePasse: false,
    champsCreeCompteEntreprise: false,
    verificationEmail: "", // oui/non
    verificationTelephone: "", // oui/non
    ageMinimum: "16", // 16 ou 18
    interdictionsAcces: "",
    exactitudeDonnees: "",
    confidentialiteMotDePasse: "",
    doubleAuthentification: "", // oui/non
    responsabiliteVolCompte: "",
    
    // 5. Fonctionnement du service
    fonctionnalitesDisponibles: "",
    limitationsService: "",
    prerequisTechniques: "",
    misesAJour: "",
    interruptionsService: "",
    evolutionsSansPreavis: "",
    
    // 6. R√®gles d'utilisation / Comportements interdits
    interdictionUsurpationIdentite: true,
    interdictionViolationLois: true,
    interdictionSpamPhishing: true,
    interdictionExploitationCommerciale: true,
    interdictionAccesNonAutorise: true,
    interdictionContournementProtections: true,
    contenuIllicite: true,
    contenuViolentHaineux: true,
    contenuPornographique: true,
    contenuDiffamatoire: true,
    violationDroitsAuteur: true,
    publiciteDissimulee: true,
    venteProduitsInterdits: true,
    reverseEngineering: true,
    scrapingIntensif: true,
    surutilisationService: true,
    automatisationNonAutorisee: true,
    autresInterdictions: "",
    
    // 7. Contenus utilisateurs (UGC)
    definitionContenuUGC: "",
    droitsConcedes: "",
    licenceUtilisation: "",
    droitsReproduction: "",
    dureeLicence: "",
    responsabiliteContenu: "",
    pouvoirSuppression: "",
    procedureSignalement: "",
    suspensionCompte: "",
    dsaSignalement: "",
    dsaTransparence: "",
    
    // 8. Propri√©t√© intellectuelle
    titulariteDroits: "",
    marquesLogosDesign: "",
    logicielsUtilises: "",
    interdictionReproductionPI: true,
    protectionCodePI: true,
    droitsClientContenu: "",
    
    // 9. Donn√©es personnelles / RGPD
    donneesIdentite: false,
    donneesContacts: false,
    donneesIdentifiants: false,
    donneesCookiesTracking: false,
    donneesNavigation: false,
    donneesUsage: false,
    finaliteFonctionnement: false,
    finaliteSecurite: false,
    finaliteStatistiques: false,
    finalitePublicite: false,
    finalitePreventionFraude: false,
    baseLegaleConsentement: false,
    baseLegaleContrat: false,
    baseLegaleInteretLegitime: false,
    dureeConservationRGPD: "",
    droitAcces: true,
    droitRectification: true,
    droitSuppression: true,
    droitOpposition: true,
    droitPortabilite: true,
    droitLimitation: true,
    sousTraitants: "",
    transfertHorsUERGPD: "", // oui/non
    transfertHorsUEPays: "",
    dpo: "",
    
    // 10. Cookies et traceurs
    cookiesNecessaires: true,
    cookiesStatistiques: false,
    cookiesPublicitaires: false,
    consentementCookies: true,
    conservationChoixCookies: "",
    lienPolitiqueCookies: "",
    
    // 11. Responsabilit√©
    engagementDisponibilite: "",
    engagementSecurite: "",
    engagementMaintenance: "",
    engagementRespectLois: "",
    exclusionUtilisationIncorrecte: true,
    exclusionPanneInternet: true,
    exclusionDommagesIndirects: true,
    exclusionPerteDonnees: true,
    exclusionIntrusionExterne: true,
    forceMajeureResponsabilite: "",
    
    // 12. Suspension / Suppression du compte
    suspensionNonRespectCGU: true,
    suspensionComportementsIllicites: true,
    suspensionUtilisationAbusive: true,
    suppressionDemandeUtilisateur: true,
    suppressionDecesUtilisateur: true,
    dureeSuspension: "",
    procedureRecours: "",
    
    // 13. Modification des CGU
    notificationModification: "", // oui/non
    dateEntreeVigueur: "",
    acceptationTaciteExpresse: "", // tacite/expresse
    archivageVersions: "", // oui/non
    
    // 14. R√©siliation du service
    resiliationParUtilisateur: "",
    resiliationParPlateforme: "",
    effetsClotureCompte: "",
    effetsSuppressionDonnees: "",
    effetsRestitutionAcces: "",
    
    // 15. Litiges / Droit applicable
    droitApplicable: "France",
    tribunalCompetent: "",
    procedureAmiable: "", // oui/non
    clauseMediationLitiges: "", // oui/non
    
    // 15bis. Clause de hi√©rarchie des documents
    hierarchieDocuments: "",
    
    // 15ter. Clause de nullit√© partielle
    clauseNullitePartielle: "",
    
    // 15quater. Clause de preuve √©lectronique
    clausePreuveElectronique: "",
    
    // 16. Annexes techniques
    annexePolitiqueConfidentialite: false,
    annexePolitiqueCookies: false,
    annexeCharteUtilisation: false,
    annexeDocumentationAPI: false,
    annexeReglesModeration: false,
    
    // 17. Pi√®ces justificatives
    piecesMentionsLegales: false,
    piecesPolitiqueConfidentialite: false,
    piecesPolitiqueCookies: false,
    piecesConditionsCommerciales: false,
  });
  
  // √âtats individuels pour chaque annexe/pi√®ce CGU
  const [cguPolitiqueConfidentialiteFile, setCguPolitiqueConfidentialiteFile] = useState<File | null>(null);
  const [cguPolitiqueCookiesFile, setCguPolitiqueCookiesFile] = useState<File | null>(null);
  const [cguCharteUtilisationFile, setCguCharteUtilisationFile] = useState<File | null>(null);
  const [cguDocumentationAPIFile, setCguDocumentationAPIFile] = useState<File | null>(null);
  const [cguReglesModerationFile, setCguReglesModerationFile] = useState<File | null>(null);
  const [cguMentionsLegalesFile, setCguMentionsLegalesFile] = useState<File | null>(null);
  const [cguPolitiqueConfidentialite2File, setCguPolitiqueConfidentialite2File] = useState<File | null>(null);
  const [cguPolitiqueCookies2File, setCguPolitiqueCookies2File] = useState<File | null>(null);
  const [cguConditionsCommercialesFile, setCguConditionsCommercialesFile] = useState<File | null>(null);
  
  // States pour Contrat d'agence commerciale
  const [agenceClientId, setAgenceClientId] = useState<string>("");
  const [agenceData, setAgenceData] = useState({
    // 1. Identification mandant
    mandantDenomination: "",
    mandantFormeJuridique: "",
    mandantCapital: "",
    mandantRCS: "",
    mandantSIREN: "",
    mandantSiege: "",
    mandantRepresentant: "",
    mandantActivite: "",
    mandantEmail: "",
    mandantTelephone: "",
    
    // 1. Identification agent
    agentNomPrenom: "",
    agentDenomination: "",
    agentStatutJuridique: "",
    agentAdresse: "",
    agentRCS: "",
    agentSIREN: "",
    agentRSAC: "",
    agentRCPro: "", // oui/non
    agentNumeroRCPro: "",
    agentEmail: "",
    agentTelephone: "",
    agentEtranger: false,
    agentSousAgents: "", // oui/non
    
    // 2. Objet
    produits: "",
    marchesCibles: "",
    secteursGeographiques: "",
    clienteleVisee: "",
    cgvApplicables: "",
    
    // 3. Nature juridique
    rappelIntermediaireIndependant: true,
    rappelPasRisqueVente: true,
    rappelPasEncaissementSaufClause: true,
    rappelArticlesCodeCommerce: true,
    
    // 4. Mandat et pouvoirs
    pouvoirProspection: false,
    pouvoirPresentation: false,
    pouvoirNegociation: false,
    pouvoirConclusion: false,
    pouvoirSalons: false,
    pouvoirReporting: false,
    interdictionModifTarifs: true,
    interdictionRemises: true,
    interdictionClausesNonApprouvees: true,
    interdictionEncaissement: true,
    mandatExclusif: "", // exclusif/non exclusif
    possibiliteSousAgents: "", // oui/non
    
    // 5. Exclusivit√©
    exclusiviteZone: "",
    exclusiviteSecteur: "",
    exclusiviteGamme: "",
    exclusiviteMandantInterdictionConcurrent: "", // oui/non
    exclusiviteMandantInterdictionProduitsConcurrents: "", // oui/non
    objectifsMinimaux: "",
    
    // 6. Obligations agent
    obligationProspecter: "",
    obligationPromouvoir: "",
    obligationPolitiqueCommerciale: "",
    obligationInformer: "",
    obligationReportingFrequence: "",
    obligationConfidentialite: "",
    obligationNonConflit: "",
    obligationNonConcurrence: "",
    
    // 7. Obligations mandant
    obligationCatalogues: "",
    obligationInformerModifs: "",
    obligationSupportTechnique: "",
    obligationRespecterExclusivite: "",
    obligationPayerCommissions: "",
    obligationInformerOperations: "",
    
    // 8. Commissionnement
    commissionType: "", // pourcentage/fixe/degressif/progressif
    commissionPourcentage: "",
    commissionMontantFixe: "",
    commissionGammes: "",
    commissionVentesAgent: false,
    commissionVentesMandant: false,
    commissionRenouvellements: false,
    commissionAugmentations: false,
    commissionMomentDue: "", // conclusion/paiement/expedition
    commissionPeriodicite: "", // mensuelle/trimestrielle
    commissionDroitInformation: "",
    
    // 9. Non-concurrence
    nonConcurrenceAvant: "",
    nonConcurrenceApresDuree: "",
    nonConcurrenceApresZone: "",
    nonConcurrenceApresSecteur: "",
    nonConcurrenceCompensation: "",
    
    // 10. Responsabilit√©
    responsabiliteAgent: "",
    responsabiliteMandant: "",
    exclusionsResponsabilite: "",
    
    // 11. Confidentialit√©
    confidentialitePendant: "",
    confidentialiteApres: "",
    confidentialiteDonneesSensibles: "",
    
    // 12. Propri√©t√© intellectuelle
    piInterdictionMarques: true,
    piLicenceLimitee: "",
    piRestitutionMateriel: "",
    
    // 13. RGPD
    rgpdStatutAgent: "", // responsable/sous-traitant
    rgpdDonneesTraitees: "",
    rgpdFinalites: "",
    rgpdDurees: "",
    rgpdMesuresSecurite: "",
    rgpdDPO: "",
    
    // 14. Dur√©e et r√©siliation
    dureeDeterminee: "", // oui/non
    dureeIndeterminee: "", // oui/non
    dureeReconduction: "", // oui/non
    resiliationPreavis1an: "1 mois",
    resiliationPreavis2ans: "2 mois",
    resiliationPreavis3ans: "3 mois et plus",
    resiliationImmediateFauteGrave: true,
    resiliationImmediateNonRespect: true,
    resiliationImmediateCessation: true,
    resiliationImmediateLiquidation: true,
    
    // 15. Indemnit√© l√©gale
    indemniteMontant: "2 ann√©es de commissions",
    indemniteSaufFauteGrave: true,
    indemnitePaiementDelai: "",
    
    // 16. Annexes
    annexeTarifs: false,
    annexeCatalogue: false,
    annexePolitiqueCommerciale: false,
    annexeFichesTechniques: false,
    annexeReporting: false,
    annexeHistoriqueCommissions: false,
    annexeFormulaireRSAC: false,
    
    // 17. Pi√®ces justificatives
    piecesMandantKbis: false,
    piecesMandantPolitique: false,
    piecesMandantCatalogue: false,
    piecesMandantTarifs: false,
    piecesAgentKbisRSAC: false,
    piecesAgentRCPro: false,
    piecesAgentIdentite: false,
  });
  
  // √âtats individuels pour chaque pi√®ce justificative - agence commerciale
  const [agenceMandantKbisFile, setAgenceMandantKbisFile] = useState<File | null>(null);
  const [agenceMandantPolitiqueFile, setAgenceMandantPolitiqueFile] = useState<File | null>(null);
  const [agenceMandantCatalogueFile, setAgenceMandantCatalogueFile] = useState<File | null>(null);
  const [agenceMandantTarifsFile, setAgenceMandantTarifsFile] = useState<File | null>(null);
  const [agenceAgentRSACFile, setAgenceAgentRSACFile] = useState<File | null>(null);
  const [agenceAgentRCProFile, setAgenceAgentRCProFile] = useState<File | null>(null);
  const [agenceAgentIdentiteFile, setAgenceAgentIdentiteFile] = useState<File | null>(null);
  const [agenceAnnexesFiles, setAgenceAnnexesFiles] = useState<File[]>([]);
  
  // States pour attestation de propri√©t√© immobili√®re
  const [attestationActeDecesFiles, setAttestationActeDecesFiles] = useState<File[]>([]);
  const [attestationIdentiteHeritiers, setAttestationIdentiteHeritiers] = useState<File[]>([]);
  const [attestationTitrePropriete, setAttestationTitrePropriete] = useState<File[]>([]);
  const [attestationLivretFamille, setAttestationLivretFamille] = useState<File[]>([]);
  const [attestationTestament, setAttestationTestament] = useState<File[]>([]);
  const [attestationContratMariage, setAttestationContratMariage] = useState<File[]>([]);
  const [attestationCopropriete, setAttestationCopropriete] = useState<File[]>([]);
  const [attestationBaux, setAttestationBaux] = useState<File[]>([]);
  const [attestationHypotheque, setAttestationHypotheque] = useState<File[]>([]);
  const [attestationJustifDomicile, setAttestationJustifDomicile] = useState<File[]>([]);
  const [bailCommercialDiagnosticsFiles, setBailCommercialDiagnosticsFiles] = useState<File[]>([]); // Diagnostics bail commercial
  const [bailCommercialCautionFiles, setBailCommercialCautionFiles] = useState<File[]>([]); // Acte de caution
  
  // States pour Quitus / Reconnaissance de dette
  const [quitusCreancierIdentiteFiles, setQuitusCreancierIdentiteFiles] = useState<File[]>([]);
  const [quitusDebiteurIdentiteFiles, setQuitusDebiteurIdentiteFiles] = useState<File[]>([]);
  const [quitusPreuveDetteFiles, setQuitusPreuveDetteFiles] = useState<File[]>([]);
  const [quitusPreuveTransfertFiles, setQuitusPreuveTransfertFiles] = useState<File[]>([]);
  const [quitusEcheancierFiles, setQuitusEcheancierFiles] = useState<File[]>([]);
  const [quitusCautionIdentiteFiles, setQuitusCautionIdentiteFiles] = useState<File[]>([]);
  const [quitusPreuvesPaiementsFiles, setQuitusPreuvesPaiementsFiles] = useState<File[]>([]);
  const [quitusAncienneDetteFiles, setQuitusAncienneDetteFiles] = useState<File[]>([]);
  const [quitusJustifDomicileCreancierFiles, setQuitusJustifDomicileCreancierFiles] = useState<File[]>([]);
  const [quitusJustifDomicileDebiteurFiles, setQuitusJustifDomicileDebiteurFiles] = useState<File[]>([]);
  const [procurationMandantIdentiteUrl, setProcurationMandantIdentiteUrl] = useState<string | null>(null); // URL du document du mandant procuration
  const [procurationMandataireIdentiteFile, setProcurationMandataireIdentiteFile] = useState<File | null>(null); // Fichier pi√®ce d'identit√© mandataire
  const [mandatProtectionMandantIdentiteUrl, setMandatProtectionMandantIdentiteUrl] = useState<string | null>(null); // URL pi√®ce d'identit√© mandant
  const [mandatProtectionMandataireIdentiteFile, setMandatProtectionMandataireIdentiteFile] = useState<File | null>(null); // Fichier pi√®ce d'identit√© mandataire
  const [bailCommercialEtatLieuxFiles, setBailCommercialEtatLieuxFiles] = useState<File[]>([]); // √âtat des lieux
  const [bailCommercialCautionIdFiles, setBailCommercialCautionIdFiles] = useState<File[]>([]); // Pi√®ce d'identit√© caution
  const [bailCommercialAssuranceFiles, setBailCommercialAssuranceFiles] = useState<File[]>([]); // Attestation d'assurance
  const [bailProfessionnelOrdreFiles, setBailProfessionnelOrdreFiles] = useState<File[]>([]); // Attestation inscription ordre professionnel
  const [garantDocsFiles, setGarantDocsFiles] = useState<File[]>([]);
  const [bailDiagnosticsFiles, setBailDiagnosticsFiles] = useState<File[]>([]);
  
  // States pour convention d'indivision
  const [indivisairesIdentiteUrls, setIndivisairesIdentiteUrls] = useState<Record<number, string | null>>({}); // URLs des documents identit√© indivisaires clients
  const [indivisairesIdentiteFiles, setIndivisairesIdentiteFiles] = useState<Record<number, File[]>>({}); // Fichiers identit√© indivisaires non-clients
  const [indivisairesDomicileFiles, setIndivisairesDomicileFiles] = useState<Record<number, File[]>>({}); // Justificatifs domicile
  const [indivisairesContratMariageFiles, setIndivisairesContratMariageFiles] = useState<Record<number, File[]>>({}); // Contrats de mariage
  const [indivisairesLivretFamilleFiles, setIndivisairesLivretFamilleFiles] = useState<Record<number, File[]>>({}); // Livrets de famille
  const [indivisionTitreProprietFiles, setIndivisionTitreProprietFiles] = useState<File[]>([]); // Titre de propri√©t√©
  const [indivisionEvaluationFiles, setIndivisionEvaluationFiles] = useState<File[]>([]); // √âvaluation/estimation
  const [indivisionCadastreFiles, setIndivisionCadastreFiles] = useState<File[]>([]); // Relev√© cadastral
  const [indivisionDiagnosticsFiles, setIndivisionDiagnosticsFiles] = useState<File[]>([]); // Diagnostics
  const [indivisionBailFiles, setIndivisionBailFiles] = useState<File[]>([]); // Bail si bien lou√©
  const [indivisionProcurationFiles, setIndivisionProcurationFiles] = useState<File[]>([]); // Procurations
  const [indivisionMandatGerantFiles, setIndivisionMandatGerantFiles] = useState<File[]>([]); // Mandat du g√©rant
  const [indivisionAssuranceFiles, setIndivisionAssuranceFiles] = useState<File[]>([]); // Attestation d'assurance
  
  // States pour mainlev√©e d'hypoth√®que
  const [mainleveeCreancierMandatFiles, setMainleveeCreancierMandatFiles] = useState<File[]>([]); // Mandat repr√©sentant
  const [mainleveeCreancierKbisFiles, setMainleveeCreancierKbisFiles] = useState<File[]>([]); // KBIS
  const [mainleveeCreancierDelegationFiles, setMainleveeCreancierDelegationFiles] = useState<File[]>([]); // D√©l√©gation de pouvoir
  const [mainleveeCreancierIdentiteFiles, setMainleveeCreancierIdentiteFiles] = useState<File[]>([]); // Identit√© repr√©sentant
  const [mainleveeDebiteursIdentiteFiles, setMainleveeDebiteursIdentiteFiles] = useState<Record<number, File[]>>({}); // Identit√©s d√©biteurs
  const [mainleveeDebiteursJustifDomicileFiles, setMainleveeDebiteursJustifDomicileFiles] = useState<Record<number, File[]>>({}); // Justif domicile
  const [mainleveeActeConstitutifFiles, setMainleveeActeConstitutifFiles] = useState<File[]>([]); // Acte constitutif
  const [mainleveeInscriptionHypothequeFiles, setMainleveeInscriptionHypothequeFiles] = useState<File[]>([]); // Inscription hypoth√©caire
  const [mainleveeAttestationRemboursementFiles, setMainleveeAttestationRemboursementFiles] = useState<File[]>([]); // Attestation remboursement
  
  // States pour contrat de mariage
  const [contratMariageEpoux1IdentiteFiles, setContratMariageEpoux1IdentiteFiles] = useState<File[]>([]); // Identit√© √©poux 1
  const [contratMariageEpoux2IdentiteFiles, setContratMariageEpoux2IdentiteFiles] = useState<File[]>([]); // Identit√© √©poux 2
  const [contratMariageEpoux1ActeNaissanceFiles, setContratMariageEpoux1ActeNaissanceFiles] = useState<File[]>([]); // Acte naissance √©poux 1
  const [contratMariageEpoux2ActeNaissanceFiles, setContratMariageEpoux2ActeNaissanceFiles] = useState<File[]>([]); // Acte naissance √©poux 2
  const [contratMariageEpoux1DomicileFiles, setContratMariageEpoux1DomicileFiles] = useState<File[]>([]); // Justif domicile √©poux 1
  const [contratMariageEpoux2DomicileFiles, setContratMariageEpoux2DomicileFiles] = useState<File[]>([]); // Justif domicile √©poux 2
  const [contratMariageContratInitialFiles, setContratMariageContratInitialFiles] = useState<File[]>([]); // Contrat mariage initial (si changement)
  const [contratMariageJustificatifMariageFiles, setContratMariageJustificatifMariageFiles] = useState<File[]>([]); // Justificatif mariage
  const [contratMariageAccordEnfantsFiles, setContratMariageAccordEnfantsFiles] = useState<File[]>([]); // Accord enfants majeurs
  const [contratMariageTitresProprieteFiles, setContratMariageTitresProprieteFiles] = useState<File[]>([]); // Titres propri√©t√©
  const [contratMariageEstimationBiensFiles, setContratMariageEstimationBiensFiles] = useState<File[]>([]); // Estimation biens
  const [contratMariageActeDecesFiles, setContratMariageActeDecesFiles] = useState<File[]>([]); // Acte d√©c√®s (si veuf)
  const [contratMariageConsentementEnfantsFiles, setContratMariageConsentementEnfantsFiles] = useState<File[]>([]); // Consentement enfants majeurs
  const [contratMariageCertificatBansFiles, setContratMariageCertificatBansFiles] = useState<File[]>([]); // Certificat publication bans
  const [contratMariageDecisionJugeFiles, setContratMariageDecisionJugeFiles] = useState<File[]>([]); // D√©cision/autorisation judiciaire
  
  // State pour PACS - Pi√®ces justificatives
  const [pacsPartenaire1IdentiteFiles, setPacsPartenaire1IdentiteFiles] = useState<File[]>([]); // Identit√© partenaire 1
  const [pacsPartenaire2IdentiteFiles, setPacsPartenaire2IdentiteFiles] = useState<File[]>([]); // Identit√© partenaire 2
  const [pacsPartenaire1ActeNaissanceFiles, setPacsPartenaire1ActeNaissanceFiles] = useState<File[]>([]); // Acte naissance partenaire 1
  const [pacsPartenaire2ActeNaissanceFiles, setPacsPartenaire2ActeNaissanceFiles] = useState<File[]>([]); // Acte naissance partenaire 2
  const [pacsPartenaire1DomicileFiles, setPacsPartenaire1DomicileFiles] = useState<File[]>([]); // Justif domicile partenaire 1
  const [pacsPartenaire2DomicileFiles, setPacsPartenaire2DomicileFiles] = useState<File[]>([]); // Justif domicile partenaire 2
  const [pacsPartenaire1DivorceFiles, setPacsPartenaire1DivorceFiles] = useState<File[]>([]); // Jugement divorce partenaire 1
  const [pacsPartenaire2DivorceFiles, setPacsPartenaire2DivorceFiles] = useState<File[]>([]); // Jugement divorce partenaire 2
  const [pacsPartenaire1DecesFiles, setPacsPartenaire1DecesFiles] = useState<File[]>([]); // Acte d√©c√®s conjoint pr√©c√©dent partenaire 1
  const [pacsPartenaire2DecesFiles, setPacsPartenaire2DecesFiles] = useState<File[]>([]); // Acte d√©c√®s conjoint pr√©c√©dent partenaire 2
  const [pacsPartenaire1CertificatCoutumeFiles, setPacsPartenaire1CertificatCoutumeFiles] = useState<File[]>([]); // Certificat coutume √©tranger partenaire 1
  const [pacsPartenaire2CertificatCoutumeFiles, setPacsPartenaire2CertificatCoutumeFiles] = useState<File[]>([]); // Certificat coutume √©tranger partenaire 2
  const [pacsPartenaire1CertificatNonPacsFiles, setPacsPartenaire1CertificatNonPacsFiles] = useState<File[]>([]); // Certificat non-PACS √©tranger partenaire 1
  const [pacsPartenaire2CertificatNonPacsFiles, setPacsPartenaire2CertificatNonPacsFiles] = useState<File[]>([]); // Certificat non-PACS √©tranger partenaire 2
  const [pacsPartenaire1TraductionsFiles, setPacsPartenaire1TraductionsFiles] = useState<File[]>([]); // Traductions certifi√©es partenaire 1
  const [pacsPartenaire2TraductionsFiles, setPacsPartenaire2TraductionsFiles] = useState<File[]>([]); // Traductions certifi√©es partenaire 2
  
  // State pour Donation entre √©poux - Pi√®ces justificatives
  const [donationEpoux1IdentiteFiles, setDonationEpoux1IdentiteFiles] = useState<File[]>([]); // Identit√© √©poux 1
  const [donationEpoux2IdentiteFiles, setDonationEpoux2IdentiteFiles] = useState<File[]>([]); // Identit√© √©poux 2
  const [donationEpoux1LivretFamilleFiles, setDonationEpoux1LivretFamilleFiles] = useState<File[]>([]); // Livret famille (√©poux 1 peut uploader)
  const [donationEpoux2LivretFamilleFiles, setDonationEpoux2LivretFamilleFiles] = useState<File[]>([]); // Livret famille (√©poux 2 peut uploader)
  const [donationEpoux1ActeMariageFiles, setDonationEpoux1ActeMariageFiles] = useState<File[]>([]); // Acte mariage
  const [donationEpoux2ActeMariageFiles, setDonationEpoux2ActeMariageFiles] = useState<File[]>([]); // Acte mariage (doublon pour sym√©trie)
  const [donationEpoux1ContratMariageFiles, setDonationEpoux1ContratMariageFiles] = useState<File[]>([]); // Contrat mariage si existant
  const [donationEpoux2ContratMariageFiles, setDonationEpoux2ContratMariageFiles] = useState<File[]>([]); // Contrat mariage
  const [donationEpoux1DomicileFiles, setDonationEpoux1DomicileFiles] = useState<File[]>([]); // Justificatif domicile √©poux 1
  const [donationEpoux2DomicileFiles, setDonationEpoux2DomicileFiles] = useState<File[]>([]); // Justificatif domicile √©poux 2
  const [donationTitresProprieteBiensFiles, setDonationTitresProprieteBiensFiles] = useState<File[]>([]); // Titres propri√©t√© biens immobiliers
  const [donationEstimationBiensFiles, setDonationEstimationBiensFiles] = useState<File[]>([]); // Estimations / √©valuations
  const [donationHypothequesFiles, setDonationHypothequesFiles] = useState<File[]>([]); // Hypoth√®ques
  const [donationSituationLocativeFiles, setDonationSituationLocativeFiles] = useState<File[]>([]); // Situation locative
  const [donationRIBFiles, setDonationRIBFiles] = useState<File[]>([]); // RIB pour donation financi√®re
  const [donationCarteGriseFiles, setDonationCarteGriseFiles] = useState<File[]>([]); // Carte grise v√©hicule
  const [donationAutresDocumentsFiles, setDonationAutresDocumentsFiles] = useState<File[]>([]); // Autres documents
  
  // State pour Donation Simple (8 file types)
  const [donationSimpleDonateurIdentiteFiles, setDonationSimpleDonateurIdentiteFiles] = useState<File[]>([]);
  const [donationSimpleDonateurLivretFamilleFiles, setDonationSimpleDonateurLivretFamilleFiles] = useState<File[]>([]);
  const [donationSimpleDonateurDomicileFiles, setDonationSimpleDonateurDomicileFiles] = useState<File[]>([]);
  const [donationSimpleDonatairePieceIdentiteFiles, setDonationSimpleDonatairePieceIdentiteFiles] = useState<File[]>([]);
  const [donationSimpleDonataireDomicileFiles, setDonationSimpleDonataireDomicileFiles] = useState<File[]>([]);
  const [donationSimpleTitreProprieteFiles, setDonationSimpleTitreProprieteFiles] = useState<File[]>([]);
  const [donationSimpleEvaluationBienFiles, setDonationSimpleEvaluationBienFiles] = useState<File[]>([]);
  const [donationSimpleAutresDocumentsFiles, setDonationSimpleAutresDocumentsFiles] = useState<File[]>([]);

  // State pour Donation Simple
  const [donationSimpleData, setDonationSimpleData] = useState({
    // 1. Type de donation
    typeDonation: "", // biens_meubles / biens_immobiliers / sommes_argent / nue_propriete / usufruit / parts_sociales / manuelle / mixte
    donationAvecCharges: false,
    descriptionCharges: "",
    donationAvecReserveUsufruit: false,
    donationAvecDroitRetour: false,
    donationEffetImmediat: true,
    donationPresenteIrrevocable: true,
    
    // 2. Identit√© donateur
    donateur: {
      isClient: false,
      clientId: "",
      nom: "",
      prenom: "",
      nomNaissance: "",
      adresseComplete: "",
      telephone: "",
      email: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      profession: "",
      situationFamiliale: "", // celibataire / marie / divorce / veuf / pacse
      regimeMatrimonial: "", // communaute / separation / participation_acquets
      situationFiscale: "",
    },
    
    // 3. Identit√© donataire
    donataire: {
      isClient: false,
      clientId: "",
      nom: "",
      prenom: "",
      nomNaissance: "",
      adresseComplete: "",
      telephone: "",
      email: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      profession: "",
      lienDonateur: "", // enfant / parent / frere_soeur / neveu_niece / cousin / ami / conjoint_pacse / autre
      lienDonateurAutrePrecision: "", // Si lienDonateur === "autre"
    },
    
    // 4. Enfants / h√©ritiers du donateur
    nombreEnfants: "",
    enfants: [{
      id: 1,
      nom: "",
      prenom: "",
      dateNaissance: "",
    }],
    donationHorsPartSuccessorale: false,
    donationAvancementPart: false,
    
    // 5. Description des biens
    // A. Bien immobilier
    bienImmobilier: {
      adresseComplete: "",
      natureBien: "", // maison / appartement / terrain / dependances
      designationCadastrale: "",
      sectionCadastrale: "",
      numeroCadastral: "",
      contenance: "",
      descriptionDetaille: "",
      situationLocative: "", // libre / loue
      valeurVenale: "",
      existenceHypotheques: false,
      montantHypotheques: "",
      repartitionUsufruit: "",
      repartitionNuePropriete: "",
    },
    
    // B. Bien mobilier corporel
    bienMobilier: {
      descriptionPrecise: "",
      numeroSerie: "",
      valeurEstimee: "",
      factureExistante: false,
    },
    
    // C. Somme d'argent
    sommesArgent: {
      montantExact: "",
      provenanceFonds: "",
      modalite: "", // virement / cheque / especes
      dateTransfert: "",
    },
    
    // D. Parts sociales / actions
    partsSociales: {
      typeSociete: "",
      nombreParts: "",
      valeurUnitaire: "",
      pourcentageCapital: "",
      agrementObligatoire: false,
      clausesSpecifiques: "",
    },
    
    // E. Nue-propri√©t√© / Usufruit
    nueProprieteUsufruit: {
      valeurNuePropriete: "",
      valeurUsufruit: "",
      duree: "", // temporaire / viager
      repartitionCharges: "",
      usufruitSimultaneConjoint: false,
    },
    
    // 6. Clauses optionnelles
    clausesOptionnelles: {
      // A. R√©serve d'usufruit
      reserveUsufruit: false,
      etendueUsufruit: "",
      droitUsageHabitation: false,
      
      // B. Droit de retour conventionnel
      droitRetour: false,
      etendueRetour: "", // totalite / part_recue
      
      // C. Charge impos√©e
      chargeImposee: false,
      descriptionCharge: "",
      montantNatureCharge: "",
      conditionsExecution: "",
      
      // D. Affectation particuli√®re
      usageProfessionnel: false,
      exclusionCommunaute: false,
      
      // E. Donation rapportable
      donationRapportable: "", // avancement_hoirie / hors_part
      
      // F. Clause d'inali√©nabilit√©
      clauseInalienabilite: false,
      dureeInalienabilite: "",
      motifLegitime: "",
      autorisationRequise: false,
    },
    
    // 7. Mentions l√©gales
    mentionsLegales: {
      caracterePresentIrrevocable: true,
      acceptationExpresse: false,
      consentementEclaire: false,
      mentionReserveHereditaire: true,
      modalitesTransfertPropriete: true,
      rappelArticlesCodeCivil: true,
      obligationsFiscales: true,
    },
    
    // 8. Acceptation du donataire
    acceptationDonataire: {
      dansActe: true, // true = dans l'acte, false = acte s√©par√©
      dateAcceptation: "",
      lieuAcceptation: "",
    },
    
    // 9. Modalit√©s de remise du bien
    modalitesRemise: {
      modeRemise: "", // immediate / differee / don_manuel_deja_realise / symbolique
      lieuRemise: "",
      dateRemise: "",
      personneResponsable: "",
      documentRemis: "", // carte_grise / certificat / facture / cle / autre
    },
  });

  // State pour Acte de Notori√©t√© - Fichiers
  const [acteNotorieteDefuntActeDeces, setActeNotorieteDefuntActeDeces] = useState<File[]>([]);
  const [acteNotorieteDefuntActeNaissance, setActeNotorieteDefuntActeNaissance] = useState<File[]>([]);
  const [acteNotorieteDefuntLivretFamille, setActeNotorieteDefuntLivretFamille] = useState<File[]>([]);
  const [acteNotorieteDefuntActeMariage, setActeNotorieteDefuntActeMariage] = useState<File[]>([]);
  const [acteNotorieteDefuntContratMariage, setActeNotorieteDefuntContratMariage] = useState<File[]>([]);
  const [acteNotorieteDefuntJugementDivorce, setActeNotorieteDefuntJugementDivorce] = useState<File[]>([]);
  const [acteNotorieteDefuntTestament, setActeNotorieteDefuntTestament] = useState<File[]>([]);
  const [acteNotorieteDefuntDonations, setActeNotorieteDefuntDonations] = useState<File[]>([]);
  const [acteNotorieteDefuntJustifDomicile, setActeNotorieteDefuntJustifDomicile] = useState<File[]>([]);
  const [acteNotorieteDefuntPieceIdentite, setActeNotorieteDefuntPieceIdentite] = useState<File[]>([]);
  
  // Fichiers h√©ritiers (dynamiques par h√©ritier)
  const [acteNotorieteHeritiersIdentite, setActeNotorieteHeritiersIdentite] = useState<Record<number, File[]>>({});
  const [acteNotorieteHeritiersActeNaissance, setActeNotorieteHeritiersActeNaissance] = useState<Record<number, File[]>>({});
  const [acteNotorieteHeritiersJustifDomicile, setActeNotorieteHeritiersJustifDomicile] = useState<Record<number, File[]>>({});
  const [acteNotorieteHeritiersJugementTutelle, setActeNotorieteHeritiersJugementTutelle] = useState<Record<number, File[]>>({});
  const [acteNotorieteHeritiersActeDecesPredeced, setActeNotorieteHeritiersActeDecesPredeced] = useState<Record<number, File[]>>({});
  const [acteNotorieteHeritierFiles, setActeNotorieteHeritierFiles] = useState<Record<number, File[]>>({});
  
  // Fichiers t√©moins (dynamiques par t√©moin)
  const [acteNotorieteTemoinsIdentite, setActeNotorieteTemoinsIdentite] = useState<Record<number, File[]>>({});
  const [acteNotorieteTemoinsAttestation, setActeNotorieteTemoinsAttestation] = useState<Record<number, File[]>>({});
  const [acteNotorieteTemoinFiles, setActeNotorieteTemoinFiles] = useState<Record<number, File[]>>({});
  
  // Fichiers conjoint survivant
  const [acteNotorieteConjointDonationEntreEpoux, setActeNotorieteConjointDonationEntreEpoux] = useState<File[]>([]);
  const [acteNotorieteConjointContratMariage, setActeNotorieteConjointContratMariage] = useState<File[]>([]);
  const [acteNotorieteConjointJustificatifs, setActeNotorieteConjointJustificatifs] = useState<File[]>([]);
  
  // Fichiers preuves filiation / possession d'√©tat
  const [acteNotorietePreuvePhotos, setActeNotorietePreuvePhotos] = useState<File[]>([]);
  const [acteNotorietePreuveCertificats, setActeNotorietePreuveCertificats] = useState<File[]>([]);
  const [acteNotorietePreuveDocumentsScolaires, setActeNotorietePreuveDocumentsScolaires] = useState<File[]>([]);
  const [acteNotorietePreuveCorrespondances, setActeNotorietePreuveCorrespondances] = useState<File[]>([]);
  const [acteNotorietePreuveAutres, setActeNotorietePreuveAutres] = useState<File[]>([]);
  
  // Fichiers h√©ritiers collectifs
  const [acteNotorieteHeritiersActesNaissance, setActeNotorieteHeritiersActesNaissance] = useState<File[]>([]);
  const [acteNotorieteHeritiersPiecesIdentite, setActeNotorieteHeritiersPiecesIdentite] = useState<File[]>([]);
  const [acteNotorieteHeritiersJustifsDomicile, setActeNotorieteHeritiersJustifsDomicile] = useState<File[]>([]);
  const [acteNotorieteHeritiersLivretsFamille, setActeNotorieteHeritiersLivretsFamille] = useState<File[]>([]);
  const [acteNotorieteHeritiersActesNotoriete, setActeNotorieteHeritiersActesNotoriete] = useState<File[]>([]);
  const [acteNotorieteHeritiersCertificatsHeredite, setActeNotorieteHeritiersCertificatsHeredite] = useState<File[]>([]);
  const [acteNotorieteHeritiersTutelleCuratelle, setActeNotorieteHeritiersTutelleCuratelle] = useState<File[]>([]);
  
  // Fichiers t√©moins collectifs
  const [acteNotorieteTemoinsPiecesIdentite, setActeNotorieteTemoinsPiecesIdentite] = useState<File[]>([]);
  const [acteNotorieteTemoinsJustifsDomicile, setActeNotorieteTemoinsJustifsDomicile] = useState<File[]>([]);
  
  // Autres documents
  const [acteNotorieteAutresAttestations, setActeNotorieteAutresAttestations] = useState<File[]>([]);
  const [acteNotorieteAutresCertificatsMedicaux, setActeNotorieteAutresCertificatsMedicaux] = useState<File[]>([]);
  const [acteNotorieteAutresCorrespondances, setActeNotorieteAutresCorrespondances] = useState<File[]>([]);
  const [acteNotorieteAutresDocuments, setActeNotorieteAutresDocuments] = useState<File[]>([]);

  // State pour Acte de Notori√©t√© - Data
  const [acteNotorieteData, setActeNotorieteData] = useState({
    // 1. Type d'acte de notori√©t√©
    typeActe: "", // succession / filiation / reconstitution_fait / qualite_hereditaire
    
    // 2. Informations sur le d√©funt (si succession)
    defunt: {
      nom: "",
      prenom: "",
      nomNaissance: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      profession: "",
      adresseAuDeces: "",
      dateDeces: "",
      lieuDeces: "",
      situationMatrimoniale: "", // celibataire / marie / divorce / veuf / pacse
      regimeMatrimonial: "", // communaute / separation / participation_acquets / autre
      regimeMatrimonialAutre: "",
      dateMariage: "",
      lieuMariage: "",
      pacsExistant: false,
      datePacs: "",
      lieuPacs: "",
      testamentsConnus: false,
      donationsEntreEpoux: false,
      donationsAnterieures: false,
      listeDonations: "",
    },
    
    // 3. H√©ritiers (array)
    heritiers: [{
      id: 1,
      clientId: "",
      // A. Informations civiles
      nom: "",
      prenom: "",
      nomNaissance: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      profession: "",
      adresseComplete: "",
      telephone: "",
      email: "",
      
      // B. Lien de parent√©
      lienParente: "", // conjoint / enfant / parent / frere_soeur / autre
      lienAutrePrecision: "",
      
      // C. Repr√©sentation (si pr√©d√©c√©d√©)
      estPredeced: false,
      enfantsPredeced: [{
        id: 1,
        nom: "",
        prenom: "",
        dateNaissance: "",
        ordreRepresentation: "",
      }],
      
      // D. Capacit√© juridique
      estMineur: false,
      estMajeurProtege: false,
      typeProtection: "", // tutelle / curatelle / habilitation_familiale
      tuteurNom: "",
      tuteurPrenom: "",
      tuteurAdresse: "",
      
      // E. Option successorale
      optionSuccessorale: "", // acceptation_pure / acceptation_concurrence_actif / renonciation
    }],
    
    // 4. Conjoint survivant (si applicable)
    conjointSurvivant: {
      existe: false,
      donationEntreEpouxExiste: false,
      electionOptionnelle: "", // usufruit / quart_pleine_propriete
      droitLogementTemporaire: false,
      droitLogementViager: false,
      contratMariageExiste: false,
      clausesParticulieres: false,
      descriptionClausesParticulieres: "", // preciput / clause_attribution / autre
    },
    
    // 5. T√©moins (pour actes hors succession classique)
    temoins: [{
      id: 1,
      nom: "",
      prenom: "",
      adresse: "",
      dateNaissance: "",
      lieuNaissance: "",
      profession: "",
      lienFamille: "", // ami_famille / voisin / collegue / autre (ne doit pas √™tre h√©ritier)
      declarationEcrite: "",
    }],
    
    // 6. Preuves (pour filiation / possession d'√©tat)
    preuvesFiliation: {
      typesPreuves: [], // photos / certificats / documents_scolaires / correspondances / autres
      descriptionPreuves: "",
    },
    
    // 7. Contenu de l'acte
    contenuActe: {
      // A. D√©clarations des h√©ritiers
      reconnaissanceQualiteHeritiers: true,
      declarationAbsenceAutresHeritiers: true,
      declarationTestament: "", // aucun / existe / inconnu
      declarationDonations: "", // aucune / existent / inconnu
      absenceLitigeQualiteHereditaire: true,
      
      // B. Ordre successoral
      conjointSurvivantOrdre: false,
      heritiers1erOrdre: false, // descendants
      heritiers2eOrdre: false, // parents + freres/soeurs
      heritiers3eOrdre: false, // ascendants autres
      heritiers4eOrdre: false, // collat√©raux √©loign√©s
      
      // C. Parts h√©r√©ditaires (calcul√©es automatiquement)
      partsHereditaires: [{
        heritierId: 1,
        partPleinePropriete: "",
        partUsufruit: "",
        partNuePropriete: "",
      }],
      
      // D. Mentions l√©gales
      referenceCodeCivil: true,
      responsabiliteDeclarants: true,
      revocationPossibleFraude: true,
      mentionLecture: true,
    },
    
    // 8. Formalit√©s
    formalites: {
      enregistrementFCDDV: false, // Fichier Central des Dispositions de Derni√®res Volont√©s
      receptionPieces: false,
      authentificationElectronique: false,
      transmissionHeritiers: false,
      transmissionBanques: false,
    },
  });

  // State pour Partage Successoral - Fichiers
  const [partageDefuntActeDeces, setPartageDefuntActeDeces] = useState<File[]>([]);
  const [partageDefuntLivretFamille, setPartageDefuntLivretFamille] = useState<File[]>([]);
  const [partageDefuntContratMariage, setPartageDefuntContratMariage] = useState<File[]>([]);
  const [partageDefuntTestaments, setPartageDefuntTestaments] = useState<File[]>([]);
  const [partageDefuntDonationsEntreEpoux, setPartageDefuntDonationsEntreEpoux] = useState<File[]>([]);
  const [partageDefuntDonationsAnterieures, setPartageDefuntDonationsAnterieures] = useState<File[]>([]);
  const [partageDefuntTitresPropriete, setPartageDefuntTitresPropriete] = useState<File[]>([]);
  const [partageDefuntRelevesBancaires, setPartageDefuntRelevesBancaires] = useState<File[]>([]);
  const [partageDefuntBilansEntreprises, setPartageDefuntBilansEntreprises] = useState<File[]>([]);
  const [partageDefuntInventaireMobilier, setPartageDefuntInventaireMobilier] = useState<File[]>([]);
  
  // Fichiers h√©ritiers (dynamiques par h√©ritier)
  const [partageHeritierFiles, setPartageHeritierFiles] = useState<Record<number, File[]>>({});
  
  // Fichiers biens immobiliers (dynamiques par bien)
  const [partageBienImmobilierFiles, setPartageBienImmobilierFiles] = useState<Record<number, File[]>>({});
  
  // Fichiers autres
  const [partageAutresDiagnostics, setPartageAutresDiagnostics] = useState<File[]>([]);
  const [partageAutresEvaluations, setPartageAutresEvaluations] = useState<File[]>([]);
  const [partageAutresStatutsSocietes, setPartageAutresStatutsSocietes] = useState<File[]>([]);
  const [partageAutresDocuments, setPartageAutresDocuments] = useState<File[]>([]);

  // State pour Partage Successoral - Data
  const [partageSuccessoralData, setPartageSuccessoralData] = useState({
    // 1. Informations sur la succession
    succession: {
      defunt: {
        nom: "",
        prenom: "",
        nomNaissance: "",
        dateNaissance: "",
        lieuNaissance: "",
        dateDeces: "",
        lieuDeces: "",
        nationalite: "",
        profession: "",
        adresseAuDeces: "",
        situationMatrimoniale: "",
        regimeMatrimonial: "",
        testamentsExistants: false,
        donationsEntreEpoux: false,
        donationsAnterieures: false,
      },
      notaire: {
        nom: "",
        etude: "",
        adresse: "",
        telephone: "",
        email: "",
      },
    },
    
    // 2. H√©ritiers / L√©gataires
    heritiers: [{
      id: 1,
      clientId: "",
      // Informations d'√©tat civil
      nom: "",
      prenom: "",
      nomNaissance: "",
      adresse: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      profession: "",
      telephone: "",
      email: "",
      lienDefunt: "",
      
      // Situation juridique
      heritierReservataire: false,
      legataireUniversel: false,
      legataireATitreUniversel: false,
      legataireParticulier: false,
      heritierParRepresentation: false,
      representeQui: "",
      acceptationRenonciation: "", // accepte / renonce / benefice_inventaire
      majeurMineur: "majeur",
      sousTutelleCuratelle: false,
      typeProtection: "",
      tuteurNom: "",
      
      // Quote-part
      quotePart: "",
    }],
    
    // 3. Inventaire de l'actif successoral
    actif: {
      // A. Biens immobiliers
      biensImmobiliers: [{
        id: 1,
        adresse: "",
        description: "",
        designationCadastrale: "",
        valeurVenale: "",
        origineBien: "", // propre / commun / indivis
        quotePartDefunt: "",
        etatLocatif: "",
        loyer: "",
        hypotheques: "",
        copropriete: false,
        lots: "",
        chargesCopro: "",
      }],
      
      // B. Biens meubles
      biensMeubles: {
        mobilierForfait5Pct: true,
        mobilierValeurReelle: "",
        vehicules: "",
        bijoux: "",
        oeuvresArt: "",
        collections: "",
        materielProfessionnel: "",
      },
      
      // C. Comptes bancaires
      comptesBancaires: [{
        id: 1,
        banque: "",
        typeCompte: "",
        numeroCompte: "",
        soldeAuDeces: "",
        interetsCourus: "",
      }],
      
      // D. Assurance-vie
      assurancesVie: [{
        id: 1,
        compagnie: "",
        numeroContrat: "",
        beneficiaires: "",
        capitalVerse: "",
        primesAvant70Ans: "",
        primesApres70Ans: "",
      }],
      
      // E. Parts sociales
      partsSociales: [{
        id: 1,
        nature: "", // SARL / SAS / SCI / EI / exploitation_agricole
        nomEntite: "",
        nombreParts: "",
        valeurEstimee: "",
        droitsAttaches: "",
        pacteDutreil: false,
      }],
      
      // F. Biens √† l'√©tranger
      biensEtranger: [{
        id: 1,
        pays: "",
        adresse: "",
        valeur: "",
        regimeFiscal: "",
      }],
      
      // G. Usufruit / Nue-propri√©t√©
      usufruitNuePropriete: [{
        id: 1,
        bienConcerne: "",
        valeurUsufruit: "",
        valeurNuePropriete: "",
        baremeFiscal: "",
      }],
    },
    
    // 4. Passif successoral
    passif: {
      dettes: [{
        id: 1,
        type: "", // credit / fiscale / facture / personnelle / professionnelle
        description: "",
        montant: "",
      }],
      fraisFuneraires: "",
      fraisDerniereMaladie: "",
      impots: {
        ir: "",
        ifi: "",
        taxeFonciere: "",
        taxeHabitation: "",
      },
    },
    
    // 5. Type de partage et cr√©ation des lots
    partage: {
      typePartage: "", // total / partiel / attribution_preferentielle / amiable / judiciaire
      
      lots: [{
        id: 1,
        nomLot: "",
        biensListe: "",
        valeurTotale: "",
        attributionHeritier: "",
        quotePartTheorique: "",
        ecart: "",
        soulte: "",
        modalitesPaiementSoulte: "",
      }],
      
      attributionsPreferentielles: [{
        id: 1,
        typeBien: "", // logement_familial / vehicule / entreprise / fonds_commerce / parts_societe
        description: "",
        beneficiaire: "",
        conditions: "", // indivision / pleine_propriete
      }],
      
      donationsARapporter: [{
        id: 1,
        date: "",
        montant: "",
        beneficiaire: "",
        rapportable: true,
        evaluationAuJourPartage: "",
        impactLots: "",
      }],
      
      soultes: [{
        id: 1,
        montant: "",
        quiVerse: "",
        quiRecoit: "",
        modalitesPaiement: "",
        interets: "",
        garantie: "",
      }],
    },
    
    // 6. D√©clarations et clauses
    declarations: {
      reconnaissanceLots: true,
      absenceReticenceFraude: true,
      volonteLibre: true,
      acceptationSoultes: true,
      acceptationIndivisionResiduelle: false,
      
      clauseGarantieEviction: false,
      clausePurgeHypotheques: false,
      clauseRenonciationComplementPart: false,
      clauseRepartitionFrais: false,
      clauseRenonciationReduction: false,
      
      indivisionResiduelle: false,
      dureeIndivision: "",
      gestionIndivision: "",
      quotePartIndivision: "",
      pouvoirsIndivision: "",
    },
    
    // 7. Formalit√©s
    formalites: {
      enregistrementFiscal: false,
      publicationSPF: false,
      mutationCadastrale: false,
      paiementDroitsPartage: false,
      radiationHypotheque: false,
      miseAJourBanques: false,
      miseAJourAssurances: false,
    },
  });

  // State pour Testament (fichiers)
  const [testamentIdentiteTestateur, setTestamentIdentiteTestateur] = useState<File[]>([]);
  const [testamentLivretFamille, setTestamentLivretFamille] = useState<File[]>([]);
  const [testamentCapaciteJuridique, setTestamentCapaciteJuridique] = useState<File[]>([]);
  const [testamentIdentiteTemoins, setTestamentIdentiteTemoins] = useState<File[]>([]);
  const [testamentDomicileTemoins, setTestamentDomicileTemoins] = useState<File[]>([]);
  const [testamentAttestationsTemoins, setTestamentAttestationsTemoins] = useState<File[]>([]);
  const [testamentCasiersTemoins, setTestamentCasiersTemoins] = useState<File[]>([]);
  const [testamentTitresPropriete, setTestamentTitresPropriete] = useState<File[]>([]);
  const [testamentRelevesBancaires, setTestamentRelevesBancaires] = useState<File[]>([]);
  const [testamentContratMariage, setTestamentContratMariage] = useState<File[]>([]);
  const [testamentAutresJustificatifs, setTestamentAutresJustificatifs] = useState<File[]>([]);
  const [testamentTestamentMystique, setTestamentTestamentMystique] = useState<File[]>([]); // Le testament cachet√© lui-m√™me

  // State pour Testament
  const [testamentData, setTestamentData] = useState({
    // 1. Informations g√©n√©rales
    typeTestament: "", // authentique / mystique
    caractereTestament: "", // initial / revocation / modification_codicille
    dateSouhaiteeRedaction: "",
    langueTestateur: "", // Langue comprise par le testateur (remplace langueComprise)
    autreLangue: "", // Pr√©cision si langue = "autre"
    interpreteNecessaire: false,
    interpreteNom: "",
    interpretePrenom: "",
    interpreteQualification: "",
    interpreteLangueTraduite: "",
    interpreteAttestationFidelite: "",
    interpreteSignature: "",
    
    // 2. Identit√© testateur
    clientId: "",
    testateurNom: "",
    testateurPrenom: "",
    testateurNomNaissance: "",
    testateurDateNaissance: "",
    testateurLieuNaissance: "",
    testateurNationalite: "",
    testateurProfession: "",
    testateurSituationFamiliale: "",
    testateurAdresse: "",
    testateurTelephone: "",
    testateurEmail: "",
    testateurPieceType: "",
    testateurPieceNumero: "",
    testateurPieceAutorite: "",
    testateurPieceExpiration: "",
    capaciteJuridiqueConfirmee: false,
    sousTutelleCuratelle: false,
    
    // 3. H√©ritiers r√©servataires
    heritiersReservataires: {
      enfants: [] as Array<{nom: string; prenom: string; dateNaissance: string}>,
      descendants: [] as Array<{nom: string; prenom: string; lien: string}>,
      nomPrenomPere: "",
      nomPrenomMere: "",
      pereVivant: "",
      mereVivante: "",
    },
    
    // 4. L√©gataires
    legataires: [] as Array<{nom: string; prenom: string; lien: string; adresse: string}>,
    
    // 5. Dispositions testamentaires
    dispositions: {
      legsUniversel: false,
      detailsLegsUniversel: "",
      legsTitreUniversel: false,
      detailsLegsTitreUniversel: "",
      legsParticuliers: false,
      listeLegsParticuliers: [] as Array<{description: string; beneficiaire: string}>,
      chargesConditions: false,
      detailsChargesConditions: "",
      demembrement: false,
      detailsDemembrement: "",
      droitRetour: false,
      detailsDroitRetour: "",
      exheredation: false,
      detailsExheredation: "",
      executeurTestamentaire: false,
      nomExecuteur: "",
      adresseExecuteur: "",
    },
    
    // 6. Situation patrimoniale
    patrimoine: {
      immobiliers: [] as Array<{adresse: string; type: string; valeur: string}>,
      avoirsFinanciers: [] as Array<{type: string; etablissement: string; montant: string}>,
      biensMeubles: [] as Array<{description: string; valeur: string}>,
      partsSociales: [] as Array<{societe: string; nombre: string; valeur: string}>,
    },
    
    // 7. R√©gime matrimonial
    regimeMatrimonial: {
      nature: "",
      contratMariage: "",
      notaireContrat: "",
      biensPropres: "",
      biensCommuns: "",
      preciput: false,
      detailsPreciput: "",
    },
    
    // Testament ant√©rieur
    testamentAnterieur: false, // true / false
    testamentAnterieurDate: "",
    testamentAnterieurType: "", // authentique / mystique / olographe
    testamentAnterieurNotaire: "",
    
    // 8. Testament authentique sp√©cifique
    testamentAuthentique: {
      // Nouveau: Caract√®re du testament
      caractere: "", // initial / modificatif / revocatoire
      dateSouhaitee: "",
      
      // Modalit√©s de r√©ception
      modaliteReception: "", // "1notaire_2temoins" ou "2notaires"
      lieuReception: "",
      dateReception: "",
      
      // Notaire(s)
      notaireNom: "",
      notaireOffice: "",
      notaireAdresse: "",
      presenceSecondNotaire: false,
      secondNotaireNom: "",
      secondNotaireOffice: "",
      secondNotaireAdresse: "",
      
      // T√©moins (qualification compl√®te)
      temoins: [] as Array<{
        nom: string;
        prenom: string;
        dateNaissance: string;
        lieuNaissance: string;
        nationalite: string;
        profession: string;
        adresse: string;
        lienAvecTestateur: string;
        nonHeritier: boolean;
        nonLegataire: boolean;
        nonConjoint: boolean;
        nonParentJusque4eDegre: boolean;
        capaciteJuridique: boolean;
        comprendLangue: boolean;
        agitLibrement: boolean;
        signature: boolean;
      }>,
      
      // Formalit√©s l√©gales
      formaliteDicte: false,
      formaliteRelu: false,
      formaliteSigne: false,
      formaliteRegistre: false,
      declarationApprobation: false,
      impossibiliteSigner: false,
      motifImpossibilite: "",
      
      // Inscription FCDDV
      inscriptionFCDDV: false,
      dateInscriptionFCDDV: "",
      notaireDepositaire: "",
    },
    
    // 9. Testament mystique sp√©cifique
    testamentMystique: {
      // R√©daction du testament
      redactionPar: "", // "testateur" ou "tiers"
      nomRedacteur: "", // Si r√©dig√© par un tiers
      typeEcriture: "", // "manuscrit" ou "dactylographie"
      langueTestament: "",
      nombrePages: "",
      
      // Pr√©sentation sous pli ferm√©
      cachete: false,
      descriptionScelle: "",
      lieuPresentation: "",
      datePresentation: "",
      
      // Notaire
      notaireNom: "",
      notaireOffice: "",
      notaireAdresse: "",
      
      // T√©moins (2 obligatoires)
      temoins: [] as Array<{
        nom: string;
        prenom: string;
        dateNaissance: string;
        lieuNaissance: string;
        nationalite: string;
        profession: string;
        adresse: string;
        lienAvecTestateur: string;
        nonHeritier: boolean;
        nonLegataire: boolean;
        nonConjoint: boolean;
        nonParentJusque4eDegre: boolean;
        capaciteJuridique: boolean;
        comprendLangue: boolean;
        agitLibrement: boolean;
        signature: boolean;
      }>,
      
      // Acte de suscription
      suscription: "", // D√©claration que le pli contient le testament
      declarationContenuTestament: false,
      dateSuscription: "",
      lieuSuscription: "",
      presenceSimultanee: false, // Pr√©sence simultan√©e testateur/notaire/t√©moins
      
      // D√©clarations obligatoires art. 976 C. civ.
      testateurSaitLireEcrire: false, // OBLIGATOIRE - art. 976
      testateurReconnaitTestament: false, // OBLIGATOIRE - reconnaissance personnelle
      pliNonOuvert: false, // OBLIGATOIRE - le pli n'a pas √©t√© ouvert par le notaire
      
      // Signatures
      signatureTestateur: false,
      signatureNotaire: false,
      impossibiliteSignerTestateur: false,
      motifImpossibiliteSignature: "",
      
      // Conditions l√©gales t√©moins (s√©curisation)
      temoinsMajeurs: false,
      temoinsNonHeritiersLegataires: false,
      temoinsSaventLireEcrire: false,
      
      // Inscription FCDDV
      inscriptionFCDDV: false,
      dateInscriptionFCDDV: "",
      notaireDepositaire: "",
    },
    
    // 10. Mentions l√©gales
    mentionsLegales: {
      rappelReserveHereditaire: false,
      rappelQuotiteDisponible: false,
      testamentRevocable: false,
      casIndignite: false,
      verificationCapaciteLegataires: false,
      droitsReduction: false,
      regimeFiscalSuccessions: false,
    },
    
    // 11. Documents obligatoires
    documentsAuthentique: {
      pieceIdentiteTestateur: "",
      livretFamilleTestateur: "",
      certificatCapaciteTestateur: "",
      piecesIdentiteTemoins: "",
      justificatifsDomicileTemoins: "",
      attestationsCapaciteTemoins: "",
      casiersJudiciairesTemoins: "",
      titresPropriete: "",
      relevesBancaires: "",
      contratMariage: "",
      autresJustificatifs: "",
    },
  });
  
  // State pour Changement de R√©gime Matrimonial (fichiers)
  const [changementRegimeEpouxIdentite1, setChangementRegimeEpouxIdentite1] = useState<File[]>([]);
  const [changementRegimeEpouxIdentite2, setChangementRegimeEpouxIdentite2] = useState<File[]>([]);
  const [changementRegimeLivretFamille, setChangementRegimeLivretFamille] = useState<File[]>([]);
  const [changementRegimeActeMariage, setChangementRegimeActeMariage] = useState<File[]>([]);
  const [changementRegimeContratMariageInitial, setChangementRegimeContratMariageInitial] = useState<File[]>([]);
  const [changementRegimeJustifDomicile1, setChangementRegimeJustifDomicile1] = useState<File[]>([]);
  const [changementRegimeJustifDomicile2, setChangementRegimeJustifDomicile2] = useState<File[]>([]);
  const [changementRegimeEnfantsAccords, setChangementRegimeEnfantsAccords] = useState<File[]>([]);
  const [changementRegimeTitresPropriete, setChangementRegimeTitresPropriete] = useState<File[]>([]);
  const [changementRegimeRelevesComptes, setChangementRegimeRelevesComptes] = useState<File[]>([]);
  const [changementRegimeStatutsSocietes, setChangementRegimeStatutsSocietes] = useState<File[]>([]);
  const [changementRegimeActesPrets, setChangementRegimeActesPrets] = useState<File[]>([]);
  const [changementRegimeEstimationsBiens, setChangementRegimeEstimationsBiens] = useState<File[]>([]);
  const [changementRegimeJugementTutelle, setChangementRegimeJugementTutelle] = useState<File[]>([]);

  // State pour Changement de R√©gime Matrimonial
  const [changementRegimeData, setChangementRegimeData] = useState({
    // 1. Informations g√©n√©rales
    typeModification: "", // separation_biens / communaute_reduite / communaute_universelle / participation_acquets / modification_actuel / ajout_clauses / adoption_contrat
    regimeActuel: "", // communaute_legale / communaute_universelle / separation_biens / participation_acquets / autre
    regimeActuelAutre: "",
    dateMariage: "",
    lieuMariage: "",
    contratMariageInitial: false,
    nouveauRegimeSouhaite: "", // communaute_reduite / separation_biens / communaute_universelle / participation_acquets
    dateEffetSouhaitee: "",
    motifChangement: "", // protection_conjoint / activite_professionnelle / anticipation_successorale / simplification_patrimoniale / autre
    motifChangementAutre: "",
    
    // 1bis. Pr√©sence d'enfants
    presenceEnfants: {
      enfantsCommuns: false,
      enfantsAutreUnion: false,
      enfantsMineurs: false,
      enfantsMajeursInformes: false,
      nombreEnfantsCommuns: "",
      nombreEnfantsAutreUnion: "",
    },
    
    // 1ter. Opposition possible des tiers
    oppositionTiers: {
      creanciersConnus: false,
      risqueOpposition: false,
      detailsCreanciers: "",
      natureRisque: "",
    },
    
    // 1quater. Liquidation du r√©gime
    liquidationRegime: {
      necessaire: "", // oui / non
      justificationAbsence: "",
      repartitionBiens: "", // 50-50 / autre
      autreRepartition: "",
      recompensesCreances: false,
      detailsRecompenses: "",
    },
    
    // 1quinquies. Homologation judiciaire
    homologation: {
      requise: false,
      motif: "", // enfants_mineurs / opposition_tiers / protection_epoux / autre
      autreMotif: "",
      tribunalCompetent: "",
    },
    
    // 1sexies. Clauses sp√©cifiques
    clausesSpecifiques: {
      attributionIntegrale: false,
      detailsAttribution: "",
      preciput: false,
      detailsPreciput: "",
      exclusionBiens: false,
      biensExclus: "",
      amenagements: false,
      detailsAmenagements: "",
    },
    
    // 2. √âpoux 1
    epoux1: {
      clientId: "",
      nom: "",
      prenom: "",
      nomNaissance: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      adresse: "",
      profession: "",
      telephone: "",
      email: "",
      typeIdentite: "",
      numeroIdentite: "",
      validiteIdentite: "",
      sousTutelleCuratelle: false,
      changementAnterieur: false,
    },
    
    // 3. √âpoux 2
    epoux2: {
      clientId: "",
      nom: "",
      prenom: "",
      nomNaissance: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      adresse: "",
      profession: "",
      telephone: "",
      email: "",
      typeIdentite: "",
      numeroIdentite: "",
      validiteIdentite: "",
      sousTutelleCuratelle: false,
      changementAnterieur: false,
    },
    
    // 4. Enfants et h√©ritiers
    enfantsCommuns: [] as Array<{
      nom: string;
      prenom: string;
      dateNaissance: string;
      majeur: boolean;
      consentement: string; // accord / opposition / pas_reponse
    }>,
    enfantsPrecedenteUnion: [] as Array<{
      nom: string;
      prenom: string;
      dateNaissance: string;
      majeur: boolean;
      parent: string; // epoux1 / epoux2
      consentement: string;
    }>,
    parentsVivants: {
      pereEpoux1: false,
      mereEpoux1: false,
      pereEpoux2: false,
      mereEpoux2: false,
    },
    
    // 5. Consentements et notifications
    consentements: {
      enfantsMajeursInformes: false,
      creancierAccord: false,
      creancierNom: "",
      creancierNatureDette: "",
      autorisationJuge: false,
      dateAutorisationJuge: "",
      motifAutorisationJuge: "",
    },
    
    // 6. Patrimoine actuel
    patrimoine: {
      // Biens propres √©poux 1
      biensPropreEpoux1: [] as Array<{
        description: string;
        valeur: string;
        origine: string;
        dettes: string;
      }>,
      // Biens propres √©poux 2
      biensPropreEpoux2: [] as Array<{
        description: string;
        valeur: string;
        origine: string;
        dettes: string;
      }>,
      // Biens communs
      biensCommuns: [] as Array<{
        description: string;
        valeur: string;
        hypotheques: string;
        affectationPro: boolean;
      }>,
      // Biens indivis
      biensIndivis: [] as Array<{
        description: string;
        quotePart: string;
        provenance: string;
      }>,
      // Entreprises
      entreprises: [] as Array<{
        nom: string;
        forme: string;
        valeur: string;
        droitsTransmis: string;
      }>,
      // Comptes financiers
      comptes: [] as Array<{
        banque: string;
        type: string;
        titulaire: string;
        solde: string;
      }>,
    },
    
    // 7. Nouveau r√©gime choisi
    nouveauRegime: {
      type: "", // communaute_universelle / communaute_reduite / separation_biens / participation_acquets
      
      // Communaut√© universelle
      communauteUniverselle: {
        biensPresents: true,
        biensFuturs: true,
        clauseAttributionIntegrale: false,
        clausePreciput: false,
        detailsPreciput: "",
        exclusionBiens: [] as Array<{description: string; motif: string}>,
      },
      
      // Communaut√© r√©duite aux acqu√™ts
      communauteReduite: {
        biensPropreDefinition: "",
        biensCommunsDefinition: "",
        repartitionDettes: "",
        clauseReprise: false,
        detailsClauseReprise: "",
        clausesFiscales: "",
      },
      
      // S√©paration de biens
      separationBiens: {
        attributionBiensPropres: "",
        repartitionBiensCommuns: "",
        gestionCommuneBien: false,
        detailsGestionCommune: "",
        contributionCharges: "",
      },
      
      // Participation aux acqu√™ts
      participationAcquets: {
        masseDepart: "",
        masseFin: "",
        modalitesCalcul: "",
      },
      
      // Clauses facultatives (tous r√©gimes)
      clausesFacultatives: {
        preciput: false,
        detailsPreciput: "",
        administrationSeparee: false,
        detailsAdministrationSeparee: "",
        inalienabilite: false,
        motifInalienabilite: "",
        donationEntreEpoux: false,
        detailsDonation: "",
        protectionConjointSurvivant: false,
        detailsProtection: "",
        attributionPreferentielle: false,
        detailsAttributionPreferentielle: "",
        gestionSepareePro: false,
        detailsGestionPro: "",
      },
    },
    
    // 8. Liquidation r√©gime pr√©c√©dent
    liquidation: {
      necessaire: false, // true si on quitte communautaire
      actifCommunaute: [] as Array<{
        description: string;
        valeur: string;
        repartition: string;
      }>,
      passifCommunaute: [] as Array<{
        description: string;
        montant: string;
        repartition: string;
      }>,
      acceptationLiquidation: false,
      cleRepartition: "50-50", // 50-50 / autre
      autreRepartition: "",
    },
    
    // 9. Mentions l√©gales
    mentionsLegales: {
      rappelArticlesCodeCivil: false,
      rappelLiberteContractuelle: false,
      interetFamille: false,
      declarationLibreConsent: false,
      detailsAttestations: "",
      publicationBODACCInformee: false,
      depotGreffe: false,
      effetChangement: "", // 3_mois / immediat
    },
    
    // 10. Publicit√© et formalit√©s
    formalites: {
      depotGreffe: false,
      coordonneesTribunal: "",
      dateDepot: "",
      publicationBODACCFaite: false,
      datePublicationBODACC: "",
      notificationCreanciers: false,
      delaisNotification: "",
      preuvesReception: "",
    },
  });

  // State pour D√©claration de Succession (fichiers)
  const [successionActeDeces, setSuccessionActeDeces] = useState<File[]>([]);
  const [successionLivretFamille, setSuccessionLivretFamille] = useState<File[]>([]);
  const [successionContratMariage, setSuccessionContratMariage] = useState<File[]>([]);
  const [successionTestament, setSuccessionTestament] = useState<File[]>([]);
  const [successionDonationsAnterieures, setSuccessionDonationsAnterieures] = useState<File[]>([]);
  const [successionTitresPropriete, setSuccessionTitresPropriete] = useState<File[]>([]);
  const [successionAvisImposition, setSuccessionAvisImposition] = useState<File[]>([]);
  const [successionRelevesBancaires, setSuccessionRelevesBancaires] = useState<File[]>([]);
  const [successionAssuranceVie, setSuccessionAssuranceVie] = useState<File[]>([]);
  const [successionStatutsSocietes, setSuccessionStatutsSocietes] = useState<File[]>([]);
  const [successionJustifsDettes, setSuccessionJustifsDettes] = useState<File[]>([]);
  const [successionFactureFuneraires, setSuccessionFactureFuneraires] = useState<File[]>([]);

  // State pour D√©claration de Succession
  const [successionData, setSuccessionData] = useState({
    // 1. Informations g√©n√©rales
    dateDeces: "",
    lieuDeces: "",
    communeDernierDomicile: "",
    numeroActeDeces: "",
    declarationDans6Mois: true,
    decesEtranger: false,
    
    // 2. Identit√© du d√©funt
    defunt: {
      nom: "",
      prenom: "",
      nomNaissance: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      profession: "",
      adresse: "",
      situationMatrimoniale: "", // celibataire / marie / divorce / veuf / pacse
      regimeMatrimonial: "", // communaute_legale / separation_biens / participation_acquets / communaute_universelle
      contratMariageExiste: false,
      testamentExiste: false,
      typeTestament: "", // olographe / authentique / mystique
      donationsAnterieuresExistent: false,
      mandatProtectionFuture: false,
      pacteSuccessoral: false,
    },
    
    // Note: Les anciennes sections 3-6 (h√©ritiers, patrimoine, passif, donations) ont √©t√© remplac√©es par les sections 7-19 plus d√©taill√©es
    
    // 7. Informations sur les h√©ritiers
    heritiers: {
      conjointSurvivant: false,
      conjointIdentite: { nom: "", prenom: "", dateNaissance: "", adresse: "", telephone: "", email: "", degreParente: "conjoint" },
      enfantsExistent: false,
      nombreEnfants: "",
      enfants: [] as Array<{ id: number; nom: string; prenom: string; dateNaissance: string; adresse: string; telephone: string; email: string; degreParente: string }>,
      autresHeritiersExistent: false,
      autresHeritiers: [] as Array<{ id: number; nom: string; prenom: string; lien: string; dateNaissance: string; adresse: string; telephone: string; email: string; degreParente: string }>,
      heritierMineurOuProtege: false,
      renonciation: false,
      acceptationConcurrenceActifNet: false,
    },
    
    // 8. √âtat civil "preuve" du d√©funt
    etatCivilPreuves: {
      copieActeNaissance: false,
      acteMariageDivorce: false,
      contratMariageReferences: "",
      testamentReferences: "",
      rechercheFCDDV: false,
    },
    
    // 9. R√©gime matrimonial (liquidation)
    regimeMatrimonialLiquidation: {
      regimeExact: "",
      dateMariage: "",
      dateEffetRegime: "",
      clausesParticulieres: false,
      preciput: false,
      attributionIntegrale: false,
      avantagesMatrimoniaux: false,
      detailsClausesParticulieres: "",
      precedenteLiquidation: false,
      changementRegime: false,
    },
    
    // 10. Donations et lib√©ralit√©s ant√©rieures
    donationsLiberalites: {
      donationsFaitesParDefunt: [] as Array<{ id: number; beneficiaire: string; date: string; nature: string; valeur: string }>,
      presentsUsageSignificatifs: false,
      donationsRecuesDuConjoint: false,
    },
    
    // 11. Patrimoine immobilier d√©taill√©
    patrimoineImmobilierDetail: [] as Array<{
      id: number;
      adresseComplete: string;
      nature: string;
      quotePart: string;
      modeAcquisition: string;
      dateAcquisition: string;
      valeurEstimee: string;
      referencesCadastrales: string;
      creditRestantDu: string;
    }>,
    
    // 12. Comptes bancaires et placements
    comptesBancairesDetail: {
      banquesConnues: "",
      compteCourant: false,
      livret: false,
      pel: false,
      comptesTitres: false,
      pea: false,
      listeComptes: [] as Array<{ id: number; banque: string; typeCompte: string; solde: string; iban: string }>,
      coffreFort: false,
      coffreBanque: "",
      coffreContenu: "",
    },
    
    // 13. Assurance-vie / capital d√©c√®s
    assuranceVieDetail: {
      contratsExistent: false,
      contrats: [] as Array<{ id: number; assureur: string; numeroContrat: string; dateSouscription: string; beneficiaires: string }>,
      contratsObseques: false,
      capitalDecesEmployeur: false,
    },
    
    // 14. Entreprises / parts sociales
    entreprisesDetail: {
      societesDetenues: false,
      societes: [] as Array<{ id: number; denomination: string; forme: string; siren: string; pourcentageDetention: string; valorisation: string }>,
    },
    
    // 15. V√©hicules et biens mobiliers de valeur
    vehiculesMobiliers: {
      vehicules: [] as Array<{ id: number; immatriculation: string; valeurEstimee: string }>,
      bijoux: false,
      oeuvresArt: false,
      collections: false,
      estimationBijoux: "",
      forfait5Pourcent: false,
      inventaireCommissairePriseur: false,
    },
    
    // 16. Passif (dettes) et charges d√©ductibles
    passifDetail: {
      emprunts: [] as Array<{ id: number; organisme: string; capitalRestantDu: string }>,
      dettesPersonnelles: false,
      detailsDettes: "",
      impotsRestantDus: false,
      detailsImpots: "",
      fraisFuneraires: "",
      fraisMedicaux: false,
      facturesAttente: "",
    },
    
    // 17. Fiscalit√© / r√©sidence / d√©lais
    fiscaliteResidence: {
      residenceFiscale: "France",
      autrePays: "",
      decesEtrangerPays: "",
      existenceIFI: false,
      detailsIFI: "",
      sipCoordonnees: "",
    },
    
    // 18. Mandats / repr√©sentation
    mandatsRepresentation: {
      heritierReferentNom: "",
      heritierReferentRole: "",
      procurationsExistent: false,
      executeurTestamentaire: false,
      executeurIdentite: "",
    },
    
    // 19. Points juridiques sensibles
    pointsJuridiquesSensibles: {
      successionInternationale: false,
      indivisionConflictuelle: false,
      heritierIntrouvable: false,
      acceptationBeneficeInventaire: false,
    },
  });

  // State pour l'acte de vente
  const [acteVenteData, setActeVenteData] = useState({
    // S√©lection du client et son r√¥le
    clientId: "",
    clientRole: "", // "vendeur" ou "acheteur"
    
    // Informations d√©taill√©es sur le bien
    adresseBien: "",
    typeBien: "",
    naturePropriete: "",
    referencesCadastrales: "",
    sectionCadastrale: "",
    numeroCadastral: "",
    contenanceCadastrale: "",
    surfaceHabitable: "",
    surfaceTerrain: "",
    nombrePieces: "",
    equipements: [] as string[],
    // Bien - Ann√©e et annexes
    anneeConstruction: "",
    bienGarage: "",
    bienParking: "",
    bienCave: "",
    bienGrenier: "",
    bienJardin: "",
    autresDependances: "",
    // Bien - √âquipements inclus
    cuisineEquipee: "",
    electromenagersInclus: "",
    electromenagersListe: "",
    mobilierLaisse: "",
    autresEquipements: "",
    // Copropri√©t√©
    bienCopropriete: "",
    numerosLots: "",
    tanti√®mes: "",
    reglementCopro: "",
    chargesAnnuelles: "",
    // √âtat juridique
    servitudesExistantes: "",
    hypotheques: "",
    destinationBien: "",
    bienLibreOuOccupe: "",
    informationsBail: "",
    // Si occup√© par locataire
    locataireNom: "",
    dateBail: "",
    dureeBail: "",
    montantLoyer: "",
    depotGarantieLocataire: "",
    // Si vendeur occupant
    dateLiberation: "",
    
    // Vendeur (soit client s√©lectionn√© avec auto-fill, soit manuel)
    vendeurNom: "",
    vendeurPrenom: "",
    vendeurAdresse: "",
    vendeurDateNaissance: "",
    vendeurLieuNaissance: "",
    vendeurNationalite: "",
    vendeurProfession: "",
    vendeurStatutMatrimonial: "",
    vendeurRegimeMatrimonial: "",
    vendeurPrecisionRegime: "",
    vendeurPieceIdentite: "",
    vendeurNumeroIdentite: "",
    // Vendeur - Type de partie
    vendeurTypePartie: "personne_physique",
    vendeurDenominationSociale: "",
    vendeurFormeJuridique: "",
    vendeurSiren: "",
    vendeurSiegeSocial: "",
    vendeurRepresentantNom: "",
    vendeurRepresentantQualite: "",
    // Vendeur - Repr√©sentation
    vendeurRepresente: "",
    vendeurMandataireNom: "",
    vendeurMandatairePrenom: "",
    vendeurTypePouvoir: "",
    
    // Acheteur (soit client s√©lectionn√© avec auto-fill, soit manuel)
    acheteurNom: "",
    acheteurPrenom: "",
    acheteurAdresse: "",
    acheteurDateNaissance: "",
    acheteurLieuNaissance: "",
    acheteurNationalite: "",
    acheteurProfession: "",
    acheteurStatutMatrimonial: "",
    acheteurRegimeMatrimonial: "",
    acheteurPrecisionRegime: "",
    acheteurModeAcquisition: "",
    acheteurQuotePart: "",
    // Acheteur - Type de partie
    acheteurTypePartie: "personne_physique",
    acheteurDenominationSociale: "",
    acheteurFormeJuridique: "",
    acheteurSiren: "",
    acheteurSiegeSocial: "",
    acheteurRepresentantNom: "",
    acheteurRepresentantQualite: "",
    // Acheteur - Repr√©sentation
    acheteurRepresente: "",
    acheteurMandataireNom: "",
    acheteurMandatairePrenom: "",
    acheteurTypePouvoir: "",
    
    // Conditions financi√®res
    prixVente: "",
    origineFonds: "",
    depotGarantie: "",
    fraisNotaire: "",
    repartitionProrata: "",
    modalitesPaiement: "",
    
    // Pr√™t immobilier
    pretImmobilier: "",
    montantPret: "",
    banquePreteur: "",
    tauxPret: "",
    dureePret: "",
    typePret: "",
    dateAccordPret: "",
    conditionsPret: "",
    tauxMaximal: "",
    conditionSuspensivePret: "",
    
    // Documents et diagnostics
    diagnosticsFournis: "",
    dateDPE: "",
    classeEnergetique: "",
    presenceAmiante: "",
    presencePlomb: "",
    presenceTermites: "",
    assainissementConforme: "",
    
    // Origine de propri√©t√©
    origineProprieteDateAcquisition: "",
    origineReferenceActe: "",
    travauxDerniers10ans: "",
    conformiteUrbanisme: "",
    assuranceDommageOuvrage: "",
    taxesFoncieres: "",
    sinistreRecent: "",
    
    // Urbanisme
    zonePLU: "",
    droitPreemption: "",
    declarationsUrbanisme: "",
    documentsUrbanisme: "",
    dateEnvoiDIA: "",
    reponseMairieDIA: "",
    
    // D√©lais et signature
    dateSignatureActe: "",
    lieuSignature: "",
    remiseCles: "",
    remiseClesAnticipee: "",
    dateRemiseAnticipee: "",
    indemnit√©Occupation: "",
    montantIndemnite: "",
    procuration: "",
    identiteMandataire: "",
    
    // Annexes
    titrePropriete: "",
    diagnostics: "",
    planBien: "",
    reglementCopropriete: "",
    etatDate: "",
    attestationAssurance: "",
    releveSyndic: "",
    
    // Informations compl√©mentaires
    travauxPrevusCopro: "",
    proceduresEnCours: "",
    differendsVoisins: "",
    particularitesBien: "",
  });

  // State pour le bail d'habitation
  const [bailHabitationData, setBailHabitationData] = useState({
    // R√¥le du client
    clientRole: "", // "bailleur" ou "locataire"
    clientId: "",
    
    // S√©lection du bailleur (client)
    bailleurClientId: "",
    bailleurNom: "",
    bailleurPrenom: "",
    bailleurAdresse: "",
    bailleurDateNaissance: "",
    bailleurLieuNaissance: "",
    bailleurNationalite: "",
    bailleurProfession: "",
    bailleurStatutMatrimonial: "",
    bailleurPieceIdentite: "",
    bailleurNumeroIdentite: "",
    
    // Locataire(s) - saisie manuelle ou client
    locataireClientId: "",
    locataireNom: "",
    locatairePrenom: "",
    locataireAdresse: "",
    locataireDateNaissance: "",
    locataireLieuNaissance: "",
    locataireNationalite: "",
    locataireProfession: "",
    locataireStatutMatrimonial: "",
    locatairePieceIdentite: "",
    locataireNumeroIdentite: "",
    nombreOccupants: "",
    
    // Situation financi√®re du locataire
    locataireRevenusMensuelsNets: "",
    locataireTypeContrat: "",
    locataireEmployeur: "",
    locataireEmployeurAdresse: "",
    locataireAncienneteEmployeur: "",
    
    // Colocation
    colocation: "",
    solidariteColocataires: "",
    nombreColocataires: "",
    colocatairesNoms: "",
    
    // Garant
    aGarant: "",
    garantNom: "",
    garantPrenom: "",
    garantAdresse: "",
    garantDateNaissance: "",
    garantLieuNaissance: "",
    garantStatutMatrimonial: "",
    garantProfession: "",
    garantPieceIdentite: "",
    garantNumeroIdentite: "",
    typeCaution: "",
    
    // Logement
    adresseLogement: "",
    typeLogement: "",
    etageNumeroLot: "",
    surfaceHabitable: "",
    surfaceAnnexes: "",
    anneeConstruction: "",
    etatUsage: "",
    dependances: [] as string[], // cave, parking, grenier, jardin
    placeParking: "",
    numeroPlaceParking: "",
    entretienJardin: "",
    logementCopropriete: "",
    reglementCoproFourni: "",
    
    // Si meubl√©
    typeBail: "", // "vide" ou "meuble"
    contratMeuble: "",
    mobilierListeComplete: [] as string[],
    inventaireFourni: "",
    inventaireMobilierTexte: "",
    etatMobilierEntree: "",
    entretienMobilier: "", // "locataire" ou "bailleur"
    
    // Liste l√©gale mobilier minimal (d√©cret 2015-981)
    mobilierLiterie: false,
    mobilierOccultation: false,
    mobilierPlaquesCuisson: false,
    mobilierFourMicroondes: false,
    mobilierRefrigo: false,
    mobilierCongelateur: false,
    mobilierVaisselle: false,
    mobilierUstensiles: false,
    mobilierTable: false,
    mobilierSieges: false,
    mobilierEtageres: false,
    mobilierLampes: false,
    mobilierMaterielEntretien: false,
    
    // Type et dur√©e bail meubl√©
    typeDureeMeuble: "", // "1an" "9mois" "mobilite"
    motifBailMobilite: "", // si bail mobilit√©
    
    // Nature du bailleur
    natureBailleur: "", // "physique" ou "morale"
    
    // Usage
    residencePrincipale: "", // Oui/Non - obligatoire pour bail vide
    destinationBien: "",
    souslocationAutorisee: "",
    colocationPossible: "",
    animauxAutorises: "",
    precisionAnimaux: "",
    
    // Conditions financi√®res
    loyerMensuel: "",
    chargesMensuelles: "",
    typeCharges: "", // "provision" ou "forfait"
    typologieCharges: "",
    depotGarantie: "",
    premierLoyerDate: "",
    modePaiement: "",
    ibanBailleur: "",
    periodiciteRegularisationCharges: "",
    revisionLoyerPrevue: "", // Oui/Non
    indiceIRL: "",
    trimestreReference: "",
    
    // Dates
    typeBailDuree: "", // "3ans" "6ans" "1an" "9mois"
    dateDebutBail: "",
    dureeBail: "",
    
    // Diagnostics obligatoires
    diagnosticsFournis: "", // Oui/Non
    diagnosticDPE: "",
    diagnosticElectricite: "",
    diagnosticGaz: "",
    diagnosticERP: "",
    diagnosticPlomb: "",
    diagnosticAmiante: "",
    
    // √âtat logement
    etatLieuxFourni: "",
    inventaireMobilierFourni: "",
    travauxRecents: "",
    travauxDerniers6Mois: "",
    descriptionTravaux: "",
    
    // Obligations techniques
    typeChauffage: "",
    compteursIndividuels: "",
    releveCompteurs: "",
    
    // Assurance
    attestationAssurance: "",
    
    // Particularit√©s juridiques
    servitudes: "",
    logementZoneERP: "",
    usageProfessionnel: "",
    
    // Informations compl√©mentaires
    informationsComplementaires: "",
    
    // Remise des cl√©s
    nombreJeuxCles: "",
    typesCles: [] as string[], // portes, boites_aux_lettres, garage, badges
    codesFournis: "", // WIFI, interphone, digicode...
  });

  // State pour le bail commercial
  const [bailCommercialData, setBailCommercialData] = useState({
    // Type de bail
    typeBail: "commercial", // "commercial" ou "professionnel"
    
    // R√¥le du client
    clientRole: "", // "bailleur" ou "preneur"
    clientId: "",
    
    // Bailleur personne physique
    bailleurClientId: "",
    statutBailleur: "", // "physique" ou "morale"
    bailleurNom: "",
    bailleurPrenom: "",
    bailleurAdresse: "",
    bailleurDateNaissance: "",
    bailleurLieuNaissance: "",
    bailleurNationalite: "",
    bailleurSituationFamiliale: "", // c√©libataire, mari√©, divorc√©, veuf
    bailleurRegimeMatrimonial: "", // si mari√©: communaut√©, s√©paration, etc.
    bailleurProfession: "",
    
    // Bailleur personne morale
    bailleurDenomination: "",
    bailleurFormeJuridique: "",
    bailleurSiren: "",
    bailleurSiret: "",
    bailleurSiegeSocial: "",
    bailleurCapitalSocial: "",
    bailleurRepresentant: "",
    bailleurRepresentantPrenom: "",
    bailleurRepresentantFonction: "",
    bailleurRepresentantEstLegal: "", // "oui" ou "non"
    bailleurMandataireNom: "",
    bailleurMandatairePrenom: "",
    bailleurMandataireTypePouvoir: "",
    
    // Preneur (locataire) personne physique
    locataireClientId: "",
    statutLocataire: "", // "physique" ou "morale"
    locataireNom: "",
    locatairePrenom: "",
    locataireAdresse: "",
    locataireDateNaissance: "",
    locataireLieuNaissance: "",
    locataireNationalite: "",
    locataireSituationFamiliale: "", // c√©libataire, mari√©, divorc√©, veuf
    locataireRegimeMatrimonial: "", // si mari√©: communaut√©, s√©paration, etc.
    locataireProfession: "",
    locataireTelephone: "",
    locataireEmail: "",
    locataireExerceEnNomPropre: "", // "oui" ou "non"
    locataireActivite: "",
    locataireSirenPersonnel: "",
    locataireEntrepriseEnCreation: "", // "oui" ou "non"
    
    // Preneur personne morale
    locataireImmatriculation: "",
    locataireDenomination: "",
    locataireFormeJuridique: "",
    locataireSiege: "",
    locataireSiren: "",
    locataireSiret: "",
    locataireObjetSocial: "",
    locataireCapital: "",
    locataireRepresentant: "",
    locataireRepresentantPrenom: "",
    locataireRepresentantFonction: "",
    locataireMandataireNom: "",
    locataireMandatairePrenom: "",
    locataireMandataireTypePouvoir: "",
    
    // Activit√© (1. Destination des lieux)
    activitePrincipale: "",
    activitesAnnexes: "",
    destinationBail: "",
    destinationContractuelle: "", // Description pr√©cise des activit√©s autoris√©es (commercial uniquement)
    exclusivitesEventuelles: "", // Exclusivit√©s accord√©es (commercial uniquement)
    interdictionsUsage: "", // Activit√©s interdites (commercial uniquement)
    clauseExclusivite: "",
    clauseNonConcurrence: "",
    
    // Bail professionnel sp√©cifique
    typeProfession: "", // lib√©rale_reglementee / lib√©rale_non_reglementee
    numeroOrdreProfessionnel: "",
    assuranceRCPro: "", // oui / non
    assuranceLocaux: "", // oui / non
    clauseResiliationTriennale: "", // oui / non
    preavisResiliation: "", // 6 mois standard
    
    // Local commercial
    adresseLocal: "",
    natureLocal: "",
    surfaceTotale: "",
    lotsCopropriete: "",
    etageNumero: "",
    partiesPrivatives: [] as string[], // cave, sous-sol, mezzanine, parking, terrasse
    longueurVitrine: "",
    accesLivraison: "",
    etatGeneral: "",
    
    // Travaux
    travauxBailleur: "",
    travauxLocataire: "",
    etatLocalRemise: "",
    diagnosticAmiante: "",
    
    // Dur√©e
    dureeBail: "", // "3-6-9" "derogatoire" "saisonnier"
    datePriseEffet: "",
    dureeTotale: "",
    renouvellementAuto: "",
    
    // Conditions financi√®res (2. Clause de r√©vision du loyer)
    loyerAnnuelHT: "",
    loyerMensuelHT: "",
    modalitePaiement: "", // mensuel, trimestriel
    typeIndexation: "", // ILC, ILAT
    indiceApplicable: "", // ILC / ILAT
    baseCalculIndice: "", // Ann√©e de base
    modaliteRevision: "", // annuelle / triennale
    chargesMensuelles: "",
    typeCharges: "", // provisions, forfait
    modeReglementCharges: "", // Forfait ou Provision avec r√©gularisation
    depotGarantie: "", // 3. D√©p√¥t de garantie
    montantDepotGarantie: "",
    restitutionDepot: "", // Modalit√©s de restitution
    modePaiementLoyer: "", // virement, prelevement, cheque
    ibanBailleur: "",
    
    // Charges & travaux (4. Travaux et r√©parations)
    chargesLocataire: [] as string[], // eau, electricite, chauffage, entretien, copro, teom, taxe_fonciere
    chargesBailleur: [] as string[], // gros_travaux, mise_conformite, ravalement, remplacement, structurel
    chargesSupporteesBailleur: "", // Description des charges du bailleur
    chargesSupporteesPreneur: "", // Description des charges du preneur
    travauxChargeBailleur: "", // Travaux √† la charge du bailleur
    travauxChargePreneur: "", // Travaux √† la charge du preneur
    compteursIndividuels: "",
    
    // 5. Imp√¥ts et taxes
    taxeFonciereSupporteePar: "", // bailleur ou locataire
    taxesRecuperables: "", // Description des taxes r√©cup√©rables
    
    // Garanties (9. Garanties)
    cautionPersonnelle: "",
    cautionPersonnelleOuiNon: "", // Oui / Non
    nomCaution: "",
    prenomCaution: "",
    montantGaranti: "",
    garantieBancaire: "",
    dureeGarantie: "",
    
    // Diagnostics
    diagnosticDPE: "",
    diagnosticAmianteDTA: "",
    diagnosticERP: "",
    diagnosticElectricite: "",
    diagnosticGaz: "",
    accessibiliteHandicapes: "",
    
    // √âtat des lieux (6. √âtat des lieux)
    etatLieuxJoint: "",
    etatLieuxRealise: "", // Oui / Non
    etatEquipements: "",
    
    // Remise des cl√©s
    nombreJeuxCles: "",
    typesCles: [] as string[],
    codesAcces: "",
    
    // Clauses juridiques (8. Sous-location & cession)
    clauseResolutoire: "",
    resiliationTriennale: "",
    clauseAssurances: "",
    souslocationAutorisee: "", // Oui / Non
    souslocationConditions: "", // Conditions si autoris√©e
    cessionBailAutorisee: "", // Oui / Non
    cessionConditions: "", // Conditions (agr√©ment du bailleur...)
    
    // 10. Assurance obligatoire
    assuranceMultirisqueSouscrite: "", // Oui / Non
    nomAssureur: "",
    numeropolice: "",
    
    // Infos compl√©mentaires
    particularitesLocal: "",
    conditionsSpecifiques: "",
    restrictionsUsage: "",
    horairesOuverture: "",
  });
  
  const [questionnaireData, setQuestionnaireData] = useState({
    // Type de contrat
    typeContrat: "", // "compromis" ou "promesse_unilaterale"
    
    // Informations sur le bien
    adresseBien: "",
    typeBien: "",
    surfaceHabitable: "",
    nombrePieces: "",
    naturePropriete: "", // Pleine propri√©t√© / Usufruit / Nue-propri√©t√© / Indivision
    bienCopropriete: "", // Oui / Non
    numeroLot: "",
    tanti√®mes: "",
    occupationBien: "", // Libre / Occup√© par le vendeur / Occup√© par un locataire / Bail en cours
    servitudesConnues: "", // Oui / Non
    descriptionServitudes: "",
    bienLibre: "", // Oui / Non
    
    // Client et son r√¥le
    clientId: "",
    clientRole: "", // "acheteur" ou "vendeur"
    
    // Statut matrimonial client
    statutMatrimonialClient: "", // C√©libataire / Mari√© / Pacs√© / Divorc√© / Veuf
    regimeMatrimonialClient: "", // Communaut√© l√©gale / S√©paration de biens / Autre
    precisionRegimeClient: "",
    
    // Informations autre partie (saisie manuelle)
    nomAutrePartie: "",
    prenomAutrePartie: "",
    adresseAutrePartie: "",
    
    // Statut matrimonial autre partie
    statutMatrimonialAutrePartie: "",
    regimeMatrimonialAutrePartie: "",
    precisionRegimeAutrePartie: "",
    
    // Conditions financi√®res
    prixVente: "",
    depotGarantie: "",
    modalitesPaiement: "",
    
    // Conditions suspensives - Pr√™t immobilier
    conditionPret: "", // Oui / Non
    montantPret: "",
    dureePret: "",
    tauxInteretMax: "",
    delaiAccordPret: "",
    
    // Conditions suspensives - Autres
    conditionDiagnostics: "",
    autresConditions: "",
    
    // Droit de pr√©emption
    droitPreemptionUrbain: "", // Oui / Non / Inconnu
    locatairePreemption: "", // Oui / Non
    
    // D√©lais
    dateSignatureActeDefinitif: "",
    delaiReflexion: "",
    
    // Promesse unilat√©rale sp√©cifique
    dureeOption: "",
    dateLimiteOption: "",
    indemniteImmobilisation: "",
    
    // Informations compl√©mentaires
    chargesCopropriete: "",
    travauxAPrevenir: "",
    autresInformations: "",
  });

  // State pour convention d'indivision
  const [indivisionData, setIndivisionData] = useState({
    // Informations g√©n√©rales
    typeBien: "immobilier", // immobilier / mobilier / autre
    origine: "", // succession / achat_commun / investissement / donation / autre
    objet: "", // Texte libre
    
    // Indivisaires (tableau)
    indivisaires: [{
      id: 1,
      isClient: false, // true si c'est un de nos clients
      clientId: "",
      nom: "",
      prenom: "",
      adresse: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      profession: "",
      situationFamiliale: "", // celibataire / marie / pacse / divorce / veuf
      regimeMatrimonial: "", // communaute / separation / participation / autre
      typeIdentite: "",
      numeroIdentite: "",
      email: "",
      telephone: "",
      quotePart: "", // % de propri√©t√©
      origineQuotePart: "", // heritage / achat / donation...
      origineQuotePartAutre: "", // Si origine = autre
    }],
    
    // Description du bien
    description: {
      typeBien: "immobilier",
      immobilier: {
        adresse: "",
        nature: "", // maison / appartement / terrain / immeuble / local_commercial / autre
        description: "",
        surface: "",
        cadastre: "",
        etatLocatif: "", // libre / loue / occupe
        loyer: "",
        valeurVenale: "",
      },
      mobilier: {
        description: "",
        valeurEstimee: "",
        numerosIdentification: "",
      }
    },
    
    // Dur√©e de la convention
    duree: {
      type: "indeterminee", // indeterminee / determinee
      annees: "", // Si d√©termin√©e (max 5 ans)
      conditionsRenouvellement: "",
      conditionsSortie: "",
    },
    
    // Gestion
    gestion: {
      gerant: "",
      pouvoirs: {
        gestion_courante: false,
        travaux: false,
        representation: false,
        signature_actes: false,
      },
      decisions: "", // unanimite / majorite_2_3 / majorite_simple
      charges: "",
      compteBancaire: "",
      repartitionDepensesExceptionnelles: "", // Nouvelle section
      repartitionRevenus: "", // Nouvelle section
    },
    
    // Utilisation du bien
    utilisation: {
      utilisationParIndivisaires: "non",
      conditionsUtilisation: "",
      indemniteOccupation: "non", // Nouvelle section: oui/non/conditions
      indemniteOccupationMontant: "", // Si oui ou conditions
      indemniteOccupationConditions: "", // Si conditions
      indemniteMontant: "",
      indemniteFrequence: "",
      locationAutorisee: "non",
      mandataireLocation: "",
      repartitionLoyers: "",
    },
    
    // Travaux
    travaux: {
      typesAutorises: "",
      decisionRequise: "",
      repartitionCouts: "",
      travauxUrgents: "",
      documentation: "",
    },
    
    // Sortie d'indivisaire
    sortie: {
      venteLibre: "libre", // libre / droit_preemption
      evaluationPart: "", // gerant / accord_indivisaires / expert / juge
      delaiRachat: "",
      modalitesPaiement: "",
    },
    
    // Vente du bien
    vente: {
      conditionsMiseEnVente: "",
      decisionRequise: "", // unanimite / majorite_2_3 / majorite_simple
      mandataire: "",
      repartitionPrix: "",
      gestionPlusValues: "",
    },
    
    // Comptabilit√©
    comptabilite: {
      registreDepenses: "non",
      archivageFactures: "",
      remboursementAvances: "",
      rapportAnnuel: "non",
    },
    
    // Litiges
    litiges: {
      modesResolution: {
        mediation: false,
        arbitrage: false,
        tribunal: false,
      },
      solidariteDettes: "non",
    },
    
    // Assurance (nouvelle section)
    assurance: {
      assuranceObligatoire: "oui",
      nomAssureur: "",
      numeroPolice: "",
      repartitionPrime: "",
      dateEcheance: "",
    },
  });

  // State pour la mainlev√©e d'hypoth√®que
  const [mainleveeData, setMainleveeData] = useState({
    // 1. Informations g√©n√©rales
    typeMainlevee: "totale", // totale / partielle / renonciation / substitution
    precisionPartielle: "",
    natureInscription: "hypotheque_conventionnelle", // hypotheque_conventionnelle / hypotheque_legale / hypotheque_judiciaire / privilege_ppd
    numeroInscription: "",
    dateInscription: "",
    volumeNumero: "",
    referencePartenaire: "",

    // 2. Cr√©ancier
    creancierType: "banque", // banque / personne_physique
    creancierBanque: {
      denominationSociale: "",
      formeJuridique: "",
      capitalSocial: "",
      adresseSiege: "",
      rcs: "",
      siren: "",
      representantNom: "",
      representantPrenom: "",
      representantFonction: "",
      pouvoirsType: "", // mandat / delegation / pv
    },
    creancierPersonne: {
      nom: "",
      prenom: "",
      adresse: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      profession: "",
      statutMatrimonial: "",
      typeIdentite: "",
      numeroIdentite: "",
    },

    // 3. D√©biteurs (tableau)
    debiteurs: [{
      id: 1,
      isClient: false,
      clientId: "",
      nom: "",
      prenom: "",
      adresse: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      profession: "",
      situationFamiliale: "",
      regimeMatrimonial: "",
      typeIdentite: "",
      numeroIdentite: "",
      qualite: "emprunteur", // emprunteur / cofinanceur / caution_hypothecaire
    }],

    // 4. Acte constitutif
    acteOrigine: {
      dateSignature: "",
      natureActe: "acte_notarie", // acte_notarie / acte_sous_seing_prive
      notaireAuteur: "",
      datePublication: "",
      numeroPublication: "",
    },
    conditionsPret: {
      montantInitial: "",
      tauxInteret: "",
      dureePret: "",
      numeroContrat: "",
      etablissementPreteur: "",
      numeroDossier: "",
    },

    // 5. Bien hypoth√©qu√© (tableau pour g√©rer plusieurs biens)
    biens: [{
      id: 1,
      adresse: "",
      descriptionBien: "",
      typeBien: "", // maison / appartement / terrain / locaux / dependances
      modeDetention: "", // propriete_exclusive / indivision / communaute_acquets / separation_biens / autre
      quotepartsIndivision: "", // Si indivision
      autreRegime: "", // Si autre
      cadastreSection: "",
      cadastreParcelle: "",
      cadastreContenance: "",
      estCopropriete: "non",
      numeroLot: "",
      quotePart: "",
    }],

    // 6. D√©claration du cr√©ancier
    declaration: {
      creancePayee: true,
      aucuneDette: true,
      consentMainlevee: true,
      renonciation: true,
      demandeRadiation: true,
    },

    // 7. Mandat/Procuration
    mandataire: {
      existe: "non",
      nom: "",
      prenom: "",
      fonction: "",
      pouvoirSigner: false,
      pouvoirDeposer: false,
    },

    // 8. Consentement d√©biteur
    consentementDebiteur: {
      requis: "non",
      accordRadiation: false,
      declarationsComplementaires: "",
    },

    // 10. Frais
    frais: {
      fraisRadiation: "",
      honoraires: "",
      timbresFiscaux: "",
    },
  });

  // State pour contrat de mariage (r√©gimes matrimoniaux)
  const [contratMariageData, setContratMariageData] = useState({
    // 1. Informations g√©n√©rales
    typeRegime: "", // separation_biens / communaute_acquets / communaute_acquets_amenagee / communaute_universelle / participation_acquets / autre
    autreRegimePrecision: "",
    typeContrat: "prenuptial", // prenuptial / changement_regime
    
    // Lieu et date du mariage (pr√©nuptial)
    dateMariagePrevue: "",
    lieuMariage: {
      mairie: "",
      commune: "",
      departement: "",
      pays: "France",
    },
    
    // Si changement de r√©gime
    dateMariage: "",
    regimeActuel: "", // separation_biens / communaute_legale / participation_acquets / communaute_universelle / regime_etranger / autre
    regimeActuelAutre: "",
    motifChangement: "",
    accordEnfantsMajeurs: "",
    accordCreancier: "",
    
    // Consentement enfants majeurs (si changement)
    consentementEnfantsMajeursRequis: "non",
    
    // Liquidation du r√©gime actuel (si changement depuis r√©gime communautaire)
    liquidationRegimeActuel: "non", // oui / non
    biensCommuns: [{
      id: 1,
      description: "",
      valeurEstimee: "",
      dettesAttachees: "",
      affectationPrevue: "", // epoux1 / epoux2 / vente / indivision
      repartitionEnvisagee: "", // conserv√© pour compatibilit√©
    }],
    passifCommun: [{
      id: 1,
      description: "",
      montant: "",
      modeRepartition: "", // epoux1 / epoux2 / 50_50
    }],
    soulte: {
      soulteDue: "non",
      montantSoulte: "",
      epouxDebiteur: "",
      modalitesPaiement: "", // comptant / echelonne
      dateLimitePaiement: "",
    },
    actifsFinanciers: [{
      id: 1,
      natureCompte: "",
      etablissement: "",
      solde: "",
      modePartage: "", // epoux1 / epoux2 / personnalise
      partagePersonnalise: "",
    }],
    observationsLiquidation: "",
    
    // Choix de la loi applicable (cas internationaux)
    choixLoiApplicable: "loi_francaise", // loi_francaise / loi_residence / loi_nationalite / autre
    choixLoiApplicableAutre: "",
    
    // Consentement juge (si enfants mineurs et changement)
    accordJugeRequis: "non",
    
    // 2. √âpoux (tableau de 2 personnes)
    epoux: [
      {
        id: 1,
        isClient: false,
        clientId: "",
        nom: "",
        prenom: "",
        adresse: "",
        dateNaissance: "",
        lieuNaissance: "",
        nationalite: "",
        profession: "",
        situationFamiliale: "", // celibataire / divorce / veuf
        typeIdentite: "",
        numeroIdentite: "",
        dateEmissionIdentite: "",
        lieuEmissionIdentite: "",
        domicileActuel: "",
        domicileApresMariage: "",
        // Si mariage ant√©rieur hors France
        mariageAnterieurtHorsFrance: "non",
        datePremierMariage: "",
        lieuPremierMariage: "",
        regimeMatrimonialInitial: "",
        acteEtatCivilEtranger: "",
      },
      {
        id: 2,
        isClient: false,
        clientId: "",
        nom: "",
        prenom: "",
        adresse: "",
        dateNaissance: "",
        lieuNaissance: "",
        nationalite: "",
        profession: "",
        situationFamiliale: "",
        typeIdentite: "",
        numeroIdentite: "",
        dateEmissionIdentite: "",
        lieuEmissionIdentite: "",
        domicileActuel: "",
        domicileApresMariage: "",
        mariageAnterieurtHorsFrance: "non",
        datePremierMariage: "",
        lieuPremierMariage: "",
        regimeMatrimonialInitial: "",
        acteEtatCivilEtranger: "",
      },
    ],
    
    // 3. Informations sur les enfants
    nombreEnfants: "",
    enfantsMajeurs: [{
      id: 1,
      nom: "",
      prenom: "",
      adresse: "",
      accordInformation: "", // oui / non
    }],
    enfantsMineurs: "",
    informationJugeNecessaire: "",
    
    // 4. Patrimoine actuel des √©poux
    patrimoineEpoux1: {
      biensPropres: "",
      biensAcquisPendantMariage: "",
      valeurEstimee: "",
      dettesPersonnelles: "",
      dettesCommunes: "",
      masseDepart: "",
      masseFin: "",
    },
    patrimoineEpoux2: {
      biensPropres: "",
      biensAcquisPendantMariage: "",
      valeurEstimee: "",
      dettesPersonnelles: "",
      dettesCommunes: "",
      masseDepart: "",
      masseFin: "",
    },
    
    // 5. Clauses personnalisables selon le r√©gime
    
    // A. S√©paration de biens
    clausesSeparation: {
      administrationExclusive: false,
      comptesSepares: false,
      contributionCharges: "", // proportionnelle / 50_50 / autre
      contributionChargesAutre: "",
      miseEnCommunBien: "",
      abandonCreance: "",
    },
    
    // B. Communaut√© r√©duite aux acqu√™ts am√©nag√©e
    clausesCommunauteAmenagee: {
      definitionBiensCommunsPropres: "",
      amenagementBiensProfessionnels: "",
      contributionCharges: "",
      repartitionDettes: "",
      typeAdministration: "", // symetriques / unique
      pouvoirUniqueDetails: "",
    },
    
    // C. Communaut√© universelle
    clausesCommunauteUniverselle: {
      tousLiensCommunsPresentsEtFuturs: true,
      attributionIntegraleSurvivant: "", // oui / non
      clausesPreciput: "",
      exclusionCertainsBiens: "",
    },
    
    // D. Participation aux acqu√™ts
    clausesParticipation: {
      definitionPatrimoinesOriginels: "",
      definitionPatrimoineFinal: "",
      calculCreanceParticipation: "",
      renonciationCreance: "",
      biensPropresParNature: "",
    },
    
    // E. Clauses optionnelles avanc√©es
    clausesAvancees: {
      clauseRemploi: "",
      clausePreciput: "",
      attributionPreferentielle: "",
      gestionSepareeBiensProfessionnels: "",
      protectionConjointSurvivant: "",
      donationEntreEpoux: "",
      solidariteDetteSpecifiques: "",
    },
    
    // 6. D√©clarations obligatoires
    declarations: {
      identite: true,
      capaciteJuridique: true,
      situationMatrimoniale: true,
      absenceOpposition: true,
      choixLibreEclaire: true,
      connaissanceEffetsJuridiques: true,
    },
  });

  // State pour PACS
  const [pacsData, setPacsData] = useState({
    // 1. Informations g√©n√©rales sur le PACS
    objetPacs: "initial", // initial / modification / dissolution
    regimePacs: "separation", // separation / indivision / personnalise
    regimePersonnalise: {
      definitionBiensCommuns: "",
      biensPropres: "",
      clausesSpecifiques: "",
    },
    datePriseEffetSouhaitee: "",
    
    // Si modification de PACS
    pacsInitialDate: "",
    pacsInitialMairie: "",
    pacsInitialNumero: "",
    clausesModifiees: "",
    
    // 2. Partenaires (tableau de 2 personnes)
    partenaires: [
      {
        id: 1,
        isClient: false,
        clientId: "",
        // A. Informations civiles obligatoires
        nom: "",
        prenom: "",
        nomNaissance: "",
        adresseActuelle: "",
        dateNaissance: "",
        lieuNaissance: "",
        nationalite: "",
        profession: "",
        telephone: "",
        email: "",
        // B. Informations pour contr√¥le juridique
        situationFamiliale: "", // celibataire / divorce / veuf
        typeIdentite: "",
        numeroIdentite: "",
        dateEmissionIdentite: "",
        autoriteDelivrante: "",
        // C. Pour partenaire √©tranger
        estEtranger: false,
        attestationNonPacsPaysOrigine: false,
        certificatCoutumeRequis: false,
        traductionRequise: false,
      },
      {
        id: 2,
        isClient: false,
        clientId: "",
        nom: "",
        prenom: "",
        nomNaissance: "",
        adresseActuelle: "",
        dateNaissance: "",
        lieuNaissance: "",
        nationalite: "",
        profession: "",
        telephone: "",
        email: "",
        situationFamiliale: "",
        typeIdentite: "",
        numeroIdentite: "",
        dateEmissionIdentite: "",
        autoriteDelivrante: "",
        estEtranger: false,
        attestationNonPacsPaysOrigine: false,
        certificatCoutumeRequis: false,
        traductionRequise: false,
      }
    ],
    
    // 3. Adresse commune (obligatoire)
    adresseCommune: "",
    dateDebutResidenceCommune: "",
    
    // 4. Clauses du PACS
    // A. Clauses obligatoires
    contributionCharges: "proportionnelle", // proportionnelle / 50_50 / autre
    contributionChargesAutre: "",
    
    // B. Clauses facultatives
    clausesFacultatives: {
      gestionBiensPersonnels: "",
      gestionBienCommun: "",
      usageBienIndivis: "",
      repartitionDepensesSpecifiques: "",
      clauseOccupationLogementSeparation: "",
      clauseRepriseBienDeces: "",
      clauseAbandonCreance: "",
      modalitesCompteBancaireCommun: "",
      clausesFinancieresPersonnalisees: "",
      clausesSolidariteDettes: "",
    },
    
    // 6. D√©clarations sur l'honneur (obligatoires)
    declarations: {
      residenceCommune: false,
      absenceLienParente: false,
      absenceMariageEtPacs: false,
    },
    
    // 7. Cas particuliers
    // A. Enfant en commun
    enfantEnCommun: "non",
    enfants: [{
      id: 1,
      nom: "",
      prenom: "",
      dateNaissance: "",
      autoriteParentale: "",
    }],
    
    // B. R√©gimes patrimoniaux √©trangers
    droitApplicable: "francais",
    droitApplicableAutre: "",
    
    // C. Biens d√©j√† acquis ensemble
    biensPreexistants: "non",
    biensListe: [{
      id: 1,
      description: "",
      quotePart1: "",
      quotePart2: "",
      indivision: "",
    }],
  });

  // State pour Donation entre √©poux
  const [donationEntreEpouxData, setDonationEntreEpouxData] = useState({
    // 1. Informations g√©n√©rales sur la donation
    typeDonation: "au_dernier_vivant", // au_dernier_vivant / biens_presents / mixte
    objetDonation: [], // protection_conjoint / transmission_bien / partage_inegal / renforcement_droits
    datePrevueSignature: "",
    
    // 2. Identit√© compl√®te des √©poux
    epoux: [
      {
        id: 1,
        isClient: false,
        clientId: "",
        // Informations civiles
        nom: "",
        prenom: "",
        nomNaissance: "",
        adresseComplete: "",
        telephone: "",
        email: "",
        dateNaissance: "",
        lieuNaissance: "",
        nationalite: "",
        profession: "",
        situationMatrimoniale: "marie",
        // R√©gime matrimonial
        regimeMatrimonial: "", // communaute_legale / communaute_universelle / separation_biens / participation_acquets / autre
        regimeMatrimonialAutre: "",
        dateMariage: "",
        lieuMariage: "",
        existenceContratMariage: "non", // oui / non
        // Pi√®ce d'identit√©
        typeIdentite: "",
        numeroIdentite: "",
        autoriteDelivrance: "",
        dateExpiration: "",
      },
      {
        id: 2,
        isClient: false,
        clientId: "",
        nom: "",
        prenom: "",
        nomNaissance: "",
        adresseComplete: "",
        telephone: "",
        email: "",
        dateNaissance: "",
        lieuNaissance: "",
        nationalite: "",
        profession: "",
        situationMatrimoniale: "marie",
        regimeMatrimonial: "",
        regimeMatrimonialAutre: "",
        dateMariage: "",
        lieuMariage: "",
        existenceContratMariage: "non",
        typeIdentite: "",
        numeroIdentite: "",
        autoriteDelivrance: "",
        dateExpiration: "",
      }
    ],
    
    // 3. Enfants et h√©ritiers potentiels
    enfantsCommuns: [{
      id: 1,
      nom: "",
      prenom: "",
      dateNaissance: "",
    }],
    enfantsNonCommuns: [{
      id: 1,
      epoux: "1", // 1 ou 2
      nom: "",
      prenom: "",
      dateNaissance: "",
    }],
    parentsVivants: {
      epoux1: "non", // oui / non
      epoux2: "non",
    },
    autresHeritiers: "",
    
    // 4. Patrimoine des √©poux
    biensPropresEpoux1: [{
      id: 1,
      type: "", // immobilier / meuble / financier / autre
      description: "",
      valeur: "",
      origine: "", // heritage / donation / achat
    }],
    biensPropresEpoux2: [{
      id: 1,
      type: "",
      description: "",
      valeur: "",
      origine: "",
    }],
    biensCommuns: [{
      id: 1,
      description: "",
      valeur: "",
      partEpoux1: "",
      partEpoux2: "",
    }],
    droitsParticuliers: {
      nueProprieteBiens: "",
      usufruitBiens: "",
      biensIndivis: "",
      biensHypotheques: "",
    },
    
    // 5. Clauses de donation - Donation au dernier vivant
    donationDernierVivant: {
      // Options successorales
      optionsSuccessorales: [], // pleine_propriete_quotite / usufruit_universel / quart_pleine_3quarts_usufruit / choix_multiple / attribution_biens_specifiques
      biensSpecifiques: "",
      // Clause d'attribution pr√©f√©rentielle
      attributionPreferentielle: {
        active: false,
        logementFamilial: false,
        mobilier: false,
        bienProfessionnel: false,
        vehicule: false,
        autresBiens: "",
      },
      // Clause de pr√©ciput
      clausePreciput: {
        active: false,
        descriptionBien: "",
        effet: "", // hors_part / valorise_part
      },
      // Clause de cantonnement
      clauseCantonnement: false,
      // Clause d'exclusion
      clauseExclusion: {
        active: false,
        biensExclus: "",
        casParticuliers: "",
      },
    },
    
    // 5B. Clauses - Donation de biens pr√©sents
    donationBiensPresents: {
      biensDonnes: [{
        id: 1,
        nature: "", // immobilier / financier / meuble / entreprise / autre
        description: "",
        valeur: "",
        regimePropriete: "", // propre / commun / indivis
      }],
      irrevocabilite: "oui", // oui / non
      clauseRetourPredeces: "non", // oui / non
      reserveUsufruit: {
        active: false,
        conditions: "",
      },
    },
    
    // 6. Clauses communes
    clausesCommunes: {
      administrationGestion: "",
      conditionSuspensiveResolutoire: "",
      acceptationBeneficiaire: false,
      renonciationDroitsSuccessorauxStandards: false,
      clauseNonRevocation: false,
      // R√©vocabilit√© de la donation
      revocabilite: "revocable", // revocable / irrevocable
      motifsRevocation: [], // survenance_enfants / ingratitude / non_execution / revocation_libre
      // Mandataire √©ventuel
      signatureMandataire: "non", // oui / non
      mandataireEpoux1: {
        nom: "",
        prenom: "",
        typeProcuration: "", // sous_seing_prive / acte_notarie
      },
      mandataireEpoux2: {
        nom: "",
        prenom: "",
        typeProcuration: "",
      },
      // Information successorale obligatoire
      informationEffetsSuccessoraux: false,
    },
    
    // 7. Mentions l√©gales (pr√©-remplies mais √©ditables)
    mentionsLegales: {
      articlesCodeCivil: true,
      effetsDonation: true,
      quotiteDisponible: true,
      limitesReserveHereditaire: true,
      declarationCapaciteJuridique: true,
      consentementEclaire: true,
      lectureActe: true,
      signaturesElectroniques: true,
    },
  });

  // State pour Mandat de protection future
  const [mandatProtectionData, setMandatProtectionData] = useState({
    // 1. Type de mandat
    typeMandat: [], // mandat_soi_meme, mandat_autrui, sous_seing_prive, acte_authentique, mandat_mixte
    mandatAutrui: {
      lienJuridique: "",
      justificationLegale: "",
    },
    
    // 2. Identit√© compl√®te du mandant
    mandant: {
      isClient: false,
      clientId: "",
      nom: "",
      prenom: "",
      nomNaissance: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      profession: "",
      adresseComplete: "",
      telephone: "",
      email: "",
      situationMatrimoniale: "", // celibataire, marie, divorce, veuf, pacse
      regimeMatrimonial: "",
      conjointNom: "",
      conjointPrenom: "",
      capaciteJuridique: "majeur_capable", // majeur_capable, sauvegarde_justice, curatelle, tutelle
      typeIdentite: "",
      numeroIdentite: "",
      dateEmissionIdentite: "",
      dateExpirationIdentite: "",
    },
    
    // 3. Identit√© compl√®te du mandataire principal
    mandatairePrincipal: {
      nom: "",
      prenom: "",
      dateNaissance: "",
      lieuNaissance: "",
      adresseComplete: "",
      profession: "",
      telephone: "",
      email: "",
      typeIdentite: "",
      numeroIdentite: "",
      dateExpirationIdentite: "",
      lienMandant: "", // conjoint, enfant, parent, ami, tiers_professionnel
      absenceIncapaciteLegale: false,
      absenceDecheanceAutorite: false,
      absenceInterdictionGestion: false,
      absenceMesureProtection: false,
      acceptationEcrite: false,
    },
    
    // 4. Mandataire substitut (optionnel)
    mandataireSubstitut: {
      existe: false,
      nom: "",
      prenom: "",
      dateNaissance: "",
      lieuNaissance: "",
      adresseComplete: "",
      profession: "",
      telephone: "",
      email: "",
      typeIdentite: "",
      numeroIdentite: "",
      lienMandant: "",
      conditionsEntree: "",
      etenduePouvoirs: "",
    },
    
    // 5A. Pouvoirs sur la personne
    pouvoirsPersonne: {
      representationActesCourants: false,
      choixEtablissement: false,
      demarchesSociales: false,
      organisationSoins: false,
      gestionMedecins: false,
      gestionQuotidien: false,
      precisionsAutres: "",
    },
    
    // 5B. Pouvoirs sur le patrimoine - Actes d'administration
    pouvoirsAdministration: {
      gestionComptes: false,
      encaissementRevenus: false,
      paiementDepenses: false,
      renouvellementBail: false,
      souscriptionAssurances: false,
      entretienBiens: false,
    },
    
    // 5B. Pouvoirs sur le patrimoine - Actes de disposition
    pouvoirsDisposition: {
      venteImmobilier: false,
      achatImmobilier: false,
      donationMobilier: false,
      gestionTitres: false,
      resiliationBail: false,
      reglementDettes: false,
      acceptationSuccession: false,
      renonciationSuccession: false,
      donations: false,
      modificationsSuccessorales: false,
      actesGratuits: false,
      modificationContratMariage: false,
    },
    
    // 6. Liste des biens du mandant
    biensPatrimoine: {
      biensImmobiliers: "",
      comptesBancaires: "",
      assurancesVie: "",
      livretsEpargne: "",
      biensMobiliers: "",
      partsSociales: "",
      revenusReguliers: "",
      dettesExistantes: "",
    },
    
    // 7. Limites du mandat
    limites: {
      interdictionVenteCertainsBiens: false,
      biensConcernes: "",
      interdictionDeplacement: false,
      interdictionModificationContrats: false,
      montantMaximum: "",
      obligationComptesReguliers: false,
      periodiciteComptes: "", // mensuel, trimestriel, annuel
    },
    
    // 8. Contr√¥le du mandataire
    controle: {
      obligationCompteGestion: false,
      controlePersonne: false,
      controleIdentite: "",
      controlePouvoirs: "",
      controleNotaire: false,
      controleExpertComptable: false,
      compteRenduAnnuel: false,
      periodicite: "",
    },
    
    // 9. Conditions de mise en ≈ìuvre
    miseEnOeuvre: {
      certificatMedical: true,
      medecinListe: "",
      dateConstat: "",
      depotGreffe: false,
      notificationMandataire: false,
    },
    
    // 10. Fin du mandat
    finMandat: {
      finRetourFacultes: true,
      revocationMandant: true,
      destitutionJuge: true,
      decesMandant: true,
      remplacementSubstitut: false,
    },
    
    // 11. D√©clarations obligatoires
    declarations: {
      volonteLibre: false,
      consentementSansPression: false,
      explicationComprise: false,
      acceptationActesDisposition: false,
      acceptationMandataire: false,
      droitRevocation: false,
    },
    
    // 12. Forme du mandat
    forme: {
      typeActe: "", // notarie / sous_seing_prive
      nomNotaire: "",
      villeOffice: "",
      dateSignature: "",
      datePriseEffet: "",
      lieuSignature: "",
      referenceLegale: "Articles 477 √† 494 du Code civil",
    },
    
    // 13. Juridiction et conservation
    juridictionConservation: {
      tribunalCompetent: "",
      villeJuridiction: "",
      lieuConservation: "", // notaire / mandant / tiers
      precisionsConservation: "",
    },
    
    // 14. Frais et r√©mun√©ration
    remuneration: {
      typeRemuneration: "", // gratuit / remunere
      modalitesRemuneration: "",
      remboursementFrais: false,
      precisionsRemboursement: "",
    },
    
    // 15. Clauses sp√©ciales
    clausesSpeciales: {
      prioriteFamiliale: false,
      obligationInformationFamille: false,
      precisionsInformationFamille: "",
      ordreSubstitution: "",
      conditionsRemplacement: "",
      etenduePouvoirs: "",
      responsabiliteCivile: false,
      obligationInteretExclusif: true, // ‚ö†Ô∏è OBLIGATOIRE par la loi
      donationsAutorisees: "", // autorise / interdit / limite / presentsUsage
      beneficiairesAutorises: "",
    },
  });

  // State pour Attestation de propri√©t√© immobili√®re
  const [attestationData, setAttestationData] = useState({
    // 1. Informations sur le d√©funt
    defunt: {
      nom: "",
      prenom: "",
      nomNaissance: "",
      sexe: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      profession: "",
      adresseDecesComplete: "",
      dateDeces: "",
      lieuDeces: "",
      domicileFiscalCommune: "", // Nouveau : obligatoire pour SPF
      domicileFiscalPays: "", // Nouveau : obligatoire pour SPF
      situationMatrimoniale: "",
      regimeMatrimonial: "",
      regimeMatrimonialAutre: "", // Nouveau : si "autre" s√©lectionn√©
      dateContratMariage: "", // Nouveau : obligatoire si contrat
      notaireContratMariage: "", // Nouveau : obligatoire si contrat
      existenceContratMariage: false,
      existencePacs: false,
      existenceTestament: false,
      existenceDonationsEntreEpoux: false,
      existenceDonationsAnterieures: false,
    },
    
    // 2. Succession - H√©ritiers (array)
    heritiers: [{
      id: 1,
      nom: "",
      prenom: "",
      dateNaissance: "",
      lieuNaissance: "",
      lienParente: "",
      adresseComplete: "",
      email: "",
      telephone: "",
      nationalite: "",
      profession: "",
      typeAcceptation: "", // pure_simple / concurrence / renonciation
      statutAge: "", // majeur / mineur
      protectionJuridique: "", // aucune / tutelle / curatelle
      clientId: "", // Nouveau : lien vers clients existants
    }],
    
    // Conjoint survivant
    conjointSurvivant: {
      existe: false,
      nom: "",
      prenom: "",
      regimeMatrimonial: "",
      droitsConjoint: "", // usufruit / quart / testament / donation
    },
    
    // 3. Biens immobiliers (array)
    biens: [{
      id: 1,
      // A. Identit√© du bien
      adresseComplete: "",
      codePostal: "",
      commune: "",
      cadastreSection: "",
      cadastreNumero: "",
      cadastreContenance: "",
      
      // B. Description
      typeBien: "", // maison / appartement / terrain / commercial / garage
      surfaceHabitable: "",
      nombrePieces: "",
      dependances: "",
      annexes: "",
      equipements: "",
      situationLocative: "", // libre / occupe
      montantLoyer: "",
      
      // C. Origine de propri√©t√©
      dateAcquisition: "",
      natureAcquisition: "", // achat / donation / partage / succession
      repartitionDroits: "", // pleine / usufruit / indivision
      quotePart: "",
      notaireAcquisition: "", // Nouveau : obligatoire pour SPF
      datePublicationSPF: "", // Nouveau : obligatoire pour SPF
      volumeSPF: "", // Nouveau : obligatoire pour SPF
      numeroSPF: "", // Nouveau : obligatoire pour SPF
      
      // D. Servitudes
      servitudesActives: "",
      servitudesPassives: "",
      
      // E. Hypoth√®ques
      pretEnCours: false,
      hypothequeInscrite: false,
      typeHypotheque: "",
      montantResiduel: "",
      necessitMainlevee: false,
      
      // F. Copropri√©t√©
      estCopropriete: false,
      numeroLot: "",
      quotepartCommunes: "",
      chargesAnnuelles: "",
      
      // G. Legs particuliers
      existenceLegsParticuliers: false, // Nouveau : obligatoire
      precisionLegs: "", // Nouveau : si legs existe
    }],
    
    // 4. Situation familiale
    regimeMatrimonial: "",
    droitsConjointSurvivant: "",
    
    // 5. R√©partition des droits (calcul√©)
    repartitionDroits: {
      conjoint: "",
      heritiers: "",
    },
    
    // 6. Destination du bien
    destinationBien: "", // indivision / usage_conjoint / attribution / vente / location / aucune
    
    // 7. D√©clarations
    loiSuccessoraleApplicable: "",
    confirmationAbsenceAutresHeritiers: false,
    indivisionSuccessorale: false, // Nouveau : mention obligatoire
    declarationFiscaleHonneur: false, // Nouveau : d√©claration fiscale obligatoire
    
    // 8. Signatures
    dateSignature: "", // Nouveau : date de signature
    lieuSignature: "", // Nouveau : lieu de signature
    notaireInstrumentaire: "", // Nouveau : notaire signataire
    
    // 8. √âvaluation
    valeurVenale: "",
    methodeEstimation: "", // expertise / avis / references
    valeurDeclareeFiscale: "",
    
    // 9. Formalit√©s publiaires
    bureauSPF: "",
    fichesPreparees: false,
  });

  // State pour Quitus / Reconnaissance de dette
  const [quitusDetteData, setQuitusDetteData] = useState({
    // 1. Type d'acte
    typeActe: "", // reconnaissance_dette / reconnaissance_dette_modalites / quitus / quitus_partiel / remise_dette / solde_tout_compte / attestation_reglement
    
    // 2. Identit√© compl√®te du cr√©ancier
    creancier: {
      isClient: false,
      clientId: "",
      nom: "",
      prenom: "",
      nomNaissance: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      profession: "",
      adresseComplete: "",
      telephone: "",
      email: "",
      typeIdentite: "",
      numeroIdentite: "",
      situationMatrimoniale: "",
      rib: "",
    },
    
    // 3. Identit√© compl√®te du d√©biteur
    debiteur: {
      isClient: false,
      clientId: "",
      nom: "",
      prenom: "",
      nomNaissance: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      profession: "",
      adresseComplete: "",
      telephone: "",
      email: "",
      typeIdentite: "",
      numeroIdentite: "",
      situationMatrimoniale: "",
      rib: "",
    },
    
    // 4. Objet de la dette
    objetDette: {
      natureDette: "", // pret_argent / avance_fonds / aide_exceptionnelle / remboursement_depenses / participation_projet / dette_commerciale / dette_familiale
      dateNaissanceDette: "",
      circonstancesDette: "",
      preuveEcriteExiste: false,
      temoinsEventuels: "",
    },
    
    // 5. Montant de la dette
    montant: {
      montantTotal: "",
      devise: "EUR",
      sommeDejaRemboursee: "",
      sommeRestantDue: "",
      montantReconnuDebiteur: "",
      modalitePret: "", // transfert_bancaire / cheque / especes / virement
      dateExigibiliteSolde: "",
    },
    
    // 6. Conditions de remboursement
    remboursement: {
      modalite: "", // une_fois / plusieurs_echeances / libre / premiere_demande / conditionnel
      conditionRemboursement: "", // vente_bien / obtention_credit / autre
      
      // √âch√©ancier (array)
      echeances: [{
        id: 1,
        date: "",
        montant: "",
        moyenPaiement: "",
        consequencesRetard: "",
      }],
      
      // Int√©r√™ts
      avecInterets: false,
      tauxInteret: "",
      tauxUsuraire: "",
      capitalisationInterets: false,
      
      // Clause p√©nale
      clausePenale: false,
      montantPenalite: "",
      pourcentagePenalite: "",
      delaiGrace: "",
    },
    
    // 7. S√ªret√©s et garanties
    suretes: {
      cautionPersonnelle: false,
      cautionIdentite: "",
      cautionMontant: "",
      cautionDuree: "",
      
      garantieSalaire: false,
      
      gageMobilier: false,
      gageDescription: "",
      
      nantissementTitres: false,
      nantissementDetails: "",
      
      hypotheque: false,
      hypothequeDetails: "",
      
      depotGarantie: false,
      depotMontant: "",
      
      acteAuthentique: false,
      notaireNom: "",
    },
    
    // 8. Remise de dette (si applicable)
    remiseDette: {
      remiseTotale: false,
      remisePartielle: false,
      montantRemise: "",
      conditionsRemise: "",
      effetsRetroactifs: false,
      renonciationPoursuites: false,
      preuvesPaiementsPartiels: "",
    },
    
    // 9. Quitus (si dette r√©gl√©e)
    quitus: {
      typeQuitus: "", // total / partiel / comptable
      
      // Paiements re√ßus (array)
      paiementsRecus: [{
        id: 1,
        date: "",
        montant: "",
        modePaiement: "",
        referenceBancaire: "",
      }],
      
      // D√©clarations du cr√©ancier
      sommesRecuesTotalement: false,
      renonciationReclamations: false,
      detteEteinte: false,
      annulationGaranties: false,
      restitutionDocuments: false,
    },
    
    // 10. Clauses l√©gales
    clausesLegales: {
      consentementLibre: false,
      reconnaissanceMontant: false,
      engagementRemboursement: false,
      mentionManuscrite: "",
      clauseSolidarite: false,
      clauseDivisibilite: false,
      extinctionDette: false,
      liberationDefinitive: false,
      renonciationRecours: false,
      identificationDette: "",
      clauseNonNovation: false,
      droitApplicable: "france",
      tribunalCompetent: "",
      pluraliteDebiteurs: false,
      solidarite: false,
    },
    
    // 11. Signatures et formalit√©s
    signatures: {
      dateSignature: "",
      lieuSignature: "",
      dateExtinctionEffective: "",
      signatureNotaire: false,
      nomNotaire: "",
      villeNotaire: "",
    },
  });

  // State pour Cession de parts sociales
  const [cessionPartsData, setCessionPartsData] = useState({
    // 1. Type de soci√©t√©
    typeSociete: "", // sarl / sci / sas / snc / autre_personne
    
    // 2. Informations sur la soci√©t√©
    societe: {
      denominationSociale: "",
      sigle: "",
      formeJuridique: "",
      capitalSocial: "",
      siegeSocial: "",
      siren: "",
      rcs: "",
      greffeCompetent: "",
      activiteSociete: "",
      dateCreation: "",
      objetSocial: "",
      pacteAssocies: false,
      expertComptable: false,
      
      // G√©rant/Pr√©sident
      gerantNom: "",
      gerantPrenom: "",
      gerantAdresse: "",
      gerantPouvoirs: "",
    },
    
    // 3. Identit√© compl√®te du c√©dant (vendeur)
    cedant: {
      isClient: false,
      clientId: "",
      nom: "",
      prenom: "",
      nomNaissance: "",
      adresseComplete: "",
      email: "",
      telephone: "",
      dateNaissance: "",
      nationalite: "",
      profession: "",
      situationMatrimoniale: "",
      regimeMatrimonial: "",
      typeIdentite: "",
      numeroIdentite: "",
      qualiteSociete: "", // associe / gerant_president / associe_fondateur
    },
    
    // 4. Identit√© compl√®te du cessionnaire (acheteur)
    cessionnaire: {
      typePersonne: "physique", // physique / morale
      
      // Personne physique
      clientId: "",
      nom: "",
      prenom: "",
      adresseComplete: "",
      email: "",
      telephone: "",
      dateNaissance: "",
      nationalite: "",
      profession: "",
      situationMatrimoniale: "",
      typeIdentite: "",
      numeroIdentite: "",
      capaciteJuridique: "majeur",
      
      // Personne morale
      denominationMorale: "",
      representantLegal: "",
    },
    
    // 5. Objet de la cession
    objetCession: {
      // A. Nature exacte des titres
      natureTitres: "", // parts_sociales / actions
      
      // B. Type de droits c√©d√©s
      typeDroits: "", // parts_sociales / actions / droits_indivis / compte_courant / cession_reprise_dette
      
      // C. Nombre de parts
      nombreParts: "",
      pourcentageCapital: "",
      
      // D. Valeur nominale
      valeurNominale: "",
      
      // E. Prix de cession
      prixTotal: "",
      prixUnitaire: "",
      modeCalcul: "", // valeur_marche / valeur_comptable / clause_statutaire
      
      // F. Modalit√©s de paiement
      modalitePaiement: "", // comptant / echelonne / differe / conditionnel
      ribCedant: "",
      
      // G. Date d'effet de la cession
      dateEffetCession: "", // date_signature / date_differee
      dateEffetDifferee: "",
      
      // H. Conditions suspensives
      agrement: false,
      approbationConjoint: false,
      financementBancaire: false,
      leveeNantissement: false,
      
      // I. Clause de non-garantie de passif
      sansGarantiePassif: false,
    },
    
    // 6. Agr√©ment (SARL & SCI)
    agrement: {
      procedureAgrement: "",
      organeCompetent: "", // assemblee_generale / gerant_president / autre
      dateDecisionAgrement: "",
      modeVoteMajorite: "",
      convocationAssocies: false,
      voteEffectue: false,
      majoriteRequise: "",
      notificationStatut: "", // acceptation / refus
      delaiLegalRespecte: false,
    },
    
    // 7. Compte courant d'associ√©
    compteCourant: {
      cessionCCA: false,
      maintienCCA: false,
      remboursementImmediat: false,
      remboursementEchelonne: false,
      compensationPrix: false,
      garantieSolde: false,
      montantSoldeCCA: "",
      detteVersTiers: false,
      natureDetteTiers: "",
      montantDetteTiers: "",
      creancierTiers: "",
      acceptationCreancier: false,
    },
    
    // 8. Garanties donn√©es par le c√©dant
    garanties: {
      // Garanties classiques
      garantieEviction: false,
      garantiePropriete: false,
      garantiePassif: "", // generale / limitee / aucune
      garantieActifNet: false,
      absenceNantissement: false,
      absenceLitiges: false,
      
      // Garanties renforc√©es
      plafondGarantie: "",
      dureeGarantie: "",
      exclusions: "",
      procedureMiseEnJeu: "",
    },
    
    // 9. Droit du conjoint
    conjoint: {
      identiteConjoint: "",
      acceptationCession: false,
      renonciationCession: false,
      signatureObligatoire: false,
      regimeMatrimonialPrecise: "",
    },
    
    // 10. Droits d'enregistrement (fiscal)
    droitsEnregistrement: {
      tauxApplicable: "", // 3_pourcent / 0_1_pourcent
      chargeDroits: "", // cessionnaire / cedant / autre
    },
    
    // 11. Clause de non-concurrence
    nonConcurrence: {
      clauseNonConcurrence: false,
      dureeNonConcurrence: "",
      zoneGeographique: "",
      activiteInterdite: "",
    },
    
    // 12. Notification √† la soci√©t√©
    notificationSociete: {
      modeNotification: "", // signification_huissier / acceptation_acte
    },
    
    // 13. D√©clarations l√©gales obligatoires
    declarationsLegales: {
      consentementLibre: false,
      origineLiciteFonds: false,
      absenceFraude: false,
      acceptationPrix: false,
      transfertProprieteDateSignature: false,
      mentionStatutsMisAJour: false,
      mentionImpositionFiscale: false,
      renonciationDroitPreemption: false,
    },
    
    // 14. Mise √† jour statuts et formalit√©s
    formalites: {
      modificationCapital: false,
      miseAJourRegistreMouvements: false,
      miseAJourRegistreAssocies: false,
      depotGreffe: false,
      publicationLegale: false,
      informationBanques: false,
    },
    
    // 15. Signatures
    signatures: {
      dateSignature: "",
      lieuSignature: "",
      signatureNotaire: false,
      nomNotaire: "",
      villeNotaire: "",
    },
  });

  // State pour Procuration authentique
  const [procurationData, setProcurationData] = useState({
    // 1. Type de procuration
    typeProcuration: "",
    actesVises: "", // Si sp√©ciale/immobili√®re/bancaire/fiscale
    
    // 2. Identit√© compl√®te du mandant
    mandant: {
      isClient: false,
      clientId: "",
      nom: "",
      prenom: "",
      nomNaissance: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      profession: "",
      adresseComplete: "",
      telephone: "",
      email: "",
      situationMatrimoniale: "",
      regimeMatrimonial: "",
      conjointNom: "",
      conjointPrenom: "",
      capaciteJuridique: "majeur_capable",
      typeMesureProtection: "", // tutelle/curatelle/sauvegarde
      autorisationJointe: false,
      typeIdentite: "",
      numeroIdentite: "",
      dateEmissionIdentite: "",
      autoriteEmettrice: "",
    },
    
    // 3. Identit√© compl√®te du mandataire
    mandataire: {
      nom: "",
      prenom: "",
      nomNaissance: "",
      dateNaissance: "",
      lieuNaissance: "",
      nationalite: "",
      profession: "",
      adresseComplete: "",
      telephone: "",
      email: "",
      lienMandant: "",
      typeIdentite: "",
      numeroIdentite: "",
      dateEmissionIdentite: "",
      autoriteEmettrice: "",
    },
    
    // 4. Objet pr√©cis de la procuration
    objet: {
      descriptionPrecise: "",
      listeActesAutorises: "",
      faculteSignerActes: false,
      faculteRecevoirSommes: false,
      // Si procuration immobili√®re
      immobilierVente: false,
      immobilierAchat: false,
      immobilierHypotheque: false,
      immobilierMainlevee: false,
      immobilierSignatureAvantContrats: false,
      immobilierAcceptationConditions: false,
      immobilierPercevoirPrix: false,
      faculteSubstituer: false,
    },
    
    // 5. √âtendue des pouvoirs et limites
    etendue: {
      typeEtendue: "tres_large", // tres_large / limitee
      precisionsLimitees: "",
      actesExclus: "",
      subdelegation: "interdite", // autorisee / interdite
    },
    
    // 6. Dur√©e - R√©vocation
    duree: {
      type: "indeterminee", // indeterminee / determinee
      dateFin: "",
      revocable: true,
    },
    
    // 7. Acceptation du mandataire
    acceptation: {
      type: "expresse", // expresse / tacite
      acceptationJourActe: true,
    },
    
    // 8. D√©clarations essentielles du mandant
    declarations: {
      agitLibrement: false,
      pleineCapacite: false,
      comprendPortee: false,
      consentLibre: false,
      pouvoirIrrevocable: false,
    },
    
    // 9. Langue - Compr√©hension
    langue: {
      langueComprise: "Fran√ßais",
      interpreteNecessaire: false,
      interpreteIdentite: "",
    },
    
    // 10. Comparution - Signature
    comparution: {
      typeComparution: "presence", // presence / distance
      lectureFaite: false,
      consentementRecueilli: false,
      typeSignature: "presentiel", // presentiel / distance
    },
    
    // 11. Mentions notariales
    mentionsNotariales: {
      nomNotaire: "",
      villeOffice: "",
      dateReception: "",
      lieuReception: "",
      acteRecuMinute: false,
    },
    
    // 12. Conservation - Copies
    conservation: {
      minuteConservee: false,
      copiesSimples: false,
      copiesCertifiees: false,
      copiesExecutoires: false,
    },
  });

  const navigate = useNavigate();

  // debounce
  useEffect(() => {
    const t = setTimeout(() => setDebounced(search.trim()), 300);
    return () => clearTimeout(t);
  }, [search]);

  // D√©tecte le r√¥le depuis l'URL
  let role: 'avocat' | 'notaire' = 'avocat';
  if (location.pathname.includes('/notaires')) role = 'notaire';
  if (location.pathname.includes('/avocats')) role = 'avocat';

  const mainButtonColor = role === 'notaire'
    ? 'bg-orange-600 hover:bg-orange-700 text-white'
    : 'bg-blue-600 hover:bg-blue-700 text-white';

  // Role-based menu/select styling
  const menuContentClass = role === 'notaire' ? 'bg-orange-50 border-orange-200' : 'bg-blue-50 border-blue-200';
  const menuItemClass = role === 'notaire' ? 'focus:bg-orange-600 focus:text-white hover:bg-orange-600 hover:text-white' : 'focus:bg-blue-600 focus:text-white hover:bg-blue-600 hover:text-white';
  const selectContentClass = role === 'notaire' ? 'bg-orange-50 border-orange-200' : 'bg-blue-50 border-blue-200';
  const selectItemClass = role === 'notaire' ? 'cursor-pointer hover:bg-orange-600 hover:text-white' : 'cursor-pointer hover:bg-blue-600 hover:text-white';

  // Charger les clients
  useEffect(() => {
    let isMounted = true;
    async function loadClients() {
      if (!user) return;
      const { data, error } = await supabase
        .from('clients')
        .select('id, nom, prenom, adresse, telephone, email, date_naissance, lieu_naissance, nationalite, profession, situation_matrimoniale, situation_familiale, type_identite, numero_identite, date_expiration_identite, id_doc_path')
        .eq('owner_id', user.id)
        .eq('role', role)
        .order('nom', { ascending: true });
      
      if (error) {
        console.error('Erreur chargement clients:', error);
      } else if (isMounted && data) {
        setClients(data);
      }
    }
    loadClients();
    return () => { isMounted = false; };
  }, [user, role]);

  // Pr√©-remplir les informations du client s√©lectionn√© (Compromis de vente)
  useEffect(() => {
    if (questionnaireData.clientId && clients.length > 0) {
      const selectedClient = clients.find(c => c.id === questionnaireData.clientId) as any;
      if (selectedClient) {
        console.log('üìã Client s√©lectionn√©:', selectedClient.nom, selectedClient.prenom);
        console.log('üìÑ id_doc_path:', selectedClient.id_doc_path);
        
        // Extraire la situation familiale de l'objet JSON
        let situationFamiliale = "";
        if (typeof selectedClient.situation_familiale === 'object' && selectedClient.situation_familiale !== null) {
          situationFamiliale = selectedClient.situation_familiale.situation_familiale || "";
        } else if (typeof selectedClient.situation_familiale === 'string') {
          situationFamiliale = selectedClient.situation_familiale;
        }
        
        setQuestionnaireData(prev => ({
          ...prev,
          statutMatrimonialClient: situationFamiliale || selectedClient.situation_matrimoniale || "",
        }));

        // Charger le document d'identit√© du client si disponible
        if (selectedClient.id_doc_path) {
          console.log('‚úÖ Chargement du document depuis id_doc_path:', selectedClient.id_doc_path);
          // G√©n√©rer l'URL sign√©e pour acc√©der au document
          supabase.storage
            .from('documents')
            .createSignedUrl(selectedClient.id_doc_path, 3600)
            .then(({ data, error }) => {
              if (error) {
                console.error('‚ùå Erreur chargement document:', error);
                setCompromisClientIdentiteUrl(null);
              } else if (data?.signedUrl) {
                console.log('‚úÖ Document charg√© avec succ√®s');
                setCompromisClientIdentiteUrl(data.signedUrl);
              }
            });
        } else {
          // Chercher dans client_documents si pas de id_doc_path
          console.log('üîç Recherche dans client_documents pour client:', selectedClient.id);
          supabase
            .from('client_documents')
            .select('file_path, file_name, document_type')
            .eq('client_id', selectedClient.id)
            .order('uploaded_at', { ascending: false })
            .limit(5) // Prendre les 5 plus r√©cents
            .then(({ data: docs, error: docsError }) => {
              if (docsError) {
                console.error('‚ùå Erreur recherche documents:', docsError);
                setCompromisClientIdentiteUrl(null);
              } else if (docs && docs.length > 0) {
                console.log(`üìÑ ${docs.length} document(s) trouv√©(s) pour ce client`);
                // Chercher d'abord piece_identite, sinon prendre le premier
                const idDoc = docs.find(d => d.document_type === 'piece_identite') || docs[0];
                console.log('üìÑ Document s√©lectionn√©:', idDoc.file_name, '(type:', idDoc.document_type, ')');
                supabase.storage
                  .from('documents')
                  .createSignedUrl(idDoc.file_path, 3600)
                  .then(({ data, error }) => {
                    if (error) {
                      console.error('‚ùå Erreur chargement document:', error);
                      setCompromisClientIdentiteUrl(null);
                    } else if (data?.signedUrl) {
                      console.log('‚úÖ Document client_documents charg√© avec succ√®s');
                      setCompromisClientIdentiteUrl(data.signedUrl);
                    }
                  });
              } else {
                console.log('‚ö†Ô∏è Aucun document trouv√© dans client_documents');
                setCompromisClientIdentiteUrl(null);
              }
            });
        }
      }
    } else {
      setCompromisClientIdentiteUrl(null);
    }
  }, [questionnaireData.clientId, clients]);

  // Charger la pi√®ce d'identit√© du mandant (Mandat de Protection Future)
  useEffect(() => {
    if (mandatProtectionData.mandant.clientId && clients.length > 0) {
      const selectedClient = clients.find(c => c.id === mandatProtectionData.mandant.clientId) as any;
      if (selectedClient?.id_doc_path) {
        console.log('‚úÖ Chargement pi√®ce identit√© mandant depuis id_doc_path:', selectedClient.id_doc_path);
        supabase.storage
          .from('documents')
          .createSignedUrl(selectedClient.id_doc_path, 3600)
          .then(({ data, error }) => {
            if (error) {
              console.error('‚ùå Erreur chargement document mandant:', error);
              setMandatProtectionMandantIdentiteUrl(null);
            } else if (data?.signedUrl) {
              console.log('‚úÖ Document mandant charg√© avec succ√®s');
              setMandatProtectionMandantIdentiteUrl(data.signedUrl);
            }
          });
      } else {
        // Chercher dans client_documents si pas de id_doc_path
        console.log('üîç Recherche dans client_documents pour mandant:', selectedClient?.id);
        if (selectedClient?.id) {
          supabase
            .from('client_documents')
            .select('file_path, file_name, document_type')
            .eq('client_id', selectedClient.id)
            .eq('document_type', 'piece_identite')
            .order('uploaded_at', { ascending: false })
            .limit(1)
            .then(({ data: docs, error: docsError }) => {
              if (docsError) {
                console.error('‚ùå Erreur recherche documents mandant:', docsError);
                setMandatProtectionMandantIdentiteUrl(null);
              } else if (docs && docs.length > 0) {
                console.log('üìÑ Document trouv√© dans client_documents:', docs[0].file_name);
                supabase.storage
                  .from('documents')
                  .createSignedUrl(docs[0].file_path, 3600)
                  .then(({ data, error }) => {
                    if (error) {
                      console.error('‚ùå Erreur chargement document mandant:', error);
                      setMandatProtectionMandantIdentiteUrl(null);
                    } else if (data?.signedUrl) {
                      console.log('‚úÖ Document mandant client_documents charg√© avec succ√®s');
                      setMandatProtectionMandantIdentiteUrl(data.signedUrl);
                    }
                  });
              } else {
                setMandatProtectionMandantIdentiteUrl(null);
              }
            });
        } else {
          setMandatProtectionMandantIdentiteUrl(null);
        }
      }
    } else {
      setMandatProtectionMandantIdentiteUrl(null);
    }
  }, [mandatProtectionData.mandant.clientId, clients]);

  // Auto-fill depuis le client s√©lectionn√© selon son r√¥le (Acte de vente)
  useEffect(() => {
    if (acteVenteData.clientId && acteVenteData.clientRole && clients.length > 0) {
      const selectedClient = clients.find(c => c.id === acteVenteData.clientId) as any;
      if (selectedClient) {
        // Extraire la situation familiale de l'objet JSON
        let situationFamiliale = "";
        if (typeof selectedClient.situation_familiale === 'object' && selectedClient.situation_familiale !== null) {
          situationFamiliale = selectedClient.situation_familiale.situation_familiale || "";
        } else if (typeof selectedClient.situation_familiale === 'string') {
          situationFamiliale = selectedClient.situation_familiale;
        }
        
        const statutMatrimonial = situationFamiliale || selectedClient.situation_matrimoniale || "";

        if (acteVenteData.clientRole === "vendeur") {
          setActeVenteData(prev => ({
            ...prev,
            // Remplir les infos du vendeur avec le client
            vendeurNom: selectedClient.nom || "",
            vendeurPrenom: selectedClient.prenom || "",
            vendeurAdresse: selectedClient.adresse || "",
            vendeurDateNaissance: selectedClient.date_naissance || "",
            vendeurLieuNaissance: selectedClient.lieu_naissance || "",
            vendeurNationalite: selectedClient.nationalite || "",
            vendeurProfession: selectedClient.profession || "",
            vendeurStatutMatrimonial: statutMatrimonial,
            vendeurPieceIdentite: selectedClient.type_identite || "",
            vendeurNumeroIdentite: selectedClient.numero_identite || "",
            // Vider les champs de l'acheteur
            acheteurNom: "",
            acheteurPrenom: "",
            acheteurAdresse: "",
            acheteurDateNaissance: "",
            acheteurLieuNaissance: "",
            acheteurNationalite: "",
            acheteurProfession: "",
            acheteurStatutMatrimonial: "",
          }));
        } else if (acteVenteData.clientRole === "acheteur") {
          setActeVenteData(prev => ({
            ...prev,
            // Remplir les infos de l'acheteur avec le client
            acheteurNom: selectedClient.nom || "",
            acheteurPrenom: selectedClient.prenom || "",
            acheteurAdresse: selectedClient.adresse || "",
            acheteurDateNaissance: selectedClient.date_naissance || "",
            acheteurLieuNaissance: selectedClient.lieu_naissance || "",
            acheteurNationalite: selectedClient.nationalite || "",
            acheteurProfession: selectedClient.profession || "",
            acheteurStatutMatrimonial: statutMatrimonial,
            // Vider les champs du vendeur
            vendeurNom: "",
            vendeurPrenom: "",
            vendeurAdresse: "",
            vendeurDateNaissance: "",
            vendeurLieuNaissance: "",
            vendeurNationalite: "",
            vendeurProfession: "",
            vendeurStatutMatrimonial: "",
            vendeurPieceIdentite: "",
            vendeurNumeroIdentite: "",
          }));
        }
      }
    }
  }, [acteVenteData.clientId, acteVenteData.clientRole, clients]);

  // Charger automatiquement le document d'identit√© du client pour l'acte de vente
  useEffect(() => {
    if (acteVenteData.clientId && clients.length > 0) {
      const selectedClient = clients.find(c => c.id === acteVenteData.clientId) as any;
      console.log('üìã Client acte s√©lectionn√©:', selectedClient?.nom, selectedClient?.prenom);
      console.log('üìÑ id_doc_path acte:', selectedClient?.id_doc_path);
      
      if (selectedClient?.id_doc_path) {
        console.log('‚úÖ Chargement document acte depuis id_doc_path:', selectedClient.id_doc_path);
        supabase.storage
          .from('documents')
          .createSignedUrl(selectedClient.id_doc_path, 3600)
          .then(({ data, error }) => {
            if (error) {
              console.error('‚ùå Erreur chargement document acte:', error);
              setActeClientIdentiteUrl(null);
            } else if (data?.signedUrl) {
              console.log('‚úÖ Document acte charg√© avec succ√®s');
              setActeClientIdentiteUrl(data.signedUrl);
            }
          });
      } else {
        // Chercher dans client_documents si pas de id_doc_path
        console.log('üîç Recherche dans client_documents pour client (acte):', selectedClient?.id);
        if (selectedClient?.id) {
          supabase
            .from('client_documents')
            .select('file_path, file_name, document_type')
            .eq('client_id', selectedClient.id)
            .order('uploaded_at', { ascending: false })
            .limit(5) // Prendre les 5 plus r√©cents
            .then(({ data: docs, error: docsError }) => {
              if (docsError) {
                console.error('‚ùå Erreur recherche documents (acte):', docsError);
                setActeClientIdentiteUrl(null);
              } else if (docs && docs.length > 0) {
                console.log(`üìÑ ${docs.length} document(s) acte trouv√©(s) pour ce client`);
                // Chercher d'abord piece_identite, sinon prendre le premier
                const idDoc = docs.find(d => d.document_type === 'piece_identite') || docs[0];
                console.log('üìÑ Document acte s√©lectionn√©:', idDoc.file_name, '(type:', idDoc.document_type, ')');
                supabase.storage
                  .from('documents')
                  .createSignedUrl(idDoc.file_path, 3600)
                  .then(({ data, error }) => {
                    if (error) {
                      console.error('‚ùå Erreur chargement document acte:', error);
                      setActeClientIdentiteUrl(null);
                    } else if (data?.signedUrl) {
                      console.log('‚úÖ Document acte client_documents charg√© avec succ√®s');
                      setActeClientIdentiteUrl(data.signedUrl);
                    }
                  });
              } else {
                console.log('‚ö†Ô∏è Aucun document trouv√© dans client_documents (acte)');
                setActeClientIdentiteUrl(null);
              }
            });
        } else {
          setActeClientIdentiteUrl(null);
        }
      }
    } else {
      setActeClientIdentiteUrl(null);
    }
  }, [acteVenteData.clientId, clients]);

  // Charger la pi√®ce d'identit√© du client (Bail d'habitation)
  // Auto-load carte d'identit√© bailleur bail commercial
  useEffect(() => {
    if (bailCommercialData.clientRole === "bailleur" && bailCommercialData.clientId && clients.length > 0) {
      const selectedClient = clients.find(c => c.id === bailCommercialData.clientId) as any;
      console.log('üìã Client bailleur bail commercial s√©lectionn√©:', selectedClient?.nom, selectedClient?.prenom);
      console.log('üìÑ id_doc_path bail commercial:', selectedClient?.id_doc_path);
      
      if (selectedClient?.id_doc_path) {
        console.log('‚úÖ Chargement document bail commercial depuis id_doc_path:', selectedClient.id_doc_path);
        supabase.storage
          .from('documents')
          .createSignedUrl(selectedClient.id_doc_path, 3600)
          .then(({ data, error }) => {
            if (error) {
              console.error('‚ùå Erreur chargement document bail commercial:', error);
              setBailCommercialBailleurClientIdentiteUrl(null);
            } else if (data?.signedUrl) {
              console.log('‚úÖ Document bail commercial charg√© avec succ√®s');
              setBailCommercialBailleurClientIdentiteUrl(data.signedUrl);
            }
          });
      } else {
        // Chercher dans client_documents si pas de id_doc_path
        console.log('üîç Recherche dans client_documents pour client (bail commercial):', selectedClient?.id);
        if (selectedClient?.id) {
          supabase
            .from('client_documents')
            .select('file_path, file_name, document_type')
            .eq('client_id', selectedClient.id)
            .order('uploaded_at', { ascending: false })
            .limit(5)
            .then(({ data: docs, error: docsError }) => {
              if (docsError) {
                console.error('‚ùå Erreur recherche documents (bail commercial):', docsError);
                setBailCommercialBailleurClientIdentiteUrl(null);
              } else if (docs && docs.length > 0) {
                console.log(`üìÑ ${docs.length} document(s) bail commercial trouv√©(s) pour ce client`);
                const idDoc = docs.find(d => d.document_type === 'piece_identite') || docs[0];
                console.log('üìÑ Document bail commercial s√©lectionn√©:', idDoc.file_name, '(type:', idDoc.document_type, ')');
                supabase.storage
                  .from('documents')
                  .createSignedUrl(idDoc.file_path, 3600)
                  .then(({ data, error }) => {
                    if (error) {
                      console.error('‚ùå Erreur chargement document bail commercial:', error);
                      setBailCommercialBailleurClientIdentiteUrl(null);
                    } else if (data?.signedUrl) {
                      console.log('‚úÖ Document bail commercial client_documents charg√© avec succ√®s');
                      setBailCommercialBailleurClientIdentiteUrl(data.signedUrl);
                    }
                  });
              } else {
                console.log('‚ö†Ô∏è Aucun document bail commercial trouv√© dans client_documents');
                setBailCommercialBailleurClientIdentiteUrl(null);
              }
            });
        } else {
          setBailCommercialBailleurClientIdentiteUrl(null);
        }
      }
    } else {
      setBailCommercialBailleurClientIdentiteUrl(null);
    }
  }, [bailCommercialData.clientId, bailCommercialData.clientRole, clients]);

  // Auto-load carte d'identit√© preneur bail commercial
  useEffect(() => {
    if (bailCommercialData.clientRole === "preneur" && bailCommercialData.clientId && clients.length > 0) {
      const selectedClient = clients.find(c => c.id === bailCommercialData.clientId) as any;
      console.log('üìã Client preneur bail commercial s√©lectionn√©:', selectedClient?.nom, selectedClient?.prenom);
      console.log('üìÑ id_doc_path bail commercial preneur:', selectedClient?.id_doc_path);
      
      if (selectedClient?.id_doc_path) {
        console.log('‚úÖ Chargement document preneur bail commercial depuis id_doc_path:', selectedClient.id_doc_path);
        supabase.storage
          .from('documents')
          .createSignedUrl(selectedClient.id_doc_path, 3600)
          .then(({ data, error }) => {
            if (error) {
              console.error('‚ùå Erreur chargement document preneur bail commercial:', error);
              setBailCommercialPreneurClientIdentiteUrl(null);
            } else if (data?.signedUrl) {
              console.log('‚úÖ Document preneur bail commercial charg√© avec succ√®s');
              setBailCommercialPreneurClientIdentiteUrl(data.signedUrl);
            }
          });
      } else {
        // Chercher dans client_documents si pas de id_doc_path
        console.log('üîç Recherche dans client_documents pour preneur (bail commercial):', selectedClient?.id);
        if (selectedClient?.id) {
          supabase
            .from('client_documents')
            .select('file_path, file_name, document_type')
            .eq('client_id', selectedClient.id)
            .order('uploaded_at', { ascending: false })
            .limit(5)
            .then(({ data: docs, error: docsError }) => {
              if (docsError) {
                console.error('‚ùå Erreur recherche documents preneur (bail commercial):', docsError);
                setBailCommercialPreneurClientIdentiteUrl(null);
              } else if (docs && docs.length > 0) {
                console.log(`üìÑ ${docs.length} document(s) preneur bail commercial trouv√©(s) pour ce client`);
                const idDoc = docs.find(d => d.document_type === 'piece_identite') || docs[0];
                console.log('üìÑ Document preneur bail commercial s√©lectionn√©:', idDoc.file_name, '(type:', idDoc.document_type, ')');
                supabase.storage
                  .from('documents')
                  .createSignedUrl(idDoc.file_path, 3600)
                  .then(({ data, error }) => {
                    if (error) {
                      console.error('‚ùå Erreur chargement document preneur bail commercial:', error);
                      setBailCommercialPreneurClientIdentiteUrl(null);
                    } else if (data?.signedUrl) {
                      console.log('‚úÖ Document preneur bail commercial client_documents charg√© avec succ√®s');
                      setBailCommercialPreneurClientIdentiteUrl(data.signedUrl);
                    }
                  });
              } else {
                console.log('‚ö†Ô∏è Aucun document preneur bail commercial trouv√© dans client_documents');
                setBailCommercialPreneurClientIdentiteUrl(null);
              }
            });
        } else {
          setBailCommercialPreneurClientIdentiteUrl(null);
        }
      }
    } else {
      setBailCommercialPreneurClientIdentiteUrl(null);
    }
  }, [bailCommercialData.clientId, bailCommercialData.clientRole, clients]);

  useEffect(() => {
    if (bailHabitationData.clientId && clients.length > 0) {
      const selectedClient = clients.find(c => c.id === bailHabitationData.clientId) as any;
      console.log('üìã Client bail s√©lectionn√©:', selectedClient?.nom, selectedClient?.prenom);
      console.log('üìÑ id_doc_path bail:', selectedClient?.id_doc_path);
      
      if (selectedClient?.id_doc_path) {
        console.log('‚úÖ Chargement document bail depuis id_doc_path:', selectedClient.id_doc_path);
        supabase.storage
          .from('documents')
          .createSignedUrl(selectedClient.id_doc_path, 3600)
          .then(({ data, error }) => {
            if (error) {
              console.error('‚ùå Erreur chargement document bail:', error);
              setBailClientIdentiteUrl(null);
            } else if (data?.signedUrl) {
              console.log('‚úÖ Document bail charg√© avec succ√®s');
              setBailClientIdentiteUrl(data.signedUrl);
            }
          });
      } else {
        // Chercher dans client_documents si pas de id_doc_path
        console.log('üîç Recherche dans client_documents pour client (bail):', selectedClient?.id);
        if (selectedClient?.id) {
          supabase
            .from('client_documents')
            .select('file_path, file_name, document_type')
            .eq('client_id', selectedClient.id)
            .order('uploaded_at', { ascending: false })
            .limit(5)
            .then(({ data: docs, error: docsError }) => {
              if (docsError) {
                console.error('‚ùå Erreur recherche documents (bail):', docsError);
                setBailClientIdentiteUrl(null);
              } else if (docs && docs.length > 0) {
                console.log(`üìÑ ${docs.length} document(s) bail trouv√©(s) pour ce client`);
                const idDoc = docs.find(d => d.document_type === 'piece_identite') || docs[0];
                console.log('üìÑ Document bail s√©lectionn√©:', idDoc.file_name, '(type:', idDoc.document_type, ')');
                supabase.storage
                  .from('documents')
                  .createSignedUrl(idDoc.file_path, 3600)
                  .then(({ data, error }) => {
                    if (error) {
                      console.error('‚ùå Erreur chargement document bail:', error);
                      setBailClientIdentiteUrl(null);
                    } else if (data?.signedUrl) {
                      console.log('‚úÖ Document bail client_documents charg√© avec succ√®s');
                      setBailClientIdentiteUrl(data.signedUrl);
                    }
                  });
              } else {
                console.log('‚ö†Ô∏è Aucun document trouv√© dans client_documents (bail)');
                setBailClientIdentiteUrl(null);
              }
            });
        } else {
          setBailClientIdentiteUrl(null);
        }
      }
    } else {
      setBailClientIdentiteUrl(null);
    }
  }, [bailHabitationData.clientId, clients]);

  // Charger automatiquement les pi√®ces d'identit√© des h√©ritiers depuis les clients
  useEffect(() => {
    const loadHeritiersIdentite = async () => {
      const allFiles: FileWithMetadata[] = [];
      
      for (const heritier of attestationData.heritiers) {
        if (heritier.clientId && clients.length > 0) {
          const selectedClient = clients.find(c => c.id === heritier.clientId) as any;
          const clientName = `${selectedClient?.prenom || ''} ${selectedClient?.nom || ''}`.trim();
          
          if (selectedClient?.id_doc_path) {
            console.log('‚úÖ Chargement pi√®ce identit√© h√©ritier depuis id_doc_path:', selectedClient.id_doc_path);
            try {
              const { data, error } = await supabase.storage
                .from('documents')
                .download(selectedClient.id_doc_path);
              
              if (data && !error) {
                const fileName = selectedClient.id_doc_path.split('/').pop() || `identite_${heritier.nom}_${heritier.prenom}.pdf`;
                const file = new File([data], fileName, { type: data.type }) as FileWithMetadata;
                file._autoLoaded = true;
                file._clientName = clientName;
                allFiles.push(file);
                console.log('‚úÖ Document h√©ritier charg√©:', fileName);
              }
            } catch (error) {
              console.error('‚ùå Erreur chargement identit√© h√©ritier:', error);
            }
          } else if (selectedClient?.id) {
            // Chercher dans client_documents
            console.log('üîç Recherche dans client_documents pour h√©ritier:', selectedClient.id);
            try {
              const { data: docs, error: docsError } = await supabase
                .from('client_documents')
                .select('file_path, file_name, document_type')
                .eq('client_id', selectedClient.id)
                .eq('document_type', 'piece_identite')
                .order('uploaded_at', { ascending: false })
                .limit(1);
              
              if (docs && docs.length > 0 && !docsError) {
                const { data, error } = await supabase.storage
                  .from('documents')
                  .download(docs[0].file_path);
                
                if (data && !error) {
                  const file = new File([data], docs[0].file_name, { type: data.type }) as FileWithMetadata;
                  file._autoLoaded = true;
                  file._clientName = clientName;
                  allFiles.push(file);
                  console.log('‚úÖ Document h√©ritier charg√© depuis client_documents:', docs[0].file_name);
                }
              }
            } catch (error) {
              console.error('‚ùå Erreur recherche client_documents h√©ritier:', error);
            }
          }
        }
      }
      
      if (allFiles.length > 0) {
        setAttestationIdentiteHeritiers(allFiles);
        console.log(`üì¶ ${allFiles.length} document(s) h√©ritier(s) charg√©(s)`);
      }
    };
    
    if (attestationData.heritiers.some(h => h.clientId)) {
      loadHeritiersIdentite();
    }
  }, [attestationData.heritiers, clients]);

  // Auto-fill depuis le client s√©lectionn√© comme bailleur (Bail d'habitation)
  useEffect(() => {
    if (bailHabitationData.bailleurClientId && clients.length > 0) {
      const selectedClient = clients.find(c => c.id === bailHabitationData.bailleurClientId) as any;
      if (selectedClient) {
        // Extraire la situation familiale de l'objet JSON
        let situationFamiliale = "";
        if (typeof selectedClient.situation_familiale === 'object' && selectedClient.situation_familiale !== null) {
          situationFamiliale = selectedClient.situation_familiale.situation_familiale || "";
        } else if (typeof selectedClient.situation_familiale === 'string') {
          situationFamiliale = selectedClient.situation_familiale;
        }

        setBailHabitationData(prev => ({
          ...prev,
          bailleurNom: selectedClient.nom || "",
          bailleurPrenom: selectedClient.prenom || "",
          bailleurAdresse: selectedClient.adresse || "",
          bailleurDateNaissance: selectedClient.date_naissance || "",
          bailleurLieuNaissance: selectedClient.lieu_naissance || "",
          bailleurNationalite: selectedClient.nationalite || "",
          bailleurProfession: selectedClient.profession || "",
          bailleurStatutMatrimonial: situationFamiliale || selectedClient.situation_matrimoniale || "",
          bailleurPieceIdentite: selectedClient.type_identite || "",
          bailleurNumeroIdentite: selectedClient.numero_identite || "",
        }));
      }
    }
  }, [bailHabitationData.bailleurClientId, clients]);

  // D√©tecter les param√®tres URL pour ouvrir le questionnaire automatiquement
  useEffect(() => {
    const params = new URLSearchParams(location.search);
    const shouldCreate = params.get('create') === 'true';
    const type = params.get('type');
    const category = params.get('category');
    
    if (shouldCreate && type && category) {
      console.log('üìã Ouverture du formulaire depuis URL:', type, category);
      setPendingContractType(type);
      setPendingCategory(category);
      
      // Ouvrir le dialogue apr√®s avoir d√©fini les √©tats
      requestAnimationFrame(() => {
        setShowQuestionDialog(true);
      });
      
      // Nettoyer l'URL apr√®s un d√©lai pour laisser le dialogue se monter
      const timer = setTimeout(() => {
        window.history.replaceState({}, '', location.pathname);
      }, 500);
      
      return () => clearTimeout(timer);
    }
  }, [location.search]);

  useEffect(() => {
    let isMounted = true;
    async function load() {
      if (!user) {
        setContrats([]);
        setLoading(false);
        return;
      }
      setLoading(true);
      let query = supabase
        .from('contrats')
        .select('id,name,category,type,created_at,updated_at')
        .eq('owner_id', user.id)
        .eq('role', role)
        .order('created_at', { ascending: false });
      if (debounced) {
        query = query.or(`name.ilike.%${debounced}%,type.ilike.%${debounced}%`);
      }
      if (categoryFilter && categoryFilter !== 'Tous') {
        query = query.eq('category', categoryFilter);
      }
      const { data, error } = await query;
      if (error) {
        console.error('Erreur chargement contrats:', error);
        if (isMounted) setContrats([]);
      } else if (isMounted) {
        setContrats(data as ContratRow[]);
      }
      if (isMounted) setLoading(false);
    }
    load();
    return () => { isMounted = false; };
  }, [user, role, debounced, categoryFilter]);

  const createContract = async (contractType: string, categoryKey: string) => {
    if (!user) {
      toast.error("Connexion requise");
      return;
    }
    
    // Ouvrir le formulaire pour TOUS les types de contrats
    console.log('üìã Cr√©ation contrat:', contractType, categoryKey);
    setPendingContractType(contractType);
    setPendingCategory(categoryKey);
    setShowQuestionDialog(true);
  };

  // Fonction pour cr√©er un contrat g√©n√©rique (sans formulaire sp√©cifique)
  const handleGenericContractSubmit = async () => {
    if (!user) return;
    
    try {
      const { data, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: pendingContractType,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: genericDescription || undefined,
          client_id: selectedClientId || undefined,
        })
        .select()
        .single();

      if (error) throw error;
      
      toast.success('Contrat cr√©√©', { description: pendingContractType });
      setShowQuestionDialog(false);
      setSelectedClientId("");
      setGenericDescription("");
      refreshContrats();
    } catch (err: unknown) {
      console.error('Erreur cr√©ation contrat:', err);
      const message = err instanceof Error ? err.message : String(err);
      toast.error('Erreur lors de la cr√©ation', { description: message });
    }
  };

  // Handler pour le formulaire CGU
  const handleCGUSubmit = async () => {
    if (!user) return;

    // Validation des champs obligatoires LCEN
    if (!cguData.editeurNom || !cguData.editeurDenomination || !cguData.editeurSiege || 
        !cguData.editeurDirecteurPublication || !cguData.hebergeurNom || !cguData.hebergeurAdresse) {
      toast.error("Champs LCEN obligatoires manquants", { 
        description: "Nom, d√©nomination, si√®ge, directeur publication et h√©bergeur requis" 
      });
      return;
    }

    try {
      const description = `CGU ‚Äî ${cguData.editeurDenomination} ‚Äî Service: ${cguData.serviceFourni || 'Non pr√©cis√©'}`;
      
      const { data, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: pendingContractType,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: description,
          contenu_json: cguData
        })
        .select()
        .single();

      if (error) throw error;

      // Upload des fichiers annexes CGU
      if (cguPolitiqueConfidentialiteFile) {
        const filePath = `${user.id}/${data.id}/annexes/politique_confidentialite_${cguPolitiqueConfidentialiteFile.name}`;
        const { error: uploadError } = await supabase.storage.from('contrats').upload(filePath, cguPolitiqueConfidentialiteFile);
        if (uploadError) console.error('Erreur upload politique confidentialit√©:', uploadError);
      }
      if (cguPolitiqueCookiesFile) {
        const filePath = `${user.id}/${data.id}/annexes/politique_cookies_${cguPolitiqueCookiesFile.name}`;
        const { error: uploadError } = await supabase.storage.from('contrats').upload(filePath, cguPolitiqueCookiesFile);
        if (uploadError) console.error('Erreur upload politique cookies:', uploadError);
      }
      if (cguCharteUtilisationFile) {
        const filePath = `${user.id}/${data.id}/annexes/charte_utilisation_${cguCharteUtilisationFile.name}`;
        const { error: uploadError } = await supabase.storage.from('contrats').upload(filePath, cguCharteUtilisationFile);
        if (uploadError) console.error('Erreur upload charte:', uploadError);
      }
      if (cguDocumentationAPIFile) {
        const filePath = `${user.id}/${data.id}/annexes/documentation_api_${cguDocumentationAPIFile.name}`;
        const { error: uploadError } = await supabase.storage.from('contrats').upload(filePath, cguDocumentationAPIFile);
        if (uploadError) console.error('Erreur upload doc API:', uploadError);
      }
      if (cguReglesModerationFile) {
        const filePath = `${user.id}/${data.id}/annexes/regles_moderation_${cguReglesModerationFile.name}`;
        const { error: uploadError } = await supabase.storage.from('contrats').upload(filePath, cguReglesModerationFile);
        if (uploadError) console.error('Erreur upload r√®gles mod√©ration:', uploadError);
      }

      // Upload des pi√®ces justificatives CGU
      if (cguMentionsLegalesFile) {
        const filePath = `${user.id}/${data.id}/pieces/mentions_legales_${cguMentionsLegalesFile.name}`;
        const { error: uploadError } = await supabase.storage.from('contrats').upload(filePath, cguMentionsLegalesFile);
        if (uploadError) console.error('Erreur upload mentions l√©gales:', uploadError);
      }
      if (cguPolitiqueConfidentialite2File) {
        const filePath = `${user.id}/${data.id}/pieces/politique_confidentialite_${cguPolitiqueConfidentialite2File.name}`;
        const { error: uploadError } = await supabase.storage.from('contrats').upload(filePath, cguPolitiqueConfidentialite2File);
        if (uploadError) console.error('Erreur upload politique confid pi√®ce:', uploadError);
      }
      if (cguPolitiqueCookies2File) {
        const filePath = `${user.id}/${data.id}/pieces/politique_cookies_${cguPolitiqueCookies2File.name}`;
        const { error: uploadError } = await supabase.storage.from('contrats').upload(filePath, cguPolitiqueCookies2File);
        if (uploadError) console.error('Erreur upload politique cookies pi√®ce:', uploadError);
      }
      if (cguConditionsCommercialesFile) {
        const filePath = `${user.id}/${data.id}/pieces/conditions_commerciales_${cguConditionsCommercialesFile.name}`;
        const { error: uploadError } = await supabase.storage.from('contrats').upload(filePath, cguConditionsCommercialesFile);
        if (uploadError) console.error('Erreur upload conditions commerciales:', uploadError);
      }

      toast.success("CGU cr√©√©es", { description: "Conditions G√©n√©rales d'Utilisation enregistr√©es" });
      setShowQuestionDialog(false);
      refreshContrats();
    } catch (err: unknown) {
      console.error('Erreur cr√©ation CGU:', err);
      const message = err instanceof Error ? err.message : String(err);
      toast.error('Erreur lors de la cr√©ation', { description: message });
    }
  };

  // Handler pour le formulaire de contrat d'agence commerciale
  const handleAgenceCommercialeSubmit = async () => {
    if (!user) return;

    // Validation des champs obligatoires
    if (!agenceData.mandantDenomination || !agenceData.mandantSIREN) {
      toast.error("Identification mandant incompl√®te", { 
        description: "D√©nomination et SIREN du mandant sont requis" 
      });
      return;
    }
    
    if (!agenceData.agentRSAC) {
      toast.error("RSAC obligatoire", { 
        description: "L'agent commercial doit √™tre inscrit au RSAC (obligation l√©gale)" 
      });
      return;
    }
    
    if (!agenceData.produits || !agenceData.secteursGeographiques) {
      toast.error("Objet du contrat incomplet", { 
        description: "Produits et zones g√©ographiques sont requis" 
      });
      return;
    }
    
    if (!agenceData.commissionType) {
      toast.error("Commissionnement requis", { 
        description: "Vous devez d√©finir le type de commissionnement" 
      });
      return;
    }
    
    // Validation conditionnelle du commissionnement
    if (agenceData.commissionType === 'pourcentage' && !agenceData.commissionPourcentage) {
      toast.error("Pourcentage manquant", { 
        description: "Veuillez indiquer le pourcentage de commission" 
      });
      return;
    }
    
    if (agenceData.commissionType === 'fixe' && !agenceData.commissionMontantFixe) {
      toast.error("Montant fixe manquant", { 
        description: "Veuillez indiquer le montant fixe de commission" 
      });
      return;
    }

    try {
      const description = `Contrat d'agence commerciale ‚Äî ${agenceData.mandantDenomination} / Agent: ${agenceData.agentNomPrenom || agenceData.agentDenomination}`;
      
      const { data: contrat, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: pendingContractType,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: description,
          contenu_json: agenceData
        })
        .select()
        .single();

      if (error) throw error;

      // Upload des fichiers individuels mandant
      if (agenceMandantKbisFile) {
        const filePath = `${user.id}/${contrat.id}/mandant/kbis_${agenceMandantKbisFile.name}`;
        const { error: uploadError } = await supabase.storage
          .from('contrats')
          .upload(filePath, agenceMandantKbisFile);
        if (uploadError) console.error('Erreur upload Kbis mandant:', uploadError);
      }
      if (agenceMandantPolitiqueFile) {
        const filePath = `${user.id}/${contrat.id}/mandant/politique_${agenceMandantPolitiqueFile.name}`;
        const { error: uploadError } = await supabase.storage
          .from('contrats')
          .upload(filePath, agenceMandantPolitiqueFile);
        if (uploadError) console.error('Erreur upload politique mandant:', uploadError);
      }
      if (agenceMandantCatalogueFile) {
        const filePath = `${user.id}/${contrat.id}/mandant/catalogue_${agenceMandantCatalogueFile.name}`;
        const { error: uploadError } = await supabase.storage
          .from('contrats')
          .upload(filePath, agenceMandantCatalogueFile);
        if (uploadError) console.error('Erreur upload catalogue mandant:', uploadError);
      }
      if (agenceMandantTarifsFile) {
        const filePath = `${user.id}/${contrat.id}/mandant/tarifs_${agenceMandantTarifsFile.name}`;
        const { error: uploadError } = await supabase.storage
          .from('contrats')
          .upload(filePath, agenceMandantTarifsFile);
        if (uploadError) console.error('Erreur upload tarifs mandant:', uploadError);
      }

      // Upload des fichiers individuels agent
      if (agenceAgentRSACFile) {
        const filePath = `${user.id}/${contrat.id}/agent/rsac_${agenceAgentRSACFile.name}`;
        const { error: uploadError } = await supabase.storage
          .from('contrats')
          .upload(filePath, agenceAgentRSACFile);
        if (uploadError) console.error('Erreur upload RSAC agent:', uploadError);
      }
      if (agenceAgentRCProFile) {
        const filePath = `${user.id}/${contrat.id}/agent/rcpro_${agenceAgentRCProFile.name}`;
        const { error: uploadError } = await supabase.storage
          .from('contrats')
          .upload(filePath, agenceAgentRCProFile);
        if (uploadError) console.error('Erreur upload RC Pro agent:', uploadError);
      }
      if (agenceAgentIdentiteFile) {
        const filePath = `${user.id}/${contrat.id}/agent/identite_${agenceAgentIdentiteFile.name}`;
        const { error: uploadError } = await supabase.storage
          .from('contrats')
          .upload(filePath, agenceAgentIdentiteFile);
        if (uploadError) console.error('Erreur upload identit√© agent:', uploadError);
      }

      // Upload des annexes (plusieurs fichiers possibles)
      if (agenceAnnexesFiles.length > 0) {
        for (const file of agenceAnnexesFiles) {
          const filePath = `${user.id}/${contrat.id}/annexes/${file.name}`;
          const { error: uploadError } = await supabase.storage
            .from('contrats')
            .upload(filePath, file);
          if (uploadError) console.error('Erreur upload annexe:', uploadError);
        }
      }

      toast.success("Contrat d'agence commerciale cr√©√©", { 
        description: "Toutes les sections et pi√®ces ont √©t√© enregistr√©es" 
      });
      setShowQuestionDialog(false);
      refreshContrats();
    } catch (err: unknown) {
      console.error('Erreur cr√©ation agence commerciale:', err);
      const message = err instanceof Error ? err.message : String(err);
      toast.error('Erreur lors de la cr√©ation', { description: message });
    }
  };

  // Handler pour le formulaire de procuration authentique
  const handleProcurationSubmit = async () => {
    if (!user) return;

    // Validation
    if (procurationData.typeProcuration.length === 0) {
      toast.error("Type de procuration requis", { description: "Veuillez s√©lectionner au moins un type" });
      return;
    }
    if (!procurationData.mandant.nom || !procurationData.mandant.prenom || !procurationData.mandant.dateNaissance || !procurationData.mandant.adresseComplete) {
      toast.error("Champs mandant requis", { description: "Nom, pr√©nom, date de naissance et adresse obligatoires" });
      return;
    }
    if (!procurationData.mandataire.nom || !procurationData.mandataire.prenom || !procurationData.mandataire.adresseComplete) {
      toast.error("Champs mandataire requis", { description: "Nom, pr√©nom et adresse obligatoires" });
      return;
    }
    if (!procurationData.objet.descriptionPrecise.trim()) {
      toast.error("Objet de la procuration requis", { description: "Veuillez pr√©ciser l'objet de la procuration" });
      return;
    }
    if (!procurationData.mentionsNotariales.nomNotaire || !procurationData.mentionsNotariales.villeOffice || !procurationData.mentionsNotariales.dateReception || !procurationData.mentionsNotariales.lieuReception) {
      toast.error("Mentions notariales requises", { description: "Tous les champs notariaux sont obligatoires" });
      return;
    }

    try {
      const description = `Procuration - Mandant: ${procurationData.mandant.prenom} ${procurationData.mandant.nom} ‚Üí Mandataire: ${procurationData.mandataire.prenom} ${procurationData.mandataire.nom}`;
      
      const { data, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: pendingContractType,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: description,
          contenu_json: procurationData
        })
        .select()
        .single();

      if (error) throw error;

      toast.success("Procuration cr√©√©e", { description: "Vous pouvez maintenant compl√©ter les d√©tails" });
      setShowQuestionDialog(false);
      
      // R√©initialiser le formulaire
      setProcurationData({
        typeProcuration: "",
        actesVises: "",
        mandant: {
          isClient: false, clientId: "", nom: "", prenom: "", nomNaissance: "",
          dateNaissance: "", lieuNaissance: "", nationalite: "", profession: "", adresseComplete: "",
          telephone: "", email: "", situationMatrimoniale: "", regimeMatrimonial: "", conjointNom: "",
          conjointPrenom: "", capaciteJuridique: "majeur_capable", typeMesureProtection: "", autorisationJointe: false,
          typeIdentite: "", numeroIdentite: "", dateEmissionIdentite: "", autoriteEmettrice: "",
        },
        mandataire: {
          nom: "", prenom: "", nomNaissance: "", dateNaissance: "", lieuNaissance: "", nationalite: "", profession: "",
          adresseComplete: "", telephone: "", email: "", lienMandant: "",
          typeIdentite: "", numeroIdentite: "", dateEmissionIdentite: "", autoriteEmettrice: "",
        },
        objet: {
          descriptionPrecise: "", listeActesAutorises: "", faculteSignerActes: false, faculteRecevoirSommes: false,
          immobilierVente: false, immobilierAchat: false, immobilierHypotheque: false, immobilierMainlevee: false,
          immobilierSignatureAvantContrats: false, immobilierAcceptationConditions: false, immobilierPercevoirPrix: false,
          faculteSubstituer: false,
        },
        etendue: {
          typeEtendue: "tres_large", precisionsLimitees: "", actesExclus: "", subdelegation: "interdite",
        },
        duree: {
          type: "indeterminee", dateFin: "", revocable: true,
        },
        acceptation: {
          type: "expresse", acceptationJourActe: true,
        },
        declarations: {
          agitLibrement: false, pleineCapacite: false, comprendPortee: false, consentLibre: false, pouvoirIrrevocable: false,
        },
        langue: {
          langueComprise: "Fran√ßais", interpreteNecessaire: false, interpreteIdentite: "",
        },
        comparution: {
          typeComparution: "presence", lectureFaite: false, consentementRecueilli: false, typeSignature: "presentiel",
        },
        mentionsNotariales: {
          nomNotaire: "", villeOffice: "", dateReception: "", lieuReception: "", acteRecuMinute: false,
        },
        conservation: {
          minuteConservee: false, copiesSimples: false, copiesCertifiees: false, copiesExecutoires: false,
        }
      });
      
      refreshContrats();
    } catch (err: unknown) {
      console.error('Erreur cr√©ation procuration:', err);
      const message = err instanceof Error ? err.message : String(err);
      toast.error('Erreur lors de la cr√©ation', { description: message });
    }
  };

  // Handler pour le formulaire de mandat de protection future
  const handleMandatProtectionSubmit = async () => {
    if (!user) return;

    // Validation
    if (mandatProtectionData.typeMandat.length === 0) {
      toast.error("Type de mandat requis", { description: "Veuillez s√©lectionner au moins un type" });
      return;
    }
    if (!mandatProtectionData.mandant.nom || !mandatProtectionData.mandant.prenom || !mandatProtectionData.mandant.dateNaissance || !mandatProtectionData.mandant.adresseComplete) {
      toast.error("Champs mandant requis", { description: "Nom, pr√©nom, date de naissance et adresse obligatoires" });
      return;
    }
    if (!mandatProtectionData.mandatairePrincipal.nom || !mandatProtectionData.mandatairePrincipal.prenom || !mandatProtectionData.mandatairePrincipal.adresseComplete) {
      toast.error("Champs mandataire requis", { description: "Nom, pr√©nom et adresse obligatoires" });
      return;
    }
    if (!mandatProtectionData.forme.typeActe || !mandatProtectionData.forme.dateSignature) {
      toast.error("Forme du mandat requise", { description: "Type d'acte et date de signature obligatoires" });
      return;
    }
    if (!mandatProtectionData.juridictionConservation.tribunalCompetent || !mandatProtectionData.juridictionConservation.villeJuridiction || !mandatProtectionData.juridictionConservation.lieuConservation) {
      toast.error("Juridiction et conservation requises", { description: "Tribunal comp√©tent, ville et lieu de conservation obligatoires" });
      return;
    }
    if (!mandatProtectionData.remuneration.typeRemuneration) {
      toast.error("R√©mun√©ration requise", { description: "Type de r√©mun√©ration obligatoire" });
      return;
    }
    if (mandatProtectionData.remuneration.typeRemuneration === "remunere" && !mandatProtectionData.remuneration.modalitesRemuneration) {
      toast.error("Modalit√©s de r√©mun√©ration requises", { description: "Veuillez pr√©ciser les modalit√©s de r√©mun√©ration" });
      return;
    }
    if (!mandatProtectionData.clausesSpeciales.donationsAutorisees) {
      toast.error("Clause donations requise", { description: "Clause expresse obligatoire sur les donations et actes √† titre gratuit" });
      return;
    }

    try {
      const description = `Mandat de protection future - Mandant: ${mandatProtectionData.mandant.prenom} ${mandatProtectionData.mandant.nom} ‚Üí Mandataire: ${mandatProtectionData.mandatairePrincipal.prenom} ${mandatProtectionData.mandatairePrincipal.nom}`;
      
      const { data, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: pendingContractType,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: description,
          contenu_json: mandatProtectionData
        })
        .select()
        .single();

      if (error) throw error;

      toast.success("Mandat de protection future cr√©√©", { description: "Vous pouvez maintenant compl√©ter les d√©tails" });
      setShowQuestionDialog(false);
      
      // R√©initialiser le formulaire
      setMandatProtectionData({
        typeMandat: [],
        mandatAutrui: { lienJuridique: "", justificationLegale: "" },
        mandant: {
          isClient: false, clientId: "", nom: "", prenom: "", nomNaissance: "", dateNaissance: "", lieuNaissance: "",
          nationalite: "", profession: "", adresseComplete: "", telephone: "", email: "", situationMatrimoniale: "",
          regimeMatrimonial: "", conjointNom: "", conjointPrenom: "", capaciteJuridique: "majeur_capable",
          typeIdentite: "", numeroIdentite: "", dateEmissionIdentite: "", dateExpirationIdentite: "",
        },
        mandatairePrincipal: {
          nom: "", prenom: "", dateNaissance: "", lieuNaissance: "", adresseComplete: "", profession: "",
          telephone: "", email: "", typeIdentite: "", numeroIdentite: "", dateExpirationIdentite: "",
          lienMandant: "", absenceIncapaciteLegale: false, absenceDecheanceAutorite: false,
          absenceInterdictionGestion: false, absenceMesureProtection: false, acceptationEcrite: false,
        },
        mandataireSubstitut: {
          existe: false, nom: "", prenom: "", dateNaissance: "", lieuNaissance: "", adresseComplete: "",
          profession: "", telephone: "", email: "", typeIdentite: "", numeroIdentite: "",
          lienMandant: "", conditionsEntree: "", etenduePouvoirs: "",
        },
        pouvoirsPersonne: {
          representationActesCourants: false, choixEtablissement: false, demarchesSociales: false,
          organisationSoins: false, gestionMedecins: false, gestionQuotidien: false, precisionsAutres: "",
        },
        pouvoirsAdministration: {
          gestionComptes: false, encaissementRevenus: false, paiementDepenses: false,
          renouvellementBail: false, souscriptionAssurances: false, entretienBiens: false,
        },
        pouvoirsDisposition: {
          venteImmobilier: false, achatImmobilier: false, donationMobilier: false, gestionTitres: false,
          resiliationBail: false, reglementDettes: false, acceptationSuccession: false, renonciationSuccession: false,
          donations: false, modificationsSuccessorales: false, actesGratuits: false, modificationContratMariage: false,
        },
        biensPatrimoine: {
          biensImmobiliers: "", comptesBancaires: "", assurancesVie: "", livretsEpargne: "",
          biensMobiliers: "", partsSociales: "", revenusReguliers: "", dettesExistantes: "",
        },
        limites: {
          interdictionVenteCertainsBiens: false, biensConcernes: "", interdictionDeplacement: false,
          interdictionModificationContrats: false, montantMaximum: "", obligationComptesReguliers: false, periodiciteComptes: "",
        },
        controle: {
          obligationCompteGestion: false, controlePersonne: false, controleIdentite: "", controlePouvoirs: "",
          controleNotaire: false, controleExpertComptable: false, compteRenduAnnuel: false, periodicite: "",
        },
        miseEnOeuvre: {
          certificatMedical: true, medecinListe: "", dateConstat: "", depotGreffe: false, notificationMandataire: false,
        },
        finMandat: {
          finRetourFacultes: true, revocationMandant: true, destitutionJuge: true, decesMandant: true, remplacementSubstitut: false,
        },
        declarations: {
          volonteLibre: false, consentementSansPression: false, explicationComprise: false,
          acceptationActesDisposition: false, acceptationMandataire: false, droitRevocation: false,
        },
        forme: {
          typeActe: "", nomNotaire: "", villeOffice: "", dateSignature: "", datePriseEffet: "",
          lieuSignature: "", referenceLegale: "Articles 477 √† 494 du Code civil",
        },
        juridictionConservation: {
          tribunalCompetent: "", villeJuridiction: "", lieuConservation: "", precisionsConservation: "",
        },
        remuneration: {
          typeRemuneration: "", modalitesRemuneration: "", remboursementFrais: false, precisionsRemboursement: "",
        },
        clausesSpeciales: {
          prioriteFamiliale: false, obligationInformationFamille: false, precisionsInformationFamille: "",
          ordreSubstitution: "", conditionsRemplacement: "", etenduePouvoirs: "",
          responsabiliteCivile: false, obligationInteretExclusif: true,
          donationsAutorisees: "", beneficiairesAutorises: "",
        },
      });
      
      refreshContrats();
    } catch (err: unknown) {
      console.error('Erreur cr√©ation mandat protection:', err);
      const message = err instanceof Error ? err.message : String(err);
      toast.error('Erreur lors de la cr√©ation', { description: message });
    }
  };

  // Handler pour Quitus / reconnaissance de dette
  const handleQuitusDetteSubmit = async () => {
    if (!user) return;

    // Validation
    if (!quitusDetteData.typeActe) {
      toast.error("Type d'acte requis", { description: "Veuillez s√©lectionner le type d'acte" });
      return;
    }
    if (!quitusDetteData.creancier.nom || !quitusDetteData.creancier.prenom || !quitusDetteData.creancier.adresseComplete) {
      toast.error("Identit√© cr√©ancier requise", { description: "Nom, pr√©nom et adresse obligatoires" });
      return;
    }
    if (!quitusDetteData.debiteur.nom || !quitusDetteData.debiteur.prenom || !quitusDetteData.debiteur.adresseComplete) {
      toast.error("Identit√© d√©biteur requise", { description: "Nom, pr√©nom et adresse obligatoires" });
      return;
    }
    if (!quitusDetteData.objetDette.natureDette || !quitusDetteData.objetDette.dateNaissanceDette) {
      toast.error("Objet de la dette requis", { description: "Nature et date de la dette obligatoires" });
      return;
    }
    if (!quitusDetteData.montant.montantTotal || !quitusDetteData.montant.devise) {
      toast.error("Montant requis", { description: "Montant total et devise obligatoires" });
      return;
    }
    if (!quitusDetteData.signatures.dateSignature || !quitusDetteData.signatures.lieuSignature) {
      toast.error("Signatures requises", { description: "Date et lieu de signature obligatoires" });
      return;
    }

    // Validations sp√©cifiques selon type d'acte
    if ((quitusDetteData.typeActe === "reconnaissance_dette" || quitusDetteData.typeActe === "reconnaissance_dette_modalites") && parseFloat(quitusDetteData.montant.montantTotal) > 1500 && !quitusDetteData.clausesLegales.mentionManuscrite) {
      toast.error("Mention manuscrite requise", { description: "Pour une dette > 1500‚Ç¨, la mention manuscrite est obligatoire" });
      return;
    }

    if ((quitusDetteData.typeActe === "quitus" || quitusDetteData.typeActe === "quitus_partiel" || quitusDetteData.typeActe === "solde_tout_compte" || quitusDetteData.typeActe === "attestation_reglement") && quitusDetteData.quitus.paiementsRecus.length === 0) {
      toast.error("Paiements requis", { description: "Veuillez indiquer les paiements re√ßus" });
      return;
    }

    try {
      const typeLabels: Record<string, string> = {
        reconnaissance_dette: "Reconnaissance de dette",
        reconnaissance_dette_modalites: "Reconnaissance de dette avec modalit√©s",
        quitus: "Quitus total",
        quitus_partiel: "Quitus partiel",
        remise_dette: "Remise de dette",
        solde_tout_compte: "Solde de tout compte",
        attestation_reglement: "Attestation de r√®glement"
      };

      const description = `${typeLabels[quitusDetteData.typeActe] || quitusDetteData.typeActe} - Cr√©ancier: ${quitusDetteData.creancier.prenom} ${quitusDetteData.creancier.nom} / D√©biteur: ${quitusDetteData.debiteur.prenom} ${quitusDetteData.debiteur.nom} - Montant: ${quitusDetteData.montant.montantTotal} ${quitusDetteData.montant.devise}`;
      
      const { data, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: pendingContractType,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: description,
          contenu_json: quitusDetteData
        })
        .select()
        .single();

      if (error) throw error;

      toast.success("Document cr√©√©", { description: "Vous pouvez maintenant compl√©ter les d√©tails" });
      setShowQuestionDialog(false);
      
      // R√©initialiser le formulaire
      setQuitusDetteData({
        typeActe: "",
        creancier: {
          isClient: false, clientId: "", nom: "", prenom: "", nomNaissance: "", dateNaissance: "",
          lieuNaissance: "", nationalite: "", profession: "", adresseComplete: "", telephone: "",
          email: "", typeIdentite: "", numeroIdentite: "", situationMatrimoniale: "", rib: ""
        },
        debiteur: {
          isClient: false, clientId: "", nom: "", prenom: "", nomNaissance: "", dateNaissance: "",
          lieuNaissance: "", nationalite: "", profession: "", adresseComplete: "", telephone: "",
          email: "", typeIdentite: "", numeroIdentite: "", situationMatrimoniale: "", rib: ""
        },
        objetDette: {
          natureDette: "", dateNaissanceDette: "", circonstancesDette: "", preuveEcriteExiste: "", temoinsEventuels: ""
        },
        montant: {
          montantTotal: "", devise: "EUR", sommeDejaRemboursee: "", sommeRestantDue: "", montantReconnuDebiteur: "", modalitePret: "", dateExigibiliteSolde: ""
        },
        remboursement: {
          modalite: "", conditionRemboursement: "",
          echeances: [{ id: 1, date: "", montant: "", moyenPaiement: "", consequencesRetard: "" }],
          avecInterets: false, tauxInteret: "", tauxUsuraire: "", capitalisationInterets: "",
          clausePenale: false, montantPenalite: "", pourcentagePenalite: "", delaiGrace: ""
        },
        suretes: {
          cautionPersonnelle: false, cautionIdentite: "", cautionMontant: "", cautionDuree: "",
          garantieSalaire: false, gageMobilier: false, gageDescription: "",
          nantissementTitres: false, nantissementDetails: "",
          hypotheque: false, hypothequeDetails: "",
          depotGarantie: false, depotMontant: "",
          acteAuthentique: false, notaireNom: ""
        },
        remiseDette: {
          remiseTotale: false, remisePartielle: false, montantRemise: "", conditionsRemise: "",
          effetsRetroactifs: false, renonciationPoursuites: false, preuvesPaiementsPartiels: ""
        },
        quitus: {
          typeQuitus: "",
          paiementsRecus: [{ id: 1, date: "", montant: "", modePaiement: "", referenceBancaire: "" }],
          sommesRecuesTotalement: false, renonciationReclamations: false, detteEteinte: false,
          annulationGaranties: false, restitutionDocuments: false
        },
        clausesLegales: {
          consentementLibre: false, reconnaissanceMontant: false, engagementRemboursement: false,
          mentionManuscrite: "", clauseSolidarite: false, clauseDivisibilite: false,
          extinctionDette: false, liberationDefinitive: false, renonciationRecours: false, identificationDette: "",
          clauseNonNovation: false, droitApplicable: "france", tribunalCompetent: "",
          pluraliteDebiteurs: false, solidarite: false
        },
        signatures: {
          dateSignature: "", lieuSignature: "", dateExtinctionEffective: "", signatureNotaire: "non", nomNotaire: "", villeNotaire: ""
        }
      });
      setQuitusCreancierIdentiteFiles([]);
      setQuitusDebiteurIdentiteFiles([]);
      setQuitusPreuveDetteFiles([]);
      setQuitusPreuveTransfertFiles([]);
      setQuitusEcheancierFiles([]);
      setQuitusCautionIdentiteFiles([]);
      setQuitusPreuvesPaiementsFiles([]);
      setQuitusAncienneDetteFiles([]);
      setQuitusJustifDomicileCreancierFiles([]);
      setQuitusJustifDomicileDebiteurFiles([]);
      
      refreshContrats();
    } catch (err: unknown) {
      console.error('Erreur cr√©ation quitus/reconnaissance:', err);
      const message = err instanceof Error ? err.message : String(err);
      toast.error('Erreur lors de la cr√©ation', { description: message });
    }
  };

  // Handler pour Cession de parts sociales
  const handleCessionPartsSubmit = async () => {
    if (!user) return;

    // Validation
    if (!cessionPartsData.typeSociete) {
      toast.error("Type de soci√©t√© requis", { description: "Veuillez s√©lectionner le type de soci√©t√©" });
      return;
    }
    if (!cessionPartsData.societe.denominationSociale || !cessionPartsData.societe.siren || !cessionPartsData.societe.siegeSocial) {
      toast.error("Informations soci√©t√© requises", { description: "D√©nomination, SIREN et si√®ge obligatoires" });
      return;
    }
    if (!cessionPartsData.cedant.nom || !cessionPartsData.cedant.prenom || !cessionPartsData.cedant.adresseComplete) {
      toast.error("Identit√© c√©dant requise", { description: "Nom, pr√©nom et adresse obligatoires" });
      return;
    }
    if (cessionPartsData.cessionnaire.typePersonne === "physique") {
      if (!cessionPartsData.cessionnaire.nom || !cessionPartsData.cessionnaire.prenom || !cessionPartsData.cessionnaire.adresseComplete) {
        toast.error("Identit√© cessionnaire requise", { description: "Nom, pr√©nom et adresse obligatoires" });
        return;
      }
    } else {
      if (!cessionPartsData.cessionnaire.denominationMorale || !cessionPartsData.cessionnaire.representantLegal) {
        toast.error("Informations personne morale requises", { description: "D√©nomination et repr√©sentant obligatoires" });
        return;
      }
    }
    if (!cessionPartsData.objetCession.nombreParts || !cessionPartsData.objetCession.prixTotal) {
      toast.error("Objet de cession requis", { description: "Nombre de parts et prix obligatoires" });
      return;
    }
    if (!cessionPartsData.signatures.dateSignature || !cessionPartsData.signatures.lieuSignature) {
      toast.error("Signatures requises", { description: "Date et lieu de signature obligatoires" });
      return;
    }

    try {
      const description = `Cession de parts ${cessionPartsData.typeSociete.toUpperCase()} - ${cessionPartsData.societe.denominationSociale} - C√©dant: ${cessionPartsData.cedant.prenom} ${cessionPartsData.cedant.nom} - ${cessionPartsData.objetCession.nombreParts} parts pour ${cessionPartsData.objetCession.prixTotal}‚Ç¨`;
      
      const { data, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: pendingContractType,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: description,
          contenu_json: cessionPartsData
        })
        .select()
        .single();

      if (error) throw error;

      toast.success("Document cr√©√©", { description: "Vous pouvez maintenant compl√©ter les d√©tails" });
      setShowQuestionDialog(false);
      
      // R√©initialiser le formulaire
      setCessionPartsData({
        typeSociete: "",
        societe: {
          denominationSociale: "", sigle: "", formeJuridique: "", capitalSocial: "", siegeSocial: "",
          siren: "", rcs: "", greffeCompetent: "", activiteSociete: "", dateCreation: "", objetSocial: "",
          pacteAssocies: false, expertComptable: false, gerantNom: "", gerantPrenom: "", gerantAdresse: "", gerantPouvoirs: ""
        },
        cedant: {
          isClient: false, clientId: "", nom: "", prenom: "", nomNaissance: "", adresseComplete: "",
          email: "", telephone: "", dateNaissance: "", nationalite: "", profession: "", situationMatrimoniale: "",
          regimeMatrimonial: "", typeIdentite: "", numeroIdentite: "", qualiteSociete: ""
        },
        cessionnaire: {
          typePersonne: "physique", clientId: "", nom: "", prenom: "", adresseComplete: "", email: "", telephone: "",
          dateNaissance: "", nationalite: "", profession: "", situationMatrimoniale: "", typeIdentite: "",
          numeroIdentite: "", capaciteJuridique: "majeur", denominationMorale: "", representantLegal: ""
        },
        objetCession: {
          natureTitres: "", typeDroits: "", nombreParts: "", pourcentageCapital: "", valeurNominale: "", prixTotal: "",
          prixUnitaire: "", modeCalcul: "", modalitePaiement: "", ribCedant: "",
          dateEffetCession: "", dateEffetDifferee: "",
          agrement: false, approbationConjoint: false, financementBancaire: false, leveeNantissement: false,
          sansGarantiePassif: false
        },
        agrement: {
          procedureAgrement: "", organeCompetent: "", dateDecisionAgrement: "", modeVoteMajorite: "",
          convocationAssocies: false, voteEffectue: false, majoriteRequise: "",
          notificationStatut: "", delaiLegalRespecte: false
        },
        compteCourant: {
          cessionCCA: false, maintienCCA: false, remboursementImmediat: false, remboursementEchelonne: false,
          compensationPrix: false, garantieSolde: false, montantSoldeCCA: "",
          detteVersTiers: false, natureDetteTiers: "", montantDetteTiers: "", creancierTiers: "", acceptationCreancier: false
        },
        garanties: {
          garantieEviction: false, garantiePropriete: false, garantiePassif: "", garantieActifNet: false,
          absenceNantissement: false, absenceLitiges: false, plafondGarantie: "", dureeGarantie: "",
          exclusions: "", procedureMiseEnJeu: ""
        },
        conjoint: {
          identiteConjoint: "", acceptationCession: false, renonciationCession: false,
          signatureObligatoire: false, regimeMatrimonialPrecise: ""
        },
        droitsEnregistrement: {
          tauxApplicable: "", chargeDroits: ""
        },
        nonConcurrence: {
          clauseNonConcurrence: false, dureeNonConcurrence: "", zoneGeographique: "", activiteInterdite: ""
        },
        notificationSociete: {
          modeNotification: ""
        },
        declarationsLegales: {
          consentementLibre: false, origineLiciteFonds: false, absenceFraude: false, acceptationPrix: false,
          transfertProprieteDateSignature: false, mentionStatutsMisAJour: false, mentionImpositionFiscale: false,
          renonciationDroitPreemption: false
        },
        formalites: {
          modificationCapital: false, miseAJourRegistreMouvements: false, miseAJourRegistreAssocies: false,
          depotGreffe: false, publicationLegale: false, informationBanques: false
        },
        signatures: {
          dateSignature: "", lieuSignature: "", signatureNotaire: false, nomNotaire: "", villeNotaire: ""
        }
      });
      setCessionStatutsFiles([]);
      setCessionKbisFiles([]);
      setCessionComptesFiles([]);
      setCessionRegistreFiles([]);
      setCessionPacteFiles([]);
      setCessionCedantIdFiles([]);
      setCessionCedantMariageFiles([]);
      setCessionExpertiseFiles([]);
      setCessionCCAFiles([]);
      setCessionCessionnaireIdFiles([]);
      setCessionCessionnaireDomicileFiles([]);
      setCessionCessionnaireKbisFiles([]);
      setCessionOrigineFondsFiles([]);
      setCessionPVAgrementFiles([]);
      
      refreshContrats();
    } catch (err: unknown) {
      console.error('Erreur cr√©ation cession parts:', err);
      const message = err instanceof Error ? err.message : String(err);
      toast.error('Erreur lors de la cr√©ation', { description: message });
    }
  };

  // Handler pour Attestation de propri√©t√© immobili√®re
  const handleAttestationSubmit = async () => {
    if (!user) return;

    // Validation
    if (!attestationData.defunt.nom || !attestationData.defunt.prenom || !attestationData.defunt.dateDeces) {
      toast.error("Informations d√©funt requises", { description: "Nom, pr√©nom et date de d√©c√®s obligatoires" });
      return;
    }
    if (attestationData.heritiers.length === 0 || !attestationData.heritiers[0].nom) {
      toast.error("Au moins un h√©ritier requis", { description: "Veuillez ajouter les h√©ritiers" });
      return;
    }
    if (attestationData.biens.length === 0 || !attestationData.biens[0].adresseComplete) {
      toast.error("Au moins un bien requis", { description: "Veuillez d√©crire les biens immobiliers" });
      return;
    }

    try {
      const description = `Attestation de propri√©t√© immobili√®re - D√©funt: ${attestationData.defunt.prenom} ${attestationData.defunt.nom} (d√©c√©d√© le ${attestationData.defunt.dateDeces})
${attestationData.heritiers.length} h√©ritier(s), ${attestationData.biens.length} bien(s)`;
      
      const { data, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: pendingContractType,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: description,
          details: JSON.stringify(attestationData),
          status: 'draft',
        })
        .select()
        .single();

      if (error) throw error;

      toast.success("Attestation cr√©√©e", { description: "Vous pouvez maintenant compl√©ter les d√©tails" });
      setShowQuestionDialog(false);
      
      // R√©initialiser le formulaire
      setAttestationData({
        defunt: {
          nom: "", prenom: "", nomNaissance: "", sexe: "", dateNaissance: "", lieuNaissance: "", nationalite: "",
          profession: "", adresseDecesComplete: "", dateDeces: "", lieuDeces: "", domicileFiscalCommune: "", 
          domicileFiscalPays: "", situationMatrimoniale: "", regimeMatrimonial: "", regimeMatrimonialAutre: "",
          dateContratMariage: "", notaireContratMariage: "", existenceContratMariage: false, existencePacs: false, 
          existenceTestament: false, existenceDonationsEntreEpoux: false, existenceDonationsAnterieures: false,
        },
        heritiers: [{
          id: 1, nom: "", prenom: "", dateNaissance: "", lieuNaissance: "", lienParente: "", adresseComplete: "",
          email: "", telephone: "", nationalite: "", profession: "", typeAcceptation: "", statutAge: "", 
          protectionJuridique: "", clientId: "",
        }],
        conjointSurvivant: {
          existe: false, nom: "", prenom: "", regimeMatrimonial: "", droitsConjoint: "",
        },
        biens: [{
          id: 1, adresseComplete: "", codePostal: "", commune: "", cadastreSection: "", cadastreNumero: "",
          cadastreContenance: "", typeBien: "", surfaceHabitable: "", nombrePieces: "", dependances: "", annexes: "",
          equipements: "", situationLocative: "", montantLoyer: "", dateAcquisition: "", natureAcquisition: "",
          repartitionDroits: "", quotePart: "", notaireAcquisition: "", datePublicationSPF: "", volumeSPF: "",
          numeroSPF: "", servitudesActives: "", servitudesPassives: "", pretEnCours: false,
          hypothequeInscrite: false, typeHypotheque: "", montantResiduel: "", necessitMainlevee: false,
          estCopropriete: false, numeroLot: "", quotepartCommunes: "", chargesAnnuelles: "",
          existenceLegsParticuliers: false, precisionLegs: "",
        }],
        regimeMatrimonial: "", droitsConjointSurvivant: "",
        repartitionDroits: { conjoint: "", heritiers: "" },
        destinationBien: "", loiSuccessoraleApplicable: "", confirmationAbsenceAutresHeritiers: false,
        indivisionSuccessorale: false, declarationFiscaleHonneur: false,
        valeurVenale: "", methodeEstimation: "", valeurDeclareeFiscale: "", bureauSPF: "", fichesPreparees: false,
        dateSignature: "", lieuSignature: "", notaireInstrumentaire: "",
      });
      
      refreshContrats();
    } catch (err: unknown) {
      console.error('Erreur cr√©ation attestation:', err);
      const message = err instanceof Error ? err.message : String(err);
      toast.error('Erreur lors de la cr√©ation', { description: message });
    }
  };

  const handleQuestionnaireSubmit = async () => {
    if (!user) return;
    
    try {
      // R√©cup√©rer les infos du client s√©lectionn√©
      const selectedClient = clients.find(c => c.id === questionnaireData.clientId);
      if (!selectedClient) {
        toast.error('Veuillez s√©lectionner un client');
        return;
      }

      // D√©terminer qui est le vendeur et qui est l'acqu√©reur
      const isClientAcheteur = questionnaireData.clientRole === "acheteur";
      const vendeurInfo = isClientAcheteur 
        ? {
            nom: questionnaireData.nomAutrePartie,
            prenom: questionnaireData.prenomAutrePartie,
            adresse: questionnaireData.adresseAutrePartie
          }
        : {
            nom: selectedClient.nom,
            prenom: selectedClient.prenom,
            adresse: selectedClient.adresse
          };
      
      const acquereurInfo = isClientAcheteur
        ? {
            nom: selectedClient.nom,
            prenom: selectedClient.prenom,
            adresse: selectedClient.adresse
          }
        : {
            nom: questionnaireData.nomAutrePartie,
            prenom: questionnaireData.prenomAutrePartie,
            adresse: questionnaireData.adresseAutrePartie
          };

      // Cr√©er le contrat avec les donn√©es du questionnaire en description
      const descriptionData = `
TYPE DE CONTRAT: ${questionnaireData.typeContrat === "compromis" ? "Compromis de vente" : "Promesse unilat√©rale de vente"}

INFORMATIONS SUR LE BIEN:
- Adresse: ${questionnaireData.adresseBien}
- Type de bien: ${questionnaireData.typeBien}
- Surface habitable: ${questionnaireData.surfaceHabitable} m¬≤
- Nombre de pi√®ces: ${questionnaireData.nombrePieces}
- Nature de la propri√©t√©: ${questionnaireData.naturePropriete}
- Bien en copropri√©t√©: ${questionnaireData.bienCopropriete}
${questionnaireData.bienCopropriete === "oui" ? `- Num√©ro de lot: ${questionnaireData.numeroLot}\n- Tanti√®mes: ${questionnaireData.tanti√®mes}` : ''}
- Occupation du bien: ${questionnaireData.occupationBien}
- Servitudes connues: ${questionnaireData.servitudesConnues}
${questionnaireData.servitudesConnues === "oui" ? `- Description des servitudes: ${questionnaireData.descriptionServitudes}` : ''}
- Bien vendu libre de toute occupation: ${questionnaireData.bienLibre}

VENDEUR:
- Nom: ${vendeurInfo.nom}
- Pr√©nom: ${vendeurInfo.prenom}
- Adresse: ${vendeurInfo.adresse}
- Statut matrimonial: ${isClientAcheteur ? questionnaireData.statutMatrimonialAutrePartie : questionnaireData.statutMatrimonialClient}
${(isClientAcheteur ? questionnaireData.statutMatrimonialAutrePartie : questionnaireData.statutMatrimonialClient) === "marie" || (isClientAcheteur ? questionnaireData.statutMatrimonialAutrePartie : questionnaireData.statutMatrimonialClient) === "pacse" ? `- R√©gime matrimonial: ${isClientAcheteur ? questionnaireData.regimeMatrimonialAutrePartie : questionnaireData.regimeMatrimonialClient}` : ''}

ACQU√âREUR:
- Nom: ${acquereurInfo.nom}
- Pr√©nom: ${acquereurInfo.prenom}
- Adresse: ${acquereurInfo.adresse}
- Statut matrimonial: ${isClientAcheteur ? questionnaireData.statutMatrimonialClient : questionnaireData.statutMatrimonialAutrePartie}
${(isClientAcheteur ? questionnaireData.statutMatrimonialClient : questionnaireData.statutMatrimonialAutrePartie) === "marie" || (isClientAcheteur ? questionnaireData.statutMatrimonialClient : questionnaireData.statutMatrimonialAutrePartie) === "pacse" ? `- R√©gime matrimonial: ${isClientAcheteur ? questionnaireData.regimeMatrimonialClient : questionnaireData.regimeMatrimonialAutrePartie}` : ''}

CONDITIONS FINANCI√àRES:
- Prix de vente: ${questionnaireData.prixVente} ‚Ç¨
- D√©p√¥t de garantie: ${questionnaireData.depotGarantie} ‚Ç¨
- Modalit√©s de paiement: ${questionnaireData.modalitesPaiement}

${questionnaireData.typeContrat === "compromis" ? `
CONDITIONS SUSPENSIVES:
- Condition de pr√™t: ${questionnaireData.conditionPret}
${questionnaireData.conditionPret === "oui" ? `
D√âTAILS DU PR√äT IMMOBILIER:
- Montant du pr√™t: ${questionnaireData.montantPret} ‚Ç¨
- Dur√©e du pr√™t: ${questionnaireData.dureePret} ann√©es
- Taux d'int√©r√™t maximal: ${questionnaireData.tauxInteretMax} %
- D√©lai pour accord de pr√™t: ${questionnaireData.delaiAccordPret}` : ''}
- Diagnostics: ${questionnaireData.conditionDiagnostics}
- Autres conditions: ${questionnaireData.autresConditions}` : ''}

DROIT DE PR√âEMPTION:
- Droit de pr√©emption urbain: ${questionnaireData.droitPreemptionUrbain}
- Locataire avec droit de pr√©emption: ${questionnaireData.locatairePreemption}

${questionnaireData.typeContrat === "promesse_unilaterale" ? `
PROMESSE UNILAT√âRALE:
- Dur√©e de l'option: ${questionnaireData.dureeOption} jours
- Date limite de lev√©e d'option: ${questionnaireData.dateLimiteOption}
- Indemnit√© d'immobilisation: ${questionnaireData.indemniteImmobilisation}` : ''}

D√âLAIS:
- Date signature acte d√©finitif: ${questionnaireData.dateSignatureActeDefinitif}
- D√©lai de r√©flexion: ${questionnaireData.delaiReflexion} jours

INFORMATIONS COMPL√âMENTAIRES:
- Charges de copropri√©t√©: ${questionnaireData.chargesCopropriete}
- Travaux √† pr√©voir: ${questionnaireData.travauxAPrevenir}
- Autres informations: ${questionnaireData.autresInformations}
      `.trim();

      const { data, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: pendingContractType,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: descriptionData,
        })
        .select()
        .single();

      if (error) throw error;
      
      toast.success('Contrat cr√©√© avec succ√®s', { 
        description: 'Les informations ont √©t√© enregistr√©es et pourront √™tre utilis√©es pour g√©n√©rer le document'
      });
      
      setShowQuestionDialog(false);
      // R√©initialiser le questionnaire
      setQuestionnaireData({
        typeContrat: "",
        adresseBien: "",
        typeBien: "",
        surfaceHabitable: "",
        nombrePieces: "",
        naturePropriete: "",
        bienCopropriete: "",
        numeroLot: "",
        tanti√®mes: "",
        occupationBien: "",
        servitudesConnues: "",
        descriptionServitudes: "",
        bienLibre: "",
        clientId: "",
        clientRole: "",
        statutMatrimonialClient: "",
        regimeMatrimonialClient: "",
        precisionRegimeClient: "",
        nomAutrePartie: "",
        prenomAutrePartie: "",
        adresseAutrePartie: "",
        statutMatrimonialAutrePartie: "",
        regimeMatrimonialAutrePartie: "",
        precisionRegimeAutrePartie: "",
        prixVente: "",
        depotGarantie: "",
        modalitesPaiement: "",
        conditionPret: "",
        montantPret: "",
        dureePret: "",
        tauxInteretMax: "",
        delaiAccordPret: "",
        conditionDiagnostics: "",
        autresConditions: "",
        droitPreemptionUrbain: "",
        locatairePreemption: "",
        dateSignatureActeDefinitif: "",
        delaiReflexion: "",
        dureeOption: "",
        dateLimiteOption: "",
        indemniteImmobilisation: "",
        chargesCopropriete: "",
        travauxAPrevenir: "",
        autresInformations: "",
      });
      
      refreshContrats();
    } catch (err: unknown) {
      console.error('Erreur cr√©ation contrat:', err);
      const message = err instanceof Error ? err.message : String(err);
      toast.error('Erreur lors de la cr√©ation', { description: message });
    }
  };

  // Handler pour la soumission du questionnaire Acte de vente immobili√®re
  const handleActeVenteSubmit = async () => {
    try {
      if (!user) {
        toast.error('Utilisateur non connect√©');
        return;
      }

      // Validation des champs requis
      if (!acteVenteData.clientId || !acteVenteData.clientRole) {
        toast.error('Veuillez s√©lectionner un client et son r√¥le');
        return;
      }

      if (!acteVenteData.vendeurNom || !acteVenteData.acheteurNom) {
        toast.error('Veuillez remplir les informations du vendeur et de l\'acheteur');
        return;
      }

      if (!acteVenteData.adresseBien || !acteVenteData.typeBien || !acteVenteData.prixVente) {
        toast.error('Veuillez remplir les champs obligatoires (adresse, type de bien, prix)');
        return;
      }

      // Cr√©er le contrat avec les donn√©es compl√®tes en description
      const descriptionData = `
TYPE DE CONTRAT: Acte de vente immobili√®re

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
INFORMATIONS SUR LE BIEN
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Adresse compl√®te: ${acteVenteData.adresseBien}
- Type de bien: ${acteVenteData.typeBien}
- Nature de propri√©t√©: ${acteVenteData.naturePropriete}
- Destination: ${acteVenteData.destinationBien}

R√âF√âRENCES CADASTRALES:
- Section cadastrale: ${acteVenteData.sectionCadastrale}
- Num√©ro cadastral: ${acteVenteData.numeroCadastral}
- Contenance cadastrale: ${acteVenteData.contenanceCadastrale}

SURFACES:
- Surface habitable: ${acteVenteData.surfaceHabitable} m¬≤
- Surface terrain: ${acteVenteData.surfaceTerrain} m¬≤
- Nombre de pi√®ces: ${acteVenteData.nombrePieces}

${acteVenteData.bienCopropriete === "oui" ? `
COPROPRI√âT√â:
- Bien en copropri√©t√©: Oui
- Num√©ros de lot(s): ${acteVenteData.numerosLots}
- Tanti√®mes / Quote-parts: ${acteVenteData.tanti√®mes}
- R√®glement disponible: ${acteVenteData.reglementCopro}
- Charges annuelles: ${acteVenteData.chargesAnnuelles} ‚Ç¨` : `
COPROPRI√âT√â: Non`}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
√âTAT JURIDIQUE DU BIEN
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Servitudes existantes: ${acteVenteData.servitudesExistantes || 'Aucune'}
- Hypoth√®ques / Inscriptions: ${acteVenteData.hypotheques || 'Aucune'}
- Bien libre ou occup√©: ${acteVenteData.bienLibreOuOccupe}
${acteVenteData.bienLibreOuOccupe === "occupe" ? `- Informations bail: ${acteVenteData.informationsBail}` : ''}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
VENDEUR
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Nom complet: ${acteVenteData.vendeurNom} ${acteVenteData.vendeurPrenom}
- Adresse: ${acteVenteData.vendeurAdresse}
- Date de naissance: ${acteVenteData.vendeurDateNaissance}
- Lieu de naissance: ${acteVenteData.vendeurLieuNaissance}
- Nationalit√©: ${acteVenteData.vendeurNationalite}
- Profession: ${acteVenteData.vendeurProfession}
- Statut matrimonial: ${acteVenteData.vendeurStatutMatrimonial}
${(acteVenteData.vendeurStatutMatrimonial === "marie" || acteVenteData.vendeurStatutMatrimonial === "pacse") ? `- R√©gime matrimonial: ${acteVenteData.vendeurRegimeMatrimonial}` : ''}
- Pi√®ce d'identit√©: ${acteVenteData.vendeurPieceIdentite} n¬∞ ${acteVenteData.vendeurNumeroIdentite}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
ACHETEUR
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Nom complet: ${acteVenteData.acheteurNom} ${acteVenteData.acheteurPrenom}
- Adresse: ${acteVenteData.acheteurAdresse}
- Date de naissance: ${acteVenteData.acheteurDateNaissance}
- Lieu de naissance: ${acteVenteData.acheteurLieuNaissance}
- Nationalit√©: ${acteVenteData.acheteurNationalite}
- Profession: ${acteVenteData.acheteurProfession}
- Statut matrimonial: ${acteVenteData.acheteurStatutMatrimonial}
${(acteVenteData.acheteurStatutMatrimonial === "marie" || acteVenteData.acheteurStatutMatrimonial === "pacse") ? `- R√©gime matrimonial: ${acteVenteData.acheteurRegimeMatrimonial}` : ''}
- Mode d'acquisition: ${acteVenteData.acheteurModeAcquisition}
${acteVenteData.acheteurModeAcquisition === "indivision" ? `- Quote-part: ${acteVenteData.acheteurQuotePart}%` : ''}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CONDITIONS FINANCI√àRES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Prix de vente: ${acteVenteData.prixVente} ‚Ç¨
- Origine des fonds: ${acteVenteData.origineFonds}
- D√©p√¥t de garantie: ${acteVenteData.depotGarantie} ‚Ç¨
- Frais de notaire: ${acteVenteData.fraisNotaire} ‚Ç¨
- R√©partition prorata: ${acteVenteData.repartitionProrata}
- Modalit√©s de paiement: ${acteVenteData.modalitesPaiement}

${acteVenteData.pretImmobilier === "oui" ? `
PR√äT IMMOBILIER:
- Montant du pr√™t: ${acteVenteData.montantPret} ‚Ç¨
- Banque pr√™teuse: ${acteVenteData.banquePreteur}
- Taux r√©el: ${acteVenteData.tauxPret} %
- Dur√©e: ${acteVenteData.dureePret} ann√©es
- Type de pr√™t: ${acteVenteData.typePret}
- Date accord: ${acteVenteData.dateAccordPret}
- Conditions: ${acteVenteData.conditionsPret}` : ''}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
DOCUMENTS & DIAGNOSTICS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${acteVenteData.diagnosticsFournis}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
ORIGINE DE PROPRI√âT√â & D√âCLARATIONS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Date d'acquisition pr√©c√©dente: ${acteVenteData.origineProprieteDateAcquisition}
- R√©f√©rence acte: ${acteVenteData.origineReferenceActe}
- Travaux (10 ans): ${acteVenteData.travauxDerniers10ans || 'Aucun'}
- Conformit√© urbanisme: ${acteVenteData.conformiteUrbanisme}
- Assurance dommage-ouvrage: ${acteVenteData.assuranceDommageOuvrage}
- Taxes fonci√®res N-1: ${acteVenteData.taxesFoncieres} ‚Ç¨
- Sinistre r√©cent: ${acteVenteData.sinistreRecent}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
URBANISME
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Zone PLU/POS: ${acteVenteData.zonePLU}
- Droit de pr√©emption: ${acteVenteData.droitPreemption}
- D√©clarations d'urbanisme: ${acteVenteData.declarationsUrbanisme}
- Documents fournis: ${acteVenteData.documentsUrbanisme}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
D√âLAIS & SIGNATURE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Date de signature: ${acteVenteData.dateSignatureActe}
- Lieu de signature: ${acteVenteData.lieuSignature}
- Remise des cl√©s: ${acteVenteData.remiseCles}
${acteVenteData.procuration === "oui" ? `- Procuration: Oui\n- Mandataire: ${acteVenteData.identiteMandataire}` : '- Procuration: Non'}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
ANNEXES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Titre de propri√©t√©: ${acteVenteData.titrePropriete}
- Diagnostics: ${acteVenteData.diagnostics}
- Plan du bien: ${acteVenteData.planBien}
- R√®glement copropri√©t√©: ${acteVenteData.reglementCopropriete}
- √âtat dat√©: ${acteVenteData.etatDate}
- Attestation assurance: ${acteVenteData.attestationAssurance}
- Relev√© syndic: ${acteVenteData.releveSyndic}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
INFORMATIONS COMPL√âMENTAIRES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Travaux pr√©vus copropri√©t√©: ${acteVenteData.travauxPrevusCopro || 'Aucun'}
- Proc√©dures en cours: ${acteVenteData.proceduresEnCours || 'Aucune'}
- Diff√©rends voisins: ${acteVenteData.differendsVoisins || 'Aucun'}
- Particularit√©s: ${acteVenteData.particularitesBien || 'Aucune'}
      `.trim();

      const { data, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: pendingContractType,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: descriptionData,
        })
        .select()
        .single();

      if (error) throw error;
      
      toast.success('Acte de vente cr√©√© avec succ√®s', { 
        description: 'Toutes les informations ont √©t√© enregistr√©es et pourront √™tre utilis√©es pour g√©n√©rer le document'
      });
      
      setShowQuestionDialog(false);
      
      // R√©initialiser le formulaire acte de vente
      setActeVenteData({
        clientId: "",
        clientRole: "",
        adresseBien: "",
        typeBien: "",
        naturePropriete: "",
        sectionCadastrale: "",
        numeroCadastral: "",
        contenanceCadastrale: "",
        surfaceHabitable: "",
        surfaceTerrain: "",
        nombrePieces: "",
        equipements: [],
        bienCopropriete: "",
        numerosLots: "",
        tanti√®mes: "",
        reglementCopro: "",
        chargesAnnuelles: "",
        servitudesExistantes: "",
        hypotheques: "",
        destinationBien: "",
        bienLibreOuOccupe: "",
        informationsBail: "",
        vendeurNom: "",
        vendeurPrenom: "",
        vendeurAdresse: "",
        vendeurDateNaissance: "",
        vendeurLieuNaissance: "",
        vendeurNationalite: "",
        vendeurProfession: "",
        vendeurStatutMatrimonial: "",
        vendeurRegimeMatrimonial: "",
        vendeurPrecisionRegime: "",
        vendeurPieceIdentite: "",
        vendeurNumeroIdentite: "",
        acheteurNom: "",
        acheteurPrenom: "",
        acheteurAdresse: "",
        acheteurDateNaissance: "",
        acheteurLieuNaissance: "",
        acheteurNationalite: "",
        acheteurProfession: "",
        acheteurStatutMatrimonial: "",
        acheteurRegimeMatrimonial: "",
        acheteurPrecisionRegime: "",
        acheteurModeAcquisition: "",
        acheteurQuotePart: "",
        prixVente: "",
        origineFonds: "",
        depotGarantie: "",
        fraisNotaire: "",
        repartitionProrata: "",
        modalitesPaiement: "",
        pretImmobilier: "",
        montantPret: "",
        banquePreteur: "",
        tauxPret: "",
        dureePret: "",
        typePret: "",
        dateAccordPret: "",
        conditionsPret: "",
        diagnosticsFournis: "",
        origineProprieteDateAcquisition: "",
        origineReferenceActe: "",
        travauxDerniers10ans: "",
        conformiteUrbanisme: "",
        assuranceDommageOuvrage: "",
        taxesFoncieres: "",
        sinistreRecent: "",
        zonePLU: "",
        droitPreemption: "",
        declarationsUrbanisme: "",
        documentsUrbanisme: "",
        dateSignatureActe: "",
        lieuSignature: "",
        remiseCles: "",
        procuration: "",
        identiteMandataire: "",
        titrePropriete: "",
        diagnostics: "",
        planBien: "",
        reglementCopropriete: "",
        etatDate: "",
        attestationAssurance: "",
        releveSyndic: "",
        travauxPrevusCopro: "",
        proceduresEnCours: "",
        differendsVoisins: "",
        particularitesBien: "",
      });
      
      refreshContrats();
    } catch (err: unknown) {
      console.error('Erreur cr√©ation acte de vente:', err);
      const message = err instanceof Error ? err.message : String(err);
      toast.error('Erreur lors de la cr√©ation', { description: message });
    }
  };

  const refreshContrats = () => {
    // Force un rechargement
    if (!user) return;
    supabase
      .from('contrats')
      .select('id,name,category,type,created_at,updated_at')
      .eq('owner_id', user.id)
      .eq('role', role)
      .order('created_at', { ascending: false })
      .then(({ data, error }) => {
        if (error) {
          console.error('Erreur rechargement contrats:', error);
        } else {
          setContrats(data as ContratRow[]);
        }
      });
  };

  // Handler pour la soumission du bail d'habitation
  const handleBailHabitationSubmit = async () => {
    try {
      if (!user) {
        toast.error('Utilisateur non connect√©');
        return;
      }

      if (!bailHabitationData.bailleurClientId) {
        toast.error('Veuillez s√©lectionner un client bailleur');
        return;
      }

      if (!bailHabitationData.locataireNom || !bailHabitationData.adresseLogement || !bailHabitationData.loyerMensuel) {
        toast.error('Veuillez remplir les champs obligatoires (locataire, adresse logement, loyer)');
        return;
      }

      const descriptionData = `
TYPE DE CONTRAT: Bail d'habitation ${bailHabitationData.typeBail === "meuble" ? "meubl√©" : "vide"}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
BAILLEUR
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Nom complet: ${bailHabitationData.bailleurNom} ${bailHabitationData.bailleurPrenom}
- Adresse: ${bailHabitationData.bailleurAdresse}
- Date de naissance: ${bailHabitationData.bailleurDateNaissance}
- Lieu de naissance: ${bailHabitationData.bailleurLieuNaissance}
- Nationalit√©: ${bailHabitationData.bailleurNationalite}
- Profession: ${bailHabitationData.bailleurProfession}
- Statut matrimonial: ${bailHabitationData.bailleurStatutMatrimonial}
- Pi√®ce d'identit√©: ${bailHabitationData.bailleurPieceIdentite} n¬∞ ${bailHabitationData.bailleurNumeroIdentite}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
LOCATAIRE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Nom complet: ${bailHabitationData.locataireNom} ${bailHabitationData.locatairePrenom}
- Adresse: ${bailHabitationData.locataireAdresse}
- Date de naissance: ${bailHabitationData.locataireDateNaissance}
- Lieu de naissance: ${bailHabitationData.locataireLieuNaissance}
- Nationalit√©: ${bailHabitationData.locataireNationalite}
- Profession: ${bailHabitationData.locataireProfession}
- Statut matrimonial: ${bailHabitationData.locataireStatutMatrimonial}
- Pi√®ce d'identit√©: ${bailHabitationData.locatairePieceIdentite} n¬∞ ${bailHabitationData.locataireNumeroIdentite}
- Nombre d'occupants: ${bailHabitationData.nombreOccupants}

${bailHabitationData.aGarant === "oui" ? `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
GARANT
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Nom complet: ${bailHabitationData.garantNom} ${bailHabitationData.garantPrenom}
- Adresse: ${bailHabitationData.garantAdresse}
- Profession: ${bailHabitationData.garantProfession}
- Type de caution: ${bailHabitationData.typeCaution}
` : ''}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
LOGEMENT
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Adresse compl√®te: ${bailHabitationData.adresseLogement}
- Type de logement: ${bailHabitationData.typeLogement}
- Surface habitable: ${bailHabitationData.surfaceHabitable} m¬≤
- Ann√©e construction: ${bailHabitationData.anneeConstruction || 'Non renseign√©e'}
- √âtat d'usage: ${bailHabitationData.etatUsage}
- Copropri√©t√©: ${bailHabitationData.logementCopropriete}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CONDITIONS FINANCI√àRES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Loyer mensuel: ${bailHabitationData.loyerMensuel} ‚Ç¨
- Charges mensuelles: ${bailHabitationData.chargesMensuelles} ‚Ç¨
- Type de charges: ${bailHabitationData.typologieCharges}
- D√©p√¥t de garantie: ${bailHabitationData.depotGarantie} ‚Ç¨
- Premier loyer payable le: ${bailHabitationData.premierLoyerDate}
- Mode de paiement: ${bailHabitationData.modePaiement}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
DATES DU BAIL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Type: ${bailHabitationData.typeBail === "meuble" ? "Location meubl√©e" : "Location vide"}
- Dur√©e: ${bailHabitationData.typeBailDuree}
- Date de d√©but: ${bailHabitationData.dateDebutBail}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
INFORMATIONS COMPL√âMENTAIRES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${bailHabitationData.informationsComplementaires || 'Aucune'}
      `.trim();

      const { data, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: `Bail d'habitation - ${bailHabitationData.locataireNom} ${bailHabitationData.locatairePrenom}`,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: descriptionData,
        })
        .select()
        .single();

      if (error) throw error;
      
      toast.success("Bail d'habitation cr√©√© avec succ√®s");
      setShowQuestionDialog(false);
      
      // R√©initialiser le formulaire
      setBailHabitationData({
        clientRole: "",
        clientId: "",
        bailleurClientId: "",
        bailleurNom: "",
        bailleurPrenom: "",
        bailleurAdresse: "",
        bailleurDateNaissance: "",
        bailleurLieuNaissance: "",
        bailleurNationalite: "",
        bailleurProfession: "",
        bailleurStatutMatrimonial: "",
        bailleurPieceIdentite: "",
        bailleurNumeroIdentite: "",
        locataireClientId: "",
        locataireNom: "",
        locatairePrenom: "",
        locataireAdresse: "",
        locataireDateNaissance: "",
        locataireLieuNaissance: "",
        locataireNationalite: "",
        locataireProfession: "",
        locataireStatutMatrimonial: "",
        locatairePieceIdentite: "",
        locataireNumeroIdentite: "",
        nombreOccupants: "",
        locataireRevenusMensuelsNets: "",
        locataireTypeContrat: "",
        locataireEmployeur: "",
        locataireEmployeurAdresse: "",
        locataireAncienneteEmployeur: "",
        colocation: "",
        solidariteColocataires: "",
        nombreColocataires: "",
        colocatairesNoms: "",
        aGarant: "",
        garantNom: "",
        garantPrenom: "",
        garantAdresse: "",
        garantDateNaissance: "",
        garantLieuNaissance: "",
        garantStatutMatrimonial: "",
        garantProfession: "",
        garantPieceIdentite: "",
        garantNumeroIdentite: "",
        typeCaution: "",
        adresseLogement: "",
        typeLogement: "",
        etageNumeroLot: "",
        surfaceHabitable: "",
        surfaceAnnexes: "",
        anneeConstruction: "",
        etatUsage: "",
        dependances: [],
        placeParking: "",
        numeroPlaceParking: "",
        entretienJardin: "",
        logementCopropriete: "",
        reglementCoproFourni: "",
        typeBail: "",
        contratMeuble: "",
        mobilierListeComplete: [],
        inventaireFourni: "",
        inventaireMobilierTexte: "",
        etatMobilierEntree: "",
        entretienMobilier: "",
        mobilierLiterie: false,
        mobilierOccultation: false,
        mobilierPlaquesCuisson: false,
        mobilierFourMicroondes: false,
        mobilierRefrigo: false,
        mobilierCongelateur: false,
        mobilierVaisselle: false,
        mobilierUstensiles: false,
        mobilierTable: false,
        mobilierSieges: false,
        mobilierEtageres: false,
        mobilierLampes: false,
        mobilierMaterielEntretien: false,
        typeDureeMeuble: "",
        motifBailMobilite: "",
        natureBailleur: "",
        residencePrincipale: "",
        destinationBien: "",
        souslocationAutorisee: "",
        colocationPossible: "",
        animauxAutorises: "",
        precisionAnimaux: "",
        loyerMensuel: "",
        chargesMensuelles: "",
        typeCharges: "",
        typologieCharges: "",
        depotGarantie: "",
        premierLoyerDate: "",
        modePaiement: "",
        ibanBailleur: "",
        periodiciteRegularisationCharges: "",
        revisionLoyerPrevue: "",
        indiceIRL: "",
        trimestreReference: "",
        typeBailDuree: "",
        dateDebutBail: "",
        dureeBail: "",
        diagnosticsFournis: "",
        diagnosticDPE: "",
        diagnosticElectricite: "",
        diagnosticGaz: "",
        diagnosticERP: "",
        diagnosticPlomb: "",
        diagnosticAmiante: "",
        etatLieuxFourni: "",
        inventaireMobilierFourni: "",
        travauxRecents: "",
        travauxDerniers6Mois: "",
        descriptionTravaux: "",
        typeChauffage: "",
        compteursIndividuels: "",
        releveCompteurs: "",
        attestationAssurance: "",
        servitudes: "",
        logementZoneERP: "",
        usageProfessionnel: "",
        informationsComplementaires: "",
        nombreJeuxCles: "",
        typesCles: [],
        codesFournis: "",
      });

      refreshContrats();
    } catch (err) {
      console.error('Erreur cr√©ation bail:', err);
      toast.error('Erreur lors de la cr√©ation du bail');
    }
  };

  const handleBailCommercialSubmit = async () => {
    try {
      if (!user) {
        toast.error('Utilisateur non connect√©');
        return;
      }

      if (!bailCommercialData.typeBail || !bailCommercialData.statutBailleur || !bailCommercialData.adresseLocal || !bailCommercialData.loyerMensuelHT) {
        toast.error('Veuillez remplir les champs obligatoires (type de bail, statut bailleur, adresse local, loyer)');
        return;
      }

      const descriptionData = `
TYPE DE CONTRAT: ${bailCommercialData.typeBail === "commercial" ? "Bail commercial" : "Bail professionnel"}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
BAILLEUR
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Statut: ${bailCommercialData.statutBailleur === "physique" ? "Personne physique" : "Personne morale (soci√©t√©)"}
${bailCommercialData.statutBailleur === "physique" ? `- Nom: ${bailCommercialData.bailleurNom} ${bailCommercialData.bailleurPrenom}` : `- D√©nomination: ${bailCommercialData.bailleurDenomination}
- Forme juridique: ${bailCommercialData.bailleurFormeJuridique}
- SIREN: ${bailCommercialData.bailleurSiren}
- SIRET: ${bailCommercialData.bailleurSiret}`}
- Adresse: ${bailCommercialData.bailleurAdresse}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
LOCAL COMMERCIAL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Adresse: ${bailCommercialData.adresseLocal}
- Nature: ${bailCommercialData.natureLocal}
- Surface totale: ${bailCommercialData.surfaceTotale} m¬≤

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
ACTIVIT√â
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Activit√© principale autoris√©e: ${bailCommercialData.activitePrincipale}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CONDITIONS FINANCI√àRES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Loyer mensuel HT: ${bailCommercialData.loyerMensuelHT} ‚Ç¨
- Charges mensuelles: ${bailCommercialData.chargesMensuelles} ‚Ç¨

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
DUR√âE DU BAIL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Type de bail: ${bailCommercialData.typeBail}
- Date de prise d'effet: ${bailCommercialData.datePriseEffet}
      `.trim();

      const { data, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: `Bail commercial - ${bailCommercialData.adresseLocal}`,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: descriptionData,
        })
        .select()
        .single();

      if (error) throw error;
      
      toast.success("Bail commercial cr√©√© avec succ√®s");
      setShowQuestionDialog(false);
      
      // R√©initialiser le formulaire
      setBailCommercialData({
        clientRole: "",
        clientId: "",
        bailleurClientId: "",
        statutBailleur: "",
        bailleurNom: "",
        bailleurPrenom: "",
        bailleurAdresse: "",
        bailleurDateNaissance: "",
        bailleurLieuNaissance: "",
        bailleurNationalite: "",
        bailleurStatutMatrimonial: "",
        bailleurRegimeMatrimonial: "",
        bailleurProfession: "",
        bailleurDenomination: "",
        bailleurFormeJuridique: "",
        bailleurSiren: "",
        bailleurSiret: "",
        bailleurSiegeSocial: "",
        bailleurCapitalSocial: "",
        bailleurRepresentant: "",
        bailleurRepresentantPrenom: "",
        bailleurRepresentantFonction: "",
        bailleurRepresentantEstLegal: "",
        bailleurMandataireNom: "",
        bailleurMandatairePrenom: "",
        bailleurMandataireTypePouvoir: "",
        locataireClientId: "",
        statutLocataire: "",
        locataireNom: "",
        locatairePrenom: "",
        locataireAdresse: "",
        locataireDateNaissance: "",
        locataireLieuNaissance: "",
        locataireNationalite: "",
        locataireStatutMatrimonial: "",
        locataireRegimeMatrimonial: "",
        locataireProfession: "",
        locataireTelephone: "",
        locataireEmail: "",
        locataireExerceEnNomPropre: "",
        locataireActivite: "",
        locataireSirenPersonnel: "",
        locataireEntrepriseEnCreation: "",
        locataireImmatriculation: "",
        locataireDenomination: "",
        locataireFormeJuridique: "",
        locataireSiege: "",
        locataireSiren: "",
        locataireSiret: "",
        locataireObjetSocial: "",
        locataireCapital: "",
        locataireRepresentant: "",
        locataireRepresentantPrenom: "",
        locataireRepresentantFonction: "",
        locataireMandataireNom: "",
        locataireMandatairePrenom: "",
        locataireMandataireTypePouvoir: "",
        activitePrincipale: "",
        activitesAnnexes: "",
        destinationBail: "",
        clauseExclusivite: "",
        clauseNonConcurrence: "",
        adresseLocal: "",
        natureLocal: "",
        surfaceTotale: "",
        lotsCopropriete: "",
        etageNumero: "",
        partiesPrivatives: [],
        longueurVitrine: "",
        accesLivraison: "",
        etatGeneral: "",
        travauxBailleur: "",
        travauxLocataire: "",
        etatLocalRemise: "",
        diagnosticAmiante: "",
        typeBail: "",
        datePriseEffet: "",
        dureeTotale: "",
        renouvellementAuto: "",
        loyerAnnuelHT: "",
        loyerMensuelHT: "",
        modalitePaiement: "",
        typeIndexation: "",
        chargesMensuelles: "",
        typeCharges: "",
        depotGarantie: "",
        modePaiementLoyer: "",
        ibanBailleur: "",
        chargesLocataire: [],
        chargesBailleur: [],
        compteursIndividuels: "",
        cautionPersonnelle: "",
        garantieBancaire: "",
        montantGaranti: "",
        dureeGarantie: "",
        diagnosticDPE: "",
        diagnosticAmianteDTA: "",
        diagnosticERP: "",
        diagnosticElectricite: "",
        diagnosticGaz: "",
        diagnosticTermites: "",
        attestationConformiteERP: "",
        cedabilite: "",
        conditionsCession: "",
        droitPreemptionCommune: "",
        derogationUsageLocal: "",
        clauseRecettes: "",
        clauseNonAffectation: "",
        clauseNonConcurrenceDetails: "",
        presenceCompteurs: "",
        releveCompteurs: "",
      });

      refreshContrats();
    } catch (err) {
      console.error('Erreur cr√©ation bail commercial:', err);
      toast.error('Erreur lors de la cr√©ation du bail commercial');
    }
  };

  const handleIndivisionSubmit = async () => {
    try {
      if (!user) {
        toast.error('Utilisateur non connect√©');
        return;
      }

      if (!indivisionData.typeBien || !indivisionData.origineIndivision) {
        toast.error('Veuillez remplir les champs obligatoires (type de bien, origine)');
        return;
      }

      const descriptionData = `
TYPE DE CONTRAT: Convention d'indivision

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
INFORMATIONS G√âN√âRALES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Type de bien: ${indivisionData.typeBien}
${indivisionData.typeBien === "autre" ? `- Pr√©cision: ${indivisionData.typeBienAutre}` : ""}
- Origine de l'indivision: ${indivisionData.origineIndivision}
${indivisionData.origineIndivision === "autre" ? `- Pr√©cision: ${indivisionData.origineIndivisionAutre}` : ""}
- Objet: ${indivisionData.objetConvention}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
INDIVISAIRES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Nombre d'indivisaires: ${indivisionData.indivisaires.length}
${indivisionData.indivisaires.map((ind, idx) => `
Indivisaire ${idx + 1}:
- Nom: ${ind.nom} ${ind.prenom}
- Quote-part: ${ind.quotePart}%
`).join('')}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
BIEN EN INDIVISION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${indivisionData.typeBien === "immobilier" ? `- Adresse: ${indivisionData.adresseBien}
- Nature: ${indivisionData.natureBienImmobilier}
- Description: ${indivisionData.descriptionBien}
- Surface: ${indivisionData.surfaceBien} m¬≤
- R√©f√©rences cadastrales: ${indivisionData.referencesCadastrales}
- √âtat locatif: ${indivisionData.etatLocatif}
- Valeur v√©nale: ${indivisionData.valeurVenale} ‚Ç¨` : 
indivisionData.typeBien === "mobilier" ? `- Description: ${indivisionData.descriptionBienMobilier}
- Valeur estim√©e: ${indivisionData.valeurEstimee} ‚Ç¨` : ""}
      `.trim();

      const { data, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: `Convention d'indivision - ${indivisionData.adresseBien || indivisionData.descriptionBienMobilier || 'Bien indivis'}`,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: descriptionData,
        })
        .select()
        .single();

      if (error) throw error;
      
      toast.success("Convention d'indivision cr√©√©e avec succ√®s");
      setShowQuestionDialog(false);
      
      // R√©initialiser le formulaire
      setIndivisionData({
        typeBien: "",
        typeBienAutre: "",
        origineIndivision: "",
        origineIndivisionAutre: "",
        objetConvention: "",
        indivisaires: [{
          id: 1,
          isClient: false,
          clientId: "",
          nom: "",
          prenom: "",
          adresse: "",
          dateNaissance: "",
          lieuNaissance: "",
          nationalite: "",
          profession: "",
          statutMatrimonial: "",
          regimeMatrimonial: "",
          typeIdentite: "",
          numeroIdentite: "",
          email: "",
          telephone: "",
          quotePart: "",
          origineQuotePart: "",
        }],
        adresseBien: "",
        natureBienImmobilier: "",
        descriptionBien: "",
        surfaceBien: "",
        referencesCadastrales: "",
        etatLocatif: "",
        montantLoyer: "",
        dureeBail: "",
        valeurVenale: "",
        dateEstimation: "",
        sourceEstimation: "",
        descriptionBienMobilier: "",
        valeurEstimee: "",
        numerosSerie: "",
        dureeType: "",
        dureeAnnees: "",
        conditionsRenouvellement: "",
        conditionsSortie: "",
        gerantNom: "",
        gerantPrenom: "",
        gerantEstIndivisaire: "",
        pouvoirsGerant: [],
        pouvoirsAutres: "",
        dureeMandat: "",
        decisionsType: "",
        casUnanimite: "",
        chargesRepartition: "",
        chargesRepartitionAutre: "",
        modalitesRemboursement: "",
        compteBancaire: "",
        compteTitulaires: "",
        compteModalites: "",
        utilisationParIndivisaires: "",
        utilisationConditions: "",
        indemnit√©Occupation: "",
        indemniteOccupationMontant: "",
        indemniteOccupationFrequence: "",
        locationAutorisee: "",
        locationMandataire: "",
        locationRepartitionLoyers: "",
        travauxAutorises: "",
        travauxDecision: "",
        travauxRepartitionCouts: "",
        travauxUrgents: "",
        travauxDocumentation: "",
        ventePartLibre: "",
        droitPreemption: "",
        evaluationPart: "",
        delaiRachat: "",
        modalitesPaiement: "",
        conditionsMiseEnVente: "",
        decisionVente: "",
        mandataireVente: "",
        repartitionPrix: "",
        gestionPlusValues: "",
        registreDepenses: "",
        archivageFactures: "",
        modalitesRemboursementAvances: "",
        rapportAnnuel: "",
        resolutionLitiges: [],
        solidariteDettes: "",
      });

      refreshContrats();
    } catch (err) {
      console.error('Erreur cr√©ation convention d\'indivision:', err);
      toast.error('Erreur lors de la cr√©ation de la convention');
    }
  };

  const handleMainleveeSubmit = async () => {
    try {
      if (!user) {
        toast.error('Utilisateur non connect√©');
        return;
      }

      if (!mainleveeData.informationsGenerales.typeMainlevee || !mainleveeData.informationsGenerales.natureInscription) {
        toast.error('Veuillez remplir les champs obligatoires (type de mainlev√©e, nature de l\'inscription)');
        return;
      }

      const descriptionData = `
TYPE DE CONTRAT: Mainlev√©e d'hypoth√®que

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
INFORMATIONS G√âN√âRALES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Type de mainlev√©e: ${mainleveeData.informationsGenerales.typeMainlevee}
${mainleveeData.informationsGenerales.typeMainlevee === "partielle" ? `- Pr√©cision: ${mainleveeData.informationsGenerales.precisionPartielle}` : ""}
- Nature de l'inscription: ${mainleveeData.informationsGenerales.natureInscription}
- Num√©ro d'inscription: ${mainleveeData.informationsGenerales.numeroInscription}
- Date d'inscription: ${mainleveeData.informationsGenerales.dateInscription}
- Volume: ${mainleveeData.informationsGenerales.volume}
- Num√©ro de publication: ${mainleveeData.informationsGenerales.numeroPublication}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CR√âANCIER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Type: ${mainleveeData.creancier.typeCreancier}
${mainleveeData.creancier.typeCreancier === "banque" ? `
- D√©nomination: ${mainleveeData.creancierBanque.denomination}
- SIREN: ${mainleveeData.creancierBanque.siren}
- Si√®ge social: ${mainleveeData.creancierBanque.siegeSocial}
- Repr√©sentant: ${mainleveeData.creancierBanque.representantNom} ${mainleveeData.creancierBanque.representantPrenom}
- Fonction: ${mainleveeData.creancierBanque.representantFonction}
` : `
- Nom: ${mainleveeData.creancierPersonne.nom} ${mainleveeData.creancierPersonne.prenom}
- Date de naissance: ${mainleveeData.creancierPersonne.dateNaissance}
- Lieu de naissance: ${mainleveeData.creancierPersonne.lieuNaissance}
- Adresse: ${mainleveeData.creancierPersonne.adresse}
- Nationalit√©: ${mainleveeData.creancierPersonne.nationalite}
- Situation familiale: ${mainleveeData.creancierPersonne.situationFamiliale}
${mainleveeData.creancierPersonne.regimeMatrimonial ? `- R√©gime matrimonial: ${mainleveeData.creancierPersonne.regimeMatrimonial}` : ""}
`}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
D√âBITEURS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Nombre de d√©biteurs: ${mainleveeData.debiteurs.length}
${mainleveeData.debiteurs.map((deb, idx) => `
D√©biteur ${idx + 1}:
- Nom: ${deb.nom} ${deb.prenom}
- Date de naissance: ${deb.dateNaissance}
- Lieu de naissance: ${deb.lieuNaissance}
- Adresse: ${deb.adresse}
- Situation familiale: ${deb.situationFamiliale}
${deb.regimeMatrimonial ? `- R√©gime matrimonial: ${deb.regimeMatrimonial}` : ""}
- Qualit√©: ${deb.qualite}
`).join('')}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
ACTE CONSTITUTIF
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Date de signature: ${mainleveeData.acteOrigine.dateSignature}
- Nature de l'acte: ${mainleveeData.acteOrigine.natureActe}
- Notaire/Auteur: ${mainleveeData.acteOrigine.notaireAuteur}
- Date de publication: ${mainleveeData.acteOrigine.datePublication}
- Num√©ro de publication: ${mainleveeData.acteOrigine.numeroPublication}

CONDITIONS DU PR√äT:
- Montant initial: ${mainleveeData.conditionsPret.montantInitial} ‚Ç¨
- Taux d'int√©r√™t: ${mainleveeData.conditionsPret.tauxInteret}
- Dur√©e: ${mainleveeData.conditionsPret.dureePret}
- Num√©ro de contrat: ${mainleveeData.conditionsPret.numeroContrat}
- √âtablissement pr√™teur: ${mainleveeData.conditionsPret.etablissementPreteur}
- Num√©ro de dossier: ${mainleveeData.conditionsPret.numeroDossier}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
BIENS HYPOTH√âQU√âS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Nombre de biens: ${mainleveeData.biens.length}
${mainleveeData.biens.map((bien, idx) => `
Bien ${idx + 1}:
- Adresse: ${bien.adresse}
- Type: ${bien.typeBien}
- Description: ${bien.descriptionBien}
- Mode de d√©tention: ${bien.modeDetention === "propriete_exclusive" ? "Propri√©t√© exclusive" : bien.modeDetention === "indivision" ? `Indivision (${bien.quotepartsIndivision})` : bien.modeDetention === "communaute_acquets" ? "Communaut√© r√©duite aux acqu√™ts" : bien.modeDetention === "separation_biens" ? "S√©paration de biens" : bien.modeDetention === "autre" ? `Autre: ${bien.autreRegime}` : "Non pr√©cis√©"}
- Cadastre: Section ${bien.cadastreSection}, Parcelle ${bien.cadastreParcelle}
- Contenance: ${bien.cadastreContenance}
${bien.estCopropriete === "oui" ? `- Copropri√©t√©: Lot n¬∞${bien.numeroLot}, Quote-part: ${bien.quotePart}` : ""}
`).join('')}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
D√âCLARATION DU CR√âANCIER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Cr√©ance int√©gralement pay√©e: ${mainleveeData.declaration.creancePayee ? "Oui" : "Non"}
- Aucune dette subsistante: ${mainleveeData.declaration.aucuneDette ? "Oui" : "Non"}
- Consent √† la mainlev√©e: ${mainleveeData.declaration.consentMainlevee ? "Oui" : "Non"}
- Renonce √† l'inscription: ${mainleveeData.declaration.renonciation ? "Oui" : "Non"}
- Demande la radiation au SPF: ${mainleveeData.declaration.demandeRadiation ? "Oui" : "Non"}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
MANDAT/PROCURATION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${mainleveeData.mandataire.existe === "oui" ? `
- Mandataire: ${mainleveeData.mandataire.nom} ${mainleveeData.mandataire.prenom}
- Fonction: ${mainleveeData.mandataire.fonction}
- Pouvoirs: ${mainleveeData.mandataire.pouvoirSigner ? "Signer la mainlev√©e" : ""}${mainleveeData.mandataire.pouvoirDeposer ? ", D√©poser au SPF" : ""}
` : "Aucun mandataire"}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CONSENTEMENT D√âBITEUR
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${mainleveeData.consentementDebiteur.requis === "oui" ? `
- Accord pour la radiation: ${mainleveeData.consentementDebiteur.accordRadiation ? "Oui" : "Non"}
- D√©clarations compl√©mentaires: ${mainleveeData.consentementDebiteur.declarationsComplementaires}
` : "Non requis"}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
FRAIS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Frais de radiation: ${mainleveeData.frais.fraisRadiation} ‚Ç¨
- Honoraires: ${mainleveeData.frais.honoraires} ‚Ç¨
- Timbres fiscaux: ${mainleveeData.frais.timbresFiscaux} ‚Ç¨
      `.trim();

      const { data, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: `Mainlev√©e d'hypoth√®que - ${mainleveeData.debiteurs[0]?.nom || 'D√©biteur'} - ${mainleveeData.biens[0]?.adresse || 'Bien'}`,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: descriptionData,
        })
        .select()
        .single();

      if (error) throw error;
      
      toast.success("Mainlev√©e d'hypoth√®que cr√©√©e avec succ√®s");
      setShowQuestionDialog(false);
      
      // R√©initialiser le formulaire
      setMainleveeData({
        informationsGenerales: {
          typeMainlevee: "",
          precisionPartielle: "",
          natureInscription: "",
          numeroInscription: "",
          dateInscription: "",
          volume: "",
          numeroPublication: "",
        },
        creancier: {
          typeCreancier: "",
        },
        creancierBanque: {
          denomination: "",
          siren: "",
          siegeSocial: "",
          representantNom: "",
          representantPrenom: "",
          representantFonction: "",
        },
        creancierPersonne: {
          isClient: false,
          clientId: "",
          nom: "",
          prenom: "",
          dateNaissance: "",
          lieuNaissance: "",
          adresse: "",
          nationalite: "",
          situationFamiliale: "",
          regimeMatrimonial: "",
          typeIdentite: "",
          numeroIdentite: "",
        },
        debiteurs: [{
          id: 1,
          isClient: false,
          clientId: "",
          nom: "",
          prenom: "",
          dateNaissance: "",
          lieuNaissance: "",
          adresse: "",
          nationalite: "",
          situationFamiliale: "",
          regimeMatrimonial: "",
          qualite: "",
          typeIdentite: "",
          numeroIdentite: "",
        }],
        acteOrigine: {
          dateSignature: "",
          natureActe: "",
          notaireAuteur: "",
          datePublication: "",
          numeroPublication: "",
        },
        conditionsPret: {
          montantInitial: "",
          tauxInteret: "",
          dureePret: "",
          numeroContrat: "",
          etablissementPreteur: "",
          numeroDossier: "",
        },
        biens: [{
          id: 1,
          adresse: "",
          descriptionBien: "",
          typeBien: "",
          modeDetention: "",
          quotepartsIndivision: "",
          autreRegime: "",
          cadastreSection: "",
          cadastreParcelle: "",
          cadastreContenance: "",
          estCopropriete: "non",
          numeroLot: "",
          quotePart: "",
        }],
        declaration: {
          creancePayee: false,
          aucuneDette: false,
          consentMainlevee: false,
          renonciation: false,
          demandeRadiation: false,
        },
        mandataire: {
          existe: "non",
          nom: "",
          prenom: "",
          fonction: "",
          pouvoirSigner: false,
          pouvoirDeposer: false,
        },
        consentementDebiteur: {
          requis: "non",
          accordRadiation: false,
          declarationsComplementaires: "",
        },
        frais: {
          fraisRadiation: "",
          honoraires: "",
          timbresFiscaux: "",
        },
      });

      refreshContrats();
    } catch (err) {
      console.error('Erreur cr√©ation mainlev√©e d\'hypoth√®que:', err);
      toast.error('Erreur lors de la cr√©ation de la mainlev√©e');
    }
  };

  const handleContratMariageSubmit = async () => {
    try {
      if (!user) {
        toast.error('Utilisateur non connect√©');
        return;
      }

      if (!contratMariageData.typeRegime) {
        toast.error('Veuillez s√©lectionner un type de r√©gime matrimonial');
        return;
      }

      if (!contratMariageData.dateMariagePrevue) {
        toast.error('Veuillez renseigner la date pr√©vue du mariage');
        return;
      }

      if (!contratMariageData.lieuMariage.mairie || !contratMariageData.lieuMariage.commune) {
        toast.error('Veuillez renseigner le lieu du mariage (mairie et commune obligatoires)');
        return;
      }

      const regimeLabels: Record<string, string> = {
        separation_biens: "S√©paration de biens",
        communaute_acquets: "Communaut√© r√©duite aux acqu√™ts",
        communaute_acquets_amenagee: "Communaut√© r√©duite aux acqu√™ts am√©nag√©e",
        communaute_universelle: "Communaut√© universelle",
        participation_acquets: "Participation aux acqu√™ts",
        autre: contratMariageData.autreRegimePrecision
      };

      const descriptionData = `
TYPE DE CONTRAT: Contrat de mariage pr√©nuptial (r√©gimes matrimoniaux)

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
INFORMATIONS G√âN√âRALES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- R√©gime matrimonial choisi: ${regimeLabels[contratMariageData.typeRegime] || contratMariageData.typeRegime}

DATE ET LIEU DU MARIAGE:
- Date pr√©vue: ${contratMariageData.dateMariagePrevue || "Non renseign√©e"}
- Mairie: ${contratMariageData.lieuMariage.mairie || "Non renseign√©e"}
- Commune: ${contratMariageData.lieuMariage.commune || "Non renseign√©e"}
- D√©partement: ${contratMariageData.lieuMariage.departement || "Non renseign√©"}
- Pays: ${contratMariageData.lieuMariage.pays || "France"}

LOI APPLICABLE:
- ${contratMariageData.choixLoiApplicable === "autre" ? contratMariageData.choixLoiApplicableAutre : contratMariageData.choixLoiApplicable}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
√âPOUX
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${contratMariageData.epoux.map((epoux, idx) => `
√âpoux ${idx + 1}:
- Nom: ${epoux.nom} ${epoux.prenom}
- Date de naissance: ${epoux.dateNaissance}
- Lieu de naissance: ${epoux.lieuNaissance}
- Nationalit√©: ${epoux.nationalite}
- Profession: ${epoux.profession}
- Situation familiale: ${epoux.situationFamiliale}
- Domicile actuel: ${epoux.domicileActuel}
${epoux.domicileApresMariage ? `- Domicile apr√®s mariage: ${epoux.domicileApresMariage}` : ""}
${epoux.mariageAnterieurtHorsFrance === "oui" ? `
MARIAGE ANT√âRIEUR HORS FRANCE:
- Date: ${epoux.datePremierMariage}
- Lieu: ${epoux.lieuPremierMariage}
- R√©gime initial: ${epoux.regimeMatrimonialInitial}
` : ""}
`).join('')}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
ENFANTS (si changement de r√©gime)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${contratMariageData.nombreEnfants ? `
- Nombre d'enfants: ${contratMariageData.nombreEnfants}
- Enfants mineurs: ${contratMariageData.enfantsMineurs}
- Information au juge: ${contratMariageData.informationJugeNecessaire}
` : "Non applicable"}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CLAUSES SP√âCIFIQUES DU R√âGIME
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
R√©gime: ${regimeLabels[contratMariageData.typeRegime] || contratMariageData.typeRegime}

${contratMariageData.typeRegime === "separation_biens" ? `
S√âPARATION DE BIENS:
- Administration exclusive: ${contratMariageData.clausesSeparation.administrationExclusive ? "Oui" : "Non"}
- Comptes s√©par√©s: ${contratMariageData.clausesSeparation.comptesSepares ? "Oui" : "Non"}
- Contribution aux charges: ${contratMariageData.clausesSeparation.contributionCharges}
` : ""}

${contratMariageData.typeRegime === "communaute_universelle" ? `
COMMUNAUT√â UNIVERSELLE:
- Attribution int√©grale au survivant: ${contratMariageData.clausesCommunauteUniverselle.attributionIntegraleSurvivant}
- Clause de pr√©ciput: ${contratMariageData.clausesCommunauteUniverselle.clausesPreciput}
- Exclusions de biens: ${contratMariageData.clausesCommunauteUniverselle.exclusionCertainsBiens}
` : ""}

${contratMariageData.typeRegime === "participation_acquets" ? `
PARTICIPATION AUX ACQU√äTS:
- Patrimoine originel d√©fini: ${contratMariageData.clausesParticipation.definitionPatrimoinesOriginels}
- Calcul cr√©ance: ${contratMariageData.clausesParticipation.calculCreanceParticipation}
` : ""}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
D√âCLARATIONS DES √âPOUX
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Identit√©: ${contratMariageData.declarations.identite ? "‚úì" : "‚úó"}
- Capacit√© juridique: ${contratMariageData.declarations.capaciteJuridique ? "‚úì" : "‚úó"}
- Choix libre et √©clair√©: ${contratMariageData.declarations.choixLibreEclaire ? "‚úì" : "‚úó"}
- Connaissance des effets juridiques: ${contratMariageData.declarations.connaissanceEffetsJuridiques ? "‚úì" : "‚úó"}
      `.trim();

      const { data, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: `Contrat de mariage - ${contratMariageData.epoux[0]?.nom || '√âpoux 1'} & ${contratMariageData.epoux[1]?.nom || '√âpoux 2'}`,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: descriptionData,
        })
        .select()
        .single();

      if (error) throw error;
      
      toast.success("Contrat de mariage cr√©√© avec succ√®s");
      setShowQuestionDialog(false);
      
      // R√©initialiser le formulaire (structure minimale pour ne pas alourdir)
      setContratMariageData({
        typeRegime: "",
        autreRegimePrecision: "",
        typeContrat: "prenuptial",
        dateMariagePrevue: "",
        lieuMariage: {
          mairie: "",
          commune: "",
          departement: "",
          pays: "France",
        },
        dateMariage: "",
        regimeActuel: "",
        regimeActuelAutre: "",
        motifChangement: "",
        accordEnfantsMajeurs: "",
        accordCreancier: "",
        consentementEnfantsMajeursRequis: "non",
        liquidationRegimeActuel: "non",
        biensCommuns: [{
          id: 1,
          description: "",
          valeurEstimee: "",
          dettesAttachees: "",
          affectationPrevue: "",
          repartitionEnvisagee: "",
        }],
        passifCommun: [{
          id: 1,
          description: "",
          montant: "",
          modeRepartition: "",
        }],
        soulte: {
          soulteDue: "non",
          montantSoulte: "",
          epouxDebiteur: "",
          modalitesPaiement: "",
          dateLimitePaiement: "",
        },
        actifsFinanciers: [{
          id: 1,
          natureCompte: "",
          etablissement: "",
          solde: "",
          modePartage: "",
          partagePersonnalise: "",
        }],
        observationsLiquidation: "",
        choixLoiApplicable: "loi_francaise",
        choixLoiApplicableAutre: "",
        accordJugeRequis: "non",
        epoux: [
          {
            id: 1,
            isClient: false,
            clientId: "",
            nom: "",
            prenom: "",
            adresse: "",
            dateNaissance: "",
            lieuNaissance: "",
            nationalite: "",
            profession: "",
            situationFamiliale: "",
            typeIdentite: "",
            numeroIdentite: "",
            dateEmissionIdentite: "",
            lieuEmissionIdentite: "",
            domicileActuel: "",
            domicileApresMariage: "",
            mariageAnterieurtHorsFrance: "non",
            datePremierMariage: "",
            lieuPremierMariage: "",
            regimeMatrimonialInitial: "",
            acteEtatCivilEtranger: "",
          },
          {
            id: 2,
            isClient: false,
            clientId: "",
            nom: "",
            prenom: "",
            adresse: "",
            dateNaissance: "",
            lieuNaissance: "",
            nationalite: "",
            profession: "",
            situationFamiliale: "",
            typeIdentite: "",
            numeroIdentite: "",
            dateEmissionIdentite: "",
            lieuEmissionIdentite: "",
            domicileActuel: "",
            domicileApresMariage: "",
            mariageAnterieurtHorsFrance: "non",
            datePremierMariage: "",
            lieuPremierMariage: "",
            regimeMatrimonialInitial: "",
            acteEtatCivilEtranger: "",
          },
        ],
        nombreEnfants: "",
        enfantsMajeurs: [{
          id: 1,
          nom: "",
          prenom: "",
          adresse: "",
          accordInformation: "",
        }],
        enfantsMineurs: "",
        informationJugeNecessaire: "",
        patrimoineEpoux1: {
          biensPropres: "",
          biensAcquisPendantMariage: "",
          valeurEstimee: "",
          dettesPersonnelles: "",
          dettesCommunes: "",
          masseDepart: "",
          masseFin: "",
        },
        patrimoineEpoux2: {
          biensPropres: "",
          biensAcquisPendantMariage: "",
          valeurEstimee: "",
          dettesPersonnelles: "",
          dettesCommunes: "",
          masseDepart: "",
          masseFin: "",
        },
        clausesSeparation: {
          administrationExclusive: false,
          comptesSepares: false,
          contributionCharges: "",
          contributionChargesAutre: "",
          miseEnCommunBien: "",
          abandonCreance: "",
        },
        clausesCommunauteAmenagee: {
          definitionBiensCommunsPropres: "",
          amenagementBiensProfessionnels: "",
          contributionCharges: "",
          repartitionDettes: "",
          typeAdministration: "",
          pouvoirUniqueDetails: "",
        },
        clausesCommunauteUniverselle: {
          tousLiensCommunsPresentsEtFuturs: true,
          attributionIntegraleSurvivant: "",
          clausesPreciput: "",
          exclusionCertainsBiens: "",
        },
        clausesParticipation: {
          definitionPatrimoinesOriginels: "",
          definitionPatrimoineFinal: "",
          calculCreanceParticipation: "",
          renonciationCreance: "",
          biensPropresParNature: "",
        },
        clausesAvancees: {
          clauseRemploi: "",
          clausePreciput: "",
          attributionPreferentielle: "",
          gestionSepareeBiensProfessionnels: "",
          protectionConjointSurvivant: "",
          donationEntreEpoux: "",
          solidariteDetteSpecifiques: "",
        },
        declarations: {
          identite: true,
          capaciteJuridique: true,
          situationMatrimoniale: true,
          absenceOpposition: true,
          choixLibreEclaire: true,
          connaissanceEffetsJuridiques: true,
        },
      });

      // Reset file uploads
      setContratMariageEpoux1IdentiteFiles([]);
      setContratMariageEpoux2IdentiteFiles([]);
      setContratMariageEpoux1ActeNaissanceFiles([]);
      setContratMariageEpoux2ActeNaissanceFiles([]);
      setContratMariageEpoux1DomicileFiles([]);
      setContratMariageEpoux2DomicileFiles([]);
      setContratMariageContratInitialFiles([]);
      setContratMariageJustificatifMariageFiles([]);
      setContratMariageAccordEnfantsFiles([]);
      setContratMariageTitresProprieteFiles([]);
      setContratMariageEstimationBiensFiles([]);
      setContratMariageActeDecesFiles([]);
      setContratMariageConsentementEnfantsFiles([]);
      setContratMariageCertificatBansFiles([]);
      setContratMariageDecisionJugeFiles([]);

      refreshContrats();
    } catch (err) {
      console.error('Erreur cr√©ation contrat de mariage:', err);
      toast.error('Erreur lors de la cr√©ation du contrat de mariage');
    }
  };

  const handlePacsSubmit = async () => {
    try {
      if (!user) {
        toast.error('Utilisateur non connect√©');
        return;
      }

      // Validations obligatoires
      if (!pacsData.regimePacs) {
        toast.error('Veuillez s√©lectionner un r√©gime de PACS');
        return;
      }

      if (!pacsData.adresseCommune) {
        toast.error('Veuillez renseigner l\'adresse commune (obligatoire pour l\'enregistrement)');
        return;
      }

      if (!pacsData.declarations.residenceCommune || !pacsData.declarations.absenceLienParente || !pacsData.declarations.absenceMariageEtPacs) {
        toast.error('Veuillez valider toutes les d√©clarations sur l\'honneur obligatoires');
        return;
      }

      const regimeLabels: Record<string, string> = {
        separation: "S√©paration de biens (r√©gime l√©gal par d√©faut)",
        indivision: "Indivision",
        personnalise: "R√©gime personnalis√©"
      };

      const objetLabels: Record<string, string> = {
        initial: "PACS initial",
        modification: "Modification de PACS existant",
        dissolution: "Dissolution de PACS"
      };

      const descriptionData = `
TYPE DE CONTRAT: PACS (Pacte Civil de Solidarit√©)

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
INFORMATIONS G√âN√âRALES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Objet du PACS: ${objetLabels[pacsData.objetPacs] || pacsData.objetPacs}
- R√©gime choisi: ${regimeLabels[pacsData.regimePacs] || pacsData.regimePacs}
${pacsData.regimePacs === "personnalise" ? `
  ‚Ä¢ D√©finition biens communs: ${pacsData.regimePersonnalise.definitionBiensCommuns || "Non renseign√©"}
  ‚Ä¢ Biens propres: ${pacsData.regimePersonnalise.biensPropres || "Non renseign√©"}
  ‚Ä¢ Clauses sp√©cifiques: ${pacsData.regimePersonnalise.clausesSpecifiques || "Non renseign√©"}
` : ""}
- Date de prise d'effet souhait√©e: ${pacsData.datePriseEffetSouhaitee || "√Ä l'enregistrement"}

${pacsData.objetPacs === "modification" ? `
R√âF√âRENCE DU PACS INITIAL:
- Date: ${pacsData.pacsInitialDate || "Non renseign√©e"}
- Mairie/Notaire: ${pacsData.pacsInitialMairie || "Non renseign√©"}
- Num√©ro d'enregistrement: ${pacsData.pacsInitialNumero || "Non renseign√©"}
- Clauses modifi√©es: ${pacsData.clausesModifiees || "Non renseign√©"}
` : ""}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
PARTENAIRES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${pacsData.partenaires.map((p, idx) => `
Partenaire ${idx + 1}:
- Nom: ${p.nom} ${p.prenom}
- Nom de naissance: ${p.nomNaissance || p.nom}
- Date de naissance: ${p.dateNaissance || "Non renseign√©e"}
- Lieu de naissance: ${p.lieuNaissance || "Non renseign√©"}
- Nationalit√©: ${p.nationalite || "Non renseign√©e"}
- Profession: ${p.profession || "Non renseign√©e"}
- Adresse actuelle: ${p.adresseActuelle || "Non renseign√©e"}
- T√©l√©phone: ${p.telephone || "Non renseign√©"}
- Email: ${p.email || "Non renseign√©"}
- Situation familiale: ${p.situationFamiliale || "Non renseign√©e"}
- Pi√®ce d'identit√©: ${p.typeIdentite || "Non renseign√©"} n¬∞${p.numeroIdentite || "Non renseign√©"}
  D√©livr√©e le ${p.dateEmissionIdentite || "Non renseign√©"} par ${p.autoriteDelivrante || "Non renseign√©"}
${p.estEtranger ? `
  ‚ö†Ô∏è PARTENAIRE √âTRANGER:
  - Attestation non-PACS pays d'origine: ${p.attestationNonPacsPaysOrigine ? "Oui" : "Non"}
  - Certificat de coutume requis: ${p.certificatCoutumeRequis ? "Oui" : "Non"}
  - Traduction requise: ${p.traductionRequise ? "Oui" : "Non"}
` : ""}
`).join('\n')}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
ADRESSE COMMUNE (OBLIGATOIRE)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Adresse commune d√©clar√©e: ${pacsData.adresseCommune}
- Date de d√©but de r√©sidence commune: ${pacsData.dateDebutResidenceCommune || "Non renseign√©e"}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CLAUSES DU PACS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
A. CLAUSES OBLIGATOIRES
- Contribution aux charges du m√©nage: ${pacsData.contributionCharges === "proportionnelle" ? "Proportionnelle aux revenus" : pacsData.contributionCharges === "50_50" ? "50/50" : pacsData.contributionChargesAutre || "Non renseign√©"}

B. CLAUSES FACULTATIVES
${pacsData.clausesFacultatives.gestionBiensPersonnels ? `- Gestion des biens personnels: ${pacsData.clausesFacultatives.gestionBiensPersonnels}` : ""}
${pacsData.clausesFacultatives.gestionBienCommun ? `- Gestion d'un bien commun: ${pacsData.clausesFacultatives.gestionBienCommun}` : ""}
${pacsData.clausesFacultatives.usageBienIndivis ? `- Usage d'un bien indivis: ${pacsData.clausesFacultatives.usageBienIndivis}` : ""}
${pacsData.clausesFacultatives.repartitionDepensesSpecifiques ? `- R√©partition d√©penses sp√©cifiques: ${pacsData.clausesFacultatives.repartitionDepensesSpecifiques}` : ""}
${pacsData.clausesFacultatives.clauseOccupationLogementSeparation ? `- Clause occupation logement en cas de s√©paration: ${pacsData.clausesFacultatives.clauseOccupationLogementSeparation}` : ""}
${pacsData.clausesFacultatives.clauseRepriseBienDeces ? `- Clause reprise bien en cas de d√©c√®s: ${pacsData.clausesFacultatives.clauseRepriseBienDeces}` : ""}
${pacsData.clausesFacultatives.clauseAbandonCreance ? `- Clause abandon de cr√©ance: ${pacsData.clausesFacultatives.clauseAbandonCreance}` : ""}
${pacsData.clausesFacultatives.modalitesCompteBancaireCommun ? `- Modalit√©s compte bancaire commun: ${pacsData.clausesFacultatives.modalitesCompteBancaireCommun}` : ""}
${pacsData.clausesFacultatives.clausesFinancieresPersonnalisees ? `- Clauses financi√®res personnalis√©es: ${pacsData.clausesFacultatives.clausesFinancieresPersonnalisees}` : ""}
${pacsData.clausesFacultatives.clausesSolidariteDettes ? `- Clauses solidarit√© sur dettes: ${pacsData.clausesFacultatives.clausesSolidariteDettes}` : ""}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
D√âCLARATIONS SUR L'HONNEUR (OBLIGATOIRES)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚úì D√©claration de r√©sidence commune: ${pacsData.declarations.residenceCommune ? "Oui" : "Non"}
‚úì D√©claration d'absence de lien de parent√©: ${pacsData.declarations.absenceLienParente ? "Oui" : "Non"}
‚úì D√©claration d'absence de mariage et PACS en cours: ${pacsData.declarations.absenceMariageEtPacs ? "Oui" : "Non"}

${pacsData.enfantEnCommun === "oui" ? `
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
ENFANT(S) EN COMMUN
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${pacsData.enfants.map((e, idx) => `
Enfant ${idx + 1}:
- Nom: ${e.nom} ${e.prenom}
- Date de naissance: ${e.dateNaissance || "Non renseign√©e"}
- Autorit√© parentale: ${e.autoriteParentale || "Non renseign√©e"}
`).join('\n')}
` : ""}

${pacsData.droitApplicable !== "francais" ? `
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
R√âGIME PATRIMONIAL √âTRANGER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Droit applicable: ${pacsData.droitApplicableAutre || pacsData.droitApplicable}
- Clause de priorit√© du droit fran√ßais pour le PACS appliqu√©e
` : ""}

${pacsData.biensPreexistants === "oui" ? `
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
BIENS D√âJ√Ä ACQUIS ENSEMBLE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${pacsData.biensListe.map((b, idx) => `
Bien ${idx + 1}:
- Description: ${b.description || "Non renseign√©"}
- Quote-part partenaire 1: ${b.quotePart1 || "Non renseign√©"}
- Quote-part partenaire 2: ${b.quotePart2 || "Non renseign√©"}
- Indivision: ${b.indivision || "Non renseign√©"}
`).join('\n')}
` : ""}
      `.trim();

      const { data, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          role: role,
          type: 'pacs',
          name: `PACS - ${pacsData.partenaires[0]?.nom || "Sans nom"} & ${pacsData.partenaires[1]?.nom || "Sans nom"}`,
          status: 'draft',
          description: descriptionData,
        })
        .select()
        .single();

      if (error) throw error;

      toast.success('Convention de PACS cr√©√©e avec succ√®s');

      // Reset du formulaire
      setPacsData({
        objetPacs: "initial",
        regimePacs: "separation",
        regimePersonnalise: {
          definitionBiensCommuns: "",
          biensPropres: "",
          clausesSpecifiques: "",
        },
        datePriseEffetSouhaitee: "",
        pacsInitialDate: "",
        pacsInitialMairie: "",
        pacsInitialNumero: "",
        clausesModifiees: "",
        partenaires: [
          {
            id: 1,
            isClient: false,
            clientId: "",
            nom: "",
            prenom: "",
            nomNaissance: "",
            adresseActuelle: "",
            dateNaissance: "",
            lieuNaissance: "",
            nationalite: "",
            profession: "",
            telephone: "",
            email: "",
            situationFamiliale: "",
            typeIdentite: "",
            numeroIdentite: "",
            dateEmissionIdentite: "",
            autoriteDelivrante: "",
            estEtranger: false,
            attestationNonPacsPaysOrigine: false,
            certificatCoutumeRequis: false,
            traductionRequise: false,
          },
          {
            id: 2,
            isClient: false,
            clientId: "",
            nom: "",
            prenom: "",
            nomNaissance: "",
            adresseActuelle: "",
            dateNaissance: "",
            lieuNaissance: "",
            nationalite: "",
            profession: "",
            telephone: "",
            email: "",
            situationFamiliale: "",
            typeIdentite: "",
            numeroIdentite: "",
            dateEmissionIdentite: "",
            autoriteDelivrante: "",
            estEtranger: false,
            attestationNonPacsPaysOrigine: false,
            certificatCoutumeRequis: false,
            traductionRequise: false,
          }
        ],
        adresseCommune: "",
        dateDebutResidenceCommune: "",
        contributionCharges: "proportionnelle",
        contributionChargesAutre: "",
        clausesFacultatives: {
          gestionBiensPersonnels: "",
          gestionBienCommun: "",
          usageBienIndivis: "",
          repartitionDepensesSpecifiques: "",
          clauseOccupationLogementSeparation: "",
          clauseRepriseBienDeces: "",
          clauseAbandonCreance: "",
          modalitesCompteBancaireCommun: "",
          clausesFinancieresPersonnalisees: "",
          clausesSolidariteDettes: "",
        },
        declarations: {
          residenceCommune: false,
          absenceLienParente: false,
          absenceMariageEtPacs: false,
        },
        enfantEnCommun: "non",
        enfants: [{
          id: 1,
          nom: "",
          prenom: "",
          dateNaissance: "",
          autoriteParentale: "",
        }],
        droitApplicable: "francais",
        droitApplicableAutre: "",
        biensPreexistants: "non",
        biensListe: [{
          id: 1,
          description: "",
          quotePart1: "",
          quotePart2: "",
          indivision: "",
        }],
      });

      // Reset file uploads
      setPacsPartenaire1IdentiteFiles([]);
      setPacsPartenaire2IdentiteFiles([]);
      setPacsPartenaire1ActeNaissanceFiles([]);
      setPacsPartenaire2ActeNaissanceFiles([]);
      setPacsPartenaire1DomicileFiles([]);
      setPacsPartenaire2DomicileFiles([]);
      setPacsPartenaire1DivorceFiles([]);
      setPacsPartenaire2DivorceFiles([]);
      setPacsPartenaire1DecesFiles([]);
      setPacsPartenaire2DecesFiles([]);
      setPacsPartenaire1CertificatCoutumeFiles([]);
      setPacsPartenaire2CertificatCoutumeFiles([]);
      setPacsPartenaire1CertificatNonPacsFiles([]);
      setPacsPartenaire2CertificatNonPacsFiles([]);
      setPacsPartenaire1TraductionsFiles([]);
      setPacsPartenaire2TraductionsFiles([]);

      refreshContrats();
    } catch (err) {
      console.error('Erreur cr√©ation PACS:', err);
      toast.error('Erreur lors de la cr√©ation de la convention de PACS');
    }
  };

  const handleDonationEntreEpouxSubmit = async () => {
    try {
      if (!user) {
        toast.error('Utilisateur non connect√©');
        return;
      }

      // Validations obligatoires
      if (!donationEntreEpouxData.typeDonation) {
        toast.error('Veuillez s√©lectionner un type de donation');
        return;
      }

      if (donationEntreEpouxData.objetDonation.length === 0) {
        toast.error('Veuillez s√©lectionner au moins un objet de donation');
        return;
      }

      if (!donationEntreEpouxData.epoux[0].regimeMatrimonial || !donationEntreEpouxData.epoux[1].regimeMatrimonial) {
        toast.error('Veuillez renseigner le r√©gime matrimonial des deux √©poux');
        return;
      }

      const typeLabels: Record<string, string> = {
        au_dernier_vivant: "Donation entre √©poux au dernier vivant (effets au d√©c√®s)",
        biens_presents: "Donation de biens pr√©sents (effets imm√©diats)",
        mixte: "Donation mixte"
      };

      const regimeLabels: Record<string, string> = {
        communaute_legale: "Communaut√© l√©gale",
        communaute_universelle: "Communaut√© universelle",
        separation_biens: "S√©paration de biens",
        participation_acquets: "Participation aux acqu√™ts",
        autre: "Autre r√©gime"
      };

      const descriptionData = `
TYPE DE CONTRAT: DONATION ENTRE √âPOUX

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
INFORMATIONS G√âN√âRALES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
- Type de donation: ${typeLabels[donationEntreEpouxData.typeDonation] || donationEntreEpouxData.typeDonation}
- Objet(s) de la donation: ${donationEntreEpouxData.objetDonation.map(o => {
  const labels: Record<string, string> = {
    protection_conjoint: "Protection du conjoint survivant",
    transmission_bien: "Transmission d'un bien particulier",
    partage_inegal: "Partage in√©gal",
    renforcement_droits: "Renforcement des droits successoraux"
  };
  return labels[o] || o;
}).join(', ')}
- Date pr√©vue de signature: ${donationEntreEpouxData.datePrevueSignature || "Non renseign√©e"}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
IDENTIT√â DES √âPOUX
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${donationEntreEpouxData.epoux.map((e, idx) => `
√âpoux ${idx + 1}:
- Nom: ${e.nom} ${e.prenom}
- Nom de naissance: ${e.nomNaissance || e.nom}
- Date de naissance: ${e.dateNaissance || "Non renseign√©e"}
- Lieu de naissance: ${e.lieuNaissance || "Non renseign√©"}
- Nationalit√©: ${e.nationalite || "Non renseign√©e"}
- Profession: ${e.profession || "Non renseign√©e"}
- Adresse: ${e.adresseComplete || "Non renseign√©e"}
- T√©l√©phone: ${e.telephone || "Non renseign√©"}
- Email: ${e.email || "Non renseign√©"}
- R√©gime matrimonial: ${regimeLabels[e.regimeMatrimonial] || e.regimeMatrimonialAutre || "Non renseign√©"}
- Date du mariage: ${e.dateMariage || "Non renseign√©e"}
- Lieu du mariage: ${e.lieuMariage || "Non renseign√©"}
- Contrat de mariage: ${e.existenceContratMariage === "oui" ? "Oui (copie √† joindre)" : "Non"}
- Pi√®ce d'identit√©: ${e.typeIdentite || "Non renseign√©"} n¬∞${e.numeroIdentite || "Non renseign√©"}
  Autorit√©: ${e.autoriteDelivrance || "Non renseign√©"}, Expiration: ${e.dateExpiration || "Non renseign√©e"}
`).join('\n')}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
ENFANTS ET H√âRITIERS R√âSERVATAIRES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
A. ENFANTS COMMUNS (${donationEntreEpouxData.enfantsCommuns.length || 0})
${donationEntreEpouxData.enfantsCommuns.filter(e => e.nom).map(e => `- ${e.nom} ${e.prenom}, n√©(e) le ${e.dateNaissance || "Non renseign√©"}`).join('\n') || "Aucun enfant commun d√©clar√©"}

B. ENFANTS NON COMMUNS (${donationEntreEpouxData.enfantsNonCommuns.filter(e => e.nom).length || 0})
${donationEntreEpouxData.enfantsNonCommuns.filter(e => e.nom).map(e => `- ${e.nom} ${e.prenom} (√©poux ${e.epoux}), n√©(e) le ${e.dateNaissance || "Non renseign√©"}`).join('\n') || "Aucun enfant non commun d√©clar√©"}

C. PARENTS VIVANTS
- Parents √©poux 1: ${donationEntreEpouxData.parentsVivants.epoux1 === "oui" ? "Oui" : "Non"}
- Parents √©poux 2: ${donationEntreEpouxData.parentsVivants.epoux2 === "oui" ? "Oui" : "Non"}

D. AUTRES H√âRITIERS
${donationEntreEpouxData.autresHeritiers || "Aucun autre h√©ritier d√©clar√©"}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
PATRIMOINE DES √âPOUX
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
A. BIENS PROPRES √âPOUX 1 (${donationEntreEpouxData.biensPropresEpoux1.filter(b => b.description).length})
${donationEntreEpouxData.biensPropresEpoux1.filter(b => b.description).map(b => 
  `- ${b.type}: ${b.description}, valeur: ${b.valeur || "Non estim√©e"}, origine: ${b.origine || "Non pr√©cis√©e"}`
).join('\n') || "Aucun bien propre d√©clar√©"}

B. BIENS PROPRES √âPOUX 2 (${donationEntreEpouxData.biensPropresEpoux2.filter(b => b.description).length})
${donationEntreEpouxData.biensPropresEpoux2.filter(b => b.description).map(b => 
  `- ${b.type}: ${b.description}, valeur: ${b.valeur || "Non estim√©e"}, origine: ${b.origine || "Non pr√©cis√©e"}`
).join('\n') || "Aucun bien propre d√©clar√©"}

C. BIENS COMMUNS (${donationEntreEpouxData.biensCommuns.filter(b => b.description).length})
${donationEntreEpouxData.biensCommuns.filter(b => b.description).map(b => 
  `- ${b.description}, valeur: ${b.valeur || "Non estim√©e"}, parts: ${b.partEpoux1 || "50"}% / ${b.partEpoux2 || "50"}%`
).join('\n') || "Aucun bien commun d√©clar√©"}

D. DROITS PARTICULIERS
${donationEntreEpouxData.droitsParticuliers.nueProprieteBiens ? `- Nue-propri√©t√©: ${donationEntreEpouxData.droitsParticuliers.nueProprieteBiens}` : ""}
${donationEntreEpouxData.droitsParticuliers.usufruitBiens ? `- Usufruit: ${donationEntreEpouxData.droitsParticuliers.usufruitBiens}` : ""}
${donationEntreEpouxData.droitsParticuliers.biensIndivis ? `- Biens indivis: ${donationEntreEpouxData.droitsParticuliers.biensIndivis}` : ""}
${donationEntreEpouxData.droitsParticuliers.biensHypotheques ? `- Hypoth√®ques: ${donationEntreEpouxData.droitsParticuliers.biensHypotheques}` : ""}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CLAUSES DE LA DONATION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${donationEntreEpouxData.typeDonation === "au_dernier_vivant" || donationEntreEpouxData.typeDonation === "mixte" ? `
A. DONATION AU DERNIER VIVANT
Options successorales choisies:
${donationEntreEpouxData.donationDernierVivant.optionsSuccessorales.map(o => {
  const labels: Record<string, string> = {
    pleine_propriete_quotite: "- Pleine propri√©t√© de la quotit√© disponible",
    usufruit_universel: "- Usufruit universel de la succession",
    quart_pleine_3quarts_usufruit: "- 1/4 en pleine propri√©t√© + 3/4 en usufruit",
    choix_multiple: "- Choix entre plusieurs options au d√©c√®s",
    attribution_biens_specifiques: "- Attribution de biens sp√©cifiques"
  };
  return labels[o] || o;
}).join('\n') || "Aucune option s√©lectionn√©e"}
${donationEntreEpouxData.donationDernierVivant.biensSpecifiques ? `Biens sp√©cifiques: ${donationEntreEpouxData.donationDernierVivant.biensSpecifiques}` : ""}

Attribution pr√©f√©rentielle:
${donationEntreEpouxData.donationDernierVivant.attributionPreferentielle.active ? `
- Logement familial: ${donationEntreEpouxData.donationDernierVivant.attributionPreferentielle.logementFamilial ? "Oui" : "Non"}
- Mobilier: ${donationEntreEpouxData.donationDernierVivant.attributionPreferentielle.mobilier ? "Oui" : "Non"}
- Bien professionnel: ${donationEntreEpouxData.donationDernierVivant.attributionPreferentielle.bienProfessionnel ? "Oui" : "Non"}
- V√©hicule: ${donationEntreEpouxData.donationDernierVivant.attributionPreferentielle.vehicule ? "Oui" : "Non"}
${donationEntreEpouxData.donationDernierVivant.attributionPreferentielle.autresBiens ? `- Autres biens: ${donationEntreEpouxData.donationDernierVivant.attributionPreferentielle.autresBiens}` : ""}
` : "Non activ√©e"}

Clause de pr√©ciput: ${donationEntreEpouxData.donationDernierVivant.clausePreciput.active ? `
- Bien: ${donationEntreEpouxData.donationDernierVivant.clausePreciput.descriptionBien || "Non pr√©cis√©"}
- Effet: ${donationEntreEpouxData.donationDernierVivant.clausePreciput.effet === "hors_part" ? "Hors part successorale" : "Valoris√© dans la part"}
` : "Non activ√©e"}

Clause de cantonnement: ${donationEntreEpouxData.donationDernierVivant.clauseCantonnement ? "Oui (optimisation fiscale)" : "Non"}

Clause d'exclusion: ${donationEntreEpouxData.donationDernierVivant.clauseExclusion.active ? `
- Biens exclus: ${donationEntreEpouxData.donationDernierVivant.clauseExclusion.biensExclus || "Non pr√©cis√©"}
- Cas particuliers: ${donationEntreEpouxData.donationDernierVivant.clauseExclusion.casParticuliers || "Non pr√©cis√©"}
` : "Non activ√©e"}
` : ""}

${donationEntreEpouxData.typeDonation === "biens_presents" || donationEntreEpouxData.typeDonation === "mixte" ? `
B. DONATION DE BIENS PR√âSENTS
Biens donn√©s imm√©diatement (${donationEntreEpouxData.donationBiensPresents.biensDonnes.filter(b => b.description).length}):
${donationEntreEpouxData.donationBiensPresents.biensDonnes.filter(b => b.description).map(b => 
  `- ${b.nature}: ${b.description}, valeur: ${b.valeur || "Non estim√©e"}, r√©gime: ${b.regimePropriete || "Non pr√©cis√©"}`
).join('\n') || "Aucun bien donn√©"}

Irr√©vocabilit√©: ${donationEntreEpouxData.donationBiensPresents.irrevocabilite === "oui" ? "Oui (donation irr√©vocable)" : "Non"}
Clause de retour en cas de pr√©d√©c√®s: ${donationEntreEpouxData.donationBiensPresents.clauseRetourPredeces === "oui" ? "Oui" : "Non"}
R√©serve d'usufruit: ${donationEntreEpouxData.donationBiensPresents.reserveUsufruit.active ? `Oui - ${donationEntreEpouxData.donationBiensPresents.reserveUsufruit.conditions || "Conditions non pr√©cis√©es"}` : "Non"}
` : ""}

C. CLAUSES COMMUNES
${donationEntreEpouxData.clausesCommunes.administrationGestion ? `- Administration et gestion: ${donationEntreEpouxData.clausesCommunes.administrationGestion}` : ""}
${donationEntreEpouxData.clausesCommunes.conditionSuspensiveResolutoire ? `- Condition suspensive/r√©solutoire: ${donationEntreEpouxData.clausesCommunes.conditionSuspensiveResolutoire}` : ""}
- Acceptation du b√©n√©ficiaire: ${donationEntreEpouxData.clausesCommunes.acceptationBeneficiaire ? "Oui (obligatoire)" : "En attente"}
- Renonciation droits successoraux standards: ${donationEntreEpouxData.clausesCommunes.renonciationDroitsSuccessorauxStandards ? "Oui" : "Non"}
- Clause de non-r√©vocation: ${donationEntreEpouxData.clausesCommunes.clauseNonRevocation ? "Oui" : "Non"}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
MENTIONS L√âGALES OBLIGATOIRES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚úì Articles du Code civil applicables
‚úì Effets de la donation entre √©poux
‚úì Quotit√© disponible sp√©ciale entre √©poux
‚úì Limites de la r√©serve h√©r√©ditaire
‚úì D√©claration de capacit√© juridique
‚úì Consentement √©clair√© des deux √©poux
‚úì Lecture de l'acte
‚úì Signatures √©lectroniques

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
FIN DE LA CONVENTION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
`;

      await supabase.from('contrats').insert({
        name: `Donation entre √©poux - ${donationEntreEpouxData.epoux[0].nom} ${donationEntreEpouxData.epoux[0].prenom} & ${donationEntreEpouxData.epoux[1].nom} ${donationEntreEpouxData.epoux[1].prenom}`,
        user_id: user.id,
        status: 'draft',
        type: 'Donation entre √©poux',
        description: descriptionData,
      });

      toast.success('Donation entre √©poux cr√©√©e avec succ√®s');
      setShowQuestionDialog(false);

      // Reset form
      setDonationEntreEpouxData({
        typeDonation: "au_dernier_vivant",
        objetDonation: [],
        datePrevueSignature: "",
        epoux: [
          {
            id: 1, isClient: false, clientId: "", nom: "", prenom: "", nomNaissance: "", adresseComplete: "",
            telephone: "", email: "", dateNaissance: "", lieuNaissance: "", nationalite: "", profession: "",
            situationMatrimoniale: "marie", regimeMatrimonial: "", regimeMatrimonialAutre: "",
            dateMariage: "", lieuMariage: "", existenceContratMariage: "non",
            typeIdentite: "", numeroIdentite: "", autoriteDelivrance: "", dateExpiration: "",
          },
          {
            id: 2, isClient: false, clientId: "", nom: "", prenom: "", nomNaissance: "", adresseComplete: "",
            telephone: "", email: "", dateNaissance: "", lieuNaissance: "", nationalite: "", profession: "",
            situationMatrimoniale: "marie", regimeMatrimonial: "", regimeMatrimonialAutre: "",
            dateMariage: "", lieuMariage: "", existenceContratMariage: "non",
            typeIdentite: "", numeroIdentite: "", autoriteDelivrance: "", dateExpiration: "",
          }
        ],
        enfantsCommuns: [{ id: 1, nom: "", prenom: "", dateNaissance: "" }],
        enfantsNonCommuns: [{ id: 1, epoux: "1", nom: "", prenom: "", dateNaissance: "" }],
        parentsVivants: { epoux1: "non", epoux2: "non" },
        autresHeritiers: "",
        biensPropresEpoux1: [{ id: 1, type: "", description: "", valeur: "", origine: "" }],
        biensPropresEpoux2: [{ id: 1, type: "", description: "", valeur: "", origine: "" }],
        biensCommuns: [{ id: 1, description: "", valeur: "", partEpoux1: "", partEpoux2: "" }],
        droitsParticuliers: { nueProprieteBiens: "", usufruitBiens: "", biensIndivis: "", biensHypotheques: "" },
        donationDernierVivant: {
          optionsSuccessorales: [],
          biensSpecifiques: "",
          attributionPreferentielle: {
            active: false, logementFamilial: false, mobilier: false, bienProfessionnel: false,
            vehicule: false, autresBiens: "",
          },
          clausePreciput: { active: false, descriptionBien: "", effet: "" },
          clauseCantonnement: false,
          clauseExclusion: { active: false, biensExclus: "", casParticuliers: "" },
        },
        donationBiensPresents: {
          biensDonnes: [{ id: 1, nature: "", description: "", valeur: "", regimePropriete: "" }],
          irrevocabilite: "oui",
          clauseRetourPredeces: "non",
          reserveUsufruit: { active: false, conditions: "" },
        },
        clausesCommunes: {
          administrationGestion: "",
          conditionSuspensiveResolutoire: "",
          acceptationBeneficiaire: false,
          renonciationDroitsSuccessorauxStandards: false,
          clauseNonRevocation: false,
        },
        mentionsLegales: {
          articlesCodeCivil: true, effetsDonation: true, quotiteDisponible: true,
          limitesReserveHereditaire: true, declarationCapaciteJuridique: true,
          consentementEclaire: true, lectureActe: true, signaturesElectroniques: true,
        },
      });

      // Reset file states
      setDonationEpoux1IdentiteFiles([]);
      setDonationEpoux2IdentiteFiles([]);
      setDonationEpoux1LivretFamilleFiles([]);
      setDonationEpoux2LivretFamilleFiles([]);
      setDonationEpoux1ActeMariageFiles([]);
      setDonationEpoux2ActeMariageFiles([]);
      setDonationEpoux1ContratMariageFiles([]);
      setDonationEpoux2ContratMariageFiles([]);
      setDonationEpoux1DomicileFiles([]);
      setDonationEpoux2DomicileFiles([]);
      setDonationTitresProprieteBiensFiles([]);
      setDonationEstimationBiensFiles([]);
      setDonationHypothequesFiles([]);
      setDonationSituationLocativeFiles([]);
      setDonationRIBFiles([]);
      setDonationCarteGriseFiles([]);
      setDonationAutresDocumentsFiles([]);

      refreshContrats();
    } catch (err) {
      console.error('Erreur cr√©ation donation entre √©poux:', err);
      toast.error('Erreur lors de la cr√©ation de la donation entre √©poux');
    }
  };

  const handleDonationSimpleSubmit = async () => {
    if (!user) return;
    
    // Validation
    if (!donationSimpleData.typeDonation) {
      toast.error("Veuillez s√©lectionner un type de donation");
      return;
    }
    if (!donationSimpleData.donateur.nom || !donationSimpleData.donateur.prenom) {
      toast.error("Veuillez renseigner le donateur");
      return;
    }
    if (!donationSimpleData.donataire.nom || !donationSimpleData.donataire.prenom) {
      toast.error("Veuillez renseigner le donataire");
      return;
    }
    if (!donationSimpleData.mentionsLegales.acceptationExpresse) {
      toast.error("L'acceptation expresse du donataire est obligatoire");
      return;
    }
    if (!donationSimpleData.mentionsLegales.consentementEclaire) {
      toast.error("Le consentement √©clair√© du donateur est obligatoire");
      return;
    }
    
    try {
      // Construction de la description d√©taill√©e
      let description = `DONATION SIMPLE\n\n`;
      
      // Type de donation
      const typesLibelles: Record<string, string> = {
        biens_meubles: "Donation simple de biens meubles",
        biens_immobiliers: "Donation simple de biens immobiliers",
        sommes_argent: "Donation de sommes d'argent",
        nue_propriete: "Donation de nue-propri√©t√©",
        usufruit: "Donation d'usufruit",
        parts_sociales: "Donation de parts sociales / actions",
        manuelle: "Donation manuelle",
        mixte: "Donation mixte",
      };
      description += `Type : ${typesLibelles[donationSimpleData.typeDonation] || donationSimpleData.typeDonation}\n`;
      description += `Avec charges : ${donationSimpleData.donationAvecCharges ? "Oui" : "Non"}\n`;
      if (donationSimpleData.donationAvecCharges) {
        description += `Charges : ${donationSimpleData.descriptionCharges}\n`;
      }
      description += `Avec r√©serve d'usufruit : ${donationSimpleData.donationAvecReserveUsufruit ? "Oui" : "Non"}\n`;
      description += `Avec droit de retour : ${donationSimpleData.donationAvecDroitRetour ? "Oui" : "Non"}\n\n`;
      
      // Donateur
      description += `DONATEUR :\n`;
      description += `${donationSimpleData.donateur.prenom} ${donationSimpleData.donateur.nom}\n`;
      if (donationSimpleData.donateur.nomNaissance) description += `Nom de naissance : ${donationSimpleData.donateur.nomNaissance}\n`;
      description += `N√©(e) le ${donationSimpleData.donateur.dateNaissance} √† ${donationSimpleData.donateur.lieuNaissance}\n`;
      description += `Adresse : ${donationSimpleData.donateur.adresseComplete}\n`;
      description += `T√©l√©phone : ${donationSimpleData.donateur.telephone}\n`;
      description += `Email : ${donationSimpleData.donateur.email}\n`;
      description += `Nationalit√© : ${donationSimpleData.donateur.nationalite}\n`;
      description += `Profession : ${donationSimpleData.donateur.profession}\n`;
      description += `Situation familiale : ${donationSimpleData.donateur.situationFamiliale}\n`;
      if (donationSimpleData.donateur.situationFamiliale === "marie") {
        description += `R√©gime matrimonial : ${donationSimpleData.donateur.regimeMatrimonial}\n`;
      }
      if (donationSimpleData.donateur.situationFiscale) {
        description += `Situation fiscale : ${donationSimpleData.donateur.situationFiscale}\n`;
      }
      description += `\n`;
      
      // Donataire
      description += `DONATAIRE :\n`;
      description += `${donationSimpleData.donataire.prenom} ${donationSimpleData.donataire.nom}\n`;
      if (donationSimpleData.donataire.nomNaissance) description += `Nom de naissance : ${donationSimpleData.donataire.nomNaissance}\n`;
      description += `N√©(e) le ${donationSimpleData.donataire.dateNaissance} √† ${donationSimpleData.donataire.lieuNaissance}\n`;
      description += `Adresse : ${donationSimpleData.donataire.adresseComplete}\n`;
      description += `T√©l√©phone : ${donationSimpleData.donataire.telephone}\n`;
      description += `Email : ${donationSimpleData.donataire.email}\n`;
      description += `Nationalit√© : ${donationSimpleData.donataire.nationalite}\n`;
      description += `Profession : ${donationSimpleData.donataire.profession}\n`;
      description += `Lien avec le donateur : ${donationSimpleData.donataire.lienDonateur}\n`;
      description += `\n`;
      
      // Enfants / h√©ritiers
      if (donationSimpleData.nombreEnfants) {
        description += `ENFANTS DU DONATEUR :\n`;
        description += `Nombre : ${donationSimpleData.nombreEnfants}\n`;
        donationSimpleData.enfants.forEach((enfant, idx) => {
          if (enfant.nom) {
            description += `- ${enfant.prenom} ${enfant.nom}, n√©(e) le ${enfant.dateNaissance}\n`;
          }
        });
        description += `Type de donation : ${donationSimpleData.donationHorsPartSuccessorale ? "Hors part successorale" : ""}${donationSimpleData.donationAvancementPart ? "En avancement de part successorale" : ""}\n`;
        description += `\n`;
      }
      
      // Description des biens selon type
      description += `BIEN(S) DONN√â(S) :\n`;
      if (donationSimpleData.typeDonation === "biens_immobiliers" && donationSimpleData.bienImmobilier.adresseComplete) {
        description += `Bien immobilier :\n`;
        description += `Adresse : ${donationSimpleData.bienImmobilier.adresseComplete}\n`;
        description += `Nature : ${donationSimpleData.bienImmobilier.natureBien}\n`;
        description += `D√©signation cadastrale : Section ${donationSimpleData.bienImmobilier.sectionCadastrale}, N¬∞ ${donationSimpleData.bienImmobilier.numeroCadastral}\n`;
        description += `Contenance : ${donationSimpleData.bienImmobilier.contenance}\n`;
        description += `Description : ${donationSimpleData.bienImmobilier.descriptionDetaille}\n`;
        description += `Situation locative : ${donationSimpleData.bienImmobilier.situationLocative}\n`;
        description += `Valeur v√©nale : ${donationSimpleData.bienImmobilier.valeurVenale} ‚Ç¨\n`;
        if (donationSimpleData.bienImmobilier.existenceHypotheques) {
          description += `Hypoth√®ques : ${donationSimpleData.bienImmobilier.montantHypotheques} ‚Ç¨\n`;
        }
        if (donationSimpleData.bienImmobilier.repartitionUsufruit) {
          description += `Usufruit : ${donationSimpleData.bienImmobilier.repartitionUsufruit}\n`;
          description += `Nue-propri√©t√© : ${donationSimpleData.bienImmobilier.repartitionNuePropriete}\n`;
        }
      }
      
      if (donationSimpleData.typeDonation === "biens_meubles" && donationSimpleData.bienMobilier.descriptionPrecise) {
        description += `Bien mobilier :\n`;
        description += `Description : ${donationSimpleData.bienMobilier.descriptionPrecise}\n`;
        if (donationSimpleData.bienMobilier.numeroSerie) description += `N¬∞ s√©rie : ${donationSimpleData.bienMobilier.numeroSerie}\n`;
        description += `Valeur estim√©e : ${donationSimpleData.bienMobilier.valeurEstimee} ‚Ç¨\n`;
      }
      
      if (donationSimpleData.typeDonation === "sommes_argent" && donationSimpleData.sommesArgent.montantExact) {
        description += `Somme d'argent :\n`;
        description += `Montant : ${donationSimpleData.sommesArgent.montantExact} ‚Ç¨\n`;
        description += `Provenance : ${donationSimpleData.sommesArgent.provenanceFonds}\n`;
        description += `Modalit√© : ${donationSimpleData.sommesArgent.modalite}\n`;
        description += `Date transfert : ${donationSimpleData.sommesArgent.dateTransfert}\n`;
      }
      
      if (donationSimpleData.typeDonation === "parts_sociales" && donationSimpleData.partsSociales.typeSociete) {
        description += `Parts sociales / Actions :\n`;
        description += `Type soci√©t√© : ${donationSimpleData.partsSociales.typeSociete}\n`;
        description += `Nombre de parts : ${donationSimpleData.partsSociales.nombreParts}\n`;
        description += `Valeur unitaire : ${donationSimpleData.partsSociales.valeurUnitaire} ‚Ç¨\n`;
        description += `Pourcentage du capital : ${donationSimpleData.partsSociales.pourcentageCapital}%\n`;
        description += `Agr√©ment obligatoire : ${donationSimpleData.partsSociales.agrementObligatoire ? "Oui" : "Non"}\n`;
        if (donationSimpleData.partsSociales.clausesSpecifiques) {
          description += `Clauses sp√©cifiques : ${donationSimpleData.partsSociales.clausesSpecifiques}\n`;
        }
      }
      
      if ((donationSimpleData.typeDonation === "nue_propriete" || donationSimpleData.typeDonation === "usufruit") && donationSimpleData.nueProprieteUsufruit.valeurNuePropriete) {
        description += `Nue-propri√©t√© / Usufruit :\n`;
        description += `Valeur nue-propri√©t√© : ${donationSimpleData.nueProprieteUsufruit.valeurNuePropriete} ‚Ç¨\n`;
        description += `Valeur usufruit : ${donationSimpleData.nueProprieteUsufruit.valeurUsufruit} ‚Ç¨\n`;
        description += `Dur√©e : ${donationSimpleData.nueProprieteUsufruit.duree}\n`;
        description += `R√©partition charges : ${donationSimpleData.nueProprieteUsufruit.repartitionCharges}\n`;
      }
      description += `\n`;
      
      // Clauses optionnelles
      if (donationSimpleData.clausesOptionnelles.reserveUsufruit) {
        description += `R√âSERVE D'USUFRUIT :\n`;
        description += `√âtendue : ${donationSimpleData.clausesOptionnelles.etendueUsufruit}\n`;
        description += `Droit usage/habitation : ${donationSimpleData.clausesOptionnelles.droitUsageHabitation ? "Oui" : "Non"}\n\n`;
      }
      
      if (donationSimpleData.clausesOptionnelles.droitRetour) {
        description += `DROIT DE RETOUR CONVENTIONNEL :\n`;
        description += `√âtendue : ${donationSimpleData.clausesOptionnelles.etendueRetour}\n\n`;
      }
      
      if (donationSimpleData.clausesOptionnelles.chargeImposee) {
        description += `CHARGE IMPOS√âE AU DONATAIRE :\n`;
        description += `Description : ${donationSimpleData.clausesOptionnelles.descriptionCharge}\n`;
        description += `Montant/Nature : ${donationSimpleData.clausesOptionnelles.montantNatureCharge}\n`;
        description += `Conditions : ${donationSimpleData.clausesOptionnelles.conditionsExecution}\n\n`;
      }
      
      if (donationSimpleData.clausesOptionnelles.usageProfessionnel) {
        description += `Bien donn√© pour usage professionnel\n`;
      }
      if (donationSimpleData.clausesOptionnelles.exclusionCommunaute) {
        description += `Exclusion de la communaut√© en cas de mariage du donataire\n`;
      }
      if (donationSimpleData.clausesOptionnelles.donationRapportable) {
        description += `Type de donation : ${donationSimpleData.clausesOptionnelles.donationRapportable === "avancement_hoirie" ? "En avancement d'hoirie (rapportable)" : "Hors part successorale (non rapportable)"}\n`;
      }
      
      if (donationSimpleData.clausesOptionnelles.clauseInalienabilite) {
        description += `CLAUSE D'INALI√âNABILIT√â :\n`;
        description += `Dur√©e : ${donationSimpleData.clausesOptionnelles.dureeInalienabilite}\n`;
        description += `Motif l√©gitime : ${donationSimpleData.clausesOptionnelles.motifLegitime}\n`;
        description += `Autorisation requise : ${donationSimpleData.clausesOptionnelles.autorisationRequise ? "Oui" : "Non"}\n`;
      }
      
      // Cr√©er le contrat
      const { data: contrat, error: contratError } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: `Donation simple - ${donationSimpleData.donateur.nom} ‚Üí ${donationSimpleData.donataire.nom}`,
          type: pendingContractType,
          category: pendingCategory,
          role: role,
          description: description,
          questionnaire_data: donationSimpleData,
        })
        .select()
        .single();
      
      if (contratError) throw contratError;
      
      // Upload des fichiers
      const uploadTasks: Promise<void>[] = [];
      
      const uploadFiles = async (files: File[], folder: string) => {
        for (const file of files) {
          const uniqueName = `${Date.now()}_${file.name}`;
          const filePath = `contrats/${contrat.id}/${folder}/${uniqueName}`;
          
          const { error: uploadError } = await supabase.storage
            .from('contrat-documents')
            .upload(filePath, file);
          
          if (uploadError) {
            console.error(`Erreur upload ${folder}:`, uploadError);
          }
        }
      };
      
      if (donationSimpleDonateurIdentiteFiles.length > 0) uploadTasks.push(uploadFiles(donationSimpleDonateurIdentiteFiles, 'donateur_identite'));
      if (donationSimpleDonateurLivretFamilleFiles.length > 0) uploadTasks.push(uploadFiles(donationSimpleDonateurLivretFamilleFiles, 'donateur_livret_famille'));
      if (donationSimpleDonateurDomicileFiles.length > 0) uploadTasks.push(uploadFiles(donationSimpleDonateurDomicileFiles, 'donateur_domicile'));
      if (donationSimpleDonatairePieceIdentiteFiles.length > 0) uploadTasks.push(uploadFiles(donationSimpleDonatairePieceIdentiteFiles, 'donataire_identite'));
      if (donationSimpleDonataireDomicileFiles.length > 0) uploadTasks.push(uploadFiles(donationSimpleDonataireDomicileFiles, 'donataire_domicile'));
      if (donationSimpleTitreProprieteFiles.length > 0) uploadTasks.push(uploadFiles(donationSimpleTitreProprieteFiles, 'titre_propriete'));
      if (donationSimpleEvaluationBienFiles.length > 0) uploadTasks.push(uploadFiles(donationSimpleEvaluationBienFiles, 'evaluation_bien'));
      if (donationSimpleAutresDocumentsFiles.length > 0) uploadTasks.push(uploadFiles(donationSimpleAutresDocumentsFiles, 'autres_documents'));
      
      await Promise.all(uploadTasks);
      
      // Rafra√Æchir la liste
      setContrats((prev) => [contrat, ...prev]);
      setShowQuestionDialog(false);
      toast.success('Donation simple cr√©√©e avec succ√®s');
      navigate(role === 'notaire' ? '/notaires/contracts' : '/avocats/contracts');
      
    } catch (err: unknown) {
      console.error('Erreur cr√©ation donation simple:', err);
      toast.error('Erreur lors de la cr√©ation de la donation simple');
    }
  };

  const handleTestamentSubmit = async () => {
    if (!user) return;
    
    // Validation
    if (!testamentData.typeTestament) {
      toast.error("Veuillez s√©lectionner le type de testament");
      return;
    }
    
    if (!testamentData.testateurNom || !testamentData.testateurPrenom) {
      toast.error("Veuillez renseigner l'identit√© compl√®te du testateur");
      return;
    }

    try {
      // G√©n√©rer la description d√©taill√©e
      let description = `TESTAMENT ${testamentData.typeTestament.toUpperCase()}\n\n`;
      
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      description += `INFORMATIONS G√âN√âRALES\n`;
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      description += `Type : ${testamentData.typeTestament === "authentique" ? "Testament authentique" : "Testament mystique"}\n`;
      description += `Caract√®re : ${testamentData.caractereTestament}\n`;
      if (testamentData.dateSouhaiteeRedaction) {
        description += `Date souhait√©e : ${testamentData.dateSouhaiteeRedaction}\n`;
      }
      description += `\n`;
      
      // Testateur
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      description += `TESTATEUR\n`;
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      description += `${testamentData.testateurPrenom} ${testamentData.testateurNom}\n`;
      if (testamentData.testateurNomNaissance) description += `Nom de naissance : ${testamentData.testateurNomNaissance}\n`;
      description += `N√©(e) le ${testamentData.testateurDateNaissance} √† ${testamentData.testateurLieuNaissance}\n`;
      description += `Adresse : ${testamentData.testateurAdresse}\n`;
      description += `T√©l√©phone : ${testamentData.testateurTelephone}\n`;
      description += `Email : ${testamentData.testateurEmail}\n`;
      description += `Nationalit√© : ${testamentData.testateurNationalite}\n`;
      description += `Profession : ${testamentData.testateurProfession}\n`;
      description += `Situation familiale : ${testamentData.testateurSituationFamiliale}\n`;
      if (testamentData.regimeMatrimonial.nature) {
        description += `R√©gime matrimonial : ${testamentData.regimeMatrimonial.nature}\n`;
      }
      description += `Pi√®ce d'identit√© : ${testamentData.testateurPieceType} n¬∞${testamentData.testateurPieceNumero}\n`;
      description += `Capacit√© juridique confirm√©e : ${testamentData.capaciteJuridiqueConfirmee ? "Oui" : "Non"}\n`;
      if (testamentData.sousTutelleCuratelle) {
        description += `‚ö†Ô∏è Sous tutelle/curatelle\n`;
      }
      description += `\n`;
      
      // H√©ritiers r√©servataires
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      description += `H√âRITIERS R√âSERVATAIRES\n`;
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      if (testamentData.heritiersReservataires.enfants.length > 0 && testamentData.heritiersReservataires.enfants[0]?.nom) {
        description += `\nENFANTS (${testamentData.heritiersReservataires.enfants.filter(e => e.nom).length}) :\n`;
        testamentData.heritiersReservataires.enfants.forEach((enfant, idx) => {
          if (enfant.nom) {
            description += `${idx + 1}. ${enfant.prenom} ${enfant.nom}, n√©(e) le ${enfant.dateNaissance}\n`;
          }
        });
      }
      
      if (testamentData.heritiersReservataires.descendants.length > 0 && testamentData.heritiersReservataires.descendants[0]?.nom) {
        description += `\nDESCENDANTS (petits-enfants) :\n`;
        testamentData.heritiersReservataires.descendants.forEach((desc, idx) => {
          if (desc.nom) {
            description += `${idx + 1}. ${desc.prenom} ${desc.nom} - ${desc.lien}\n`;
          }
        });
      }
      
      if (testamentData.heritiersReservataires.pereVivant === "oui" || testamentData.heritiersReservataires.mereVivante === "oui") {
        description += `\nPARENTS VIVANTS :\n`;
        if (testamentData.heritiersReservataires.pereVivant === "oui") {
          description += `P√®re : ${testamentData.heritiersReservataires.nomPrenomPere}\n`;
        }
        if (testamentData.heritiersReservataires.mereVivante === "oui") {
          description += `M√®re : ${testamentData.heritiersReservataires.nomPrenomMere}\n`;
        }
      }
      
      description += `\n`;
      
      // L√©gataires
      if (testamentData.legataires.length > 0 && testamentData.legataires[0]?.nom) {
        description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
        description += `L√âGATAIRES\n`;
        description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
        testamentData.legataires.forEach((leg, idx) => {
          if (leg.nom) {
            description += `${idx + 1}. ${leg.prenom} ${leg.nom}\n`;
            description += `   Adresse : ${leg.adresse}\n`;
            description += `   Lien : ${leg.lien}\n`;
          }
        });
        description += `\n`;
      }
      
      // Dispositions testamentaires
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      description += `DISPOSITIONS TESTAMENTAIRES\n`;
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      
      if (testamentData.dispositionsTestamentaires.legsUniversel.actif) {
        description += `\n‚úì LEGS UNIVERSEL\n`;
        description += `B√©n√©ficiaire : ${testamentData.dispositionsTestamentaires.legsUniversel.beneficiaire}\n`;
        if (testamentData.dispositionsTestamentaires.legsUniversel.conditions) {
          description += `Conditions : ${testamentData.dispositionsTestamentaires.legsUniversel.conditions}\n`;
        }
      }
      
      if (testamentData.dispositionsTestamentaires.legsTitreUniversel.actif) {
        description += `\n‚úì LEGS √Ä TITRE UNIVERSEL\n`;
        description += `Quotit√© : ${testamentData.dispositionsTestamentaires.legsTitreUniversel.quotite}\n`;
        description += `B√©n√©ficiaire : ${testamentData.dispositionsTestamentaires.legsTitreUniversel.beneficiaire}\n`;
        if (testamentData.dispositionsTestamentaires.legsTitreUniversel.conditions) {
          description += `Conditions : ${testamentData.dispositionsTestamentaires.legsTitreUniversel.conditions}\n`;
        }
      }
      
      if (testamentData.dispositionsTestamentaires.legsParticuliers.length > 0 && testamentData.dispositionsTestamentaires.legsParticuliers[0]?.beneficiaire) {
        description += `\n‚úì LEGS PARTICULIERS (${testamentData.dispositionsTestamentaires.legsParticuliers.length})\n`;
        testamentData.dispositionsTestamentaires.legsParticuliers.forEach((leg, idx) => {
          if (leg.beneficiaire) {
            description += `${idx + 1}. ${leg.description} ‚Üí ${leg.beneficiaire}\n`;
          }
        });
      }
      
      if (testamentData.dispositionsTestamentaires.executeurTestamentaire.actif) {
        description += `\n‚úì EX√âCUTEUR TESTAMENTAIRE\n`;
        description += `${testamentData.dispositionsTestamentaires.executeurTestamentaire.prenom} ${testamentData.dispositionsTestamentaires.executeurTestamentaire.nom}\n`;
        description += `Mission : ${testamentData.dispositionsTestamentaires.executeurTestamentaire.mission}\n`;
      }
      description += `\n`;
      
      // Patrimoine
      if (testamentData.patrimoine.biensImmobiliers.length > 0 && testamentData.patrimoine.biensImmobiliers[0]?.adresse) {
        description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
        description += `PATRIMOINE\n`;
        description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
        description += `\nBIENS IMMOBILIERS :\n`;
        testamentData.patrimoine.biensImmobiliers.forEach((bien, idx) => {
          if (bien.adresse) {
            description += `${idx + 1}. ${bien.typeBien} - ${bien.adresse} (${bien.valeurEstimative}‚Ç¨)\n`;
          }
        });
      }
      
      // Testament authentique sp√©cifique
      if (testamentData.typeTestament === "authentique") {
        description += `\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
        description += `TESTAMENT AUTHENTIQUE - FORMALIT√âS\n`;
        description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
        description += `Notaire : ${testamentData.testamentAuthentique.notaireNom}\n`;
        description += `Office : ${testamentData.testamentAuthentique.notaireOffice}\n`;
        
        if (testamentData.testamentAuthentique.presenceSecondNotaire) {
          description += `Deuxi√®me notaire : ${testamentData.testamentAuthentique.secondNotaireNom}\n`;
        }
        
        if (testamentData.testamentAuthentique.temoins.length > 0 && testamentData.testamentAuthentique.temoins[0]?.nom) {
          description += `\nT√âMOINS :\n`;
          testamentData.testamentAuthentique.temoins.forEach((temoin, idx) => {
            if (temoin.nom) {
              description += `${idx + 1}. ${temoin.prenom} ${temoin.nom} - ${temoin.adresse}\n`;
            }
          });
        }
        
        description += `\nFormalit√©s accomplies :\n`;
        description += `- Testament dict√© : ${testamentData.testamentAuthentique.formaliteDicte ? "‚úì" : "‚úó"}\n`;
        description += `- Testament relu : ${testamentData.testamentAuthentique.formaliteRelu ? "‚úì" : "‚úó"}\n`;
        description += `- Testament sign√© : ${testamentData.testamentAuthentique.formaliteSigne ? "‚úì" : "‚úó"}\n`;
        description += `- Inscription FCDDV : ${testamentData.testamentAuthentique.formaliteRegistre ? "‚úì" : "‚úó"}\n`;
      }
      
      // Testament mystique sp√©cifique
      if (testamentData.typeTestament === "mystique") {
        description += `\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
        description += `TESTAMENT MYSTIQUE - FORMALIT√âS\n`;
        description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
        description += `Type d'√©criture : ${testamentData.testamentMystique.typeEcriture}\n`;
        description += `Enveloppe cachet√©e : ${testamentData.testamentMystique.cachete ? "Oui" : "Non"}\n`;
        if (testamentData.testamentMystique.suscription) {
          description += `Suscription : ${testamentData.testamentMystique.suscription}\n`;
        }
        
        if (testamentData.testamentMystique.temoins.length > 0 && testamentData.testamentMystique.temoins[0]?.nom) {
          description += `\nT√âMOINS OBLIGATOIRES :\n`;
          testamentData.testamentMystique.temoins.forEach((temoin, idx) => {
            if (temoin.nom) {
              description += `${idx + 1}. ${temoin.prenom} ${temoin.nom}\n`;
            }
          });
        }
        description += `Inscription FCDDV : ${testamentData.testamentMystique.inscriptionFCDDV ? "Oui" : "Non"}\n`;
      }

      // Cr√©er le contrat
      const { data: contrat, error: contratError } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: `Testament ${testamentData.typeTestament} - ${testamentData.testateur.nom}`,
          type: "Testament authentique ou mystique",
          category: pendingCategory,
          role: role,
          description: description,
        })
        .select()
        .single();

      if (contratError) throw contratError;

      // Upload des fichiers (m√™me logique que donation simple)
      // ... Upload de tous les fichiers testament

      setContrats((prev) => [contrat, ...prev]);
      setShowQuestionDialog(false);
      toast.success('Testament cr√©√© avec succ√®s');
      navigate(role === 'notaire' ? '/notaires/contracts' : '/avocats/contracts');
      
    } catch (err: unknown) {
      console.error('Erreur cr√©ation testament:', err);
      toast.error('Erreur lors de la cr√©ation du testament');
    }
  };

  const handleSuccessionSubmit = async () => {
    if (!user) return;
    
    // Validation des champs obligatoires
    if (!successionData.dateDeces || !successionData.lieuDeces || !successionData.communeDernierDomicile) {
      toast.error("Veuillez renseigner les informations g√©n√©rales sur le d√©c√®s");
      return;
    }
    
    if (!successionData.defunt.nom || !successionData.defunt.prenom || !successionData.defunt.dateNaissance || !successionData.defunt.situationMatrimoniale) {
      toast.error("Veuillez renseigner l'identit√© compl√®te du d√©funt");
      return;
    }
    
    if (!successionActeDeces) {
      toast.error("L'acte de d√©c√®s est obligatoire");
      return;
    }

    try {
      // G√©n√©rer la description d√©taill√©e
      let description = `D√âCLARATION DE SUCCESSION\n\n`;
      
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      description += `INFORMATIONS G√âN√âRALES\n`;
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      description += `Date du d√©c√®s : ${successionData.dateDeces}\n`;
      description += `Lieu du d√©c√®s : ${successionData.lieuDeces}\n`;
      description += `Commune du dernier domicile : ${successionData.communeDernierDomicile}\n`;
      if (successionData.numeroActeDeces) {
        description += `Num√©ro d'acte de d√©c√®s : ${successionData.numeroActeDeces}\n`;
      }
      if (successionData.notaireCharge) {
        description += `Notaire charg√© : ${successionData.notaireCharge}\n`;
      }
      description += `D√©claration dans les 6 mois : ${successionData.declarationDans6Mois ? "Oui" : "Non"}\n`;
      if (successionData.decesEtranger) {
        description += `‚ö†Ô∏è D√©c√®s √† l'√©tranger (d√©lai 12 mois)\n`;
      }
      description += `\n`;
      
      // Identit√© du d√©funt
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      description += `IDENTIT√â DU D√âFUNT\n`;
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      description += `${successionData.defunt.prenom} ${successionData.defunt.nom}\n`;
      if (successionData.defunt.nomNaissance) {
        description += `Nom de naissance : ${successionData.defunt.nomNaissance}\n`;
      }
      description += `N√©(e) le ${successionData.defunt.dateNaissance}`;
      if (successionData.defunt.lieuNaissance) {
        description += ` √† ${successionData.defunt.lieuNaissance}`;
      }
      description += `\n`;
      if (successionData.defunt.nationalite) {
        description += `Nationalit√© : ${successionData.defunt.nationalite}\n`;
      }
      if (successionData.defunt.profession) {
        description += `Profession : ${successionData.defunt.profession}\n`;
      }
      if (successionData.defunt.adresse) {
        description += `Adresse : ${successionData.defunt.adresse}\n`;
      }
      description += `\n`;
      
      // Situation familiale
      description += `SITUATION FAMILIALE\n`;
      description += `Situation matrimoniale : ${successionData.defunt.situationMatrimoniale}\n`;
      if (successionData.defunt.regimeMatrimonial) {
        description += `R√©gime matrimonial : ${successionData.defunt.regimeMatrimonial}\n`;
      }
      if (successionData.defunt.contratMariageExiste) {
        description += `‚úì Contrat de mariage existant\n`;
      }
      if (successionData.defunt.testamentExiste) {
        description += `‚úì Testament existant`;
        if (successionData.defunt.typeTestament) {
          description += ` (${successionData.defunt.typeTestament})`;
        }
        description += `\n`;
      }
      if (successionData.defunt.donationsAnterieuresExistent) {
        description += `‚úì Donations ant√©rieures\n`;
      }
      if (successionData.defunt.mandatProtectionFuture) {
        description += `‚úì Mandat de protection future\n`;
      }
      if (successionData.defunt.pacteSuccessoral) {
        description += `‚úì Pacte successoral\n`;
      }
      description += `\n`;
      
      // Pi√®ces fournies
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      description += `PI√àCES JUSTIFICATIVES FOURNIES\n`;
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      if (successionActeDeces) description += `‚úì Acte de d√©c√®s\n`;
      if (successionLivretFamille) description += `‚úì Livret de famille\n`;
      if (successionContratMariage) description += `‚úì Contrat de mariage\n`;
      if (successionTestament) description += `‚úì Testament\n`;
      if (successionTitresPropriete) description += `‚úì Titres de propri√©t√©\n`;
      if (successionAvisImposition) description += `‚úì Avis d'imposition\n`;
      if (successionRelevesBancaires) description += `‚úì Relev√©s bancaires\n`;
      if (successionAssuranceVie) description += `‚úì Contrats d'assurance-vie\n`;
      if (successionStatutsSocietes) description += `‚úì Statuts de soci√©t√©s\n`;
      if (successionJustifsDettes) description += `‚úì Justificatifs des dettes\n`;
      if (successionFactureFuneraires) description += `‚úì Facture pompes fun√®bres\n`;
      description += `\n`;
      
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      description += `NOTE\n`;
      description += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
      description += `Les informations d√©taill√©es sur les h√©ritiers, le patrimoine complet,\n`;
      description += `le passif et les donations seront compl√©t√©es par le notaire lors de\n`;
      description += `l'instruction du dossier de succession.\n`;
      description += `\nCes informations pr√©liminaires permettent de d√©marrer la proc√©dure.\n`;

      // Cr√©er le contrat
      const { data: contrat, error: contratError } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: `D√©claration de succession - ${successionData.defunt.nom}`,
          type: "D√©claration de succession",
          category: pendingCategory,
          role: role,
          description: description,
        })
        .select()
        .single();

      if (contratError) throw contratError;

      // Upload des fichiers
      const uploadFile = async (file: File | null, fieldName: string) => {
        if (!file) return;
        
        const filePath = `${user.id}/${contrat.id}/${fieldName}_${Date.now()}_${file.name}`;
        const { error: uploadError } = await supabase.storage
          .from('contrats')
          .upload(filePath, file);
        
        if (uploadError) {
          console.error(`Erreur upload ${fieldName}:`, uploadError);
        }
      };

      // Upload de tous les fichiers
      await Promise.all([
        uploadFile(successionActeDeces, 'acte_deces'),
        uploadFile(successionLivretFamille, 'livret_famille'),
        uploadFile(successionContratMariage, 'contrat_mariage'),
        uploadFile(successionTestament, 'testament'),
        uploadFile(successionTitresPropriete, 'titres_propriete'),
        uploadFile(successionAvisImposition, 'avis_imposition'),
        uploadFile(successionRelevesBancaires, 'releves_bancaires'),
        uploadFile(successionAssuranceVie, 'assurance_vie'),
        uploadFile(successionStatutsSocietes, 'statuts_societes'),
        uploadFile(successionJustifsDettes, 'justifs_dettes'),
        uploadFile(successionFactureFuneraires, 'facture_funeraires'),
      ]);

      setContrats((prev) => [contrat, ...prev]);
      setShowQuestionDialog(false);
      toast.success('D√©claration de succession cr√©√©e avec succ√®s');
      navigate(role === 'notaire' ? `/notaires/contrats/${contrat.id}` : `/avocats/contrats/${contrat.id}`);
      
    } catch (err: unknown) {
      console.error('Erreur cr√©ation succession:', err);
      toast.error('Erreur lors de la cr√©ation de la d√©claration de succession');
    }
  };

  const handleActeNotorieteSubmit = async () => {
    if (!user) return;
    
    try {
      // G√©n√©rer la description structur√©e
      let description = `ACTE DE NOTORI√âT√â\n\n`;
      description += `TYPE D'ACTE: ${acteNotorieteData.typeActe === "succession" ? "Succession (d√©termination des h√©ritiers)" : 
                                     acteNotorieteData.typeActe === "filiation" ? "Filiation / Possession d'√©tat" :
                                     acteNotorieteData.typeActe === "reconstitution_fait" ? "Reconstitution d'un fait juridique" :
                                     "Qualit√© h√©r√©ditaire particuli√®re"}\n\n`;
      
      // Informations d√©funt (si succession)
      if (acteNotorieteData.typeActe === "succession" && acteNotorieteData.defunt.nom) {
        description += `--- D√âFUNT ---\n`;
        description += `Nom : ${acteNotorieteData.defunt.nom}\n`;
        description += `Pr√©nom : ${acteNotorieteData.defunt.prenom}\n`;
        description += `Nom de naissance : ${acteNotorieteData.defunt.nomNaissance}\n`;
        description += `Date de naissance : ${acteNotorieteData.defunt.dateNaissance}\n`;
        description += `Lieu de naissance : ${acteNotorieteData.defunt.lieuNaissance}\n`;
        description += `Date de d√©c√®s : ${acteNotorieteData.defunt.dateDeces}\n`;
        description += `Lieu de d√©c√®s : ${acteNotorieteData.defunt.lieuDeces}\n`;
        description += `Situation matrimoniale : ${acteNotorieteData.defunt.situationMatrimoniale}\n`;
        if (acteNotorieteData.defunt.regimeMatrimonial) {
          description += `R√©gime matrimonial : ${acteNotorieteData.defunt.regimeMatrimonial}\n`;
        }
        description += `Testaments connus : ${acteNotorieteData.defunt.testamentsConnus ? "Oui" : "Non"}\n`;
        description += `\n`;
      }
      
      // H√©ritiers
      if (acteNotorieteData.heritiers.length > 0) {
        description += `--- H√âRITIERS (${acteNotorieteData.heritiers.length}) ---\n`;
        acteNotorieteData.heritiers.forEach((heritier, index) => {
          description += `\nH√©ritier ${index + 1}:\n`;
          description += `Nom : ${heritier.nom} ${heritier.prenom}\n`;
          description += `Lien de parent√© : ${heritier.lienParente}\n`;
          description += `Option successorale : ${heritier.optionSuccessorale}\n`;
          if (heritier.estMajeurProtege) {
            description += `Majeur prot√©g√© (${heritier.typeProtection}) - Tuteur : ${heritier.tuteurNom}\n`;
          }
        });
        description += `\n`;
      }
      
      // T√©moins
      if (acteNotorieteData.temoins.length > 0) {
        description += `--- T√âMOINS (${acteNotorieteData.temoins.length}) ---\n`;
        acteNotorieteData.temoins.forEach((temoin, index) => {
          description += `T√©moin ${index + 1}: ${temoin.nom} ${temoin.prenom} (${temoin.profession})\n`;
        });
        description += `\n`;
      }
      
      // Conjoint survivant
      if (acteNotorieteData.conjointSurvivant.existe) {
        description += `--- CONJOINT SURVIVANT ---\n`;
        description += `Donation entre √©poux existante : ${acteNotorieteData.conjointSurvivant.donationEntreEpouxExiste ? "Oui" : "Non"}\n`;
        description += `Election optionnelle : ${acteNotorieteData.conjointSurvivant.electionOptionnelle}\n`;
        description += `\n`;
      }

      // Cr√©er le contrat
      const { data: contrat, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: `Acte de notori√©t√© - ${acteNotorieteData.defunt.nom || "Non renseign√©"}`,
          type: "Acte de notori√©t√©",
          category: "Succession",
          role: role,
          description: description,
        })
        .select()
        .single();

      if (error) throw error;

      // Upload des fichiers avec await pour chaque fichier de chaque array
      const uploadFile = async (files: File[], subfolder: string) => {
        for (const file of files) {
          const filePath = `contrats/${contrat.id}/${subfolder}/${file.name}`;
          const { error: uploadError } = await supabase.storage
            .from('documents')
            .upload(filePath, file);
          if (uploadError) {
            console.error(`Erreur upload ${file.name}:`, uploadError);
          }
        }
      };

      // Upload tous les fichiers
      await Promise.all([
        // D√©funt
        uploadFile(acteNotorieteDefuntActeDeces, 'defunt_acte_deces'),
        uploadFile(acteNotorieteDefuntActeNaissance, 'defunt_acte_naissance'),
        uploadFile(acteNotorieteDefuntLivretFamille, 'defunt_livret_famille'),
        uploadFile(acteNotorieteDefuntActeMariage, 'defunt_acte_mariage'),
        uploadFile(acteNotorieteDefuntContratMariage, 'defunt_contrat_mariage'),
        uploadFile(acteNotorieteDefuntJugementDivorce, 'defunt_jugement_divorce'),
        uploadFile(acteNotorieteDefuntTestament, 'defunt_testament'),
        uploadFile(acteNotorieteDefuntDonations, 'defunt_donations'),
        uploadFile(acteNotorieteDefuntJustifDomicile, 'defunt_justif_domicile'),
        uploadFile(acteNotorieteDefuntPieceIdentite, 'defunt_piece_identite'),
        
        // Preuves filiation
        uploadFile(acteNotorietePreuvePhotos, 'preuves_photos'),
        uploadFile(acteNotorietePreuveCertificats, 'preuves_certificats'),
        uploadFile(acteNotorietePreuveDocumentsScolaires, 'preuves_documents_scolaires'),
        uploadFile(acteNotorietePreuveCorrespondances, 'preuves_correspondances'),
        uploadFile(acteNotorietePreuveAutres, 'preuves_autres'),
        
        // H√©ritiers collectifs
        uploadFile(acteNotorieteHeritiersActesNaissance, 'heritiers_actes_naissance'),
        uploadFile(acteNotorieteHeritiersPiecesIdentite, 'heritiers_pieces_identite'),
        uploadFile(acteNotorieteHeritiersJustifsDomicile, 'heritiers_justifs_domicile'),
        uploadFile(acteNotorieteHeritiersLivretsFamille, 'heritiers_livrets_famille'),
        uploadFile(acteNotorieteHeritiersActesNotoriete, 'heritiers_actes_notoriete'),
        uploadFile(acteNotorieteHeritiersCertificatsHeredite, 'heritiers_certificats_heredite'),
        uploadFile(acteNotorieteHeritiersTutelleCuratelle, 'heritiers_tutelle_curatelle'),
        
        // T√©moins collectifs
        uploadFile(acteNotorieteTemoinsPiecesIdentite, 'temoins_pieces_identite'),
        uploadFile(acteNotorieteTemoinsJustifsDomicile, 'temoins_justifs_domicile'),
        
        // Autres documents
        uploadFile(acteNotorieteAutresAttestations, 'autres_attestations'),
        uploadFile(acteNotorieteAutresCertificatsMedicaux, 'autres_certificats_medicaux'),
        uploadFile(acteNotorieteAutresCorrespondances, 'autres_correspondances'),
        uploadFile(acteNotorieteAutresDocuments, 'autres_documents'),
      ]);
      
      // Upload des fichiers h√©ritiers individuels (dynamiques)
      for (const heritierId of Object.keys(acteNotorieteHeritierFiles)) {
        const id = Number(heritierId);
        await uploadFile(acteNotorieteHeritierFiles[id] || [], `heritier_${id}_documents`);
      }
      
      // Upload des fichiers t√©moins individuels (dynamiques)
      for (const temoinId of Object.keys(acteNotorieteTemoinFiles)) {
        const id = Number(temoinId);
        await uploadFile(acteNotorieteTemoinFiles[id] || [], `temoin_${id}_documents`);
      }

      setContrats((prev) => [contrat, ...prev]);
      setShowQuestionDialog(false);
      toast.success('Acte de notori√©t√© cr√©√© avec succ√®s');
      navigate(role === 'notaire' ? `/notaires/contrats/${contrat.id}` : `/avocats/contrats/${contrat.id}`);
      
    } catch (err: unknown) {
      console.error('Erreur cr√©ation acte de notori√©t√©:', err);
      toast.error("Erreur lors de la cr√©ation de l'acte de notori√©t√©");
    }
  };

  const handlePartageSuccessoralSubmit = async () => {
    if (!user) return;
    
    try {
      // G√©n√©rer la description structur√©e
      let description = `PARTAGE SUCCESSORAL\n\n`;
      
      // D√©funt
      description += `--- D√âFUNT ---\n`;
      description += `${partageSuccessoralData.succession.defunt.prenom} ${partageSuccessoralData.succession.defunt.nom}\n`;
      description += `N√©(e) le ${partageSuccessoralData.succession.defunt.dateNaissance} √† ${partageSuccessoralData.succession.defunt.lieuNaissance}\n`;
      description += `D√©c√©d√©(e) le ${partageSuccessoralData.succession.defunt.dateDeces} √† ${partageSuccessoralData.succession.defunt.lieuDeces}\n`;
      description += `R√©gime matrimonial : ${partageSuccessoralData.succession.defunt.regimeMatrimonial}\n\n`;
      
      // H√©ritiers
      description += `--- H√âRITIERS (${partageSuccessoralData.heritiers.length}) ---\n`;
      partageSuccessoralData.heritiers.forEach((heritier, index) => {
        description += `${index + 1}. ${heritier.prenom} ${heritier.nom} (${heritier.lienDefunt})\n`;
        description += `   Quote-part : ${heritier.quotePart}\n`;
        description += `   Statut : ${heritier.acceptationRenonciation || "Accepte"}\n`;
      });
      description += `\n`;
      
      // Type de partage
      description += `--- TYPE DE PARTAGE ---\n`;
      description += `${partageSuccessoralData.partage.typePartage === "total" ? "Partage total" :
                       partageSuccessoralData.partage.typePartage === "partiel" ? "Partage partiel" :
                       partageSuccessoralData.partage.typePartage === "attribution_preferentielle" ? "Attribution pr√©f√©rentielle" :
                       partageSuccessoralData.partage.typePartage === "amiable" ? "Partage amiable" :
                       "Partage judiciaire"}\n\n`;
      
      // Actif
      if (partageSuccessoralData.actif.biensImmobiliers.length > 0) {
        description += `--- BIENS IMMOBILIERS (${partageSuccessoralData.actif.biensImmobiliers.length}) ---\n`;
        partageSuccessoralData.actif.biensImmobiliers.forEach((bien, index) => {
          description += `${index + 1}. ${bien.adresse} - Valeur : ${bien.valeurVenale}‚Ç¨\n`;
        });
        description += `\n`;
      }
      
      // Lots
      if (partageSuccessoralData.partage.lots.length > 0) {
        description += `--- LOTS DE PARTAGE (${partageSuccessoralData.partage.lots.length}) ---\n`;
        partageSuccessoralData.partage.lots.forEach((lot, index) => {
          description += `Lot ${index + 1} : ${lot.nomLot}\n`;
          description += `   Valeur : ${lot.valeurTotale}‚Ç¨\n`;
          description += `   Attribution : ${lot.attributionHeritier}\n`;
          if (lot.soulte) description += `   Soulte : ${lot.soulte}‚Ç¨\n`;
        });
      }

      // Cr√©er le contrat
      const { data: contrat, error } = await supabase
        .from('contrats')
        .insert({
          owner_id: user.id,
          name: `Partage successoral - ${partageSuccessoralData.succession.defunt.nom}`,
          type: "Partage successoral",
          category: "Succession",
          role: role,
          description: description,
        })
        .select()
        .single();

      if (error) throw error;

      // Upload des fichiers
      const uploadFile = async (files: File[], subfolder: string) => {
        for (const file of files) {
          const filePath = `contrats/${contrat.id}/${subfolder}/${file.name}`;
          const { error: uploadError } = await supabase.storage
            .from('documents')
            .upload(filePath, file);
          if (uploadError) {
            console.error(`Erreur upload ${file.name}:`, uploadError);
          }
        }
      };

      // Upload tous les fichiers
      await Promise.all([
        // D√©funt
        uploadFile(partageDefuntActeDeces, 'defunt_acte_deces'),
        uploadFile(partageDefuntLivretFamille, 'defunt_livret_famille'),
        uploadFile(partageDefuntContratMariage, 'defunt_contrat_mariage'),
        uploadFile(partageDefuntTestaments, 'defunt_testaments'),
        uploadFile(partageDefuntDonationsEntreEpoux, 'defunt_donations_entre_epoux'),
        uploadFile(partageDefuntDonationsAnterieures, 'defunt_donations_anterieures'),
        uploadFile(partageDefuntTitresPropriete, 'defunt_titres_propriete'),
        uploadFile(partageDefuntRelevesBancaires, 'defunt_releves_bancaires'),
        uploadFile(partageDefuntBilansEntreprises, 'defunt_bilans_entreprises'),
        uploadFile(partageDefuntInventaireMobilier, 'defunt_inventaire_mobilier'),
        
        // Autres documents
        uploadFile(partageAutresDiagnostics, 'autres_diagnostics'),
        uploadFile(partageAutresEvaluations, 'autres_evaluations'),
        uploadFile(partageAutresStatutsSocietes, 'autres_statuts_societes'),
        uploadFile(partageAutresDocuments, 'autres_documents'),
      ]);
      
      // Upload des fichiers h√©ritiers (dynamiques)
      for (const heritierId of Object.keys(partageHeritierFiles)) {
        const id = Number(heritierId);
        await uploadFile(partageHeritierFiles[id] || [], `heritier_${id}_documents`);
      }
      
      // Upload des fichiers biens immobiliers (dynamiques)
      for (const bienId of Object.keys(partageBienImmobilierFiles)) {
        const id = Number(bienId);
        await uploadFile(partageBienImmobilierFiles[id] || [], `bien_immobilier_${id}_documents`);
      }

      setContrats((prev) => [contrat, ...prev]);
      setShowQuestionDialog(false);
      toast.success('Partage successoral cr√©√© avec succ√®s');
      navigate(role === 'notaire' ? `/notaires/contrats/${contrat.id}` : `/avocats/contrats/${contrat.id}`);
      
    } catch (err: unknown) {
      console.error('Erreur cr√©ation partage successoral:', err);
      toast.error("Erreur lors de la cr√©ation du partage successoral");
    }
  };

  const handleChangementRegimeSubmit = async () => {
    if (!user) return;
    
    toast.error("La fonction de cr√©ation du changement de r√©gime matrimonial n'est pas encore impl√©ment√©e");
  };

  const handleDelete = async (contrat: ContratRow) => {
    if (!user) return;
    if (!confirm(`Supprimer "${contrat.name}" ?`)) return;
    
    try {
      const { error } = await supabase
        .from('contrats')
        .delete()
        .eq('id', contrat.id)
        .eq('owner_id', user.id);
      
      if (error) throw error;
      
      setContrats((prev) => prev.filter((c) => c.id !== contrat.id));
      toast.success('Contrat supprim√©');
    } catch (err: unknown) {
      console.error('Erreur suppression contrat:', err);
      const message = err instanceof Error ? err.message : String(err);
      toast.error('Erreur lors de la suppression', { description: message });
    }
  };

  const handleView = (contrat: ContratRow) => {
    navigate(role === 'notaire' ? `/notaires/contrats/${contrat.id}` : `/avocats/contrats/${contrat.id}`);
  };

  // R√©sultats d√©j√† filtr√©s c√¥t√© SQL
  const filteredContrats = contrats;

  return (
    <AppLayout>
      <div className="p-6">
        <div className="flex items-center justify-between mb-6">
          <div>
            <h1 className="text-3xl font-bold">{role === 'notaire' ? 'Actes' : 'Contrats'}</h1>
            <p className="text-foreground mt-1">
              Centralisez et cr√©ez vos mod√®les de contrats
            </p>
          </div>
          <div>
            <DropdownMenu>
              <DropdownMenuTrigger asChild>
                <Button className={mainButtonColor}>
                  <Plus className="h-4 w-4 mr-2" />
                  Ajouter
                </Button>
              </DropdownMenuTrigger>
              <DropdownMenuContent align="end" className={menuContentClass}>
                <DropdownMenuItem className={role === 'notaire' ? 'focus:bg-orange-600 focus:text-white' : 'focus:bg-blue-600 focus:text-white'} onClick={() => window.location.href = (role === 'notaire' ? '/notaires/documents?openImport=1' : '/avocats/documents?openImport=1')}>
                  <Upload className="mr-2 h-4 w-4" />
                  Importer depuis mon appareil
                </DropdownMenuItem>

                <DropdownMenuSub>
                    <DropdownMenuSubTrigger className={role === 'notaire' ? 'font-semibold hover:bg-orange-600 hover:text-white focus:bg-orange-600 focus:text-white data-[state=open]:bg-orange-600 data-[state=open]:text-white' : 'font-semibold hover:bg-blue-600 hover:text-white focus:bg-blue-600 focus:text-white data-[state=open]:bg-blue-600 data-[state=open]:text-white'}>Cr√©er un contrat</DropdownMenuSubTrigger>
                  <DropdownMenuSubContent className={menuContentClass}>
                    {(role === 'notaire' ? NOTAIRE_CONTRACT_CATEGORIES : AVOCAT_CONTRACT_CATEGORIES).map((cat) => (
                      <DropdownMenuSub key={cat.key}>
                          <DropdownMenuSubTrigger className={role === 'notaire' ? 'font-semibold hover:bg-orange-600 hover:text-white focus:bg-orange-600 focus:text-white data-[state=open]:bg-orange-600 data-[state=open]:text-white' : 'font-semibold hover:bg-blue-600 hover:text-white focus:bg-blue-600 focus:text-white data-[state=open]:bg-blue-600 data-[state=open]:text-white'}>{cat.label}</DropdownMenuSubTrigger>
                            <DropdownMenuSubContent className={menuContentClass}>
                          {cat.contracts.map((contract) => (
                            <DropdownMenuItem
                              key={contract}
                              className={role === 'notaire' ? 'cursor-pointer hover:bg-orange-600 hover:text-white focus:bg-orange-600 focus:text-white' : 'cursor-pointer hover:bg-blue-600 hover:text-white focus:bg-blue-600 focus:text-white'}
                              onClick={() => createContract(contract, cat.key)}
                            >
                              {contract}
                            </DropdownMenuItem>
                          ))}
                        </DropdownMenuSubContent>
                      </DropdownMenuSub>
                    ))}
                  </DropdownMenuSubContent>
                </DropdownMenuSub>
              </DropdownMenuContent>
            </DropdownMenu>
          </div>
        </div>

        {loading ? (
          <div className="flex items-center justify-center h-[400px] border border-dashed border-border rounded-lg">
            <p className="text-foreground">Chargement‚Ä¶</p>
          </div>
        ) : contrats.length === 0 ? (
          <div className="flex items-center justify-center h-[400px] border border-dashed border-border rounded-lg">
            <div className="text-center">
              <p className="text-foreground">Aucun contrat pour le moment</p>
              <div className="mt-4 flex justify-center">
                <DropdownMenu>
                  <DropdownMenuTrigger asChild>
                    <Button className={mainButtonColor}>
                      <Plus className="h-4 w-4 mr-2" />
                      Ajouter
                    </Button>
                  </DropdownMenuTrigger>
                  <DropdownMenuContent align="end" className={menuContentClass}>
                    <DropdownMenuSub>
                      <DropdownMenuSubTrigger className={`font-semibold ${role === 'notaire' ? 'hover:bg-orange-600 hover:text-white focus:bg-orange-600 focus:text-white' : 'hover:bg-blue-600 hover:text-white focus:bg-blue-600 focus:text-white'}`}>Cr√©er un contrat</DropdownMenuSubTrigger>
                      <DropdownMenuSubContent className={menuContentClass}>
                        {(role === 'notaire' ? NOTAIRE_CONTRACT_CATEGORIES : AVOCAT_CONTRACT_CATEGORIES).map((cat) => (
                          <DropdownMenuSub key={cat.key}>
                            <DropdownMenuSubTrigger className={`font-semibold ${role === 'notaire' ? 'hover:bg-orange-600 hover:text-white focus:bg-orange-600 focus:text-white' : 'hover:bg-blue-600 hover:text-white focus:bg-blue-600 focus:text-white'}`}>{cat.label}</DropdownMenuSubTrigger>
                            <DropdownMenuSubContent className={menuContentClass}>
                              {cat.contracts.map((contract) => (
                                <DropdownMenuItem
                                  key={contract}
                                  className={role === 'notaire' ? 'cursor-pointer hover:bg-orange-600 hover:text-white focus:bg-orange-600 focus:text-white' : 'cursor-pointer hover:bg-blue-600 hover:text-white focus:bg-blue-600 focus:text-white'}
                                  onClick={() => createContract(contract, cat.key)}
                                >
                                  {contract}
                                </DropdownMenuItem>
                              ))}
                            </DropdownMenuSubContent>
                          </DropdownMenuSub>
                        ))}
                      </DropdownMenuSubContent>
                    </DropdownMenuSub>
                  </DropdownMenuContent>
                </DropdownMenu>
              </div>
            </div>
          </div>
        ) : (
          <>
            <div className="flex items-center gap-4 mb-4 bg-white p-4 rounded-lg border">
              <div className="relative flex-1">
                <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-foreground" />
                <Input
                  placeholder="Rechercher un contrat..."
                  value={search}
                  onChange={(e) => setSearch(e.target.value)}
                  className="pl-10 bg-white text-foreground placeholder:text-foreground/50"
                />
              </div>
              <Select value={categoryFilter} onValueChange={setCategoryFilter}>
                <SelectTrigger className="w-[280px]">
                  <SelectValue placeholder="Cat√©gorie" />
                </SelectTrigger>
                <SelectContent className={selectContentClass}>
                  {(role === 'notaire' ? categoriesNotaire : categoriesAvocat).map((cat) => (
                    <SelectItem key={cat} value={cat} className={selectItemClass}>
                      {cat}
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>

            <Card>
              <CardHeader>
                <CardTitle className="text-lg">{role === 'notaire' ? 'Liste des actes' : 'Liste des contrats'}</CardTitle>
              </CardHeader>
              <CardContent>
                <div className="border rounded-lg bg-white">
                  <Table>
                <TableHeader>
                  <TableRow>
                    <TableHead>Nom du contrat</TableHead>
                    <TableHead>Type</TableHead>
                    <TableHead>Cat√©gorie</TableHead>
                    <TableHead>Cr√©√© le</TableHead>
                    <TableHead className="w-[50px]"></TableHead>
                  </TableRow>
                </TableHeader>
                <TableBody>
                  {filteredContrats.length === 0 ? (
                    <TableRow>
                      <TableCell colSpan={5} className="text-center text-foreground">
                        Aucun contrat trouv√©
                      </TableCell>
                    </TableRow>
                  ) : (
                    filteredContrats.map((contrat) => (
                      <TableRow key={contrat.id}>
                        <TableCell className="font-medium">{contrat.name}</TableCell>
                        <TableCell className="text-sm text-foreground">{contrat.type}</TableCell>
                        <TableCell>
                          <Badge variant="outline" className={
                            role === 'notaire'
                              ? 'bg-orange-100 text-orange-600 border-orange-200'
                              : 'bg-blue-100 text-blue-600 border-blue-200'
                          }>
                            {contrat.category}
                          </Badge>
                        </TableCell>
                        <TableCell className="text-sm text-foreground">
                          {new Date(contrat.created_at).toLocaleDateString()}
                        </TableCell>
                        <TableCell>
                          <div className="flex items-center gap-1">
                            <ShareToCollaborativeDialog
                              itemId={contrat.id}
                              itemName={contrat.name}
                              itemType="contrat"
                              role={role}
                              onSuccess={() => {
                                toast.success('Contrat partag√©');
                              }}
                            />
                            <DropdownMenu>
                              <DropdownMenuTrigger asChild>
                                <Button 
                                  variant="ghost" 
                                  size="icon"
                                  className={role === 'notaire' ? 'hover:bg-orange-100 hover:text-orange-600' : 'hover:bg-blue-100 hover:text-blue-600'}
                                >
                                  <MoreHorizontal className="h-4 w-4" />
                                </Button>
                              </DropdownMenuTrigger>
                              <DropdownMenuContent align="end" className={menuContentClass}>
                                <DropdownMenuItem 
                                  className={menuItemClass}
                                  onClick={() => handleView(contrat)}
                                >
                                  <Eye className="mr-2 h-4 w-4" />
                                  Voir
                                </DropdownMenuItem>
                                <DropdownMenuItem 
                                  className={`text-destructive ${menuItemClass}`}
                                  onClick={() => handleDelete(contrat)}
                                >
                                  <Trash2 className="mr-2 h-4 w-4" />
                                  Supprimer
                                </DropdownMenuItem>
                              </DropdownMenuContent>
                            </DropdownMenu>
                          </div>
                        </TableCell>
                      </TableRow>
                    ))
                  )}
                </TableBody>
                  </Table>
                </div>
              </CardContent>
            </Card>
          </>
        )}
      </div>

      {/* Dialog questionnaire pour compromis de vente / acte de vente */}
      <Dialog open={showQuestionDialog} onOpenChange={setShowQuestionDialog}>
        <DialogContent className="max-w-4xl max-h-[90vh] overflow-y-auto">
          <DialogHeader>
            <DialogTitle>
              {pendingContractType === "Compromis de vente / Promesse unilat√©rale de vente"
                ? (questionnaireData.typeContrat === "promesse_unilaterale" 
                    ? "Informations pour la promesse unilat√©rale de vente"
                    : "Informations pour le compromis de vente")
                : pendingContractType === "Acte de vente immobili√®re" 
                ? "Informations pour l'acte de vente immobili√®re" 
                : (pendingContractType === "Bail d'habitation vide" || pendingContractType === "Bail d'habitation meubl√©")
                ? "Informations pour le bail d'habitation"
                : pendingContractType === "Bail commercial / professionnel"
                ? (bailCommercialData.typeBail === "commercial" 
                    ? "Informations pour le bail commercial"
                    : bailCommercialData.typeBail === "professionnel"
                    ? "Informations pour le bail professionnel" 
                    : "Informations pour le bail commercial / professionnel")
                : pendingContractType === "Convention d'indivision"
                ? "Informations pour la convention d'indivision"
                : pendingContractType === "Mainlev√©e d'hypoth√®que"
                ? "Informations pour la mainlev√©e d'hypoth√®que"
                : pendingContractType === "Contrat de mariage (r√©gimes matrimoniaux)"
                ? "Informations pour le contrat de mariage"
                : pendingContractType === "PACS (convention + enregistrement)"
                ? "Informations pour le PACS"
                : pendingContractType === "Donation entre √©poux"
                ? "Informations pour la donation entre √©poux"
                : pendingContractType === "Donation simple (parent ‚Üí enfant, etc.)"
                ? "Informations pour la donation simple"
                : pendingContractType === "Testament authentique ou mystique"
                ? "Informations pour le testament"
                : pendingContractType === "Acte de notori√©t√©"
                ? "Informations pour l'acte de notori√©t√©"
                : pendingContractType === "Partage successoral"
                ? "Informations pour le partage successoral"
                : pendingContractType === "Procuration authentique"
                ? "Informations pour la procuration authentique"
                : pendingContractType === "Procuration notari√©e li√©e √† la succession"
                ? "Informations pour la procuration notari√©e li√©e √† la succession"
                : pendingContractType === "Mandat de protection future"
                ? "Informations pour le mandat de protection future"
                : pendingContractType === "Attestation de propri√©t√© immobili√®re"
                ? "Informations pour l'attestation de propri√©t√© immobili√®re"
                : pendingContractType === "Quitus / reconnaissance de dette"
                ? "Informations pour le quitus / reconnaissance de dette"
                : pendingContractType === "Changement de r√©gime matrimonial"
                ? "Informations pour le changement de r√©gime matrimonial"
                : pendingContractType === "D√©claration de succession"
                ? "Informations pour la d√©claration de succession"
                : "Informations pour le " + (pendingContractType || "contrat").toLowerCase()}
            </DialogTitle>
            <DialogDescription>
              Remplissez les informations suivantes pour pr√©parer le document. Ces informations aideront l'IA √† r√©diger un contrat personnalis√©.
            </DialogDescription>
          </DialogHeader>

          <div className="space-y-6 mt-4">
            {/* Formulaire sp√©cifique pour Compromis de vente */}
            {pendingContractType === "Compromis de vente / Promesse unilat√©rale de vente" && (
              <>
            {/* Choix du type de contrat */}
            <div className="space-y-4 bg-muted/50 p-4 rounded-lg">
              <h3 className="font-semibold text-lg">Type de contrat *</h3>
              <RadioGroup 
                value={questionnaireData.typeContrat}
                onValueChange={(value) => setQuestionnaireData({...questionnaireData, typeContrat: value})}
              >
                <div className="flex items-center space-x-2">
                  <RadioGroupItem value="compromis" id="compromis" />
                  <Label htmlFor="compromis" className="cursor-pointer">Compromis de vente</Label>
                </div>
                <div className="flex items-center space-x-2">
                  <RadioGroupItem value="promesse_unilaterale" id="promesse_unilaterale" />
                  <Label htmlFor="promesse_unilaterale" className="cursor-pointer">Promesse unilat√©rale de vente</Label>
                </div>
              </RadioGroup>
            </div>

            {/* S√©lection du r√¥le du client */}
            <div className="space-y-4">
              <h3 className="font-semibold text-lg border-b pb-2">R√¥le du client</h3>
              <div className="space-y-2">
                <Label>Votre client est : *</Label>
                <RadioGroup 
                  value={questionnaireData.clientRole}
                  onValueChange={(value) => setQuestionnaireData({...questionnaireData, clientRole: value})}
                >
                  <div className="flex items-center space-x-2">
                    <RadioGroupItem value="vendeur" id="vendeur" />
                    <Label htmlFor="vendeur" className="cursor-pointer">Vendeur</Label>
                  </div>
                  <div className="flex items-center space-x-2">
                    <RadioGroupItem value="acheteur" id="acheteur" />
                    <Label htmlFor="acheteur" className="cursor-pointer">Acqu√©reur</Label>
                  </div>
                </RadioGroup>
              </div>
            </div>

            {/* Section Vendeur */}
            <div className="space-y-4">
              <h3 className="font-semibold text-lg border-b pb-2">üë§ Vendeur</h3>
              <div className="space-y-4">
                {questionnaireData.clientRole === "vendeur" ? (
                  <>
                    {/* Le client est le vendeur */}
                    <div className="space-y-2">
                      <Label htmlFor="clientId">S√©lectionner votre client *</Label>
                      <Select 
                        value={questionnaireData.clientId}
                        onValueChange={(value) => setQuestionnaireData({...questionnaireData, clientId: value})}
                      >
                        <SelectTrigger>
                          <SelectValue placeholder="Choisir un client" />
                        </SelectTrigger>
                        <SelectContent>
                          {clients.map((client) => (
                            <SelectItem key={client.id} value={client.id}>
                              {client.nom} {client.prenom}
                            </SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                    </div>

                    {/* Afficher les informations du client s√©lectionn√© */}
                    {questionnaireData.clientId && clients.find(c => c.id === questionnaireData.clientId) && (
                      <div className="p-4 bg-muted/50 rounded-lg space-y-2 text-sm">
                        <p><strong>Nom complet:</strong> {clients.find(c => c.id === questionnaireData.clientId)?.nom} {clients.find(c => c.id === questionnaireData.clientId)?.prenom}</p>
                        {clients.find(c => c.id === questionnaireData.clientId)?.adresse && (
                          <p><strong>Adresse:</strong> {clients.find(c => c.id === questionnaireData.clientId)?.adresse}</p>
                        )}
                        {clients.find(c => c.id === questionnaireData.clientId)?.telephone && (
                          <p><strong>T√©l√©phone:</strong> {clients.find(c => c.id === questionnaireData.clientId)?.telephone}</p>
                        )}
                        {clients.find(c => c.id === questionnaireData.clientId)?.email && (
                          <p><strong>Email:</strong> {clients.find(c => c.id === questionnaireData.clientId)?.email}</p>
                        )}
                        {clients.find(c => c.id === questionnaireData.clientId)?.date_naissance && (
                          <p><strong>Date de naissance:</strong> {new Date(clients.find(c => c.id === questionnaireData.clientId)?.date_naissance).toLocaleDateString('fr-FR')}</p>
                        )}
                        {clients.find(c => c.id === questionnaireData.clientId)?.nationalite && (
                          <p><strong>Nationalit√©:</strong> {clients.find(c => c.id === questionnaireData.clientId)?.nationalite}</p>
                        )}
                      </div>
                    )}

                    {/* Statut matrimonial du client vendeur */}
                    <div className="space-y-2">
                      <Label htmlFor="statutMatrimonialClient">Statut matrimonial *</Label>
                      <Input 
                        id="statutMatrimonialClient"
                        value={questionnaireData.statutMatrimonialClient} 
                        onChange={(e) => setQuestionnaireData({...questionnaireData, statutMatrimonialClient: e.target.value})}
                        placeholder="Ex: C√©libataire, Mari√©, Pacs√©, Divorc√©, Veuf"
                      />
                    </div>

                    {(questionnaireData.statutMatrimonialClient === "marie" || questionnaireData.statutMatrimonialClient === "pacse") && (
                      <>
                        <div className="space-y-2">
                          <Label htmlFor="regimeMatrimonialClient">R√©gime matrimonial *</Label>
                          <Select value={questionnaireData.regimeMatrimonialClient} onValueChange={(value) => setQuestionnaireData({...questionnaireData, regimeMatrimonialClient: value})}>
                            <SelectTrigger>
                              <SelectValue placeholder="S√©lectionner..." />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="communaute_legale">Communaut√© l√©gale</SelectItem>
                              <SelectItem value="separation_biens">S√©paration de biens</SelectItem>
                              <SelectItem value="autre">Autre</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        {questionnaireData.regimeMatrimonialClient === "autre" && (
                          <div className="space-y-2">
                            <Label htmlFor="precisionRegimeClient">Pr√©ciser le r√©gime</Label>
                            <Input 
                              id="precisionRegimeClient"
                              value={questionnaireData.precisionRegimeClient}
                              onChange={(e) => setQuestionnaireData({...questionnaireData, precisionRegimeClient: e.target.value})}
                              placeholder="Pr√©cisez le r√©gime matrimonial..."
                            />
                          </div>
                        )}
                      </>
                    )}

                    {/* Pi√®ce d'identit√© du client vendeur */}
                    {questionnaireData.clientId && (
                      <div className="space-y-2">
                        <Label>üìé Pi√®ce d'identit√©</Label>
                        {compromisClientIdentiteUrl ? (
                          <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg">
                            <svg className="w-4 h-4 text-green-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <span className="text-sm flex-1 text-green-700">Pi√®ce d'identit√© charg√©e depuis le profil client</span>
                            <Button
                              type="button"
                              variant="ghost"
                              size="sm"
                              className="bg-green-600 hover:bg-green-700 text-white"
                              onClick={() => window.open(compromisClientIdentiteUrl, '_blank')}
                            >
                              <Eye className="w-4 h-4" />
                            </Button>
                          </div>
                        ) : (
                          <div className="flex items-center gap-2 p-2 bg-orange-50 border border-orange-200 rounded-lg">
                            <svg className="w-4 h-4 text-orange-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                            </svg>
                            <span className="text-sm flex-1 text-orange-700">Aucune pi√®ce d'identit√© dans le profil client</span>
                          </div>
                        )}
                      </div>
                    )}
                  </>
                ) : (
                  <>
                    {/* Saisie manuelle vendeur (le client est acheteur) */}
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label htmlFor="nomAutrePartie">Nom *</Label>
                        <Input 
                          id="nomAutrePartie"
                          value={questionnaireData.nomAutrePartie}
                          onChange={(e) => setQuestionnaireData({...questionnaireData, nomAutrePartie: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="prenomAutrePartie">Pr√©nom *</Label>
                        <Input 
                          id="prenomAutrePartie"
                          value={questionnaireData.prenomAutrePartie}
                          onChange={(e) => setQuestionnaireData({...questionnaireData, prenomAutrePartie: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2 md:col-span-2">
                        <Label htmlFor="adresseAutrePartie">Adresse compl√®te *</Label>
                        <Input 
                          id="adresseAutrePartie"
                          value={questionnaireData.adresseAutrePartie}
                          onChange={(e) => setQuestionnaireData({...questionnaireData, adresseAutrePartie: e.target.value})}
                        />
                      </div>

                      {/* Statut matrimonial autre partie */}
                      <div className="space-y-2">
                        <Label htmlFor="statutMatrimonialAutrePartie">Statut matrimonial *</Label>
                        <Select value={questionnaireData.statutMatrimonialAutrePartie} onValueChange={(value) => setQuestionnaireData({...questionnaireData, statutMatrimonialAutrePartie: value})}>
                          <SelectTrigger>
                            <SelectValue placeholder="S√©lectionner..." />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="celibataire">C√©libataire</SelectItem>
                            <SelectItem value="marie">Mari√©</SelectItem>
                            <SelectItem value="pacse">Pacs√©</SelectItem>
                            <SelectItem value="divorce">Divorc√©</SelectItem>
                            <SelectItem value="veuf">Veuf</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {(questionnaireData.statutMatrimonialAutrePartie === "marie" || questionnaireData.statutMatrimonialAutrePartie === "pacse") && (
                        <>
                          <div className="space-y-2">
                            <Label htmlFor="regimeMatrimonialAutrePartie">R√©gime matrimonial *</Label>
                            <Select value={questionnaireData.regimeMatrimonialAutrePartie} onValueChange={(value) => setQuestionnaireData({...questionnaireData, regimeMatrimonialAutrePartie: value})}>
                              <SelectTrigger>
                                <SelectValue placeholder="S√©lectionner..." />
                              </SelectTrigger>
                              <SelectContent>
                                <SelectItem value="communaute_legale">Communaut√© l√©gale</SelectItem>
                                <SelectItem value="separation_biens">S√©paration de biens</SelectItem>
                                <SelectItem value="autre">Autre</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>
                          {questionnaireData.regimeMatrimonialAutrePartie === "autre" && (
                            <div className="space-y-2 md:col-span-2">
                              <Label htmlFor="precisionRegimeAutrePartie">Pr√©ciser le r√©gime</Label>
                              <Input 
                                id="precisionRegimeAutrePartie"
                                value={questionnaireData.precisionRegimeAutrePartie}
                                onChange={(e) => setQuestionnaireData({...questionnaireData, precisionRegimeAutrePartie: e.target.value})}
                                placeholder="Pr√©cisez le r√©gime matrimonial..."
                              />
                            </div>
                          )}
                        </>
                      )}
                    </div>
                  </>
                )}
              </div>
            </div>

            {/* Section Acqu√©reur */}
            <div className="space-y-4">
              <h3 className="font-semibold text-lg border-b pb-2">üë• Acqu√©reur</h3>
              <div className="space-y-4">
                {questionnaireData.clientRole === "acheteur" ? (
                  <>
                    {/* Le client est l'acheteur */}
                    <div className="space-y-2">
                      <Label htmlFor="clientId">S√©lectionner votre client *</Label>
                      <Select 
                        value={questionnaireData.clientId}
                        onValueChange={(value) => setQuestionnaireData({...questionnaireData, clientId: value})}
                      >
                        <SelectTrigger>
                          <SelectValue placeholder="Choisir un client" />
                        </SelectTrigger>
                        <SelectContent>
                          {clients.map((client) => (
                            <SelectItem key={client.id} value={client.id}>
                              {client.nom} {client.prenom}
                            </SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                    </div>

                    {/* Afficher les informations du client s√©lectionn√© */}
                    {questionnaireData.clientId && clients.find(c => c.id === questionnaireData.clientId) && (
                      <div className="p-4 bg-muted/50 rounded-lg space-y-2 text-sm">
                        <p><strong>Nom complet:</strong> {clients.find(c => c.id === questionnaireData.clientId)?.nom} {clients.find(c => c.id === questionnaireData.clientId)?.prenom}</p>
                        {clients.find(c => c.id === questionnaireData.clientId)?.adresse && (
                          <p><strong>Adresse:</strong> {clients.find(c => c.id === questionnaireData.clientId)?.adresse}</p>
                        )}
                        {clients.find(c => c.id === questionnaireData.clientId)?.telephone && (
                          <p><strong>T√©l√©phone:</strong> {clients.find(c => c.id === questionnaireData.clientId)?.telephone}</p>
                        )}
                        {clients.find(c => c.id === questionnaireData.clientId)?.email && (
                          <p><strong>Email:</strong> {clients.find(c => c.id === questionnaireData.clientId)?.email}</p>
                        )}
                        {clients.find(c => c.id === questionnaireData.clientId)?.date_naissance && (
                          <p><strong>Date de naissance:</strong> {new Date(clients.find(c => c.id === questionnaireData.clientId)?.date_naissance).toLocaleDateString('fr-FR')}</p>
                        )}
                        {clients.find(c => c.id === questionnaireData.clientId)?.nationalite && (
                          <p><strong>Nationalit√©:</strong> {clients.find(c => c.id === questionnaireData.clientId)?.nationalite}</p>
                        )}
                      </div>
                    )}

                    {/* Statut matrimonial du client acheteur */}
                    <div className="space-y-2">
                      <Label htmlFor="statutMatrimonialClient">Statut matrimonial *</Label>
                      <Input 
                        id="statutMatrimonialClient"
                        value={questionnaireData.statutMatrimonialClient} 
                        onChange={(e) => setQuestionnaireData({...questionnaireData, statutMatrimonialClient: e.target.value})}
                        placeholder="Ex: C√©libataire, Mari√©, Pacs√©, Divorc√©, Veuf"
                      />
                    </div>

                    {(questionnaireData.statutMatrimonialClient === "marie" || questionnaireData.statutMatrimonialClient === "pacse") && (
                      <>
                        <div className="space-y-2">
                          <Label htmlFor="regimeMatrimonialClient">R√©gime matrimonial *</Label>
                          <Select value={questionnaireData.regimeMatrimonialClient} onValueChange={(value) => setQuestionnaireData({...questionnaireData, regimeMatrimonialClient: value})}>
                            <SelectTrigger>
                              <SelectValue placeholder="S√©lectionner..." />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="communaute_legale">Communaut√© l√©gale</SelectItem>
                              <SelectItem value="separation_biens">S√©paration de biens</SelectItem>
                              <SelectItem value="autre">Autre</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        {questionnaireData.regimeMatrimonialClient === "autre" && (
                          <div className="space-y-2">
                            <Label htmlFor="precisionRegimeClient">Pr√©ciser le r√©gime</Label>
                            <Input 
                              id="precisionRegimeClient"
                              value={questionnaireData.precisionRegimeClient}
                              onChange={(e) => setQuestionnaireData({...questionnaireData, precisionRegimeClient: e.target.value})}
                              placeholder="Pr√©cisez le r√©gime matrimonial..."
                            />
                          </div>
                        )}
                      </>
                    )}

                    {/* Pi√®ce d'identit√© du client acqu√©reur */}
                    {questionnaireData.clientId && (
                      <div className="space-y-2">
                        <Label>üìé Pi√®ce d'identit√©</Label>
                        {compromisClientIdentiteUrl ? (
                          <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg">
                            <svg className="w-4 h-4 text-green-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <span className="text-sm flex-1 text-green-700">Pi√®ce d'identit√© charg√©e depuis le profil client</span>
                            <Button
                              type="button"
                              variant="ghost"
                              size="sm"
                              className="bg-green-600 hover:bg-green-700 text-white"
                              onClick={() => window.open(compromisClientIdentiteUrl, '_blank')}
                            >
                              <Eye className="w-4 h-4" />
                            </Button>
                          </div>
                        ) : (
                          <div className="flex items-center gap-2 p-2 bg-orange-50 border border-orange-200 rounded-lg">
                            <svg className="w-4 h-4 text-orange-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                            </svg>
                            <span className="text-sm flex-1 text-orange-700">Aucune pi√®ce d'identit√© dans le profil client</span>
                          </div>
                        )}
                      </div>
                    )}
                  </>
                ) : (
                  <>
                    {/* Saisie manuelle acqu√©reur (le client est vendeur) */}
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label htmlFor="nomAutrePartie">Nom *</Label>
                        <Input 
                          id="nomAutrePartie"
                          value={questionnaireData.nomAutrePartie}
                          onChange={(e) => setQuestionnaireData({...questionnaireData, nomAutrePartie: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="prenomAutrePartie">Pr√©nom *</Label>
                        <Input 
                          id="prenomAutrePartie"
                          value={questionnaireData.prenomAutrePartie}
                          onChange={(e) => setQuestionnaireData({...questionnaireData, prenomAutrePartie: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2 md:col-span-2">
                        <Label htmlFor="adresseAutrePartie">Adresse compl√®te *</Label>
                        <Input 
                          id="adresseAutrePartie"
                          value={questionnaireData.adresseAutrePartie}
                          onChange={(e) => setQuestionnaireData({...questionnaireData, adresseAutrePartie: e.target.value})}
                        />
                      </div>

                      {/* Statut matrimonial autre partie */}
                      <div className="space-y-2">
                        <Label htmlFor="statutMatrimonialAutrePartie">Statut matrimonial *</Label>
                        <Select value={questionnaireData.statutMatrimonialAutrePartie} onValueChange={(value) => setQuestionnaireData({...questionnaireData, statutMatrimonialAutrePartie: value})}>
                          <SelectTrigger>
                            <SelectValue placeholder="S√©lectionner..." />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="celibataire">C√©libataire</SelectItem>
                            <SelectItem value="marie">Mari√©</SelectItem>
                            <SelectItem value="pacse">Pacs√©</SelectItem>
                            <SelectItem value="divorce">Divorc√©</SelectItem>
                            <SelectItem value="veuf">Veuf</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {(questionnaireData.statutMatrimonialAutrePartie === "marie" || questionnaireData.statutMatrimonialAutrePartie === "pacse") && (
                        <>
                          <div className="space-y-2">
                            <Label htmlFor="regimeMatrimonialAutrePartie">R√©gime matrimonial *</Label>
                            <Select value={questionnaireData.regimeMatrimonialAutrePartie} onValueChange={(value) => setQuestionnaireData({...questionnaireData, regimeMatrimonialAutrePartie: value})}>
                              <SelectTrigger>
                                <SelectValue placeholder="S√©lectionner..." />
                              </SelectTrigger>
                              <SelectContent>
                                <SelectItem value="communaute_legale">Communaut√© l√©gale</SelectItem>
                                <SelectItem value="separation_biens">S√©paration de biens</SelectItem>
                                <SelectItem value="autre">Autre</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>
                          {questionnaireData.regimeMatrimonialAutrePartie === "autre" && (
                            <div className="space-y-2 md:col-span-2">
                              <Label htmlFor="precisionRegimeAutrePartie">Pr√©ciser le r√©gime</Label>
                              <Input 
                                id="precisionRegimeAutrePartie"
                                value={questionnaireData.precisionRegimeAutrePartie}
                                onChange={(e) => setQuestionnaireData({...questionnaireData, precisionRegimeAutrePartie: e.target.value})}
                                placeholder="Pr√©cisez le r√©gime matrimonial..."
                              />
                            </div>
                          )}
                        </>
                      )}
                    </div>
                  </>
                )}
              </div>
              <div className="space-y-2">
                <Label>üìé Pi√®ce d'identit√© de l'autre partie</Label>
                
                {/* Upload pour l'autre partie */}
                {questionnaireData.clientId && (
                  <div className="space-y-2">
                    <p className="text-sm font-medium text-muted-foreground">
                      {questionnaireData.clientRole === "vendeur" ? "Acqu√©reur" : "Vendeur"}
                    </p>
                    <MultiFileUpload
                      label="üìé Pi√®ce d'identit√© de l'autre partie"
                      files={compromisAutrePartieFiles}
                      onFilesChange={setCompromisAutrePartieFiles}
                      accept="application/pdf,image/*"
                    />
                  </div>
                )}
              </div>
            </div>

            {/* Informations sur le bien */}
            <div className="space-y-4">
              <h3 className="font-semibold text-lg border-b pb-2">üè† Informations sur le bien</h3>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div className="space-y-2">
                  <Label htmlFor="adresseBien">Adresse compl√®te du bien *</Label>
                  <Input 
                    id="adresseBien"
                    value={questionnaireData.adresseBien}
                    onChange={(e) => setQuestionnaireData({...questionnaireData, adresseBien: e.target.value})}
                    placeholder="Ex: 12 rue de la Paix, 75002 Paris"
                  />
                </div>
                <div className="space-y-2">
                  <Label htmlFor="typeBien">Type de bien *</Label>
                  <Select value={questionnaireData.typeBien} onValueChange={(value) => setQuestionnaireData({...questionnaireData, typeBien: value})}>
                    <SelectTrigger>
                      <SelectValue placeholder="S√©lectionner..." />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="appartement">Appartement</SelectItem>
                      <SelectItem value="maison">Maison</SelectItem>
                      <SelectItem value="terrain">Terrain</SelectItem>
                      <SelectItem value="immeuble">Immeuble</SelectItem>
                      <SelectItem value="local_commercial">Local commercial</SelectItem>
                      <SelectItem value="parking">Parking/Garage</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
                <div className="space-y-2">
                  <Label htmlFor="surfaceHabitable">Surface habitable (m¬≤) *</Label>
                  <Input 
                    id="surfaceHabitable"
                    type="number"
                    value={questionnaireData.surfaceHabitable}
                    onChange={(e) => setQuestionnaireData({...questionnaireData, surfaceHabitable: e.target.value})}
                    placeholder="Ex: 75"
                  />
                </div>
                <div className="space-y-2">
                  <Label htmlFor="nombrePieces">Nombre de pi√®ces</Label>
                  <Input 
                    id="nombrePieces"
                    type="number"
                    value={questionnaireData.nombrePieces}
                    onChange={(e) => setQuestionnaireData({...questionnaireData, nombrePieces: e.target.value})}
                    placeholder="Ex: 3"
                  />
                </div>
                <div className="space-y-2">
                  <Label htmlFor="naturePropriete">Nature de la propri√©t√© *</Label>
                  <Select value={questionnaireData.naturePropriete} onValueChange={(value) => setQuestionnaireData({...questionnaireData, naturePropriete: value})}>
                    <SelectTrigger>
                      <SelectValue placeholder="S√©lectionner..." />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="pleine_propriete">Pleine propri√©t√©</SelectItem>
                      <SelectItem value="usufruit">Usufruit</SelectItem>
                      <SelectItem value="nue_propriete">Nue-propri√©t√©</SelectItem>
                      <SelectItem value="indivision">Indivision</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
                <div className="space-y-2">
                  <Label htmlFor="bienCopropriete">Bien en copropri√©t√© ? *</Label>
                  <Select value={questionnaireData.bienCopropriete} onValueChange={(value) => setQuestionnaireData({...questionnaireData, bienCopropriete: value})}>
                    <SelectTrigger>
                      <SelectValue placeholder="S√©lectionner..." />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="oui">Oui</SelectItem>
                      <SelectItem value="non">Non</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
                {questionnaireData.bienCopropriete === "oui" && (
                  <>
                    <div className="space-y-2">
                      <Label htmlFor="numeroLot">Num√©ro de lot</Label>
                      <Input 
                        id="numeroLot"
                        value={questionnaireData.numeroLot}
                        onChange={(e) => setQuestionnaireData({...questionnaireData, numeroLot: e.target.value})}
                        placeholder="Ex: 123"
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="tanti√®mes">Tanti√®mes / Quote-part des parties communes</Label>
                      <Input 
                        id="tanti√®mes"
                        value={questionnaireData.tanti√®mes}
                        onChange={(e) => setQuestionnaireData({...questionnaireData, tanti√®mes: e.target.value})}
                        placeholder="Ex: 150/10000"
                      />
                    </div>
                  </>
                )}
                <div className="space-y-2">
                  <Label htmlFor="occupationBien">Occupation du bien *</Label>
                  <Select value={questionnaireData.occupationBien} onValueChange={(value) => setQuestionnaireData({...questionnaireData, occupationBien: value})}>
                    <SelectTrigger>
                      <SelectValue placeholder="S√©lectionner..." />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="libre">Libre</SelectItem>
                      <SelectItem value="occupe_vendeur">Occup√© par le vendeur</SelectItem>
                      <SelectItem value="occupe_locataire">Occup√© par un locataire</SelectItem>
                      <SelectItem value="bail_en_cours">Bail en cours</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
                <div className="space-y-2">
                  <Label htmlFor="servitudesConnues">Servitudes connues ? *</Label>
                  <Select value={questionnaireData.servitudesConnues} onValueChange={(value) => setQuestionnaireData({...questionnaireData, servitudesConnues: value})}>
                    <SelectTrigger>
                      <SelectValue placeholder="S√©lectionner..." />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="oui">Oui</SelectItem>
                      <SelectItem value="non">Non</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
                {questionnaireData.servitudesConnues === "oui" && (
                  <div className="space-y-2 md:col-span-2">
                    <Label htmlFor="descriptionServitudes">Description des servitudes</Label>
                    <Textarea 
                      id="descriptionServitudes"
                      value={questionnaireData.descriptionServitudes}
                      onChange={(e) => setQuestionnaireData({...questionnaireData, descriptionServitudes: e.target.value})}
                      placeholder="D√©crivez les servitudes..."
                      rows={3}
                    />
                  </div>
                )}
                <div className="space-y-2">
                  <Label htmlFor="bienLibre">Bien vendu libre de toute occupation √† la signature ? *</Label>
                  <Select value={questionnaireData.bienLibre} onValueChange={(value) => setQuestionnaireData({...questionnaireData, bienLibre: value})}>
                    <SelectTrigger>
                      <SelectValue placeholder="S√©lectionner..." />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="oui">Oui</SelectItem>
                      <SelectItem value="non">Non</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
              </div>
            </div>

            {/* Conditions financi√®res */}
            <div className="space-y-4">
              <h3 className="font-semibold text-lg border-b pb-2">Conditions financi√®res</h3>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div className="space-y-2">
                  <Label htmlFor="prixVente">Prix de vente (‚Ç¨) *</Label>
                  <Input 
                    id="prixVente"
                    type="number"
                    value={questionnaireData.prixVente}
                    onChange={(e) => setQuestionnaireData({...questionnaireData, prixVente: e.target.value})}
                    placeholder="Ex: 350000"
                  />
                </div>
                <div className="space-y-2">
                  <Label htmlFor="depotGarantie">D√©p√¥t de garantie (‚Ç¨)</Label>
                  <Input 
                    id="depotGarantie"
                    type="number"
                    value={questionnaireData.depotGarantie}
                    onChange={(e) => setQuestionnaireData({...questionnaireData, depotGarantie: e.target.value})}
                    placeholder="Ex: 35000"
                  />
                </div>
                <div className="space-y-2 md:col-span-2">
                  <Label htmlFor="modalitesPaiement">Modalit√©s de paiement</Label>
                  <Textarea 
                    id="modalitesPaiement"
                    rows={2}
                    value={questionnaireData.modalitesPaiement}
                    onChange={(e) => setQuestionnaireData({...questionnaireData, modalitesPaiement: e.target.value})}
                    placeholder="D√©crivez les modalit√©s de paiement (comptant, cr√©dit, etc.)"
                  />
                </div>
              </div>
            </div>

            {/* Conditions suspensives - Uniquement pour Compromis */}
            {questionnaireData.typeContrat === "compromis" && (
              <div className="space-y-4">
                <h3 className="font-semibold text-lg border-b pb-2">Conditions suspensives</h3>
                <div className="space-y-4">
                  <div className="space-y-2">
                    <Label htmlFor="conditionPret">Condition d'obtention de pr√™t ? *</Label>
                    <Select value={questionnaireData.conditionPret} onValueChange={(value) => setQuestionnaireData({...questionnaireData, conditionPret: value})}>
                      <SelectTrigger>
                        <SelectValue placeholder="S√©lectionner..." />
                      </SelectTrigger>
                      <SelectContent>
                        <SelectItem value="oui">Oui</SelectItem>
                        <SelectItem value="non">Non</SelectItem>
                      </SelectContent>
                    </Select>
                  </div>

                  {questionnaireData.conditionPret === "oui" && (
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-muted/30 rounded-lg">
                    <div className="md:col-span-2">
                      <h4 className="font-medium text-sm mb-4">D√©tails du pr√™t immobilier</h4>
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="montantPret">Montant du pr√™t envisag√© (‚Ç¨) *</Label>
                      <Input 
                        id="montantPret"
                        type="number"
                        value={questionnaireData.montantPret}
                        onChange={(e) => setQuestionnaireData({...questionnaireData, montantPret: e.target.value})}
                        placeholder="Ex: 280000"
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="dureePret">Dur√©e maximale du pr√™t (ann√©es) *</Label>
                      <Input 
                        id="dureePret"
                        type="number"
                        value={questionnaireData.dureePret}
                        onChange={(e) => setQuestionnaireData({...questionnaireData, dureePret: e.target.value})}
                        placeholder="Ex: 25"
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="tauxInteretMax">Taux d'int√©r√™t maximal accept√© (%) *</Label>
                      <Input 
                        id="tauxInteretMax"
                        type="number"
                        step="0.01"
                        value={questionnaireData.tauxInteretMax}
                        onChange={(e) => setQuestionnaireData({...questionnaireData, tauxInteretMax: e.target.value})}
                        placeholder="Ex: 3.5"
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="delaiAccordPret">D√©lai pour obtenir l'accord de pr√™t *</Label>
                      <Input 
                        id="delaiAccordPret"
                        value={questionnaireData.delaiAccordPret}
                        onChange={(e) => setQuestionnaireData({...questionnaireData, delaiAccordPret: e.target.value})}
                        placeholder="Ex: 45 jours ou date limite"
                      />
                    </div>
                  </div>
                )}
                <div className="space-y-2">
                  <Label htmlFor="conditionDiagnostics">Diagnostics et contr√¥les techniques</Label>
                  <Textarea 
                    id="conditionDiagnostics"
                    rows={2}
                    value={questionnaireData.conditionDiagnostics}
                    onChange={(e) => setQuestionnaireData({...questionnaireData, conditionDiagnostics: e.target.value})}
                    placeholder="Ex: DPE, diagnostic amiante, plomb, termites..."
                  />
                </div>
                <MultiFileUpload
                  label="üìé Joindre les diagnostics"
                  files={compromisDiagnosticsFiles}
                  onFilesChange={setCompromisDiagnosticsFiles}
                  accept="application/pdf"
                />
                <div className="space-y-2">
                  <Label htmlFor="autresConditions">Autres conditions suspensives</Label>
                  <Textarea 
                    id="autresConditions"
                    rows={2}
                    value={questionnaireData.autresConditions}
                    onChange={(e) => setQuestionnaireData({...questionnaireData, autresConditions: e.target.value})}
                    placeholder="Autres conditions √©ventuelles"
                  />
                </div>
              </div>
            </div>
            )}

            {/* Droit de pr√©emption */}
            <div className="space-y-4">
              <h3 className="font-semibold text-lg border-b pb-2">Droit de pr√©emption</h3>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div className="space-y-2">
                  <Label htmlFor="droitPreemptionUrbain">Bien soumis au droit de pr√©emption urbain ? *</Label>
                  <Select value={questionnaireData.droitPreemptionUrbain} onValueChange={(value) => setQuestionnaireData({...questionnaireData, droitPreemptionUrbain: value})}>
                    <SelectTrigger>
                      <SelectValue placeholder="S√©lectionner..." />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="oui">Oui</SelectItem>
                      <SelectItem value="non">Non</SelectItem>
                      <SelectItem value="inconnu">Inconnu</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
                <div className="space-y-2">
                  <Label htmlFor="locatairePreemption">Pr√©sence d'un locataire avec droit de pr√©emption ? *</Label>
                  <Select value={questionnaireData.locatairePreemption} onValueChange={(value) => setQuestionnaireData({...questionnaireData, locatairePreemption: value})}>
                    <SelectTrigger>
                      <SelectValue placeholder="S√©lectionner..." />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="oui">Oui</SelectItem>
                      <SelectItem value="non">Non</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
              </div>
            </div>

            {/* Promesse unilat√©rale sp√©cifique */}
            {questionnaireData.typeContrat === "promesse_unilaterale" && (
              <div className="space-y-4">
                <h3 className="font-semibold text-lg border-b pb-2">Sp√©cifique √† la promesse unilat√©rale de vente</h3>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div className="space-y-2">
                    <Label htmlFor="dureeOption">Dur√©e de l'option (en jours) *</Label>
                    <Input 
                      id="dureeOption"
                      type="number"
                      value={questionnaireData.dureeOption}
                      onChange={(e) => setQuestionnaireData({...questionnaireData, dureeOption: e.target.value})}
                      placeholder="Ex: 60"
                    />
                  </div>
                  <div className="space-y-2">
                    <Label htmlFor="dateLimiteOption">Date limite de lev√©e d'option *</Label>
                    <Input 
                      id="dateLimiteOption"
                      type="date"
                      value={questionnaireData.dateLimiteOption}
                      onChange={(e) => setQuestionnaireData({...questionnaireData, dateLimiteOption: e.target.value})}
                    />
                  </div>
                  <div className="space-y-2 md:col-span-2">
                    <Label htmlFor="indemniteImmobilisation">Indemnit√© d'immobilisation (‚Ç¨ ou %) *</Label>
                    <Input 
                      id="indemniteImmobilisation"
                      value={questionnaireData.indemniteImmobilisation}
                      onChange={(e) => setQuestionnaireData({...questionnaireData, indemniteImmobilisation: e.target.value})}
                      placeholder="Ex: 5000 ‚Ç¨ ou 5% du prix de vente"
                    />
                  </div>
                </div>
              </div>
            )}

            {/* D√©lais */}
            <div className="space-y-4">
              <h3 className="font-semibold text-lg border-b pb-2">D√©lais</h3>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div className="space-y-2">
                  <Label htmlFor="dateSignatureActeDefinitif">Date pr√©vue signature acte d√©finitif</Label>
                  <Input 
                    id="dateSignatureActeDefinitif"
                    type="date"
                    value={questionnaireData.dateSignatureActeDefinitif}
                    onChange={(e) => setQuestionnaireData({...questionnaireData, dateSignatureActeDefinitif: e.target.value})}
                  />
                </div>
                <div className="space-y-2">
                  <Label htmlFor="delaiReflexion">D√©lai de r√©tractation (jours)</Label>
                  <Input 
                    id="delaiReflexion"
                    type="number"
                    value={questionnaireData.delaiReflexion}
                    onChange={(e) => setQuestionnaireData({...questionnaireData, delaiReflexion: e.target.value})}
                    placeholder="Ex: 10"
                  />
                </div>
              </div>
            </div>

            {/* Informations compl√©mentaires */}
            <div className="space-y-4">
              <h3 className="font-semibold text-lg border-b pb-2">Informations compl√©mentaires</h3>
              <div className="space-y-4">
                <div className="space-y-2">
                  <Label htmlFor="chargesCopropriete">Charges de copropri√©t√© (si applicable)</Label>
                  <Textarea 
                    id="chargesCopropriete"
                    rows={2}
                    value={questionnaireData.chargesCopropriete}
                    onChange={(e) => setQuestionnaireData({...questionnaireData, chargesCopropriete: e.target.value})}
                    placeholder="Montant annuel, r√©partition, d√©tails..."
                  />
                </div>
                <div className="space-y-2">
                  <Label htmlFor="travauxAPrevenir">Travaux √† pr√©voir</Label>
                  <Textarea 
                    id="travauxAPrevenir"
                    rows={2}
                    value={questionnaireData.travauxAPrevenir}
                    onChange={(e) => setQuestionnaireData({...questionnaireData, travauxAPrevenir: e.target.value})}
                    placeholder="Description des travaux pr√©vus ou n√©cessaires"
                  />
                </div>
                <div className="space-y-2">
                  <Label htmlFor="autresInformations">Autres informations utiles</Label>
                  <Textarea 
                    id="autresInformations"
                    rows={3}
                    value={questionnaireData.autresInformations}
                    onChange={(e) => setQuestionnaireData({...questionnaireData, autresInformations: e.target.value})}
                    placeholder="Toute information compl√©mentaire pertinente pour le contrat"
                  />
                </div>
              </div>
            </div>
          </>
            )}

            {/* Formulaire sp√©cifique pour Acte de vente immobili√®re */}
            {pendingContractType === "Acte de vente immobili√®re" && (
              <>
                {/* S√©lection du r√¥le du client */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">R√¥le du client</h3>
                  <div className="space-y-2">
                    <Label>Votre client est : *</Label>
                    <RadioGroup 
                      value={acteVenteData.clientRole}
                      onValueChange={(value) => setActeVenteData({...acteVenteData, clientRole: value})}
                    >
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="vendeur" id="acte-vendeur" />
                        <Label htmlFor="acte-vendeur" className="cursor-pointer">Vendeur</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="acheteur" id="acte-acheteur" />
                        <Label htmlFor="acte-acheteur" className="cursor-pointer">Acqu√©reur</Label>
                      </div>
                    </RadioGroup>
                  </div>
                </div>

                {/* Vendeur - avec auto-fill si client s√©lectionn√© comme vendeur, sinon manuel */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üë§ Vendeur</h3>
                  <div className="space-y-4">
                    {acteVenteData.clientRole === "vendeur" ? (
                      <>
                        {/* Le client est le vendeur */}
                        <div className="space-y-2">
                          <Label htmlFor="acte_clientId">S√©lectionner votre client *</Label>
                          <Select 
                            value={acteVenteData.clientId}
                            onValueChange={(value) => setActeVenteData({...acteVenteData, clientId: value})}
                          >
                            <SelectTrigger>
                              <SelectValue placeholder="Choisir un client" />
                            </SelectTrigger>
                            <SelectContent>
                              {clients.map((client) => (
                                <SelectItem key={client.id} value={client.id}>
                                  {client.nom} {client.prenom}
                                </SelectItem>
                              ))}
                            </SelectContent>
                          </Select>
                        </div>

                        {/* Afficher les informations du client s√©lectionn√© */}
                        {acteVenteData.clientId && clients.find(c => c.id === acteVenteData.clientId) && (
                          <div className="p-4 bg-muted/50 rounded-lg space-y-2 text-sm">
                            <p><strong>Nom complet:</strong> {clients.find(c => c.id === acteVenteData.clientId)?.nom} {clients.find(c => c.id === acteVenteData.clientId)?.prenom}</p>
                            {clients.find(c => c.id === acteVenteData.clientId)?.adresse && (
                              <p><strong>Adresse:</strong> {clients.find(c => c.id === acteVenteData.clientId)?.adresse}</p>
                            )}
                            {clients.find(c => c.id === acteVenteData.clientId)?.telephone && (
                              <p><strong>T√©l√©phone:</strong> {clients.find(c => c.id === acteVenteData.clientId)?.telephone}</p>
                            )}
                            {clients.find(c => c.id === acteVenteData.clientId)?.email && (
                              <p><strong>Email:</strong> {clients.find(c => c.id === acteVenteData.clientId)?.email}</p>
                            )}
                            {clients.find(c => c.id === acteVenteData.clientId)?.date_naissance && (
                              <p><strong>Date de naissance:</strong> {new Date(clients.find(c => c.id === acteVenteData.clientId)?.date_naissance).toLocaleDateString('fr-FR')}</p>
                            )}
                            {clients.find(c => c.id === acteVenteData.clientId)?.nationalite && (
                              <p><strong>Nationalit√©:</strong> {clients.find(c => c.id === acteVenteData.clientId)?.nationalite}</p>
                            )}
                          </div>
                        )}
                      </>
                    ) : (
                      <>
                        {/* Saisie manuelle vendeur (le client est acheteur) */}
                        <div className="text-sm text-muted-foreground mb-2">
                          Saisir manuellement les informations du vendeur
                        </div>
                      </>
                    )}
                  </div>
                  
                  {/* Type de partie - Vendeur */}
                  <div className="space-y-4">
                    <Label>Type de partie *</Label>
                    <RadioGroup 
                      value={acteVenteData.vendeurTypePartie}
                      onValueChange={(value) => setActeVenteData({...acteVenteData, vendeurTypePartie: value})}
                    >
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="personne_physique" id="vendeur_pp" />
                        <Label htmlFor="vendeur_pp" className="cursor-pointer">Personne physique</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="personne_morale" id="vendeur_pm" />
                        <Label htmlFor="vendeur_pm" className="cursor-pointer">Personne morale (soci√©t√©)</Label>
                      </div>
                    </RadioGroup>
                  </div>

                  {/* Si personne morale */}
                  {acteVenteData.vendeurTypePartie === "personne_morale" && (
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-blue-50 dark:bg-blue-950 rounded-lg">
                      <div className="space-y-2 md:col-span-2">
                        <Label htmlFor="vendeur_denomination">D√©nomination sociale *</Label>
                        <Input 
                          id="vendeur_denomination"
                          value={acteVenteData.vendeurDenominationSociale}
                          onChange={(e) => setActeVenteData({...acteVenteData, vendeurDenominationSociale: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="vendeur_forme">Forme juridique *</Label>
                        <Input 
                          id="vendeur_forme"
                          value={acteVenteData.vendeurFormeJuridique}
                          onChange={(e) => setActeVenteData({...acteVenteData, vendeurFormeJuridique: e.target.value})}
                          placeholder="SARL, SAS, SCI..."
                        />
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="vendeur_siren">SIREN *</Label>
                        <Input 
                          id="vendeur_siren"
                          value={acteVenteData.vendeurSiren}
                          onChange={(e) => setActeVenteData({...acteVenteData, vendeurSiren: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2 md:col-span-2">
                        <Label htmlFor="vendeur_siege">Adresse du si√®ge social *</Label>
                        <Input 
                          id="vendeur_siege"
                          value={acteVenteData.vendeurSiegeSocial}
                          onChange={(e) => setActeVenteData({...acteVenteData, vendeurSiegeSocial: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="vendeur_representant">Nom du repr√©sentant l√©gal *</Label>
                        <Input 
                          id="vendeur_representant"
                          value={acteVenteData.vendeurRepresentantNom}
                          onChange={(e) => setActeVenteData({...acteVenteData, vendeurRepresentantNom: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="vendeur_qualite">Qualit√© *</Label>
                        <Input 
                          id="vendeur_qualite"
                          value={acteVenteData.vendeurRepresentantQualite}
                          onChange={(e) => setActeVenteData({...acteVenteData, vendeurRepresentantQualite: e.target.value})}
                          placeholder="G√©rant, Pr√©sident..."
                        />
                      </div>
                      <div className="space-y-2 md:col-span-2">
                        <Label>üìé Extrait Kbis</Label>
                        <button
                          type="button"
                          className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                          onClick={() => document.getElementById('kbis-vendeur')?.click()}
                        >
                          <svg className="w-4 h-4 text-orange-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                          </svg>
                          <span className="text-sm flex-1 text-orange-700">Aucune pi√®ce charg√©e - Cliquer pour ajouter</span>
                        </button>
                        <Input id="kbis-vendeur" type="file" accept=".pdf" className="hidden" />
                      </div>
                    </div>
                  )}

                  {/* Repr√©sentation - Vendeur */}
                  <div className="space-y-4">
                    <Label>La partie est-elle repr√©sent√©e ?</Label>
                    <RadioGroup 
                      value={acteVenteData.vendeurRepresente}
                      onValueChange={(value) => setActeVenteData({...acteVenteData, vendeurRepresente: value})}
                    >
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="non" id="vendeur_rep_non" />
                        <Label htmlFor="vendeur_rep_non" className="cursor-pointer">Non</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="oui" id="vendeur_rep_oui" />
                        <Label htmlFor="vendeur_rep_oui" className="cursor-pointer">Oui</Label>
                      </div>
                    </RadioGroup>
                  </div>

                  {/* Si repr√©sent√© */}
                  {acteVenteData.vendeurRepresente === "oui" && (
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-amber-50 dark:bg-amber-950 rounded-lg">
                      <div className="space-y-2">
                        <Label htmlFor="vendeur_mand_nom">Nom du mandataire *</Label>
                        <Input 
                          id="vendeur_mand_nom"
                          value={acteVenteData.vendeurMandataireNom}
                          onChange={(e) => setActeVenteData({...acteVenteData, vendeurMandataireNom: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="vendeur_mand_prenom">Pr√©nom du mandataire *</Label>
                        <Input 
                          id="vendeur_mand_prenom"
                          value={acteVenteData.vendeurMandatairePrenom}
                          onChange={(e) => setActeVenteData({...acteVenteData, vendeurMandatairePrenom: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2 md:col-span-2">
                        <Label htmlFor="vendeur_type_pouvoir">Type de pouvoir *</Label>
                        <Select value={acteVenteData.vendeurTypePouvoir} onValueChange={(value) => setActeVenteData({...acteVenteData, vendeurTypePouvoir: value})}>
                          <SelectTrigger>
                            <SelectValue placeholder="S√©lectionner..." />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="mandat_authentique">Mandat authentique</SelectItem>
                            <SelectItem value="mandat_ssp">Mandat sous seing priv√©</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2 md:col-span-2">
                        <Label>üìé Joindre le mandat (PDF)</Label>
                        <button
                          type="button"
                          className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                          onClick={() => document.getElementById('mandat-vendeur')?.click()}
                        >
                          <svg className="w-4 h-4 text-orange-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                          </svg>
                          <span className="text-sm flex-1 text-orange-700">Aucune pi√®ce charg√©e - Cliquer pour ajouter</span>
                        </button>
                        <Input id="mandat-vendeur" type="file" accept=".pdf" className="hidden" />
                      </div>
                    </div>
                  )}
                  
                  {/* Champs communs pour le vendeur */}
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label htmlFor="acte_vendeurNom">Nom *</Label>
                      <Input 
                        id="acte_vendeurNom" 
                        value={acteVenteData.vendeurNom} 
                        onChange={(e) => setActeVenteData({...acteVenteData, vendeurNom: e.target.value})} 
                        
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_vendeurPrenom">Pr√©nom *</Label>
                      <Input 
                        id="acte_vendeurPrenom" 
                        value={acteVenteData.vendeurPrenom} 
                        onChange={(e) => setActeVenteData({...acteVenteData, vendeurPrenom: e.target.value})} 
                        
                      />
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label htmlFor="acte_vendeurAdresse">Adresse *</Label>
                      <Input 
                        id="acte_vendeurAdresse" 
                        value={acteVenteData.vendeurAdresse} 
                        onChange={(e) => setActeVenteData({...acteVenteData, vendeurAdresse: e.target.value})} 
                        
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_vendeurDateNaissance">Date de naissance *</Label>
                      <Input 
                        id="acte_vendeurDateNaissance" 
                        type="date" 
                        value={acteVenteData.vendeurDateNaissance} 
                        onChange={(e) => setActeVenteData({...acteVenteData, vendeurDateNaissance: e.target.value})} 
                        
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_vendeurLieuNaissance">Lieu de naissance *</Label>
                      <Input 
                        id="acte_vendeurLieuNaissance" 
                        value={acteVenteData.vendeurLieuNaissance} 
                        onChange={(e) => setActeVenteData({...acteVenteData, vendeurLieuNaissance: e.target.value})} 
                        
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_vendeurNationalite">Nationalit√© *</Label>
                      <Input 
                        id="acte_vendeurNationalite" 
                        value={acteVenteData.vendeurNationalite} 
                        onChange={(e) => setActeVenteData({...acteVenteData, vendeurNationalite: e.target.value})} 
                        
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_vendeurProfession">Profession *</Label>
                      <Input 
                        id="acte_vendeurProfession" 
                        value={acteVenteData.vendeurProfession} 
                        onChange={(e) => setActeVenteData({...acteVenteData, vendeurProfession: e.target.value})} 
                        
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_vendeurStatut">Statut matrimonial *</Label>
                      <Input 
                        id="acte_vendeurStatut"
                        value={acteVenteData.vendeurStatutMatrimonial} 
                        onChange={(e) => setActeVenteData({...acteVenteData, vendeurStatutMatrimonial: e.target.value})}
                        placeholder="Ex: C√©libataire, Mari√©, Pacs√©, Divorc√©, Veuf"
                      />
                    </div>
                    {(acteVenteData.vendeurStatutMatrimonial === "marie" || acteVenteData.vendeurStatutMatrimonial === "pacse") && (
                      <>
                        <div className="space-y-2">
                          <Label htmlFor="acte_vendeurRegime">R√©gime matrimonial *</Label>
                          <Select value={acteVenteData.vendeurRegimeMatrimonial} onValueChange={(value) => setActeVenteData({...acteVenteData, vendeurRegimeMatrimonial: value})}>
                            <SelectTrigger>
                              <SelectValue placeholder="S√©lectionner..." />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="communaute_legale">Communaut√© l√©gale</SelectItem>
                              <SelectItem value="separation_biens">S√©paration de biens</SelectItem>
                              <SelectItem value="autre">Autre</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        {acteVenteData.vendeurRegimeMatrimonial === "autre" && (
                          <div className="space-y-2">
                            <Label htmlFor="acte_vendeurPrecisionRegime">Pr√©ciser le r√©gime</Label>
                            <Input 
                              id="acte_vendeurPrecisionRegime"
                              value={acteVenteData.vendeurPrecisionRegime}
                              onChange={(e) => setActeVenteData({...acteVenteData, vendeurPrecisionRegime: e.target.value})}
                              placeholder="Pr√©cisez le r√©gime matrimonial..."
                            />
                          </div>
                        )}
                      </>
                    )}
                    <div className="space-y-2">
                      <Label htmlFor="acte_vendeurPiece">Type de pi√®ce d'identit√© *</Label>
                      <Input 
                        id="acte_vendeurPiece" 
                        value={acteVenteData.vendeurPieceIdentite} 
                        onChange={(e) => setActeVenteData({...acteVenteData, vendeurPieceIdentite: e.target.value})} 
                        placeholder="Ex: CNI, Passeport" 
                        
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_vendeurNumero">Num√©ro de pi√®ce d'identit√© *</Label>
                      <Input 
                        id="acte_vendeurNumero" 
                        value={acteVenteData.vendeurNumeroIdentite} 
                        onChange={(e) => setActeVenteData({...acteVenteData, vendeurNumeroIdentite: e.target.value})} 
                        
                      />
                    </div>
                  </div>
                  
                  {/* Pi√®ce d'identit√© du vendeur - charg√©e depuis client ou upload */}
                  {acteVenteData.clientRole === "vendeur" && acteVenteData.clientId ? (
                    <div className="space-y-2">
                      <Label>üìé Pi√®ce d'identit√©</Label>
                      {acteClientIdentiteUrl ? (
                        <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg">
                          <svg className="w-4 h-4 text-green-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                          </svg>
                          <span className="text-sm flex-1 text-green-700">Pi√®ce d'identit√© charg√©e depuis le profil client</span>
                          <Button
                            type="button"
                            variant="ghost"
                            size="sm"
                            className="bg-green-600 hover:bg-green-700 text-white"
                            onClick={() => window.open(acteClientIdentiteUrl, '_blank')}
                          >
                            <Eye className="w-4 h-4" />
                          </Button>
                        </div>
                      ) : (
                        <div className="flex items-center gap-2 p-2 bg-orange-50 border border-orange-200 rounded-lg">
                          <svg className="w-4 h-4 text-orange-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                          </svg>
                          <span className="text-sm flex-1 text-orange-700">Aucune pi√®ce d'identit√© dans le profil client</span>
                        </div>
                      )}
                    </div>
                  ) : (
                    /* Upload de pi√®ces d'identit√© vendeur */
                    <MultiFileUpload
                      label="üìé Pi√®ces d'identit√© du vendeur"
                      files={acteVendeurFiles}
                      onFilesChange={setActeVendeurFiles}
                      accept="application/pdf,image/*"
                    />
                  )}
                </div>

                {/* Acheteur - avec auto-fill si client s√©lectionn√© comme acheteur, sinon manuel */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üë• Acqu√©reur</h3>
                  <div className="space-y-4">
                    {acteVenteData.clientRole === "acheteur" ? (
                      <>
                        {/* Le client est l'acheteur */}
                        <div className="space-y-2">
                          <Label htmlFor="acte_clientId_acheteur">S√©lectionner votre client *</Label>
                          <Select 
                            value={acteVenteData.clientId}
                            onValueChange={(value) => setActeVenteData({...acteVenteData, clientId: value})}
                          >
                            <SelectTrigger>
                              <SelectValue placeholder="Choisir un client" />
                            </SelectTrigger>
                            <SelectContent>
                              {clients.map((client) => (
                                <SelectItem key={client.id} value={client.id}>
                                  {client.nom} {client.prenom}
                                </SelectItem>
                              ))}
                            </SelectContent>
                          </Select>
                        </div>

                        {/* Afficher les informations du client s√©lectionn√© */}
                        {acteVenteData.clientId && clients.find(c => c.id === acteVenteData.clientId) && (
                          <div className="p-4 bg-muted/50 rounded-lg space-y-2 text-sm">
                            <p><strong>Nom complet:</strong> {clients.find(c => c.id === acteVenteData.clientId)?.nom} {clients.find(c => c.id === acteVenteData.clientId)?.prenom}</p>
                            {clients.find(c => c.id === acteVenteData.clientId)?.adresse && (
                              <p><strong>Adresse:</strong> {clients.find(c => c.id === acteVenteData.clientId)?.adresse}</p>
                            )}
                            {clients.find(c => c.id === acteVenteData.clientId)?.telephone && (
                              <p><strong>T√©l√©phone:</strong> {clients.find(c => c.id === acteVenteData.clientId)?.telephone}</p>
                            )}
                            {clients.find(c => c.id === acteVenteData.clientId)?.email && (
                              <p><strong>Email:</strong> {clients.find(c => c.id === acteVenteData.clientId)?.email}</p>
                            )}
                            {clients.find(c => c.id === acteVenteData.clientId)?.date_naissance && (
                              <p><strong>Date de naissance:</strong> {new Date(clients.find(c => c.id === acteVenteData.clientId)?.date_naissance).toLocaleDateString('fr-FR')}</p>
                            )}
                            {clients.find(c => c.id === acteVenteData.clientId)?.nationalite && (
                              <p><strong>Nationalit√©:</strong> {clients.find(c => c.id === acteVenteData.clientId)?.nationalite}</p>
                            )}
                          </div>
                        )}
                      </>
                    ) : (
                      <>
                        {/* Saisie manuelle acheteur (le client est vendeur) */}
                        <div className="text-sm text-muted-foreground mb-2">
                          Saisir manuellement les informations de l'acheteur
                        </div>
                      </>
                    )}
                  </div>
                  
                  {/* Champs communs pour l'acheteur */}
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label htmlFor="acte_acheteurNom">Nom *</Label>
                      <Input 
                        id="acte_acheteurNom" 
                        value={acteVenteData.acheteurNom} 
                        onChange={(e) => setActeVenteData({...acteVenteData, acheteurNom: e.target.value})} 
                        
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_acheteurPrenom">Pr√©nom *</Label>
                      <Input 
                        id="acte_acheteurPrenom" 
                        value={acteVenteData.acheteurPrenom} 
                        onChange={(e) => setActeVenteData({...acteVenteData, acheteurPrenom: e.target.value})} 
                        
                      />
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label htmlFor="acte_acheteurAdresse">Adresse *</Label>
                      <Input 
                        id="acte_acheteurAdresse" 
                        value={acteVenteData.acheteurAdresse} 
                        onChange={(e) => setActeVenteData({...acteVenteData, acheteurAdresse: e.target.value})} 
                        
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_acheteurDateNaissance">Date de naissance *</Label>
                      <Input 
                        id="acte_acheteurDateNaissance" 
                        type="date" 
                        value={acteVenteData.acheteurDateNaissance} 
                        onChange={(e) => setActeVenteData({...acteVenteData, acheteurDateNaissance: e.target.value})} 
                        
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_acheteurLieuNaissance">Lieu de naissance *</Label>
                      <Input 
                        id="acte_acheteurLieuNaissance" 
                        value={acteVenteData.acheteurLieuNaissance} 
                        onChange={(e) => setActeVenteData({...acteVenteData, acheteurLieuNaissance: e.target.value})} 
                        
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_acheteurNationalite">Nationalit√© *</Label>
                      <Input 
                        id="acte_acheteurNationalite" 
                        value={acteVenteData.acheteurNationalite} 
                        onChange={(e) => setActeVenteData({...acteVenteData, acheteurNationalite: e.target.value})} 
                        
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_acheteurProfession">Profession *</Label>
                      <Input 
                        id="acte_acheteurProfession" 
                        value={acteVenteData.acheteurProfession} 
                        onChange={(e) => setActeVenteData({...acteVenteData, acheteurProfession: e.target.value})} 
                        
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_acheteurStatut">Statut matrimonial *</Label>
                      <Input 
                        id="acte_acheteurStatut"
                        value={acteVenteData.acheteurStatutMatrimonial} 
                        onChange={(e) => setActeVenteData({...acteVenteData, acheteurStatutMatrimonial: e.target.value})}
                        placeholder="Ex: C√©libataire, Mari√©, Pacs√©, Divorc√©, Veuf"
                      />
                    </div>
                    {(acteVenteData.acheteurStatutMatrimonial === "marie" || acteVenteData.acheteurStatutMatrimonial === "pacse") && (
                      <>
                        <div className="space-y-2">
                          <Label htmlFor="acte_acheteurRegime">R√©gime matrimonial *</Label>
                          <Select value={acteVenteData.acheteurRegimeMatrimonial} onValueChange={(value) => setActeVenteData({...acteVenteData, acheteurRegimeMatrimonial: value})}>
                            <SelectTrigger>
                              <SelectValue placeholder="S√©lectionner..." />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="communaute_legale">Communaut√© l√©gale</SelectItem>
                              <SelectItem value="separation_biens">S√©paration de biens</SelectItem>
                              <SelectItem value="autre">Autre</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        {acteVenteData.acheteurRegimeMatrimonial === "autre" && (
                          <div className="space-y-2">
                            <Label htmlFor="acte_acheteurPrecisionRegime">Pr√©ciser le r√©gime</Label>
                            <Input 
                              id="acte_acheteurPrecisionRegime"
                              value={acteVenteData.acheteurPrecisionRegime}
                              onChange={(e) => setActeVenteData({...acteVenteData, acheteurPrecisionRegime: e.target.value})}
                              placeholder="Pr√©cisez le r√©gime matrimonial..."
                            />
                          </div>
                        )}
                      </>
                    )}
                    <div className="space-y-2">
                      <Label htmlFor="acte_modeAcquisition">Mode d'acquisition *</Label>
                      <Select value={acteVenteData.acheteurModeAcquisition} onValueChange={(value) => setActeVenteData({...acteVenteData, acheteurModeAcquisition: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="seul">Achat seul</SelectItem>
                          <SelectItem value="couple">En couple</SelectItem>
                          <SelectItem value="indivision">En indivision</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    {acteVenteData.acheteurModeAcquisition === "indivision" && (
                      <div className="space-y-2">
                        <Label htmlFor="acte_quotePart">Quote-part d'acquisition (%)</Label>
                        <Input id="acte_quotePart" type="number" value={acteVenteData.acheteurQuotePart} onChange={(e) => setActeVenteData({...acteVenteData, acheteurQuotePart: e.target.value})} placeholder="Ex: 50" />
                      </div>
                    )}
                  </div>
                  
                  {/* Type de partie - Acqu√©reur */}
                  <div className="space-y-4">
                    <Label>Type de partie *</Label>
                    <RadioGroup 
                      value={acteVenteData.acheteurTypePartie}
                      onValueChange={(value) => setActeVenteData({...acteVenteData, acheteurTypePartie: value})}
                    >
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="personne_physique" id="acheteur_pp" />
                        <Label htmlFor="acheteur_pp" className="cursor-pointer">Personne physique</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="personne_morale" id="acheteur_pm" />
                        <Label htmlFor="acheteur_pm" className="cursor-pointer">Personne morale (soci√©t√©)</Label>
                      </div>
                    </RadioGroup>
                  </div>

                  {/* Si personne morale - Acqu√©reur */}
                  {acteVenteData.acheteurTypePartie === "personne_morale" && (
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-blue-50 dark:bg-blue-950 rounded-lg">
                      <div className="space-y-2 md:col-span-2">
                        <Label htmlFor="acheteur_denomination">D√©nomination sociale *</Label>
                        <Input 
                          id="acheteur_denomination"
                          value={acteVenteData.acheteurDenominationSociale}
                          onChange={(e) => setActeVenteData({...acteVenteData, acheteurDenominationSociale: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="acheteur_forme">Forme juridique *</Label>
                        <Input 
                          id="acheteur_forme"
                          value={acteVenteData.acheteurFormeJuridique}
                          onChange={(e) => setActeVenteData({...acteVenteData, acheteurFormeJuridique: e.target.value})}
                          placeholder="SARL, SAS, SCI..."
                        />
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="acheteur_siren">SIREN *</Label>
                        <Input 
                          id="acheteur_siren"
                          value={acteVenteData.acheteurSiren}
                          onChange={(e) => setActeVenteData({...acteVenteData, acheteurSiren: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2 md:col-span-2">
                        <Label htmlFor="acheteur_siege">Adresse du si√®ge social *</Label>
                        <Input 
                          id="acheteur_siege"
                          value={acteVenteData.acheteurSiegeSocial}
                          onChange={(e) => setActeVenteData({...acteVenteData, acheteurSiegeSocial: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="acheteur_representant">Nom du repr√©sentant l√©gal *</Label>
                        <Input 
                          id="acheteur_representant"
                          value={acteVenteData.acheteurRepresentantNom}
                          onChange={(e) => setActeVenteData({...acteVenteData, acheteurRepresentantNom: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="acheteur_qualite">Qualit√© *</Label>
                        <Input 
                          id="acheteur_qualite"
                          value={acteVenteData.acheteurRepresentantQualite}
                          onChange={(e) => setActeVenteData({...acteVenteData, acheteurRepresentantQualite: e.target.value})}
                          placeholder="G√©rant, Pr√©sident..."
                        />
                      </div>
                      <div className="space-y-2 md:col-span-2">
                        <Label>üìé Extrait Kbis</Label>
                        <button
                          type="button"
                          className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                          onClick={() => document.getElementById('kbis-acheteur')?.click()}
                        >
                          <svg className="w-4 h-4 text-orange-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                          </svg>
                          <span className="text-sm flex-1 text-orange-700">Aucune pi√®ce charg√©e - Cliquer pour ajouter</span>
                        </button>
                        <Input id="kbis-acheteur" type="file" accept=".pdf" className="hidden" />
                      </div>
                    </div>
                  )}

                  {/* Repr√©sentation - Acqu√©reur */}
                  <div className="space-y-4">
                    <Label>La partie est-elle repr√©sent√©e ?</Label>
                    <RadioGroup 
                      value={acteVenteData.acheteurRepresente}
                      onValueChange={(value) => setActeVenteData({...acteVenteData, acheteurRepresente: value})}
                    >
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="non" id="acheteur_rep_non" />
                        <Label htmlFor="acheteur_rep_non" className="cursor-pointer">Non</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="oui" id="acheteur_rep_oui" />
                        <Label htmlFor="acheteur_rep_oui" className="cursor-pointer">Oui</Label>
                      </div>
                    </RadioGroup>
                  </div>

                  {/* Si repr√©sent√© - Acqu√©reur */}
                  {acteVenteData.acheteurRepresente === "oui" && (
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-amber-50 dark:bg-amber-950 rounded-lg">
                      <div className="space-y-2">
                        <Label htmlFor="acheteur_mand_nom">Nom du mandataire *</Label>
                        <Input 
                          id="acheteur_mand_nom"
                          value={acteVenteData.acheteurMandataireNom}
                          onChange={(e) => setActeVenteData({...acteVenteData, acheteurMandataireNom: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="acheteur_mand_prenom">Pr√©nom du mandataire *</Label>
                        <Input 
                          id="acheteur_mand_prenom"
                          value={acteVenteData.acheteurMandatairePrenom}
                          onChange={(e) => setActeVenteData({...acteVenteData, acheteurMandatairePrenom: e.target.value})}
                        />
                      </div>
                      <div className="space-y-2 md:col-span-2">
                        <Label htmlFor="acheteur_type_pouvoir">Type de pouvoir *</Label>
                        <Select value={acteVenteData.acheteurTypePouvoir} onValueChange={(value) => setActeVenteData({...acteVenteData, acheteurTypePouvoir: value})}>
                          <SelectTrigger>
                            <SelectValue placeholder="S√©lectionner..." />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="mandat_authentique">Mandat authentique</SelectItem>
                            <SelectItem value="mandat_ssp">Mandat sous seing priv√©</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2 md:col-span-2">
                        <Label>üìé Joindre le mandat (PDF)</Label>
                        <button
                          type="button"
                          className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                          onClick={() => document.getElementById('mandat-acheteur')?.click()}
                        >
                          <svg className="w-4 h-4 text-orange-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                          </svg>
                          <span className="text-sm flex-1 text-orange-700">Aucune pi√®ce charg√©e - Cliquer pour ajouter</span>
                        </button>
                        <Input id="mandat-acheteur" type="file" accept=".pdf" className="hidden" />
                      </div>
                    </div>
                  )}
                  
                  {/* Pi√®ce d'identit√© de l'acqu√©reur - charg√©e depuis client ou upload */}
                  {acteVenteData.clientRole === "acheteur" && acteVenteData.clientId ? (
                    <div className="space-y-2">
                      <Label>üìé Pi√®ce d'identit√©</Label>
                      {acteClientIdentiteUrl ? (
                        <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg">
                          <svg className="w-4 h-4 text-green-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                          </svg>
                          <span className="text-sm flex-1 text-green-700">Pi√®ce d'identit√© charg√©e depuis le profil client</span>
                          <Button
                            type="button"
                            variant="ghost"
                            size="sm"
                            className="bg-green-600 hover:bg-green-700 text-white"
                            onClick={() => window.open(acteClientIdentiteUrl, '_blank')}
                          >
                            <Eye className="w-4 h-4" />
                          </Button>
                        </div>
                      ) : (
                        <div className="flex items-center gap-2 p-2 bg-orange-50 border border-orange-200 rounded-lg">
                          <svg className="w-4 h-4 text-orange-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                          </svg>
                          <span className="text-sm flex-1 text-orange-700">Aucune pi√®ce d'identit√© dans le profil client</span>
                        </div>
                      )}
                    </div>
                  ) : (
                    /* Upload de pi√®ces d'identit√© acheteur */
                  <MultiFileUpload
                    label="üìé Pi√®ces d'identit√© de l'acheteur"
                    files={acteAcheteurFiles}
                    onFilesChange={setActeAcheteurFiles}
                    accept="application/pdf,image/*"
                  />
                  )}
                </div>

                {/* Informations sur le bien */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üè† Informations sur le bien</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2 md:col-span-2">
                      <Label htmlFor="acte_adresse">Adresse compl√®te du bien *</Label>
                      <Input 
                        id="acte_adresse"
                        value={acteVenteData.adresseBien}
                        onChange={(e) => setActeVenteData({...acteVenteData, adresseBien: e.target.value})}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_typeBien">Type de bien *</Label>
                      <Select value={acteVenteData.typeBien} onValueChange={(value) => setActeVenteData({...acteVenteData, typeBien: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="appartement">Appartement</SelectItem>
                          <SelectItem value="maison">Maison</SelectItem>
                          <SelectItem value="terrain">Terrain</SelectItem>
                          <SelectItem value="immeuble">Immeuble</SelectItem>
                          <SelectItem value="local_commercial">Local commercial</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_naturePropriete">Nature de propri√©t√© *</Label>
                      <Select value={acteVenteData.naturePropriete} onValueChange={(value) => setActeVenteData({...acteVenteData, naturePropriete: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="pleine_propriete">Pleine propri√©t√©</SelectItem>
                          <SelectItem value="usufruit">Usufruit</SelectItem>
                          <SelectItem value="nue_propriete">Nue-propri√©t√©</SelectItem>
                          <SelectItem value="indivision">Indivision</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_sectionCadastrale">Section cadastrale *</Label>
                      <Input id="acte_sectionCadastrale" value={acteVenteData.sectionCadastrale} onChange={(e) => setActeVenteData({...acteVenteData, sectionCadastrale: e.target.value})} placeholder="Ex: AB" />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_numeroCadastral">Num√©ro cadastral *</Label>
                      <Input id="acte_numeroCadastral" value={acteVenteData.numeroCadastral} onChange={(e) => setActeVenteData({...acteVenteData, numeroCadastral: e.target.value})} placeholder="Ex: 123" />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_contenanceCadastrale">Contenance cadastrale *</Label>
                      <Input id="acte_contenanceCadastrale" value={acteVenteData.contenanceCadastrale} onChange={(e) => setActeVenteData({...acteVenteData, contenanceCadastrale: e.target.value})} placeholder="Ex: 500 m¬≤" />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_surfaceHabitable">Surface habitable (m¬≤) *</Label>
                      <Input id="acte_surfaceHabitable" type="number" value={acteVenteData.surfaceHabitable} onChange={(e) => setActeVenteData({...acteVenteData, surfaceHabitable: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_surfaceTerrain">Surface du terrain (m¬≤)</Label>
                      <Input id="acte_surfaceTerrain" type="number" value={acteVenteData.surfaceTerrain} onChange={(e) => setActeVenteData({...acteVenteData, surfaceTerrain: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_nombrePieces">Nombre de pi√®ces</Label>
                      <Input id="acte_nombrePieces" type="number" value={acteVenteData.nombrePieces} onChange={(e) => setActeVenteData({...acteVenteData, nombrePieces: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_anneeConstruction">Ann√©e de construction</Label>
                      <Input id="acte_anneeConstruction" type="number" value={acteVenteData.anneeConstruction} onChange={(e) => setActeVenteData({...acteVenteData, anneeConstruction: e.target.value})} placeholder="Ex: 1990" />
                    </div>
                  </div>

                  {/* Annexes et d√©pendances */}
                  <div className="space-y-4 p-4 bg-slate-50 dark:bg-slate-900 rounded-lg">
                    <h4 className="font-medium">Annexes et d√©pendances</h4>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label htmlFor="acte_garage">Garage</Label>
                        <Select value={acteVenteData.bienGarage} onValueChange={(value) => setActeVenteData({...acteVenteData, bienGarage: value})}>
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="non">Non</SelectItem>
                            <SelectItem value="oui">Oui</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="acte_parking">Parking</Label>
                        <Select value={acteVenteData.bienParking} onValueChange={(value) => setActeVenteData({...acteVenteData, bienParking: value})}>
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="non">Non</SelectItem>
                            <SelectItem value="oui">Oui</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="acte_cave">Cave</Label>
                        <Select value={acteVenteData.bienCave} onValueChange={(value) => setActeVenteData({...acteVenteData, bienCave: value})}>
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="non">Non</SelectItem>
                            <SelectItem value="oui">Oui</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="acte_grenier">Grenier</Label>
                        <Select value={acteVenteData.bienGrenier} onValueChange={(value) => setActeVenteData({...acteVenteData, bienGrenier: value})}>
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="non">Non</SelectItem>
                            <SelectItem value="oui">Oui</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="acte_jardin">Jardin</Label>
                        <Select value={acteVenteData.bienJardin} onValueChange={(value) => setActeVenteData({...acteVenteData, bienJardin: value})}>
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="non">Non</SelectItem>
                            <SelectItem value="oui">Oui</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="acte_autresDep">Autres d√©pendances</Label>
                        <Input 
                          id="acte_autresDep"
                          value={acteVenteData.autresDependances}
                          onChange={(e) => setActeVenteData({...acteVenteData, autresDependances: e.target.value})}
                          placeholder="Ex: buanderie, atelier..."
                        />
                      </div>
                    </div>
                  </div>

                  {/* √âquipements inclus dans la vente */}
                  <div className="space-y-4 p-4 bg-green-50 dark:bg-green-950 rounded-lg">
                    <h4 className="font-medium">√âquipements inclus dans la vente</h4>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label htmlFor="acte_cuisine">Cuisine √©quip√©e</Label>
                        <Select value={acteVenteData.cuisineEquipee} onValueChange={(value) => setActeVenteData({...acteVenteData, cuisineEquipee: value})}>
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="non">Non</SelectItem>
                            <SelectItem value="oui">Oui</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="acte_electromenagers">√âlectrom√©nagers inclus</Label>
                        <Select value={acteVenteData.electromenagersInclus} onValueChange={(value) => setActeVenteData({...acteVenteData, electromenagersInclus: value})}>
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="non">Non</SelectItem>
                            <SelectItem value="oui">Oui</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      {acteVenteData.electromenagersInclus === "oui" && (
                        <div className="space-y-2 md:col-span-2">
                          <Label htmlFor="acte_electroListe">Liste des √©lectrom√©nagers</Label>
                          <Textarea 
                            id="acte_electroListe"
                            value={acteVenteData.electromenagersListe}
                            onChange={(e) => setActeVenteData({...acteVenteData, electromenagersListe: e.target.value})}
                            placeholder="Ex: r√©frig√©rateur, four, lave-vaisselle..."
                            rows={2}
                          />
                        </div>
                      )}
                      <div className="space-y-2">
                        <Label htmlFor="acte_mobilier">Mobilier laiss√©</Label>
                        <Select value={acteVenteData.mobilierLaisse} onValueChange={(value) => setActeVenteData({...acteVenteData, mobilierLaisse: value})}>
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="non">Non</SelectItem>
                            <SelectItem value="oui">Oui</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <Label htmlFor="acte_autresEquip">Autres √©quipements</Label>
                        <Input 
                          id="acte_autresEquip"
                          value={acteVenteData.autresEquipements}
                          onChange={(e) => setActeVenteData({...acteVenteData, autresEquipements: e.target.value})}
                          placeholder="Ex: climatisation, alarme..."
                        />
                      </div>
                    </div>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2 md:col-span-2">
                      <Label htmlFor="acte_destinationBien">Destination du bien *</Label>
                      <Select value={acteVenteData.destinationBien} onValueChange={(value) => setActeVenteData({...acteVenteData, destinationBien: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="habitation">Habitation</SelectItem>
                          <SelectItem value="commerciale">Commerciale</SelectItem>
                          <SelectItem value="mixte">Mixte</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>
                </div>

                {/* Copropri√©t√© */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üè¢ Copropri√©t√©</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label htmlFor="acte_bienCopropriete">Bien en copropri√©t√© ? *</Label>
                      <Select value={acteVenteData.bienCopropriete} onValueChange={(value) => setActeVenteData({...acteVenteData, bienCopropriete: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="oui">Oui</SelectItem>
                          <SelectItem value="non">Non</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    {acteVenteData.bienCopropriete === "oui" && (
                      <>
                        <div className="space-y-2">
                          <Label htmlFor="acte_numerosLots">Num√©ros de lot(s)</Label>
                          <Input id="acte_numerosLots" value={acteVenteData.numerosLots} onChange={(e) => setActeVenteData({...acteVenteData, numerosLots: e.target.value})} placeholder="Ex: 12, 13, 14" />
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="acte_tantiemes">Tanti√®mes / Quote-parts</Label>
                          <Input id="acte_tantiemes" value={acteVenteData.tanti√®mes} onChange={(e) => setActeVenteData({...acteVenteData, tanti√®mes: e.target.value})} placeholder="Ex: 150/10000" />
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="acte_reglementCopro">R√®glement de copropri√©t√© disponible ?</Label>
                          <Select value={acteVenteData.reglementCopro} onValueChange={(value) => setActeVenteData({...acteVenteData, reglementCopro: value})}>
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="oui">Oui</SelectItem>
                              <SelectItem value="non">Non</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="acte_chargesAnnuelles">Charges annuelles (‚Ç¨)</Label>
                          <Input id="acte_chargesAnnuelles" type="number" value={acteVenteData.chargesAnnuelles} onChange={(e) => setActeVenteData({...acteVenteData, chargesAnnuelles: e.target.value})} />
                        </div>
                      </>
                    )}
                  </div>
                </div>

                {/* √âtat juridique */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">‚öñÔ∏è √âtat juridique du bien</h3>
                  <div className="space-y-4">
                    <div className="space-y-2">
                      <Label htmlFor="acte_servitudes">Servitudes existantes</Label>
                      <Textarea id="acte_servitudes" value={acteVenteData.servitudesExistantes} onChange={(e) => setActeVenteData({...acteVenteData, servitudesExistantes: e.target.value})} rows={2} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_hypotheques">Hypoth√®ques / Inscriptions existantes</Label>
                      <Textarea id="acte_hypotheques" value={acteVenteData.hypotheques} onChange={(e) => setActeVenteData({...acteVenteData, hypotheques: e.target.value})} rows={2} />
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label htmlFor="acte_bienLibre">Bien libre ou occup√© √† l'acte ?</Label>
                        <Select value={acteVenteData.bienLibreOuOccupe} onValueChange={(value) => setActeVenteData({...acteVenteData, bienLibreOuOccupe: value})}>
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="libre">Libre</SelectItem>
                            <SelectItem value="occupe">Occup√©</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      {acteVenteData.bienLibreOuOccupe === "occupe" && (
                        <div className="space-y-2">
                          <Label htmlFor="acte_infoBail">Informations sur le bail</Label>
                          <Input id="acte_infoBail" value={acteVenteData.informationsBail} onChange={(e) => setActeVenteData({...acteVenteData, informationsBail: e.target.value})} />
                        </div>
                      )}
                    </div>

                    {/* D√©tails d'occupation si occup√© */}
                    {acteVenteData.bienLibreOuOccupe === "occupe" && (
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-amber-50 dark:bg-amber-950 rounded-lg">
                        <div className="space-y-2 md:col-span-2">
                          <Label htmlFor="acte_locataireNom">Nom du locataire</Label>
                          <Input 
                            id="acte_locataireNom"
                            value={acteVenteData.locataireNom}
                            onChange={(e) => setActeVenteData({...acteVenteData, locataireNom: e.target.value})}
                          />
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="acte_dateBail">Date du bail</Label>
                          <Input 
                            id="acte_dateBail"
                            type="date"
                            value={acteVenteData.dateBail}
                            onChange={(e) => setActeVenteData({...acteVenteData, dateBail: e.target.value})}
                          />
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="acte_dureeBail">Dur√©e du bail</Label>
                          <Input 
                            id="acte_dureeBail"
                            value={acteVenteData.dureeBail}
                            onChange={(e) => setActeVenteData({...acteVenteData, dureeBail: e.target.value})}
                            placeholder="Ex: 3 ans"
                          />
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="acte_montantLoyer">Montant du loyer mensuel (‚Ç¨)</Label>
                          <Input 
                            id="acte_montantLoyer"
                            type="number"
                            value={acteVenteData.montantLoyer}
                            onChange={(e) => setActeVenteData({...acteVenteData, montantLoyer: e.target.value})}
                          />
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="acte_depotGarantieLocataire">D√©p√¥t de garantie (‚Ç¨)</Label>
                          <Input 
                            id="acte_depotGarantieLocataire"
                            type="number"
                            value={acteVenteData.depotGarantieLocataire}
                            onChange={(e) => setActeVenteData({...acteVenteData, depotGarantieLocataire: e.target.value})}
                          />
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="acte_dateLiberation">Date pr√©vue de lib√©ration</Label>
                          <Input 
                            id="acte_dateLiberation"
                            type="date"
                            value={acteVenteData.dateLiberation}
                            onChange={(e) => setActeVenteData({...acteVenteData, dateLiberation: e.target.value})}
                          />
                        </div>
                        <div className="space-y-2 md:col-span-2">
                          <Label>üìé Bail locatif (PDF)</Label>
                          <button
                            type="button"
                            className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                            onClick={() => document.getElementById('bail-locatif')?.click()}
                          >
                            <svg className="w-4 h-4 text-orange-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                            </svg>
                            <span className="text-sm flex-1 text-orange-700">Aucune pi√®ce charg√©e - Cliquer pour ajouter</span>
                          </button>
                          <Input id="bail-locatif" type="file" accept=".pdf" className="hidden" />
                        </div>
                      </div>
                    )}
                  </div>
                </div>

                {/* Conditions financi√®res */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üí∂ Conditions financi√®res</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label htmlFor="acte_prixVente">Prix de vente (‚Ç¨) *</Label>
                      <Input id="acte_prixVente" type="number" value={acteVenteData.prixVente} onChange={(e) => setActeVenteData({...acteVenteData, prixVente: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_origineFonds">Origine des fonds</Label>
                      <Input id="acte_origineFonds" value={acteVenteData.origineFonds} onChange={(e) => setActeVenteData({...acteVenteData, origineFonds: e.target.value})} placeholder="√âpargne / Revente / Pr√™t" />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_depotGarantie">D√©p√¥t de garantie vers√© (‚Ç¨)</Label>
                      <Input id="acte_depotGarantie" type="number" value={acteVenteData.depotGarantie} onChange={(e) => setActeVenteData({...acteVenteData, depotGarantie: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_fraisNotaire">Frais de notaire estim√©s (‚Ç¨)</Label>
                      <Input id="acte_fraisNotaire" type="number" value={acteVenteData.fraisNotaire} onChange={(e) => setActeVenteData({...acteVenteData, fraisNotaire: e.target.value})} />
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label htmlFor="acte_repartition">R√©partition prorata temporis</Label>
                      <Textarea id="acte_repartition" value={acteVenteData.repartitionProrata} onChange={(e) => setActeVenteData({...acteVenteData, repartitionProrata: e.target.value})} rows={2} placeholder="Taxe fonci√®re, charges, loyers..." />
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label htmlFor="acte_modalitesPaiement">Modalit√©s de paiement</Label>
                      <Textarea id="acte_modalitesPaiement" value={acteVenteData.modalitesPaiement} onChange={(e) => setActeVenteData({...acteVenteData, modalitesPaiement: e.target.value})} rows={2} placeholder="Virement notarial / Pr√™ts bancaires" />
                    </div>
                  </div>
                </div>

                {/* Pr√™t immobilier */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üè¶ Pr√™t immobilier</h3>
                  <div className="space-y-4">
                    <div className="space-y-2">
                      <Label htmlFor="acte_pretImmobilier">Achat financ√© par pr√™t ?</Label>
                      <Select value={acteVenteData.pretImmobilier} onValueChange={(value) => setActeVenteData({...acteVenteData, pretImmobilier: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="oui">Oui</SelectItem>
                          <SelectItem value="non">Non</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    {acteVenteData.pretImmobilier === "oui" && (
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-muted/30 rounded-lg">
                        <div className="space-y-2">
                          <Label htmlFor="acte_montantPret">Montant du pr√™t (‚Ç¨) *</Label>
                          <Input id="acte_montantPret" type="number" value={acteVenteData.montantPret} onChange={(e) => setActeVenteData({...acteVenteData, montantPret: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="acte_banque">Banque pr√™teuse *</Label>
                          <Input id="acte_banque" value={acteVenteData.banquePreteur} onChange={(e) => setActeVenteData({...acteVenteData, banquePreteur: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="acte_tauxPret">Taux r√©el obtenu (%) *</Label>
                          <Input id="acte_tauxPret" type="number" step="0.01" value={acteVenteData.tauxPret} onChange={(e) => setActeVenteData({...acteVenteData, tauxPret: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="acte_dureePret">Dur√©e du pr√™t (ann√©es) *</Label>
                          <Input id="acte_dureePret" type="number" value={acteVenteData.dureePret} onChange={(e) => setActeVenteData({...acteVenteData, dureePret: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="acte_typePret">Type de pr√™t *</Label>
                          <Input id="acte_typePret" value={acteVenteData.typePret} onChange={(e) => setActeVenteData({...acteVenteData, typePret: e.target.value})} placeholder="Amortissable / Relais / PTZ" />
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="acte_dateAccordPret">Date accord de pr√™t *</Label>
                          <Input id="acte_dateAccordPret" type="date" value={acteVenteData.dateAccordPret} onChange={(e) => setActeVenteData({...acteVenteData, dateAccordPret: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="acte_tauxMaximal">Taux maximal accept√© (%)</Label>
                          <Input 
                            id="acte_tauxMaximal"
                            type="number"
                            step="0.01"
                            value={acteVenteData.tauxMaximal}
                            onChange={(e) => setActeVenteData({...acteVenteData, tauxMaximal: e.target.value})}
                            placeholder="Ex: 4.5"
                          />
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="acte_conditionSuspensivePret">Condition suspensive de pr√™t</Label>
                          <Select 
                            value={acteVenteData.conditionSuspensivePret} 
                            onValueChange={(value) => setActeVenteData({...acteVenteData, conditionSuspensivePret: value})}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="oui">Oui</SelectItem>
                              <SelectItem value="non">Non</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="space-y-2 md:col-span-2">
                          <Label htmlFor="acte_conditionsPret">Conditions particuli√®res du pr√™t</Label>
                          <Textarea id="acte_conditionsPret" value={acteVenteData.conditionsPret} onChange={(e) => setActeVenteData({...acteVenteData, conditionsPret: e.target.value})} rows={2} />
                        </div>
                      </div>
                    )}
                  </div>
                </div>

                {/* Documents et diagnostics */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üìú Documents & diagnostics obligatoires</h3>
                  
                  {/* Diagnostics - donn√©es essentielles */}
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-purple-50 dark:bg-purple-950 rounded-lg">
                    <div className="space-y-2">
                      <Label htmlFor="acte_dateDPE">Date du DPE</Label>
                      <Input 
                        id="acte_dateDPE"
                        type="date"
                        value={acteVenteData.dateDPE}
                        onChange={(e) => setActeVenteData({...acteVenteData, dateDPE: e.target.value})}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_classeEnergetique">Classe √©nerg√©tique</Label>
                      <Select 
                        value={acteVenteData.classeEnergetique} 
                        onValueChange={(value) => setActeVenteData({...acteVenteData, classeEnergetique: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="A">A</SelectItem>
                          <SelectItem value="B">B</SelectItem>
                          <SelectItem value="C">C</SelectItem>
                          <SelectItem value="D">D</SelectItem>
                          <SelectItem value="E">E</SelectItem>
                          <SelectItem value="F">F</SelectItem>
                          <SelectItem value="G">G</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_presenceAmiante">Pr√©sence d'amiante</Label>
                      <Select 
                        value={acteVenteData.presenceAmiante} 
                        onValueChange={(value) => setActeVenteData({...acteVenteData, presenceAmiante: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="non">Non</SelectItem>
                          <SelectItem value="oui">Oui</SelectItem>
                          <SelectItem value="non_applicable">Non applicable</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_presencePlomb">Pr√©sence de plomb</Label>
                      <Select 
                        value={acteVenteData.presencePlomb} 
                        onValueChange={(value) => setActeVenteData({...acteVenteData, presencePlomb: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="non">Non</SelectItem>
                          <SelectItem value="oui">Oui</SelectItem>
                          <SelectItem value="non_applicable">Non applicable</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_presenceTermites">Pr√©sence de termites</Label>
                      <Select 
                        value={acteVenteData.presenceTermites} 
                        onValueChange={(value) => setActeVenteData({...acteVenteData, presenceTermites: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="non">Non</SelectItem>
                          <SelectItem value="oui">Oui</SelectItem>
                          <SelectItem value="non_applicable">Non applicable</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_assainissementConforme">Assainissement conforme</Label>
                      <Select 
                        value={acteVenteData.assainissementConforme} 
                        onValueChange={(value) => setActeVenteData({...acteVenteData, assainissementConforme: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="oui">Oui</SelectItem>
                          <SelectItem value="non">Non</SelectItem>
                          <SelectItem value="non_applicable">Non applicable</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>

                  <div className="space-y-2">
                    <Label htmlFor="acte_diagnostics">Autres diagnostics fournis</Label>
                    <Textarea id="acte_diagnostics" value={acteVenteData.diagnosticsFournis} onChange={(e) => setActeVenteData({...acteVenteData, diagnosticsFournis: e.target.value})} rows={3} placeholder="√âlectricit√©, Gaz, Loi Carrez, ERP, Audit √©nerg√©tique..." />
                  </div>
                  <MultiFileUpload
                    label="üìé Joindre les diagnostics et documents obligatoires"
                    files={acteDiagnosticsFiles}
                    onFilesChange={setActeDiagnosticsFiles}
                    accept="application/pdf"
                  />
                </div>

                {/* D√©clarations vendeur */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">D√©clarations & attestations du vendeur</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label htmlFor="acte_origineDate">Date d'acquisition pr√©c√©dente *</Label>
                      <Input id="acte_origineDate" type="date" value={acteVenteData.origineProprieteDateAcquisition} onChange={(e) => setActeVenteData({...acteVenteData, origineProprieteDateAcquisition: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_origineRef">R√©f√©rence acte d'acquisition *</Label>
                      <Input id="acte_origineRef" value={acteVenteData.origineReferenceActe} onChange={(e) => setActeVenteData({...acteVenteData, origineReferenceActe: e.target.value})} />
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label htmlFor="acte_travaux">Travaux r√©alis√©s (10 derni√®res ann√©es)</Label>
                      <Textarea id="acte_travaux" value={acteVenteData.travauxDerniers10ans} onChange={(e) => setActeVenteData({...acteVenteData, travauxDerniers10ans: e.target.value})} rows={2} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_conformiteUrbanisme">Conformit√© urbanisme</Label>
                      <Input id="acte_conformiteUrbanisme" value={acteVenteData.conformiteUrbanisme} onChange={(e) => setActeVenteData({...acteVenteData, conformiteUrbanisme: e.target.value})} placeholder="Permis, d√©clarations..." />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_assuranceDO">Assurance dommage-ouvrage</Label>
                      <Input id="acte_assuranceDO" value={acteVenteData.assuranceDommageOuvrage} onChange={(e) => setActeVenteData({...acteVenteData, assuranceDommageOuvrage: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_taxesFoncieres">Taxes fonci√®res N-1 (‚Ç¨)</Label>
                      <Input id="acte_taxesFoncieres" type="number" value={acteVenteData.taxesFoncieres} onChange={(e) => setActeVenteData({...acteVenteData, taxesFoncieres: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_sinistre">Sinistre r√©cent ?</Label>
                      <Select value={acteVenteData.sinistreRecent} onValueChange={(value) => setActeVenteData({...acteVenteData, sinistreRecent: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="oui">Oui</SelectItem>
                          <SelectItem value="non">Non</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>
                </div>

                {/* Urbanisme */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üèõÔ∏è Urbanisme</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label htmlFor="acte_zonePLU">Zone PLU / POS</Label>
                      <Input id="acte_zonePLU" value={acteVenteData.zonePLU} onChange={(e) => setActeVenteData({...acteVenteData, zonePLU: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_droitPreemption">Droit de pr√©emption</Label>
                      <Input id="acte_droitPreemption" value={acteVenteData.droitPreemption} onChange={(e) => setActeVenteData({...acteVenteData, droitPreemption: e.target.value})} placeholder="Exerc√© / Lev√© + date" />
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label htmlFor="acte_declarationsUrbanisme">D√©clarations d'urbanisme pass√©es</Label>
                      <Textarea id="acte_declarationsUrbanisme" value={acteVenteData.declarationsUrbanisme} onChange={(e) => setActeVenteData({...acteVenteData, declarationsUrbanisme: e.target.value})} rows={2} placeholder="DP, permis de construire, etc." />
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label htmlFor="acte_documentsUrbanisme">Documents d'urbanisme fournis</Label>
                      <Input id="acte_documentsUrbanisme" value={acteVenteData.documentsUrbanisme} onChange={(e) => setActeVenteData({...acteVenteData, documentsUrbanisme: e.target.value})} />
                    </div>
                  </div>

                  {/* DIA - D√©claration d'Intention d'Ali√©ner */}
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-indigo-50 dark:bg-indigo-950 rounded-lg">
                    <div className="space-y-2">
                      <Label htmlFor="acte_dateEnvoiDIA">Date d'envoi de la DIA</Label>
                      <Input 
                        id="acte_dateEnvoiDIA"
                        type="date"
                        value={acteVenteData.dateEnvoiDIA}
                        onChange={(e) => setActeVenteData({...acteVenteData, dateEnvoiDIA: e.target.value})}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_reponseMairieDIA">R√©ponse de la mairie</Label>
                      <Select 
                        value={acteVenteData.reponseMairieDIA} 
                        onValueChange={(value) => setActeVenteData({...acteVenteData, reponseMairieDIA: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="non_preemption">Non pr√©emption</SelectItem>
                          <SelectItem value="preemption">Pr√©emption</SelectItem>
                          <SelectItem value="en_attente">En attente</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>
                </div>

                {/* D√©lais et signature */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üìÖ D√©lais & modalit√©s de signature</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label htmlFor="acte_dateSignature">Date de signature de l'acte *</Label>
                      <Input id="acte_dateSignature" type="date" value={acteVenteData.dateSignatureActe} onChange={(e) => setActeVenteData({...acteVenteData, dateSignatureActe: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_lieuSignature">Lieu de signature *</Label>
                      <Input id="acte_lieuSignature" value={acteVenteData.lieuSignature} onChange={(e) => setActeVenteData({...acteVenteData, lieuSignature: e.target.value})} placeholder="√âtude notariale" />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_remiseCles">Remise des cl√©s</Label>
                      <Select value={acteVenteData.remiseCles} onValueChange={(value) => setActeVenteData({...acteVenteData, remiseCles: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="signature">√Ä la signature</SelectItem>
                          <SelectItem value="differee">Diff√©r√©e</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_procuration">Procuration ?</Label>
                      <Select value={acteVenteData.procuration} onValueChange={(value) => setActeVenteData({...acteVenteData, procuration: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="oui">Oui</SelectItem>
                          <SelectItem value="non">Non</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    {acteVenteData.procuration === "oui" && (
                      <div className="space-y-2 md:col-span-2">
                        <Label htmlFor="acte_mandataire">Identit√© du mandataire</Label>
                        <Input id="acte_mandataire" value={acteVenteData.identiteMandataire} onChange={(e) => setActeVenteData({...acteVenteData, identiteMandataire: e.target.value})} />
                      </div>
                    )}
                  </div>

                  {/* Remise des cl√©s anticip√©e */}
                  <div className="space-y-4 p-4 bg-teal-50 dark:bg-teal-950 rounded-lg">
                    <h4 className="font-medium">Remise des cl√©s anticip√©e</h4>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label htmlFor="acte_remiseClesAnticipee">Remise anticip√©e des cl√©s</Label>
                        <Select 
                          value={acteVenteData.remiseClesAnticipee} 
                          onValueChange={(value) => setActeVenteData({...acteVenteData, remiseClesAnticipee: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="non">Non</SelectItem>
                            <SelectItem value="oui">Oui</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      {acteVenteData.remiseClesAnticipee === "oui" && (
                        <>
                          <div className="space-y-2">
                            <Label htmlFor="acte_dateRemiseAnticipee">Date de remise anticip√©e</Label>
                            <Input 
                              id="acte_dateRemiseAnticipee"
                              type="date"
                              value={acteVenteData.dateRemiseAnticipee}
                              onChange={(e) => setActeVenteData({...acteVenteData, dateRemiseAnticipee: e.target.value})}
                            />
                          </div>
                          <div className="space-y-2">
                            <Label htmlFor="acte_indemnit√©Occupation">Indemnit√© d'occupation</Label>
                            <Select 
                              value={acteVenteData.indemnit√©Occupation} 
                              onValueChange={(value) => setActeVenteData({...acteVenteData, indemnit√©Occupation: value})}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="non">Non</SelectItem>
                                <SelectItem value="oui">Oui</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>
                          {acteVenteData.indemnit√©Occupation === "oui" && (
                            <div className="space-y-2">
                              <Label htmlFor="acte_montantIndemnite">Montant de l'indemnit√© (‚Ç¨/jour)</Label>
                              <Input 
                                id="acte_montantIndemnite"
                                type="number"
                                value={acteVenteData.montantIndemnite}
                                onChange={(e) => setActeVenteData({...acteVenteData, montantIndemnite: e.target.value})}
                              />
                            </div>
                          )}
                        </>
                      )}
                    </div>
                  </div>
                </div>

                {/* Annexes */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üß© Annexes √† joindre</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label htmlFor="acte_titrePropriete">Titre de propri√©t√© pr√©c√©dent</Label>
                      <Input id="acte_titrePropriete" value={acteVenteData.titrePropriete} onChange={(e) => setActeVenteData({...acteVenteData, titrePropriete: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_diagnosticsAnnexes">Diagnostics (fichiers)</Label>
                      <Input id="acte_diagnosticsAnnexes" value={acteVenteData.diagnostics} onChange={(e) => setActeVenteData({...acteVenteData, diagnostics: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_plan">Plan du bien</Label>
                      <Input id="acte_plan" value={acteVenteData.planBien} onChange={(e) => setActeVenteData({...acteVenteData, planBien: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_reglementCoproAnnexe">Copie r√®glement de copropri√©t√©</Label>
                      <Input id="acte_reglementCoproAnnexe" value={acteVenteData.reglementCopropriete} onChange={(e) => setActeVenteData({...acteVenteData, reglementCopropriete: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_etatDate">√âtat dat√©</Label>
                      <Input id="acte_etatDate" value={acteVenteData.etatDate} onChange={(e) => setActeVenteData({...acteVenteData, etatDate: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_attestationAssurance">Attestation d'assurance (PNO)</Label>
                      <Input id="acte_attestationAssurance" value={acteVenteData.attestationAssurance} onChange={(e) => setActeVenteData({...acteVenteData, attestationAssurance: e.target.value})} />
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label htmlFor="acte_releveSyndic">Relev√© du syndic</Label>
                      <Input id="acte_releveSyndic" value={acteVenteData.releveSyndic} onChange={(e) => setActeVenteData({...acteVenteData, releveSyndic: e.target.value})} />
                    </div>
                  </div>
                </div>

                {/* Informations compl√©mentaires */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üéØ Informations compl√©mentaires</h3>
                  <div className="space-y-4">
                    <div className="space-y-2">
                      <Label htmlFor="acte_travauxPrevus">Travaux pr√©vus par la copropri√©t√©</Label>
                      <Textarea id="acte_travauxPrevus" value={acteVenteData.travauxPrevusCopro} onChange={(e) => setActeVenteData({...acteVenteData, travauxPrevusCopro: e.target.value})} rows={2} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_procedures">Proc√©dures en cours</Label>
                      <Textarea id="acte_procedures" value={acteVenteData.proceduresEnCours} onChange={(e) => setActeVenteData({...acteVenteData, proceduresEnCours: e.target.value})} rows={2} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_differends">Diff√©rends connus avec un voisin</Label>
                      <Textarea id="acte_differends" value={acteVenteData.differendsVoisins} onChange={(e) => setActeVenteData({...acteVenteData, differendsVoisins: e.target.value})} rows={2} />
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="acte_particularites">Particularit√©s du bien</Label>
                      <Textarea id="acte_particularites" value={acteVenteData.particularitesBien} onChange={(e) => setActeVenteData({...acteVenteData, particularitesBien: e.target.value})} rows={3} />
                    </div>
                  </div>
                </div>
              </>
            )}

            {/* Formulaire sp√©cifique pour Bail d'habitation */}
            {(pendingContractType === "Bail d'habitation vide" || pendingContractType === "Bail d'habitation meubl√©") && (
              <>
                {/* S√©lection du r√¥le du client */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üë§ Votre client</h3>
                  <div className="space-y-2">
                    <Label>Votre client est le *</Label>
                    <RadioGroup 
                      value={bailHabitationData.clientRole} 
                      onValueChange={(value) => {
                        setBailHabitationData({
                          ...bailHabitationData, 
                          clientRole: value,
                          clientId: "",
                          // Reset des champs de l'autre partie
                          ...(value === "bailleur" ? {
                            locataireClientId: "",
                            locataireNom: "",
                            locatairePrenom: "",
                            locataireAdresse: "",
                            locataireDateNaissance: "",
                            locataireLieuNaissance: "",
                            locataireNationalite: "",
                            locataireProfession: "",
                            locataireStatutMatrimonial: "",
                            nombreOccupants: "",
                          } : {
                            bailleurClientId: "",
                            bailleurNom: "",
                            bailleurPrenom: "",
                            bailleurAdresse: "",
                            bailleurDateNaissance: "",
                            bailleurLieuNaissance: "",
                            bailleurNationalite: "",
                            bailleurProfession: "",
                            bailleurStatutMatrimonial: "",
                          })
                        });
                      }}
                    >
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="bailleur" id="role_bailleur" />
                        <Label htmlFor="role_bailleur" className="cursor-pointer">Bailleur (propri√©taire)</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="locataire" id="role_locataire" />
                        <Label htmlFor="role_locataire" className="cursor-pointer">Locataire</Label>
                      </div>
                    </RadioGroup>
                  </div>
                </div>

                {/* Bailleur */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">
                    {bailHabitationData.clientRole === "bailleur" ? "üë§ Bailleur (votre client)" : "üë§ Bailleur"}
                  </h3>
                  
                  {/* S√©lection du client si bailleur */}
                  {bailHabitationData.clientRole === "bailleur" ? (
                    <div className="space-y-2">
                      <Label>S√©lectionner le client bailleur *</Label>
                      <Select 
                        value={bailHabitationData.clientId} 
                        onValueChange={(value) => {
                          const selectedClient = clients.find(c => c.id === value);
                          if (selectedClient) {
                            setBailHabitationData({
                              ...bailHabitationData,
                              clientId: value,
                              bailleurClientId: value,
                              bailleurNom: selectedClient.nom,
                              bailleurPrenom: selectedClient.prenom,
                              bailleurAdresse: selectedClient.adresse || "",
                              bailleurDateNaissance: selectedClient.date_naissance || "",
                              bailleurLieuNaissance: selectedClient.lieu_naissance || "",
                              bailleurNationalite: selectedClient.nationalite || "",
                              bailleurProfession: selectedClient.profession || "",
                              bailleurStatutMatrimonial: selectedClient.statut_matrimonial || "",
                            });
                          }
                        }}
                      >
                        <SelectTrigger><SelectValue placeholder="Choisir un client" /></SelectTrigger>
                        <SelectContent>
                          {clients.map((client) => (
                            <SelectItem key={client.id} value={client.id}>{client.nom} {client.prenom}</SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                    </div>
                  ) : (
                    <div className="text-sm text-muted-foreground mb-2">
                      Saisir manuellement les informations du bailleur
                    </div>
                  )}
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Nom *</Label>
                      <Input value={bailHabitationData.bailleurNom} onChange={(e) => setBailHabitationData({...bailHabitationData, bailleurNom: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label>Pr√©nom *</Label>
                      <Input value={bailHabitationData.bailleurPrenom} onChange={(e) => setBailHabitationData({...bailHabitationData, bailleurPrenom: e.target.value})} />
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label>Adresse *</Label>
                      <Input value={bailHabitationData.bailleurAdresse} onChange={(e) => setBailHabitationData({...bailHabitationData, bailleurAdresse: e.target.value})} />
                    </div>
                  </div>

                  {/* Pi√®ce d'identit√© du bailleur - charg√©e depuis client si c'est le client */}
                  {bailHabitationData.clientRole === "bailleur" && bailHabitationData.clientId ? (
                    <div className="space-y-2">
                      <Label>üìé Pi√®ce d'identit√©</Label>
                      {bailClientIdentiteUrl ? (
                        <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg">
                          <svg className="w-4 h-4 text-green-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                          </svg>
                          <span className="text-sm flex-1 text-green-700">Pi√®ce d'identit√© charg√©e depuis le profil client</span>
                          <Button
                            type="button"
                            variant="ghost"
                            size="sm"
                            className="bg-green-600 hover:bg-green-700 text-white"
                            onClick={() => window.open(bailClientIdentiteUrl, '_blank')}
                          >
                            <Eye className="mr-2 h-4 w-4" />
                            Voir
                          </Button>
                        </div>
                      ) : (
                        <div className="flex items-center gap-2 p-2 bg-orange-50 border border-orange-200 rounded-lg">
                          <svg className="w-4 h-4 text-orange-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                          </svg>
                          <span className="text-sm flex-1 text-orange-700">Aucune pi√®ce d'identit√© dans le profil client</span>
                        </div>
                      )}
                    </div>
                  ) : bailHabitationData.clientRole === "locataire" && (
                    /* Upload pour bailleur si le client est locataire */
                    <MultiFileUpload
                      label="üìé Pi√®ce d'identit√© du bailleur"
                      files={bailleurIdFiles}
                      onFilesChange={setBailleurIdFiles}
                      accept="application/pdf,image/*"
                    />
                  )}
                </div>

                {/* Locataire */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">
                    {bailHabitationData.clientRole === "locataire" ? "üë• Locataire (votre client)" : "üë• Locataire"}
                  </h3>
                  
                  {/* S√©lection du client si locataire */}
                  {bailHabitationData.clientRole === "locataire" ? (
                    <div className="space-y-2">
                      <Label>S√©lectionner le client locataire *</Label>
                      <Select 
                        value={bailHabitationData.clientId} 
                        onValueChange={(value) => {
                          const selectedClient = clients.find(c => c.id === value);
                          if (selectedClient) {
                            setBailHabitationData({
                              ...bailHabitationData,
                              clientId: value,
                              locataireClientId: value,
                              locataireNom: selectedClient.nom,
                              locatairePrenom: selectedClient.prenom,
                              locataireAdresse: selectedClient.adresse || "",
                              locataireDateNaissance: selectedClient.date_naissance || "",
                              locataireLieuNaissance: selectedClient.lieu_naissance || "",
                              locataireNationalite: selectedClient.nationalite || "",
                              locataireProfession: selectedClient.profession || "",
                              locataireStatutMatrimonial: selectedClient.statut_matrimonial || "",
                            });
                          }
                        }}
                      >
                        <SelectTrigger><SelectValue placeholder="Choisir un client" /></SelectTrigger>
                        <SelectContent>
                          {clients.map((client) => (
                            <SelectItem key={client.id} value={client.id}>{client.nom} {client.prenom}</SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                    </div>
                  ) : (
                    <div className="text-sm text-muted-foreground mb-2">
                      Saisir manuellement les informations du locataire
                    </div>
                  )}
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Nom *</Label>
                      <Input value={bailHabitationData.locataireNom} onChange={(e) => setBailHabitationData({...bailHabitationData, locataireNom: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label>Pr√©nom *</Label>
                      <Input value={bailHabitationData.locatairePrenom} onChange={(e) => setBailHabitationData({...bailHabitationData, locatairePrenom: e.target.value})} />
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label>Adresse actuelle *</Label>
                      <Input value={bailHabitationData.locataireAdresse} onChange={(e) => setBailHabitationData({...bailHabitationData, locataireAdresse: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label>Date de naissance *</Label>
                      <Input type="date" value={bailHabitationData.locataireDateNaissance} onChange={(e) => setBailHabitationData({...bailHabitationData, locataireDateNaissance: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label>Lieu de naissance *</Label>
                      <Input value={bailHabitationData.locataireLieuNaissance} onChange={(e) => setBailHabitationData({...bailHabitationData, locataireLieuNaissance: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label>Profession *</Label>
                      <Input value={bailHabitationData.locataireProfession} onChange={(e) => setBailHabitationData({...bailHabitationData, locataireProfession: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label>Statut matrimonial *</Label>
                      <Input value={bailHabitationData.locataireStatutMatrimonial} onChange={(e) => setBailHabitationData({...bailHabitationData, locataireStatutMatrimonial: e.target.value})} placeholder="Ex: C√©libataire, Mari√©..." />
                    </div>
                    <div className="space-y-2">
                      <Label>Nombre d'occupants *</Label>
                      <Input type="number" value={bailHabitationData.nombreOccupants} onChange={(e) => setBailHabitationData({...bailHabitationData, nombreOccupants: e.target.value})} />
                    </div>
                  </div>

                  {/* Pi√®ce d'identit√© du locataire - charg√©e depuis client si c'est le client */}
                  {bailHabitationData.clientRole === "locataire" && bailHabitationData.clientId ? (
                    <div className="space-y-2">
                      <Label>üìé Pi√®ce d'identit√©</Label>
                      {bailClientIdentiteUrl ? (
                        <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg">
                          <svg className="w-4 h-4 text-green-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                          </svg>
                          <span className="text-sm flex-1 text-green-700">Pi√®ce d'identit√© charg√©e depuis le profil client</span>
                          <Button
                            type="button"
                            variant="ghost"
                            size="sm"
                            className="bg-green-600 hover:bg-green-700 text-white"
                            onClick={() => window.open(bailClientIdentiteUrl, '_blank')}
                          >
                            <Eye className="mr-2 h-4 w-4" />
                            Voir
                          </Button>
                        </div>
                      ) : (
                        <div className="flex items-center gap-2 p-2 bg-orange-50 border border-orange-200 rounded-lg">
                          <svg className="w-4 h-4 text-orange-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                          </svg>
                          <span className="text-sm flex-1 text-orange-700">Aucune pi√®ce d'identit√© dans le profil client</span>
                        </div>
                      )}
                    </div>
                  ) : bailHabitationData.clientRole === "bailleur" && (
                    /* Upload section pour documents locataire si le client est bailleur */
                    <MultiFileUpload
                      label="üìé Documents du locataire (pi√®ce d'identit√©, justificatifs de revenus)"
                      files={locataireIdFiles}
                      onFilesChange={setLocataireIdFiles}
                      accept="application/pdf,image/*"
                    />
                  )}

                  {/* Situation financi√®re du locataire */}
                  <div className="p-4 bg-blue-50 dark:bg-blue-950 rounded-lg space-y-4">
                    <h4 className="font-medium">Situation financi√®re du locataire</h4>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Revenus mensuels nets (‚Ç¨)</Label>
                        <Input 
                          type="number"
                          value={bailHabitationData.locataireRevenusMensuelsNets} 
                          onChange={(e) => setBailHabitationData({...bailHabitationData, locataireRevenusMensuelsNets: e.target.value})} 
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Type de contrat de travail</Label>
                        <Select 
                          value={bailHabitationData.locataireTypeContrat} 
                          onValueChange={(value) => setBailHabitationData({...bailHabitationData, locataireTypeContrat: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="CDI">CDI</SelectItem>
                            <SelectItem value="CDD">CDD</SelectItem>
                            <SelectItem value="Int√©rim">Int√©rim</SelectItem>
                            <SelectItem value="√âtudiant">√âtudiant</SelectItem>
                            <SelectItem value="Ind√©pendant">Ind√©pendant</SelectItem>
                            <SelectItem value="Autre">Autre</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <Label>Employeur actuel</Label>
                        <Input 
                          value={bailHabitationData.locataireEmployeur} 
                          onChange={(e) => setBailHabitationData({...bailHabitationData, locataireEmployeur: e.target.value})} 
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Adresse de l'employeur</Label>
                        <Input 
                          value={bailHabitationData.locataireEmployeurAdresse} 
                          onChange={(e) => setBailHabitationData({...bailHabitationData, locataireEmployeurAdresse: e.target.value})} 
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Anciennet√© dans l'emploi</Label>
                        <Input 
                          value={bailHabitationData.locataireAncienneteEmployeur} 
                          onChange={(e) => setBailHabitationData({...bailHabitationData, locataireAncienneteEmployeur: e.target.value})} 
                          placeholder="Ex: 2 ans"
                        />
                      </div>
                    </div>
                  </div>

                  {/* Colocation */}
                  <div className="space-y-4 p-4 bg-purple-50 dark:bg-purple-950 rounded-lg">
                    <h4 className="font-medium">Colocation</h4>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>S'agit-il d'une colocation ?</Label>
                        <Select 
                          value={bailHabitationData.colocation} 
                          onValueChange={(value) => setBailHabitationData({...bailHabitationData, colocation: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="Non">Non</SelectItem>
                            <SelectItem value="Oui">Oui</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      {bailHabitationData.colocation === "Oui" && (
                        <>
                          <div className="space-y-2">
                            <Label>Solidarit√© entre colocataires ?</Label>
                            <Select 
                              value={bailHabitationData.solidariteColocataires} 
                              onValueChange={(value) => setBailHabitationData({...bailHabitationData, solidariteColocataires: value})}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="Oui">Oui (solidaires)</SelectItem>
                                <SelectItem value="Non">Non (s√©par√©s)</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>
                          <div className="space-y-2">
                            <Label>Nombre de colocataires</Label>
                            <Input 
                              type="number"
                              value={bailHabitationData.nombreColocataires} 
                              onChange={(e) => setBailHabitationData({...bailHabitationData, nombreColocataires: e.target.value})} 
                            />
                          </div>
                          <div className="space-y-2 md:col-span-2">
                            <Label>Noms et pr√©noms des colocataires</Label>
                            <Textarea 
                              value={bailHabitationData.colocatairesNoms} 
                              onChange={(e) => setBailHabitationData({...bailHabitationData, colocatairesNoms: e.target.value})} 
                              placeholder="Ex: Jean Dupont, Marie Martin..."
                              rows={2}
                            />
                          </div>
                        </>
                      )}
                    </div>
                  </div>
                  
                  <MultiFileUpload
                    label="üìé Documents du locataire (pi√®ce d'identit√©, justificatifs de revenus)"
                    files={locataireDocsFiles}
                    onFilesChange={setLocataireDocsFiles}
                    accept="application/pdf,image/*"
                  />
                </div>

                {/* Logement */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üè† Logement</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2 md:col-span-2">
                      <Label>Adresse compl√®te du logement *</Label>
                      <Input value={bailHabitationData.adresseLogement} onChange={(e) => setBailHabitationData({...bailHabitationData, adresseLogement: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label>Type de logement *</Label>
                      <Input value={bailHabitationData.typeLogement} onChange={(e) => setBailHabitationData({...bailHabitationData, typeLogement: e.target.value})} placeholder="Ex: T2, Studio, Maison..." />
                    </div>
                    <div className="space-y-2">
                      <Label>√âtage / N¬∞ appartement</Label>
                      <Input value={bailHabitationData.etageNumeroLot} onChange={(e) => setBailHabitationData({...bailHabitationData, etageNumeroLot: e.target.value})} placeholder="Ex: 3√®me √©tage, Appt 12..." />
                    </div>
                    <div className="space-y-2">
                      <Label>Surface habitable (m¬≤) *</Label>
                      <Input type="number" value={bailHabitationData.surfaceHabitable} onChange={(e) => setBailHabitationData({...bailHabitationData, surfaceHabitable: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label>Logement en copropri√©t√© ? *</Label>
                      <Select value={bailHabitationData.logementCopropriete} onValueChange={(value) => setBailHabitationData({...bailHabitationData, logementCopropriete: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="oui">Oui</SelectItem>
                          <SelectItem value="non">Non</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    {bailHabitationData.logementCopropriete === "oui" && (
                      <div className="space-y-2">
                        <Label>R√®glement de copropri√©t√© fourni ?</Label>
                        <Select value={bailHabitationData.reglementCoproFourni} onValueChange={(value) => setBailHabitationData({...bailHabitationData, reglementCoproFourni: value})}>
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="oui">Oui</SelectItem>
                            <SelectItem value="non">Non</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                    )}
                    <div className="space-y-2 md:col-span-2">
                      <Label>D√©pendances incluses *</Label>
                      <div className="flex flex-wrap gap-3">
                        {["Cave", "Parking", "Grenier", "Jardin"].map((dep) => (
                          <label key={dep} className="flex items-center gap-2">
                            <input
                              type="checkbox"
                              checked={bailHabitationData.dependances.includes(dep)}
                              onChange={(e) => {
                                if (e.target.checked) {
                                  setBailHabitationData({...bailHabitationData, dependances: [...bailHabitationData.dependances, dep]});
                                } else {
                                  setBailHabitationData({...bailHabitationData, dependances: bailHabitationData.dependances.filter(d => d !== dep)});
                                }
                              }}
                              className="rounded border-gray-300"
                            />
                            <span className="text-sm">{dep}</span>
                          </label>
                        ))}
                      </div>
                    </div>
                  </div>

                  {/* D√©tails parking */}
                  {bailHabitationData.dependances.includes("Parking") && (
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-slate-50 dark:bg-slate-900 rounded-lg">
                      <div className="space-y-2">
                        <Label>Place de parking num√©rot√©e ?</Label>
                        <Select 
                          value={bailHabitationData.placeParking} 
                          onValueChange={(value) => setBailHabitationData({...bailHabitationData, placeParking: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="Oui">Oui</SelectItem>
                            <SelectItem value="Non">Non</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      {bailHabitationData.placeParking === "Oui" && (
                        <div className="space-y-2">
                          <Label>Num√©ro de la place</Label>
                          <Input 
                            value={bailHabitationData.numeroPlaceParking} 
                            onChange={(e) => setBailHabitationData({...bailHabitationData, numeroPlaceParking: e.target.value})} 
                            placeholder="Ex: P12"
                          />
                        </div>
                      )}
                    </div>
                  )}

                  {/* Entretien jardin */}
                  {bailHabitationData.dependances.includes("Jardin") && (
                    <div className="space-y-2 p-4 bg-green-50 dark:bg-green-950 rounded-lg">
                      <Label>Entretien du jardin √† la charge de</Label>
                      <Select 
                        value={bailHabitationData.entretienJardin} 
                        onValueChange={(value) => setBailHabitationData({...bailHabitationData, entretienJardin: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="Locataire">Locataire</SelectItem>
                          <SelectItem value="Bailleur">Bailleur</SelectItem>
                          <SelectItem value="Partag√©">Partag√©</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  )}
                </div>

                {/* Sp√©cificit√©s du bail meubl√© */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üõãÔ∏è Sp√©cificit√©s du bail meubl√©</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {/* Type et dur√©e du bail meubl√© */}
                    <div className="space-y-2">
                      <Label>Type de dur√©e du bail meubl√©</Label>
                      <Select 
                        value={bailHabitationData.typeDureeMeuble} 
                        onValueChange={(value) => setBailHabitationData({...bailHabitationData, typeDureeMeuble: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="1an">1 an renouvelable (cas g√©n√©ral)</SelectItem>
                          <SelectItem value="9mois">9 mois √©tudiant (non renouvelable)</SelectItem>
                          <SelectItem value="mobilite">Bail mobilit√© (1 √† 10 mois)</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    {bailHabitationData.typeDureeMeuble === "mobilite" && (
                          <div className="space-y-2">
                            <Label>Motif du bail mobilit√©</Label>
                            <Input 
                              value={bailHabitationData.motifBailMobilite} 
                              onChange={(e) => setBailHabitationData({...bailHabitationData, motifBailMobilite: e.target.value})} 
                              placeholder="Ex: Stage, √©tudes, mission professionnelle..."
                            />
                          </div>
                        )}

                        {/* Inventaire du mobilier */}
                        <div className="md:col-span-2 p-4 bg-orange-50 dark:bg-orange-950 rounded-lg space-y-3">
                          <h4 className="font-medium text-orange-800 dark:text-orange-200">üìã Inventaire complet du mobilier (OBLIGATOIRE L√âGALEMENT)</h4>
                          <div className="space-y-2">
                            <Label>Description d√©taill√©e pi√®ce par pi√®ce *</Label>
                            <Textarea 
                              value={bailHabitationData.inventaireMobilierTexte} 
                              onChange={(e) => setBailHabitationData({...bailHabitationData, inventaireMobilierTexte: e.target.value})} 
                              placeholder="Ex: Salon: canap√© 3 places en tissu gris, table basse en bois, 2 lampes...\nChambre: lit 140x190, matelas, couette, 2 oreillers, armoire 3 portes..."
                              rows={5}
                            />
                          </div>
                          <MultiFileUpload
                            label="Fichier inventaire (PDF ou images)"
                            files={inventaireMobilierFiles}
                            onFilesChange={setInventaireMobilierFiles}
                            accept="application/pdf,image/*"
                          />
                        </div>

                        {/* Liste l√©gale du mobilier minimal (d√©cret 2015-981) */}
                        <div className="md:col-span-2 p-4 bg-blue-50 dark:bg-blue-950 rounded-lg space-y-3">
                          <h4 className="font-medium">‚úÖ Mobilier minimal obligatoire (d√©cret n¬∞2015-981)</h4>
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            {[
                              { key: 'mobilierLiterie', label: 'Literie + couette ou couverture' },
                              { key: 'mobilierOccultation', label: 'Dispositif d\'occultation des fen√™tres' },
                              { key: 'mobilierPlaquesCuisson', label: 'Plaques de cuisson' },
                              { key: 'mobilierFourMicroondes', label: 'Four ou micro-ondes' },
                              { key: 'mobilierRefrigo', label: 'R√©frig√©rateur' },
                              { key: 'mobilierCongelateur', label: 'Cong√©lateur ou compartiment freezer' },
                              { key: 'mobilierVaisselle', label: 'Vaisselle en quantit√© suffisante' },
                              { key: 'mobilierUstensiles', label: 'Ustensiles de cuisine' },
                              { key: 'mobilierTable', label: 'Table' },
                              { key: 'mobilierSieges', label: 'Si√®ges' },
                              { key: 'mobilierEtageres', label: '√âtag√®res de rangement' },
                              { key: 'mobilierLampes', label: 'Lampes' },
                              { key: 'mobilierMaterielEntretien', label: 'Mat√©riel d\'entretien' },
                            ].map((item) => (
                              <div key={item.key} className="flex items-center space-x-2">
                                <input
                                  type="checkbox"
                                  id={item.key}
                                  checked={bailHabitationData[item.key as keyof typeof bailHabitationData] as boolean}
                                  onChange={(e) => setBailHabitationData({...bailHabitationData, [item.key]: e.target.checked})}
                                  className="w-4 h-4"
                                />
                                <Label htmlFor={item.key} className="cursor-pointer text-sm">{item.label}</Label>
                              </div>
                            ))}
                          </div>
                        </div>

                        {/* √âtat du mobilier */}
                        <div className="space-y-2 md:col-span-2">
                          <Label>√âtat du mobilier lors de l'entr√©e</Label>
                          <Textarea 
                            value={bailHabitationData.etatMobilierEntree} 
                            onChange={(e) => setBailHabitationData({...bailHabitationData, etatMobilierEntree: e.target.value})} 
                            placeholder="Description de l'√©tat du mobilier pi√®ce par pi√®ce..."
                            rows={3}
                          />
                        </div>

                        {/* Entretien du mobilier */}
                        <div className="space-y-2">
                          <Label>Entretien du mobilier √† la charge de</Label>
                          <Select 
                            value={bailHabitationData.entretienMobilier} 
                            onValueChange={(value) => setBailHabitationData({...bailHabitationData, entretienMobilier: value})}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="Locataire">Locataire</SelectItem>
                              <SelectItem value="Bailleur">Bailleur</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                  </div>
                </div>

                {/* Animaux */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üêæ Animaux domestiques</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Animaux domestiques autoris√©s ?</Label>
                      <Select 
                        value={bailHabitationData.animauxAutorises} 
                        onValueChange={(value) => setBailHabitationData({...bailHabitationData, animauxAutorises: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="Oui">Oui</SelectItem>
                          <SelectItem value="Non">Non</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    {bailHabitationData.animauxAutorises === "Oui" && (
                      <div className="space-y-2">
                        <Label>Pr√©cisions</Label>
                        <Input 
                          value={bailHabitationData.precisionAnimaux} 
                          onChange={(e) => setBailHabitationData({...bailHabitationData, precisionAnimaux: e.target.value})} 
                          placeholder="Ex: petits chiens, chats..."
                        />
                      </div>
                    )}
                  </div>
                </div>

                {/* Nature du bailleur et dur√©e */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">‚öñÔ∏è Nature du bailleur et dur√©e du bail</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Nature du bailleur *</Label>
                      <Select value={bailHabitationData.natureBailleur} onValueChange={(value) => setBailHabitationData({...bailHabitationData, natureBailleur: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="physique">Personne physique (3 ans pour bail vide)</SelectItem>
                          <SelectItem value="morale">Personne morale (6 ans pour bail vide)</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div className="space-y-2">
                      <Label>R√©sidence principale du locataire ? *</Label>
                      <Select value={bailHabitationData.residencePrincipale} onValueChange={(value) => setBailHabitationData({...bailHabitationData, residencePrincipale: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="oui">Oui</SelectItem>
                          <SelectItem value="non">Non</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>
                </div>

                {/* Garant */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üë• Garant (si applicable)</h3>
                  <div className="space-y-2">
                    <Label>A-t-il un garant ?</Label>
                    <Select value={bailHabitationData.aGarant} onValueChange={(value) => setBailHabitationData({...bailHabitationData, aGarant: value})}>
                      <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                      <SelectContent>
                        <SelectItem value="oui">Oui</SelectItem>
                        <SelectItem value="non">Non</SelectItem>
                      </SelectContent>
                    </Select>
                  </div>
                  {bailHabitationData.aGarant === "oui" && (
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-muted/30 rounded-lg">
                      <div className="space-y-2">
                        <Label>Nom du garant *</Label>
                        <Input value={bailHabitationData.garantNom} onChange={(e) => setBailHabitationData({...bailHabitationData, garantNom: e.target.value})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Pr√©nom *</Label>
                        <Input value={bailHabitationData.garantPrenom} onChange={(e) => setBailHabitationData({...bailHabitationData, garantPrenom: e.target.value})} />
                      </div>
                      <div className="space-y-2 md:col-span-2">
                        <Label>Adresse *</Label>
                        <Input value={bailHabitationData.garantAdresse} onChange={(e) => setBailHabitationData({...bailHabitationData, garantAdresse: e.target.value})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Date de naissance *</Label>
                        <Input type="date" value={bailHabitationData.garantDateNaissance} onChange={(e) => setBailHabitationData({...bailHabitationData, garantDateNaissance: e.target.value})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Lieu de naissance *</Label>
                        <Input value={bailHabitationData.garantLieuNaissance} onChange={(e) => setBailHabitationData({...bailHabitationData, garantLieuNaissance: e.target.value})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Profession *</Label>
                        <Input value={bailHabitationData.garantProfession} onChange={(e) => setBailHabitationData({...bailHabitationData, garantProfession: e.target.value})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Type de caution *</Label>
                        <Select value={bailHabitationData.typeCaution} onValueChange={(value) => setBailHabitationData({...bailHabitationData, typeCaution: value})}>
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="simple">Caution simple</SelectItem>
                            <SelectItem value="solidaire">Caution solidaire</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2 md:col-span-2">
                        <MultiFileUpload
                          label="üìé Documents du garant (pi√®ce d'identit√©, justificatifs de revenus)"
                          files={garantDocsFiles}
                          onFilesChange={setGarantDocsFiles}
                          accept="application/pdf,image/*"
                        />
                      </div>
                    </div>
                  )}
                </div>

                {/* Conditions financi√®res */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üí∂ Conditions financi√®res</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Loyer mensuel (‚Ç¨) *</Label>
                      <Input type="number" value={bailHabitationData.loyerMensuel} onChange={(e) => setBailHabitationData({...bailHabitationData, loyerMensuel: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label>Charges mensuelles (‚Ç¨)</Label>
                      <Input type="number" value={bailHabitationData.chargesMensuelles} onChange={(e) => setBailHabitationData({...bailHabitationData, chargesMensuelles: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label>Type de charges *</Label>
                      <Select value={bailHabitationData.typeCharges} onValueChange={(value) => setBailHabitationData({...bailHabitationData, typeCharges: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="provision">Provision + r√©gularisation annuelle</SelectItem>
                          <SelectItem value="forfait">Forfait</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div className="space-y-2">
                      <Label>D√©p√¥t de garantie (‚Ç¨) *</Label>
                      <Input type="number" value={bailHabitationData.depotGarantie} onChange={(e) => setBailHabitationData({...bailHabitationData, depotGarantie: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label>R√©vision du loyer pr√©vue ? *</Label>
                      <Select value={bailHabitationData.revisionLoyerPrevue} onValueChange={(value) => setBailHabitationData({...bailHabitationData, revisionLoyerPrevue: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="oui">Oui</SelectItem>
                          <SelectItem value="non">Non</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    {bailHabitationData.revisionLoyerPrevue === "oui" && (
                      <div className="space-y-2">
                        <Label>Trimestre de r√©f√©rence IRL *</Label>
                        <Input value={bailHabitationData.trimestreReference} onChange={(e) => setBailHabitationData({...bailHabitationData, trimestreReference: e.target.value})} placeholder="Ex: 2e trimestre 2025" />
                      </div>
                    )}
                    <div className="space-y-2">
                      <Label>Type de bail</Label>
                      <Select value={bailHabitationData.typeBail} onValueChange={(value) => setBailHabitationData({...bailHabitationData, typeBail: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="vide">Location vide</SelectItem>
                          <SelectItem value="meuble">Location meubl√©e</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>

                  {/* Mode de paiement */}
                  <div className="p-4 bg-emerald-50 dark:bg-emerald-950 rounded-lg space-y-4">
                    <h4 className="font-medium">Mode de paiement du loyer</h4>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Mode de paiement choisi</Label>
                        <Select 
                          value={bailHabitationData.modePaiement} 
                          onValueChange={(value) => setBailHabitationData({...bailHabitationData, modePaiement: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="Virement">Virement</SelectItem>
                            <SelectItem value="Pr√©l√®vement automatique">Pr√©l√®vement automatique</SelectItem>
                            <SelectItem value="Ch√®que">Ch√®que</SelectItem>
                            <SelectItem value="Autre">Autre</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <Label>IBAN du bailleur</Label>
                        <Input 
                          value={bailHabitationData.ibanBailleur} 
                          onChange={(e) => setBailHabitationData({...bailHabitationData, ibanBailleur: e.target.value})} 
                          placeholder="FR76..."
                        />
                      </div>
                    </div>
                  </div>

                  {/* R√©gularisation des charges */}
                  {bailHabitationData.typeCharges === "provision" && (
                    <div className="space-y-2 p-4 bg-amber-50 dark:bg-amber-950 rounded-lg">
                      <Label>P√©riodicit√© de r√©gularisation des charges</Label>
                      <Select 
                        value={bailHabitationData.periodiciteRegularisationCharges} 
                        onValueChange={(value) => setBailHabitationData({...bailHabitationData, periodiciteRegularisationCharges: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="Annuelle">Annuelle</SelectItem>
                          <SelectItem value="Semestrielle">Semestrielle</SelectItem>
                          <SelectItem value="Autre">Autre</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  )}
                </div>

                {/* Dates */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üìÖ Dates du bail</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Date de d√©but du bail *</Label>
                      <Input type="date" value={bailHabitationData.dateDebutBail} onChange={(e) => setBailHabitationData({...bailHabitationData, dateDebutBail: e.target.value})} />
                    </div>
                    <div className="space-y-2">
                      <Label>Dur√©e du bail</Label>
                      <Select value={bailHabitationData.typeBailDuree} onValueChange={(value) => setBailHabitationData({...bailHabitationData, typeBailDuree: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="3ans">3 ans (vide)</SelectItem>
                          <SelectItem value="6ans">6 ans (vide - personne morale)</SelectItem>
                          <SelectItem value="1an">1 an (meubl√©)</SelectItem>
                          <SelectItem value="9mois">9 mois (√©tudiant)</SelectItem>
                          <SelectItem value="mobilite">Bail mobilit√© (1 √† 10 mois)</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>
                </div>

                {/* Caract√©ristiques techniques ALUR */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üîå Caract√©ristiques techniques (obligatoires ALUR)</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Type de chauffage *</Label>
                      <Select value={bailHabitationData.typeChauffage} onValueChange={(value) => setBailHabitationData({...bailHabitationData, typeChauffage: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="electrique">√âlectrique</SelectItem>
                          <SelectItem value="gaz">Gaz</SelectItem>
                          <SelectItem value="fioul">Fioul</SelectItem>
                          <SelectItem value="collectif">Collectif</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div className="space-y-2">
                      <Label>Compteurs individuels ? *</Label>
                      <Select value={bailHabitationData.compteursIndividuels} onValueChange={(value) => setBailHabitationData({...bailHabitationData, compteursIndividuels: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="oui">Oui</SelectItem>
                          <SelectItem value="non">Non</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label>Relev√© des compteurs √† l'entr√©e</Label>
                      <Input value={bailHabitationData.releveCompteurs} onChange={(e) => setBailHabitationData({...bailHabitationData, releveCompteurs: e.target.value})} placeholder="√âlectricit√©: XX kWh, Eau: XX m3..." />
                    </div>
                  </div>
                </div>

                {/* Travaux r√©cents */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üî® Travaux effectu√©s</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Travaux r√©alis√©s dans les 6 derniers mois ?</Label>
                      <Select 
                        value={bailHabitationData.travauxDerniers6Mois} 
                        onValueChange={(value) => setBailHabitationData({...bailHabitationData, travauxDerniers6Mois: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="Non">Non</SelectItem>
                          <SelectItem value="Oui">Oui</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    {bailHabitationData.travauxDerniers6Mois === "Oui" && (
                      <div className="space-y-2 md:col-span-2">
                        <Label>Description des travaux</Label>
                        <Textarea 
                          value={bailHabitationData.descriptionTravaux} 
                          onChange={(e) => setBailHabitationData({...bailHabitationData, descriptionTravaux: e.target.value})} 
                          placeholder="Ex: Peinture, r√©novation salle de bain, √©lectricit√©..."
                          rows={3}
                        />
                      </div>
                    )}
                  </div>
                </div>

                {/* Diagnostics obligatoires */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üìÅ Diagnostics obligatoires</h3>
                  <div className="space-y-2">
                    <Label>Diagnostics fournis ? *</Label>
                    <Select value={bailHabitationData.diagnosticsFournis} onValueChange={(value) => setBailHabitationData({...bailHabitationData, diagnosticsFournis: value})}>
                      <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                      <SelectContent>
                        <SelectItem value="oui">Oui - Tous les diagnostics obligatoires sont fournis</SelectItem>
                        <SelectItem value="non">Non - Diagnostics manquants</SelectItem>
                      </SelectContent>
                    </Select>
                  </div>
                  <div className="text-sm text-muted-foreground p-3 bg-muted/30 rounded-lg">
                    <p className="font-medium mb-2">Diagnostics obligatoires pour un bail vide :</p>
                    <ul className="list-disc list-inside space-y-1">
                      <li>DPE (Diagnostic de Performance √ânerg√©tique)</li>
                      <li>√âtat de l'installation √©lectrique (si + de 15 ans)</li>
                      <li>√âtat de l'installation gaz (si + de 15 ans)</li>
                      <li>ERP (√âtat des Risques et Pollutions)</li>
                      <li>CREP - Plomb (si immeuble avant 1949)</li>
                      <li>Amiante (information obligatoire)</li>
                    </ul>
                  </div>
                  <MultiFileUpload
                    label="üìé Joindre les diagnostics (PDF)"
                    files={bailDiagnosticsFiles}
                    onFilesChange={setBailDiagnosticsFiles}
                    accept="application/pdf"
                  />
                </div>

                {/* √âtat des lieux */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üõ†Ô∏è √âtat des lieux</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>√âtat des lieux d'entr√©e fourni ? *</Label>
                      <Select value={bailHabitationData.etatLieuxFourni} onValueChange={(value) => setBailHabitationData({...bailHabitationData, etatLieuxFourni: value})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="oui">Oui</SelectItem>
                          <SelectItem value="non">Non - √Ä √©tablir lors de la remise des cl√©s</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>
                </div>

                {/* Assurance */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üõ°Ô∏è Assurance habitation</h3>
                  <div className="space-y-2">
                    <Label>Attestation d'assurance fournie par le locataire ? *</Label>
                    <Select value={bailHabitationData.attestationAssurance} onValueChange={(value) => setBailHabitationData({...bailHabitationData, attestationAssurance: value})}>
                      <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                      <SelectContent>
                        <SelectItem value="oui">Oui - Attestation fournie</SelectItem>
                        <SelectItem value="non">Non - √Ä fournir avant la remise des cl√©s</SelectItem>
                      </SelectContent>
                    </Select>
                  </div>
                  <p className="text-sm text-muted-foreground">L'assurance habitation est obligatoire pour le locataire avant l'entr√©e dans les lieux.</p>
                </div>

                {/* Remise des cl√©s */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üîë Remise des cl√©s et acc√®s</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Nombre de jeux de cl√©s remis</Label>
                      <Input 
                        type="number"
                        value={bailHabitationData.nombreJeuxCles} 
                        onChange={(e) => setBailHabitationData({...bailHabitationData, nombreJeuxCles: e.target.value})} 
                        placeholder="Ex: 2"
                      />
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label>Types de cl√©s</Label>
                      <div className="flex flex-wrap gap-3">
                        {[
                          { value: "portes", label: "Portes" },
                          { value: "boites_aux_lettres", label: "Bo√Ætes aux lettres" },
                          { value: "garage", label: "Garage" },
                          { value: "badges", label: "Badges" },
                          { value: "telecommande", label: "T√©l√©commande portail" }
                        ].map((type) => (
                          <label key={type.value} className="flex items-center gap-2">
                            <input
                              type="checkbox"
                              checked={bailHabitationData.typesCles.includes(type.value)}
                              onChange={(e) => {
                                if (e.target.checked) {
                                  setBailHabitationData({
                                    ...bailHabitationData, 
                                    typesCles: [...bailHabitationData.typesCles, type.value]
                                  });
                                } else {
                                  setBailHabitationData({
                                    ...bailHabitationData, 
                                    typesCles: bailHabitationData.typesCles.filter(t => t !== type.value)
                                  });
                                }
                              }}
                              className="rounded border-gray-300"
                            />
                            <span className="text-sm">{type.label}</span>
                          </label>
                        ))}
                      </div>
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label>Codes fournis (optionnel)</Label>
                      <Textarea 
                        value={bailHabitationData.codesFournis} 
                        onChange={(e) => setBailHabitationData({...bailHabitationData, codesFournis: e.target.value})} 
                        rows={2}
                        placeholder="Ex: WIFI, interphone, digicode d'entr√©e..."
                      />
                    </div>
                  </div>
                </div>

                {/* Informations compl√©mentaires */}
                <div className="space-y-4">
                  <h3 className="font-semibold text-lg border-b pb-2">üéØ Informations compl√©mentaires</h3>
                  <div className="space-y-2">
                    <Label>Pr√©cisions, particularit√©s...</Label>
                    <Textarea 
                      value={bailHabitationData.informationsComplementaires} 
                      onChange={(e) => setBailHabitationData({...bailHabitationData, informationsComplementaires: e.target.value})} 
                      rows={4}
                      placeholder="Garant, travaux r√©cents, diagnostics fournis, assurance, etc."
                    />
                  </div>
                </div>
              </>
            )}

            {/* Formulaire sp√©cifique pour Bail commercial */}
            {pendingContractType === "Bail commercial / professionnel" && (
              <>
                <div className="space-y-6">
                  {/* S√©lection du type de bail */}
                  <div className="space-y-4 bg-muted/50 p-4 rounded-lg">
                    <h3 className="font-semibold text-lg">üìã Type de bail *</h3>
                    <div className="space-y-2">
                      <RadioGroup 
                        value={bailCommercialData.typeBail} 
                        onValueChange={(value) => setBailCommercialData({...bailCommercialData, typeBail: value})}
                      >
                        <div className="flex items-center space-x-2">
                          <RadioGroupItem value="commercial" id="bail_type_commercial" />
                          <Label htmlFor="bail_type_commercial" className="cursor-pointer">
                            <span className="font-medium">Bail commercial</span>
                            <span className="text-xs text-muted-foreground ml-2">(statut 3/6/9 - activit√© commerciale)</span>
                          </Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <RadioGroupItem value="professionnel" id="bail_type_professionnel" />
                          <Label htmlFor="bail_type_professionnel" className="cursor-pointer">
                            <span className="font-medium">Bail professionnel</span>
                            <span className="text-xs text-muted-foreground ml-2">(profession lib√©rale - min. 6 ans)</span>
                          </Label>
                        </div>
                      </RadioGroup>
                    </div>
                  </div>

                  {/* S√©lection du r√¥le du client */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üë§ Votre client</h3>
                    <div className="space-y-2">
                      <Label>Votre client est le *</Label>
                          <RadioGroup 
                            value={bailCommercialData.clientRole} 
                            onValueChange={(value) => {
                              setBailCommercialData({
                                ...bailCommercialData, 
                                clientRole: value,
                                clientId: "",
                                // Reset des champs de l'autre partie
                                ...(value === "bailleur" ? {
                                  locataireClientId: "",
                                  statutLocataire: "",
                                  locataireNom: "",
                                  locatairePrenom: "",
                                  locataireAdresse: "",
                                  locataireImmatriculation: "",
                                  locataireDenomination: "",
                                  locataireFormeJuridique: "",
                                  locataireSiege: "",
                                  locataireSiren: "",
                                  locataireSiret: "",
                                } : {
                                  bailleurClientId: "",
                                  statutBailleur: "",
                                  bailleurNom: "",
                                  bailleurPrenom: "",
                                  bailleurDenomination: "",
                                  bailleurFormeJuridique: "",
                                  bailleurAdresse: "",
                                  bailleurSiren: "",
                                  bailleurSiret: "",
                                })
                              });
                            }}
                          >
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="bailleur" id="bc_role_bailleur" />
                              <Label htmlFor="bc_role_bailleur" className="cursor-pointer">Bailleur (propri√©taire)</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <RadioGroupItem value="preneur" id="bc_role_preneur" />
                          <Label htmlFor="bc_role_preneur" className="cursor-pointer">Preneur (locataire)</Label>
                        </div>
                      </RadioGroup>
                    </div>
                  </div>

                  {/* Bailleur */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">
                      {bailCommercialData.clientRole === "bailleur" ? "üè¢ Bailleur (votre client)" : "üè¢ Bailleur"}
                    </h3>
                    
                    {/* S√©lection du client si bailleur */}
                    {bailCommercialData.clientRole === "bailleur" && (
                      <div className="space-y-2">
                        <Label>S√©lectionner le client bailleur *</Label>
                        <Select 
                          value={bailCommercialData.clientId} 
                          onValueChange={(value) => {
                            const selectedClient = clients.find(c => c.id === value);
                            if (selectedClient) {
                              console.log('üîç BAILLEUR - Client:', selectedClient);
                              console.log('üîç BAILLEUR - situation_matrimoniale:', selectedClient.situation_matrimoniale);
                              console.log('üîç BAILLEUR - situation_familiale:', selectedClient.situation_familiale);
                              
                              let situationFamiliale = "";
                              let regimeMatrimonial = "";
                              
                              // Essayer d'abord situation_matrimoniale
                              if (selectedClient.situation_matrimoniale) {
                                if (typeof selectedClient.situation_matrimoniale === 'object') {
                                  // Cas 1: Objet JSON dans situation_matrimoniale
                                  situationFamiliale = selectedClient.situation_matrimoniale.situation_familiale || '';
                                  regimeMatrimonial = selectedClient.situation_matrimoniale.regime_matrimonial || '';
                                  
                                  console.log('üîç BAILLEUR - Extrait de situation_matrimoniale:', situationFamiliale, regimeMatrimonial);
                                  
                                  // Capitaliser
                                  if (situationFamiliale) {
                                    situationFamiliale = situationFamiliale.charAt(0).toUpperCase() + situationFamiliale.slice(1);
                                  }
                                  if (regimeMatrimonial) {
                                    regimeMatrimonial = regimeMatrimonial.replace(/_/g, ' ');
                                  }
                                } else if (typeof selectedClient.situation_matrimoniale === 'string') {
                                  // Cas 2: Simple cha√Æne de texte
                                  situationFamiliale = selectedClient.situation_matrimoniale;
                                  console.log('üîç BAILLEUR - String directe:', situationFamiliale);
                                }
                              }
                              
                              // Si pas trouv√©, essayer situation_familiale
                              if (!situationFamiliale && selectedClient.situation_familiale) {
                                if (typeof selectedClient.situation_familiale === 'object') {
                                  // Objet JSON dans situation_familiale
                                  situationFamiliale = selectedClient.situation_familiale.situation_familiale || '';
                                  regimeMatrimonial = selectedClient.situation_familiale.regime_matrimonial || '';
                                  
                                  console.log('üîç BAILLEUR - Extrait de situation_familiale:', situationFamiliale, regimeMatrimonial);
                                  
                                  // Capitaliser
                                  if (situationFamiliale) {
                                    situationFamiliale = situationFamiliale.charAt(0).toUpperCase() + situationFamiliale.slice(1);
                                  }
                                  if (regimeMatrimonial) {
                                    regimeMatrimonial = regimeMatrimonial.replace(/_/g, ' ');
                                  }
                                } else if (typeof selectedClient.situation_familiale === 'string') {
                                  // Simple cha√Æne
                                  situationFamiliale = selectedClient.situation_familiale;
                                  console.log('üîç BAILLEUR - String situation_familiale:', situationFamiliale);
                                }
                              }
                              
                              console.log('üîç BAILLEUR - Valeurs finales:', { situationFamiliale, regimeMatrimonial });
                              
                              setBailCommercialData({
                                ...bailCommercialData,
                                clientId: value,
                                bailleurClientId: value,
                                statutBailleur: "physique",
                                bailleurNom: selectedClient.nom || "",
                                bailleurPrenom: selectedClient.prenom || "",
                                bailleurAdresse: selectedClient.adresse || "",
                                bailleurDateNaissance: selectedClient.date_naissance || "",
                                bailleurLieuNaissance: selectedClient.lieu_naissance || "",
                                bailleurNationalite: selectedClient.nationalite || "",
                                bailleurSituationFamiliale: situationFamiliale,
                                bailleurRegimeMatrimonial: regimeMatrimonial,
                                bailleurProfession: selectedClient.profession || "",
                              });
                            }
                          }}
                        >
                          <SelectTrigger><SelectValue placeholder="Choisir un client" /></SelectTrigger>
                          <SelectContent>
                            {clients.map((client) => (
                              <SelectItem key={client.id} value={client.id}>{client.nom} {client.prenom}</SelectItem>
                            ))}
                          </SelectContent>
                        </Select>
                      </div>
                    )}
                    
                    {bailCommercialData.clientRole === "preneur" && (
                      <div className="text-sm text-muted-foreground mb-2">
                        Saisir manuellement les informations du bailleur
                      </div>
                    )}

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Statut du bailleur *</Label>
                        <Select 
                          value={bailCommercialData.statutBailleur} 
                          onValueChange={(value) => setBailCommercialData({...bailCommercialData, statutBailleur: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="physique">Personne physique</SelectItem>
                            <SelectItem value="morale">Personne morale (soci√©t√©)</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                    </div>

                    {/* Champs personne physique */}
                    {bailCommercialData.statutBailleur === "physique" && (
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div className="space-y-2">
                          <Label>Nom *</Label>
                          <Input value={bailCommercialData.bailleurNom} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurNom: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Pr√©nom *</Label>
                          <Input value={bailCommercialData.bailleurPrenom} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurPrenom: e.target.value})} />
                        </div>
                        <div className="space-y-2 md:col-span-2">
                          <Label>Adresse compl√®te *</Label>
                          <Input value={bailCommercialData.bailleurAdresse} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurAdresse: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Date de naissance *</Label>
                          <Input type="date" value={bailCommercialData.bailleurDateNaissance} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurDateNaissance: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Lieu de naissance *</Label>
                          <Input value={bailCommercialData.bailleurLieuNaissance} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurLieuNaissance: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Nationalit√© *</Label>
                          <Input value={bailCommercialData.bailleurNationalite} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurNationalite: e.target.value})} placeholder="Ex: Fran√ßaise" />
                        </div>
                        <div className="space-y-2">
                          <Label>Situation familiale</Label>
                          <Input value={bailCommercialData.bailleurSituationFamiliale} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurSituationFamiliale: e.target.value})} placeholder="Ex: C√©libataire, Mari√©, Divorc√©..." />
                        </div>
                        {bailCommercialData.bailleurSituationFamiliale && ['mari√©', 'marie', 'mari√©e', 'pacs√©', 'pacse', 'pacs'].some(term => bailCommercialData.bailleurSituationFamiliale.toLowerCase().includes(term)) && (
                          <div className="space-y-2">
                            <Label>R√©gime matrimonial</Label>
                            <Input value={bailCommercialData.bailleurRegimeMatrimonial} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurRegimeMatrimonial: e.target.value})} placeholder="Ex: Communaut√© l√©gale, S√©paration de biens..." />
                          </div>
                        )}
                        <div className="space-y-2">
                          <Label>Profession</Label>
                          <Input value={bailCommercialData.bailleurProfession} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurProfession: e.target.value})} />
                        </div>

                        {/* Upload carte identit√© bailleur si le client est preneur (avant la fin de la grid) */}
                        {bailCommercialData.clientRole === "preneur" && (
                          <MultiFileUpload
                            label="üìé Pi√®ce d'identit√© du bailleur"
                            files={bailCommercialBailleurFiles}
                            onFilesChange={setBailCommercialBailleurFiles}
                            accept="application/pdf,image/*"
                          />
                        )}
                      </div>
                    )}

                    {/* Pi√®ce d'identit√© du bailleur (si client s√©lectionn√©) */}
                    {bailCommercialData.clientRole === "bailleur" && bailCommercialData.clientId && (
                      <div className="space-y-2 mt-4">
                        <Label>üìé Pi√®ce d'identit√© du bailleur</Label>
                        {bailCommercialBailleurClientIdentiteUrl ? (
                          <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg">
                            <svg className="w-4 h-4 text-green-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <span className="text-sm flex-1 text-green-700">Pi√®ce d'identit√© charg√©e depuis le profil client</span>
                            <Button
                              type="button"
                              variant="ghost"
                              size="sm"
                              className="bg-green-600 hover:bg-green-700 text-white"
                              onClick={() => window.open(bailCommercialBailleurClientIdentiteUrl, '_blank')}
                            >
                              <Eye className="w-4 h-4" />
                            </Button>
                          </div>
                        ) : (
                          <div className="flex items-center gap-2 p-2 bg-orange-50 border border-orange-200 rounded-lg">
                            <svg className="w-4 h-4 text-orange-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                            </svg>
                            <span className="text-sm flex-1 text-orange-700">Aucune pi√®ce d'identit√© dans le profil client</span>
                          </div>
                        )}
                      </div>
                    )}

                    {/* Champs personne morale */}
                    {bailCommercialData.statutBailleur === "morale" && (
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div className="space-y-2 md:col-span-2">
                          <Label>D√©nomination sociale *</Label>
                          <Input value={bailCommercialData.bailleurDenomination} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurDenomination: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Forme juridique *</Label>
                          <Select value={bailCommercialData.bailleurFormeJuridique} onValueChange={(value) => setBailCommercialData({...bailCommercialData, bailleurFormeJuridique: value})}>
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="SAS">SAS</SelectItem>
                              <SelectItem value="SARL">SARL</SelectItem>
                              <SelectItem value="SCI">SCI</SelectItem>
                              <SelectItem value="SA">SA</SelectItem>
                              <SelectItem value="EURL">EURL</SelectItem>
                              <SelectItem value="SASU">SASU</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="space-y-2">
                          <Label>SIREN *</Label>
                          <Input value={bailCommercialData.bailleurSiren} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurSiren: e.target.value})} placeholder="9 chiffres" />
                        </div>
                        <div className="space-y-2">
                          <Label>SIRET *</Label>
                          <Input value={bailCommercialData.bailleurSiret} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurSiret: e.target.value})} placeholder="14 chiffres" />
                        </div>
                        <div className="space-y-2 md:col-span-2">
                          <Label>Adresse du si√®ge social *</Label>
                          <Input value={bailCommercialData.bailleurSiegeSocial} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurSiegeSocial: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Capital social</Label>
                          <Input value={bailCommercialData.bailleurCapitalSocial} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurCapitalSocial: e.target.value})} placeholder="Ex: 10000 ‚Ç¨" />
                        </div>
                        <div className="space-y-2 md:col-span-2">
                          <h4 className="font-medium text-sm mt-4">Repr√©sentant l√©gal</h4>
                        </div>
                        <div className="space-y-2">
                          <Label>Nom du repr√©sentant *</Label>
                          <Input value={bailCommercialData.bailleurRepresentant} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurRepresentant: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Pr√©nom du repr√©sentant *</Label>
                          <Input value={bailCommercialData.bailleurRepresentantPrenom} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurRepresentantPrenom: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Fonction *</Label>
                          <Input value={bailCommercialData.bailleurRepresentantFonction} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurRepresentantFonction: e.target.value})} placeholder="Ex: G√©rant, Pr√©sident..." />
                        </div>
                        <div className="space-y-2">
                          <Label>Le signataire est-il le repr√©sentant l√©gal ? *</Label>
                          <Select value={bailCommercialData.bailleurRepresentantEstLegal} onValueChange={(value) => setBailCommercialData({...bailCommercialData, bailleurRepresentantEstLegal: value})}>
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="oui">Oui</SelectItem>
                              <SelectItem value="non">Non (mandataire)</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        {bailCommercialData.bailleurRepresentantEstLegal === "non" && (
                          <>
                            <div className="space-y-2 md:col-span-2">
                              <h4 className="font-medium text-sm mt-2">Mandataire</h4>
                            </div>
                            <div className="space-y-2">
                              <Label>Nom du mandataire *</Label>
                              <Input value={bailCommercialData.bailleurMandataireNom} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurMandataireNom: e.target.value})} />
                            </div>
                            <div className="space-y-2">
                              <Label>Pr√©nom du mandataire *</Label>
                              <Input value={bailCommercialData.bailleurMandatairePrenom} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurMandatairePrenom: e.target.value})} />
                            </div>
                            <div className="space-y-2 md:col-span-2">
                              <Label>Type de pouvoir *</Label>
                              <Input value={bailCommercialData.bailleurMandataireTypePouvoir} onChange={(e) => setBailCommercialData({...bailCommercialData, bailleurMandataireTypePouvoir: e.target.value})} placeholder="Ex: Procuration sp√©ciale..." />
                            </div>
                          </>
                        )}
                      </div>
                    )}
                  </div>

                  {/* Local commercial */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üè™ Local commercial</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label>Adresse compl√®te du local *</Label>
                        <Input 
                          value={bailCommercialData.adresseLocal} 
                          onChange={(e) => setBailCommercialData({...bailCommercialData, adresseLocal: e.target.value})} 
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Nature du local *</Label>
                        <Select 
                          value={bailCommercialData.natureLocal} 
                          onValueChange={(value) => setBailCommercialData({...bailCommercialData, natureLocal: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="boutique">Boutique</SelectItem>
                            <SelectItem value="bureaux">Bureaux</SelectItem>
                            <SelectItem value="restaurant">Restaurant</SelectItem>
                            <SelectItem value="entrepot">Entrep√¥t</SelectItem>
                            <SelectItem value="atelier">Atelier</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <Label>Surface totale (m¬≤) *</Label>
                        <Input 
                          type="number"
                          value={bailCommercialData.surfaceTotale} 
                          onChange={(e) => setBailCommercialData({...bailCommercialData, surfaceTotale: e.target.value})} 
                        />
                      </div>
                    </div>
                  </div>

                  {/* Preneur (Locataire) */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">
                      {bailCommercialData.clientRole === "preneur" ? "üè¢ Preneur (votre client)" : "üè¢ Preneur (Locataire)"}
                    </h3>
                    
                    {/* S√©lection du client si preneur */}
                    {bailCommercialData.clientRole === "preneur" && (
                      <div className="space-y-2">
                        <Label>S√©lectionner le client preneur *</Label>
                        <Select 
                          value={bailCommercialData.clientId} 
                          onValueChange={(value) => {
                            const selectedClient = clients.find(c => c.id === value);
                            if (selectedClient) {
                              let situationFamiliale = "";
                              let regimeMatrimonial = "";
                              
                              // Essayer d'abord situation_matrimoniale
                              if (selectedClient.situation_matrimoniale) {
                                if (typeof selectedClient.situation_matrimoniale === 'object') {
                                  // Cas 1: Objet JSON dans situation_matrimoniale
                                  situationFamiliale = selectedClient.situation_matrimoniale.situation_familiale || '';
                                  regimeMatrimonial = selectedClient.situation_matrimoniale.regime_matrimonial || '';
                                  
                                  // Capitaliser
                                  if (situationFamiliale) {
                                    situationFamiliale = situationFamiliale.charAt(0).toUpperCase() + situationFamiliale.slice(1);
                                  }
                                  if (regimeMatrimonial) {
                                    regimeMatrimonial = regimeMatrimonial.replace(/_/g, ' ');
                                  }
                                } else if (typeof selectedClient.situation_matrimoniale === 'string') {
                                  // Cas 2: Simple cha√Æne de texte
                                  situationFamiliale = selectedClient.situation_matrimoniale;
                                }
                              }
                              
                              // Si pas trouv√©, essayer situation_familiale
                              if (!situationFamiliale && selectedClient.situation_familiale) {
                                if (typeof selectedClient.situation_familiale === 'object') {
                                  // Objet JSON dans situation_familiale
                                  situationFamiliale = selectedClient.situation_familiale.situation_familiale || '';
                                  regimeMatrimonial = selectedClient.situation_familiale.regime_matrimonial || '';
                                  
                                  // Capitaliser
                                  if (situationFamiliale) {
                                    situationFamiliale = situationFamiliale.charAt(0).toUpperCase() + situationFamiliale.slice(1);
                                  }
                                  if (regimeMatrimonial) {
                                    regimeMatrimonial = regimeMatrimonial.replace(/_/g, ' ');
                                  }
                                } else if (typeof selectedClient.situation_familiale === 'string') {
                                  // Simple cha√Æne
                                  situationFamiliale = selectedClient.situation_familiale;
                                }
                              }
                              
                              setBailCommercialData({
                                ...bailCommercialData,
                                clientId: value,
                                locataireClientId: value,
                                statutLocataire: "physique",
                                locataireNom: selectedClient.nom || "",
                                locatairePrenom: selectedClient.prenom || "",
                                locataireAdresse: selectedClient.adresse || "",
                                locataireDateNaissance: selectedClient.date_naissance || "",
                                locataireLieuNaissance: selectedClient.lieu_naissance || "",
                                locataireNationalite: selectedClient.nationalite || "",
                                locataireSituationFamiliale: situationFamiliale,
                                locataireRegimeMatrimonial: regimeMatrimonial,
                                locataireProfession: selectedClient.profession || "",
                                locataireTelephone: selectedClient.telephone || "",
                                locataireEmail: selectedClient.email || "",
                              });
                            }
                          }}
                        >
                          <SelectTrigger><SelectValue placeholder="Choisir un client" /></SelectTrigger>
                          <SelectContent>
                            {clients.map((client) => (
                              <SelectItem key={client.id} value={client.id}>{client.nom} {client.prenom}</SelectItem>
                            ))}
                          </SelectContent>
                        </Select>
                      </div>
                    )}
                    
                    {bailCommercialData.clientRole === "bailleur" && (
                      <div className="text-sm text-muted-foreground mb-2">
                        Saisir manuellement les informations du preneur
                      </div>
                    )}

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Statut du preneur *</Label>
                        <Select 
                          value={bailCommercialData.statutLocataire} 
                          onValueChange={(value) => setBailCommercialData({...bailCommercialData, statutLocataire: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="physique">Personne physique</SelectItem>
                            <SelectItem value="morale">Personne morale (soci√©t√©)</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                    </div>

                    {/* Champs personne physique */}
                    {bailCommercialData.statutLocataire === "physique" && (
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div className="space-y-2">
                          <Label>Nom *</Label>
                          <Input value={bailCommercialData.locataireNom} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireNom: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Pr√©nom *</Label>
                          <Input value={bailCommercialData.locatairePrenom} onChange={(e) => setBailCommercialData({...bailCommercialData, locatairePrenom: e.target.value})} />
                        </div>
                        <div className="space-y-2 md:col-span-2">
                          <Label>Adresse actuelle *</Label>
                          <Input value={bailCommercialData.locataireAdresse} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireAdresse: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Date de naissance *</Label>
                          <Input type="date" value={bailCommercialData.locataireDateNaissance} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireDateNaissance: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Lieu de naissance *</Label>
                          <Input value={bailCommercialData.locataireLieuNaissance} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireLieuNaissance: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Nationalit√© *</Label>
                          <Input value={bailCommercialData.locataireNationalite} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireNationalite: e.target.value})} placeholder="Ex: Fran√ßaise" />
                        </div>
                        <div className="space-y-2">
                          <Label>Situation familiale</Label>
                          <Input value={bailCommercialData.locataireSituationFamiliale} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireSituationFamiliale: e.target.value})} placeholder="Ex: C√©libataire, Mari√©, Divorc√©..." />
                        </div>
                        {bailCommercialData.locataireSituationFamiliale && ['mari√©', 'marie', 'mari√©e', 'pacs√©', 'pacse', 'pacs'].some(term => bailCommercialData.locataireSituationFamiliale.toLowerCase().includes(term)) && (
                          <div className="space-y-2">
                            <Label>R√©gime matrimonial</Label>
                            <Input value={bailCommercialData.locataireRegimeMatrimonial} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireRegimeMatrimonial: e.target.value})} placeholder="Ex: Communaut√© l√©gale, S√©paration de biens..." />
                          </div>
                        )}
                        <div className="space-y-2">
                          <Label>Profession *</Label>
                          <Input value={bailCommercialData.locataireProfession} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireProfession: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>T√©l√©phone *</Label>
                          <Input value={bailCommercialData.locataireTelephone} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireTelephone: e.target.value})} placeholder="06 XX XX XX XX" />
                        </div>

                        {/* Upload carte identit√© preneur si le client est bailleur (avant Email) */}
                        {bailCommercialData.clientRole === "bailleur" && (
                          <MultiFileUpload
                            label="üìé Pi√®ce d'identit√© du preneur"
                            files={bailCommercialLocataireFiles}
                            onFilesChange={setBailCommercialLocataireFiles}
                            accept="application/pdf,image/*"
                          />
                        )}

                        <div className="space-y-2 md:col-span-2">
                          <Label>Email *</Label>
                          <Input type="email" value={bailCommercialData.locataireEmail} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireEmail: e.target.value})} />
                        </div>
                        <div className="space-y-2 md:col-span-2">
                          <h4 className="font-medium text-sm mt-4">Activit√© professionnelle</h4>
                        </div>
                        <div className="space-y-2">
                          <Label>Exerce en nom propre ou sous EI ? *</Label>
                          <Select value={bailCommercialData.locataireExerceEnNomPropre} onValueChange={(value) => setBailCommercialData({...bailCommercialData, locataireExerceEnNomPropre: value})}>
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="nom_propre">Nom propre</SelectItem>
                              <SelectItem value="ei">EI</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="space-y-2">
                          <Label>Intitul√© de l'activit√© exerc√©e *</Label>
                          <Input value={bailCommercialData.locataireActivite} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireActivite: e.target.value})} placeholder="Ex: Commerce de d√©tail, Artisan..." />
                        </div>
                        <div className="space-y-2">
                          <Label>Num√©ro SIREN</Label>
                          <Input value={bailCommercialData.locataireSirenPersonnel} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireSirenPersonnel: e.target.value})} placeholder="Si existant" />
                        </div>
                        <div className="space-y-2">
                          <Label>Entreprise en cours de cr√©ation ? *</Label>
                          <Select value={bailCommercialData.locataireEntrepriseEnCreation} onValueChange={(value) => setBailCommercialData({...bailCommercialData, locataireEntrepriseEnCreation: value})}>
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="oui">Oui</SelectItem>
                              <SelectItem value="non">Non</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                      </div>
                    )}

                    {/* Pi√®ce d'identit√© du preneur (si client s√©lectionn√©) */}
                    {bailCommercialData.clientRole === "preneur" && bailCommercialData.clientId && bailCommercialData.statutLocataire === "physique" && (
                      <div className="space-y-2 mt-4">
                        <Label>üìé Pi√®ce d'identit√© du preneur</Label>
                        {bailCommercialPreneurClientIdentiteUrl ? (
                          <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg">
                            <svg className="w-4 h-4 text-green-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <span className="text-sm flex-1 text-green-700">Pi√®ce d'identit√© charg√©e depuis le profil client</span>
                            <Button
                              type="button"
                              variant="ghost"
                              size="sm"
                              className="bg-green-600 hover:bg-green-700 text-white"
                              onClick={() => window.open(bailCommercialPreneurClientIdentiteUrl, '_blank')}
                            >
                              <Eye className="w-4 h-4" />
                            </Button>
                          </div>
                        ) : (
                          <div className="flex items-center gap-2 p-2 bg-orange-50 border border-orange-200 rounded-lg">
                            <svg className="w-4 h-4 text-orange-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                            </svg>
                            <span className="text-sm flex-1 text-orange-700">Aucune pi√®ce d'identit√© dans le profil client</span>
                          </div>
                        )}
                      </div>
                    )}

                    {/* Upload carte identit√© pour l'autre partie (bailleur qui n'est pas client) - d√©plac√© ailleurs */}

                    {/* Champs personne morale */}
                    {bailCommercialData.statutLocataire === "morale" && (
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div className="space-y-2 md:col-span-2">
                          <Label>D√©nomination sociale *</Label>
                          <Input value={bailCommercialData.locataireDenomination} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireDenomination: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Forme juridique *</Label>
                          <Select value={bailCommercialData.locataireFormeJuridique} onValueChange={(value) => setBailCommercialData({...bailCommercialData, locataireFormeJuridique: value})}>
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="SAS">SAS</SelectItem>
                              <SelectItem value="SARL">SARL</SelectItem>
                              <SelectItem value="SCI">SCI</SelectItem>
                              <SelectItem value="SA">SA</SelectItem>
                              <SelectItem value="EURL">EURL</SelectItem>
                              <SelectItem value="SASU">SASU</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="space-y-2">
                          <Label>SIREN *</Label>
                          <Input value={bailCommercialData.locataireSiren} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireSiren: e.target.value})} placeholder="9 chiffres" />
                        </div>
                        <div className="space-y-2">
                          <Label>SIRET *</Label>
                          <Input value={bailCommercialData.locataireSiret} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireSiret: e.target.value})} placeholder="14 chiffres" />
                        </div>
                        <div className="space-y-2 md:col-span-2">
                          <Label>Adresse du si√®ge social *</Label>
                          <Input value={bailCommercialData.locataireSiege} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireSiege: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Objet social *</Label>
                          <Input value={bailCommercialData.locataireObjetSocial} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireObjetSocial: e.target.value})} placeholder="Pour v√©rifier compatibilit√©" />
                        </div>
                        <div className="space-y-2">
                          <Label>Capital social</Label>
                          <Input value={bailCommercialData.locataireCapital} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireCapital: e.target.value})} placeholder="Ex: 5000 ‚Ç¨" />
                        </div>
                        <div className="space-y-2 md:col-span-2">
                          <h4 className="font-medium text-sm mt-4">Repr√©sentant l√©gal</h4>
                        </div>
                        <div className="space-y-2">
                          <Label>Nom du repr√©sentant *</Label>
                          <Input value={bailCommercialData.locataireRepresentant} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireRepresentant: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Pr√©nom du repr√©sentant *</Label>
                          <Input value={bailCommercialData.locataireRepresentantPrenom} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireRepresentantPrenom: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Fonction *</Label>
                          <Input value={bailCommercialData.locataireRepresentantFonction} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireRepresentantFonction: e.target.value})} placeholder="Ex: G√©rant, Pr√©sident..." />
                        </div>
                        <div className="space-y-2 md:col-span-2">
                          <h4 className="font-medium text-sm mt-2">Mandataire (si diff√©rent du repr√©sentant)</h4>
                        </div>
                        <div className="space-y-2">
                          <Label>Nom du mandataire</Label>
                          <Input value={bailCommercialData.locataireMandataireNom} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireMandataireNom: e.target.value})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Pr√©nom du mandataire</Label>
                          <Input value={bailCommercialData.locataireMandatairePrenom} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireMandatairePrenom: e.target.value})} />
                        </div>
                        <div className="space-y-2 md:col-span-2">
                          <Label>Type de pouvoir</Label>
                          <Input value={bailCommercialData.locataireMandataireTypePouvoir} onChange={(e) => setBailCommercialData({...bailCommercialData, locataireMandataireTypePouvoir: e.target.value})} placeholder="Ex: Procuration..." />
                        </div>
                      </div>
                    )}
                  </div>

                  {/* Activit√© */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üíº Activit√©</h3>
                    <div className="grid grid-cols-1 gap-4">
                      <div className="space-y-2">
                        <Label>Activit√© principale autoris√©e *</Label>
                        <Input 
                          value={bailCommercialData.activitePrincipale} 
                          onChange={(e) => setBailCommercialData({...bailCommercialData, activitePrincipale: e.target.value})} 
                          placeholder="Ex: Commerce de d√©tail, Restauration, Cabinet m√©dical..."
                        />
                      </div>

                      {/* COMMERCIAL UNIQUEMENT - 1. Destination des lieux */}
                      {bailCommercialData.typeBail === "commercial" && (
                        <>
                          <div className="space-y-2">
                            <Label>Destination contractuelle pr√©cise *</Label>
                            <Textarea 
                              value={bailCommercialData.destinationContractuelle} 
                              onChange={(e) => setBailCommercialData({...bailCommercialData, destinationContractuelle: e.target.value})} 
                              placeholder="Ex: Vente et pr√©paration de produits alimentaires √† consommer sur place ou √† emporter"
                              rows={3}
                            />
                            <p className="text-xs text-muted-foreground">D√©crivez pr√©cis√©ment les activit√©s autoris√©es</p>
                          </div>

                          <div className="space-y-2">
                            <Label>Exclusivit√©s √©ventuelles</Label>
                            <Textarea 
                              value={bailCommercialData.exclusivitesEventuelles} 
                              onChange={(e) => setBailCommercialData({...bailCommercialData, exclusivitesEventuelles: e.target.value})} 
                              placeholder="Ex: Exclusivit√© de vente de produits bio dans l'immeuble"
                              rows={2}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Interdictions d'usage</Label>
                            <Textarea 
                              value={bailCommercialData.interdictionsUsage} 
                              onChange={(e) => setBailCommercialData({...bailCommercialData, interdictionsUsage: e.target.value})} 
                              placeholder="Ex: √Ä l'exclusion de toute activit√© bruyante ou nuisible"
                              rows={2}
                            />
                          </div>
                        </>
                      )}

                      {/* PROFESSIONNEL UNIQUEMENT - Type de profession */}
                      {bailCommercialData.typeBail === "professionnel" && (
                        <>
                          <div className="space-y-2">
                            <Label>Type de profession *</Label>
                            <Select 
                              value={bailCommercialData.typeProfession} 
                              onValueChange={(value) => setBailCommercialData({...bailCommercialData, typeProfession: value})}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="lib√©rale_reglementee">Profession lib√©rale r√©glement√©e (m√©decin, avocat, architecte...)</SelectItem>
                                <SelectItem value="lib√©rale_non_reglementee">Profession lib√©rale non r√©glement√©e (consultant, coach...)</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          {bailCommercialData.typeProfession === "lib√©rale_reglementee" && (
                            <>
                              <div className="space-y-2">
                                <Label>Num√©ro d'ordre professionnel *</Label>
                                <Input 
                                  value={bailCommercialData.numeroOrdreProfessionnel} 
                                  onChange={(e) => setBailCommercialData({...bailCommercialData, numeroOrdreProfessionnel: e.target.value})} 
                                  placeholder="Ex: Num√©ro RPPS, num√©ro d'inscription au barreau..."
                                />
                              </div>

                              <MultiFileUpload
                                label="üìé Attestation d'inscription √† l'ordre"
                                files={bailProfessionnelOrdreFiles}
                                onFilesChange={setBailProfessionnelOrdreFiles}
                                accept="application/pdf"
                              />
                            </>
                          )}
                        </>
                      )}
                    </div>
                  </div>

                  {/* Conditions financi√®res */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üí∂ Conditions financi√®res</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Loyer mensuel HT (‚Ç¨) *</Label>
                        <Input 
                          type="number"
                          value={bailCommercialData.loyerMensuelHT} 
                          onChange={(e) => setBailCommercialData({...bailCommercialData, loyerMensuelHT: e.target.value})} 
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Charges mensuelles (‚Ç¨) *</Label>
                        <Input 
                          type="number"
                          value={bailCommercialData.chargesMensuelles} 
                          onChange={(e) => setBailCommercialData({...bailCommercialData, chargesMensuelles: e.target.value})} 
                        />
                      </div>

                      {/* 2. Clause de r√©vision du loyer */}
                      <div className="space-y-2 md:col-span-2 mt-4">
                        <h4 className="font-medium">R√©vision du loyer</h4>
                      </div>
                      
                      {bailCommercialData.typeBail === "commercial" ? (
                        <>
                          <div className="space-y-2">
                            <Label>Indice applicable *</Label>
                            <Select 
                              value={bailCommercialData.indiceApplicable} 
                              onValueChange={(value) => setBailCommercialData({...bailCommercialData, indiceApplicable: value})}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="ILC">ILC (Indice des Loyers Commerciaux)</SelectItem>
                                <SelectItem value="ILAT">ILAT (Indice des Loyers des Activit√©s Tertiaires)</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>
                          <div className="space-y-2">
                            <Label>Base de calcul de l'indice</Label>
                            <Input 
                              value={bailCommercialData.baseCalculIndice} 
                              onChange={(e) => setBailCommercialData({...bailCommercialData, baseCalculIndice: e.target.value})} 
                              placeholder="Ex: Indice du 1er trimestre 2025"
                            />
                          </div>
                          <div className="space-y-2">
                            <Label>Modalit√© de r√©vision *</Label>
                            <Select 
                              value={bailCommercialData.modaliteRevision} 
                              onValueChange={(value) => setBailCommercialData({...bailCommercialData, modaliteRevision: value})}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="annuelle">Annuelle</SelectItem>
                                <SelectItem value="triennale">Triennale</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>
                        </>
                      ) : (
                        <>
                          {/* PROFESSIONNEL - R√©vision via IRL uniquement */}
                          <div className="space-y-2 md:col-span-2">
                            <p className="text-sm text-muted-foreground">
                              Pour un bail professionnel : r√©vision annuelle via IRL (Indice de R√©f√©rence des Loyers)
                            </p>
                          </div>
                          <div className="space-y-2">
                            <Label>Base de calcul de l'indice IRL</Label>
                            <Input 
                              value={bailCommercialData.baseCalculIndice} 
                              onChange={(e) => setBailCommercialData({...bailCommercialData, baseCalculIndice: e.target.value})} 
                              placeholder="Ex: IRL du 1er trimestre 2025"
                            />
                          </div>
                        </>
                      )}

                      {/* 7. Charges r√©cup√©rables */}
                      <div className="space-y-2">
                        <Label>Mode de r√®glement des charges *</Label>
                        <Select 
                          value={bailCommercialData.modeReglementCharges} 
                          onValueChange={(value) => setBailCommercialData({...bailCommercialData, modeReglementCharges: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="forfait">Forfait</SelectItem>
                            <SelectItem value="provision">Provision avec r√©gularisation</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {/* 3. D√©p√¥t de garantie */}
                      <div className="space-y-2 md:col-span-2 mt-4">
                        <h4 className="font-medium">D√©p√¥t de garantie</h4>
                      </div>
                      <div className="space-y-2">
                        <Label>Montant du d√©p√¥t de garantie (‚Ç¨)</Label>
                        <Input 
                          type="number"
                          value={bailCommercialData.montantDepotGarantie} 
                          onChange={(e) => setBailCommercialData({...bailCommercialData, montantDepotGarantie: e.target.value})} 
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Modalit√©s de restitution</Label>
                        <Input 
                          value={bailCommercialData.restitutionDepot} 
                          onChange={(e) => setBailCommercialData({...bailCommercialData, restitutionDepot: e.target.value})} 
                          placeholder="Ex: Dans les 30 jours suivant la restitution des lieux"
                        />
                      </div>
                    </div>
                  </div>

                  {/* Dur√©e */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üìÖ Dur√©e du bail</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      {bailCommercialData.typeBail === "commercial" ? (
                        <div className="space-y-2">
                          <Label>Type de bail *</Label>
                          <Select 
                            value={bailCommercialData.dureeBail} 
                            onValueChange={(value) => setBailCommercialData({...bailCommercialData, dureeBail: value})}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="3-6-9">Bail commercial 3/6/9</SelectItem>
                              <SelectItem value="derogatoire">Bail d√©rogatoire (‚â§ 3 ans)</SelectItem>
                              <SelectItem value="saisonnier">Bail saisonnier</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                      ) : (
                        <div className="space-y-2 md:col-span-2">
                          <Label>Dur√©e du bail professionnel</Label>
                          <p className="text-sm text-muted-foreground">Dur√©e minimum de 6 ans avec possibilit√© de r√©siliation triennale</p>
                          <Input 
                            type="number"
                            value={bailCommercialData.dureeBail || "6"} 
                            onChange={(e) => setBailCommercialData({...bailCommercialData, dureeBail: e.target.value})}
                            placeholder="6"
                            min="6"
                          />
                        </div>
                      )}
                      <div className="space-y-2">
                        <Label>Date de prise d'effet *</Label>
                        <Input 
                          type="date"
                          value={bailCommercialData.datePriseEffet} 
                          onChange={(e) => setBailCommercialData({...bailCommercialData, datePriseEffet: e.target.value})} 
                        />
                      </div>
                    </div>
                  </div>

                  {/* 4. Travaux et r√©parations (COMMERCIAL UNIQUEMENT) */}
                  {bailCommercialData.typeBail === "commercial" && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">üîß Travaux et r√©parations</h3>
                      <div className="grid grid-cols-1 gap-4">
                        <div className="space-y-2">
                          <Label>Travaux √† la charge du bailleur</Label>
                          <Textarea 
                            value={bailCommercialData.travauxChargeBailleur} 
                            onChange={(e) => setBailCommercialData({...bailCommercialData, travauxChargeBailleur: e.target.value})} 
                            placeholder="Ex: Gros ≈ìuvre, ravalement, toiture, structure..."
                            rows={3}
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>Travaux √† la charge du preneur</Label>
                          <Textarea 
                            value={bailCommercialData.travauxChargePreneur} 
                            onChange={(e) => setBailCommercialData({...bailCommercialData, travauxChargePreneur: e.target.value})} 
                            placeholder="Ex: Entretien courant, r√©parations locatives, am√©nagements int√©rieurs..."
                            rows={3}
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>Charges support√©es par le bailleur</Label>
                          <Textarea 
                            value={bailCommercialData.chargesSupporteesBailleur} 
                            onChange={(e) => setBailCommercialData({...bailCommercialData, chargesSupporteesBailleur: e.target.value})} 
                            placeholder="Ex: Taxe fonci√®re, gros entretien..."
                            rows={2}
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>Charges support√©es par le preneur</Label>
                          <Textarea 
                            value={bailCommercialData.chargesSupporteesPreneur} 
                            onChange={(e) => setBailCommercialData({...bailCommercialData, chargesSupporteesPreneur: e.target.value})} 
                            placeholder="Ex: Eau, √©lectricit√©, chauffage, taxe ordures m√©nag√®res..."
                            rows={2}
                        />
                      </div>
                    </div>
                  </div>
                  )}

                  {/* 5. Imp√¥ts et taxes (COMMERCIAL UNIQUEMENT) */}
                  {bailCommercialData.typeBail === "commercial" && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">üí∞ Imp√¥ts et taxes</h3>
                      <div className="grid grid-cols-1 gap-4">
                        <div className="space-y-2">
                          <Label>Taxe fonci√®re support√©e par *</Label>
                          <Select 
                            value={bailCommercialData.taxeFonciereSupporteePar} 
                            onValueChange={(value) => setBailCommercialData({...bailCommercialData, taxeFonciereSupporteePar: value})}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="bailleur">Bailleur</SelectItem>
                              <SelectItem value="locataire">Locataire</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="space-y-2">
                          <Label>Taxes et contributions r√©cup√©rables</Label>
                          <Textarea 
                            value={bailCommercialData.taxesRecuperables} 
                            onChange={(e) => setBailCommercialData({...bailCommercialData, taxesRecuperables: e.target.value})} 
                            placeholder="Ex: TEOM, CFE..."
                            rows={2}
                          />
                        </div>
                      </div>
                    </div>
                  )}

                  {/* 6. √âtat des lieux */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üìã √âtat des lieux</h3>
                    <div className="grid grid-cols-1 gap-4">
                      <div className="space-y-2">
                        <Label>√âtat des lieux d'entr√©e r√©alis√© ? *</Label>
                        <Select 
                          value={bailCommercialData.etatLieuxRealise} 
                          onValueChange={(value) => setBailCommercialData({...bailCommercialData, etatLieuxRealise: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="oui">Oui</SelectItem>
                            <SelectItem value="non">Non</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {bailCommercialData.etatLieuxRealise === "oui" && (
                        <MultiFileUpload
                          label="üìé √âtat des lieux (PDF)"
                          files={bailCommercialEtatLieuxFiles}
                          onFilesChange={setBailCommercialEtatLieuxFiles}
                          accept="application/pdf"
                        />
                      )}
                    </div>
                  </div>

                  {/* 8. Sous-location & cession (COMMERCIAL UNIQUEMENT) */}
                  {bailCommercialData.typeBail === "commercial" && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">üìÑ Sous-location & Cession</h3>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <Label>Sous-location autoris√©e ? *</Label>
                          <Select 
                            value={bailCommercialData.souslocationAutorisee} 
                            onValueChange={(value) => setBailCommercialData({...bailCommercialData, souslocationAutorisee: value})}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="oui">Oui</SelectItem>
                              <SelectItem value="non">Non</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        {bailCommercialData.souslocationAutorisee === "oui" && (
                          <div className="space-y-2">
                            <Label>Conditions de sous-location</Label>
                            <Input 
                              value={bailCommercialData.souslocationConditions} 
                              onChange={(e) => setBailCommercialData({...bailCommercialData, souslocationConditions: e.target.value})} 
                              placeholder="Ex: Avec accord pr√©alable du bailleur"
                            />
                          </div>
                        )}
                        <div className="space-y-2">
                          <Label>Cession du bail autoris√©e ? *</Label>
                          <Select 
                            value={bailCommercialData.cessionBailAutorisee} 
                            onValueChange={(value) => setBailCommercialData({...bailCommercialData, cessionBailAutorisee: value})}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="oui">Oui</SelectItem>
                              <SelectItem value="non">Non</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        {bailCommercialData.cessionBailAutorisee === "oui" && (
                          <div className="space-y-2">
                            <Label>Conditions de cession</Label>
                            <Input 
                              value={bailCommercialData.cessionConditions} 
                              onChange={(e) => setBailCommercialData({...bailCommercialData, cessionConditions: e.target.value})} 
                              placeholder="Ex: Agr√©ment du bailleur requis"
                            />
                          </div>
                        )}
                      </div>
                    </div>
                  )}

                  {/* 9. Garanties */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üõ°Ô∏è Garanties</h3>
                    <div className="grid grid-cols-1 gap-4">
                      <div className="space-y-2">
                        <Label>Caution personnelle ? *</Label>
                        <Select 
                          value={bailCommercialData.cautionPersonnelleOuiNon} 
                          onValueChange={(value) => setBailCommercialData({...bailCommercialData, cautionPersonnelleOuiNon: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="oui">Oui</SelectItem>
                            <SelectItem value="non">Non</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {bailCommercialData.cautionPersonnelleOuiNon === "oui" && (
                        <>
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="space-y-2">
                              <Label>Nom de la caution *</Label>
                              <Input 
                                value={bailCommercialData.nomCaution} 
                                onChange={(e) => setBailCommercialData({...bailCommercialData, nomCaution: e.target.value})} 
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Pr√©nom de la caution *</Label>
                              <Input 
                                value={bailCommercialData.prenomCaution} 
                                onChange={(e) => setBailCommercialData({...bailCommercialData, prenomCaution: e.target.value})} 
                              />
                            </div>
                          </div>
                          <div className="space-y-2">
                            <Label>Montant garanti (‚Ç¨)</Label>
                            <Input 
                              type="number"
                              value={bailCommercialData.montantGaranti} 
                              onChange={(e) => setBailCommercialData({...bailCommercialData, montantGaranti: e.target.value})} 
                            />
                          </div>

                          <MultiFileUpload
                            label="üìé Pi√®ce d'identit√© de la caution"
                            files={bailCommercialCautionIdFiles}
                            onFilesChange={setBailCommercialCautionIdFiles}
                            accept="application/pdf,image/*"
                          />
                        </>
                      )}
                    </div>
                  </div>

                  {/* 10. Assurance obligatoire */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üè• Assurance obligatoire</h3>
                    <div className="grid grid-cols-1 gap-4">
                      {bailCommercialData.typeBail === "commercial" ? (
                        <>
                          {/* COMMERCIAL - Assurance multirisque professionnelle */}
                          <div className="space-y-2">
                            <Label>Assurance multirisque professionnelle souscrite ? *</Label>
                            <Select 
                              value={bailCommercialData.assuranceMultirisqueSouscrite} 
                              onValueChange={(value) => setBailCommercialData({...bailCommercialData, assuranceMultirisqueSouscrite: value})}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="oui">Oui</SelectItem>
                                <SelectItem value="non">Non (√† souscrire avant entr√©e)</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          {bailCommercialData.assuranceMultirisqueSouscrite === "oui" && (
                            <>
                              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div className="space-y-2">
                                  <Label>Nom de l'assureur</Label>
                                  <Input 
                                    value={bailCommercialData.nomAssureur} 
                                    onChange={(e) => setBailCommercialData({...bailCommercialData, nomAssureur: e.target.value})} 
                                    placeholder="Ex: AXA, Allianz..."
                                  />
                                </div>
                                <div className="space-y-2">
                                  <Label>Num√©ro de police</Label>
                                  <Input 
                                    value={bailCommercialData.numeropolice} 
                                    onChange={(e) => setBailCommercialData({...bailCommercialData, numeropolice: e.target.value})} 
                                  />
                                </div>
                              </div>

                              <MultiFileUpload
                                label="üìé Attestation d'assurance"
                                files={bailCommercialAssuranceFiles}
                                onFilesChange={setBailCommercialAssuranceFiles}
                                accept="application/pdf"
                              />
                            </>
                          )}
                        </>
                      ) : (
                        <>
                          {/* PROFESSIONNEL - RC Pro + Assurance locaux */}
                          <div className="space-y-2 md:col-span-2">
                            <p className="text-sm text-muted-foreground">
                              Pour un bail professionnel : obligation d'assurer la RC professionnelle et les locaux
                            </p>
                          </div>

                          <div className="space-y-2">
                            <Label>Assurance RC Professionnelle souscrite ? *</Label>
                            <Select 
                              value={bailCommercialData.assuranceRCPro} 
                              onValueChange={(value) => setBailCommercialData({...bailCommercialData, assuranceRCPro: value})}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="oui">Oui</SelectItem>
                                <SelectItem value="non">Non (√† souscrire avant entr√©e)</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          <div className="space-y-2">
                            <Label>Assurance des locaux souscrite ? *</Label>
                            <Select 
                              value={bailCommercialData.assuranceLocaux} 
                              onValueChange={(value) => setBailCommercialData({...bailCommercialData, assuranceLocaux: value})}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="oui">Oui</SelectItem>
                                <SelectItem value="non">Non (√† souscrire avant entr√©e)</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          {(bailCommercialData.assuranceRCPro === "oui" || bailCommercialData.assuranceLocaux === "oui") && (
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 md:col-span-2">
                              <div className="space-y-2">
                                <Label>Nom de l'assureur</Label>
                                <Input 
                                  value={bailCommercialData.nomAssureur} 
                                  onChange={(e) => setBailCommercialData({...bailCommercialData, nomAssureur: e.target.value})} 
                                  placeholder="Ex: AXA, Allianz..."
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Num√©ro de police</Label>
                                <Input 
                                  value={bailCommercialData.numeropolice} 
                                  onChange={(e) => setBailCommercialData({...bailCommercialData, numeropolice: e.target.value})} 
                                />
                              </div>
                            </div>
                          )}

                          {(bailCommercialData.assuranceRCPro === "oui" || bailCommercialData.assuranceLocaux === "oui") && (
                            <MultiFileUpload
                              label="üìé Attestations d'assurance"
                              files={bailCommercialAssuranceFiles}
                              onFilesChange={setBailCommercialAssuranceFiles}
                              accept="application/pdf"
                            />
                          )}
                        </>
                      )}
                    </div>
                  </div>
                </div>
              </>
            )}

            {/* Formulaire sp√©cifique pour Convention d'indivision */}
            {pendingContractType === "Convention d'indivision" && (
              <>
                <div className="space-y-6 max-h-[60vh] overflow-y-auto px-1">
                  {/* 1. Informations g√©n√©rales */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üìã Informations g√©n√©rales sur l'indivision</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Type de bien *</Label>
                        <Select 
                          value={indivisionData.typeBien} 
                          onValueChange={(value) => setIndivisionData({...indivisionData, typeBien: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="immobilier">Immobilier</SelectItem>
                            <SelectItem value="mobilier">Mobilier</SelectItem>
                            <SelectItem value="autre">Autre</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      {indivisionData.typeBien === "autre" && (
                        <div className="space-y-2">
                          <Label>Pr√©ciser le type de bien</Label>
                          <Input 
                            value={indivisionData.typeBienAutre} 
                            onChange={(e) => setIndivisionData({...indivisionData, typeBienAutre: e.target.value})} 
                          />
                        </div>
                      )}
                      <div className="space-y-2">
                        <Label>Origine de l'indivision *</Label>
                        <Select 
                          value={indivisionData.origineIndivision} 
                          onValueChange={(value) => setIndivisionData({...indivisionData, origineIndivision: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="succession">Succession</SelectItem>
                            <SelectItem value="achat_commun">Achat en commun</SelectItem>
                            <SelectItem value="investissement">Investissement commun</SelectItem>
                            <SelectItem value="donation">Donation</SelectItem>
                            <SelectItem value="autre">Autre</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      {indivisionData.origineIndivision === "autre" && (
                        <div className="space-y-2">
                          <Label>Pr√©ciser l'origine</Label>
                          <Input 
                            value={indivisionData.origineIndivisionAutre} 
                            onChange={(e) => setIndivisionData({...indivisionData, origineIndivisionAutre: e.target.value})} 
                          />
                        </div>
                      )}
                      <div className="space-y-2 md:col-span-2">
                        <Label>Objet de la convention</Label>
                        <Textarea 
                          value={indivisionData.objetConvention} 
                          onChange={(e) => setIndivisionData({...indivisionData, objetConvention: e.target.value})} 
                          placeholder="Ex: Gestion du bien, r√©partition des droits, d√©signation d'un g√©rant..."
                          rows={3}
                        />
                      </div>
                    </div>
                  </div>

                  {/* 2. Indivisaires */}
                  <div className="space-y-4">
                    <div className="flex items-center justify-between">
                      <h3 className="font-semibold text-lg border-b pb-2 flex-1">üë• Indivisaires</h3>
                      <Button
                        type="button"
                        variant="outline"
                        size="sm"
                        className="text-orange-600 hover:text-orange-700 hover:bg-orange-50 border-orange-300"
                        onClick={() => {
                          const newId = Math.max(...indivisionData.indivisaires.map(i => i.id), 0) + 1;
                          setIndivisionData({
                            ...indivisionData,
                            indivisaires: [...indivisionData.indivisaires, {
                              id: newId,
                              isClient: false,
                              clientId: "",
                              nom: "",
                              prenom: "",
                              adresse: "",
                              dateNaissance: "",
                              lieuNaissance: "",
                              nationalite: "",
                              profession: "",
                              statutMatrimonial: "",
                              regimeMatrimonial: "",
                              typeIdentite: "",
                              numeroIdentite: "",
                              email: "",
                              telephone: "",
                              quotePart: "",
                              origineQuotePart: "",
                              origineQuotePartAutre: "",
                            }]
                          });
                        }}
                      >
                        + Ajouter un indivisaire
                      </Button>
                    </div>

                    {indivisionData.indivisaires.map((indivisaire, index) => (
                      <div key={indivisaire.id} className="border rounded-lg p-4 space-y-4 bg-muted/30">
                        <div className="flex items-center justify-between">
                          <h4 className="font-medium">Indivisaire {index + 1}</h4>
                          {indivisionData.indivisaires.length > 1 && (
                            <Button
                              type="button"
                              variant="ghost"
                              size="sm"
                              className="text-red-600 hover:text-red-700 hover:bg-red-50"
                              onClick={() => {
                                setIndivisionData({
                                  ...indivisionData,
                                  indivisaires: indivisionData.indivisaires.filter(i => i.id !== indivisaire.id)
                                });
                              }}
                            >
                              <Trash2 className="w-4 h-4" />
                            </Button>
                          )}
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          {/* Client ou non */}
                          <div className="space-y-2 md:col-span-2">
                            <Label>Cet indivisaire est-il votre client ? *</Label>
                            <RadioGroup
                              value={indivisaire.isClient ? "oui" : "non"}
                              onValueChange={(value) => {
                                const newIndivisaires = [...indivisionData.indivisaires];
                                const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                newIndivisaires[idx] = {
                                  ...newIndivisaires[idx],
                                  isClient: value === "oui",
                                  clientId: value === "oui" ? newIndivisaires[idx].clientId : "",
                                };
                                setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                              }}
                            >
                              <div className="flex gap-4">
                                <div className="flex items-center space-x-2">
                                  <RadioGroupItem value="oui" id={`indiv_${indivisaire.id}_client_oui`} />
                                  <Label htmlFor={`indiv_${indivisaire.id}_client_oui`} className="cursor-pointer">Oui (client)</Label>
                                </div>
                                <div className="flex items-center space-x-2">
                                  <RadioGroupItem value="non" id={`indiv_${indivisaire.id}_client_non`} />
                                  <Label htmlFor={`indiv_${indivisaire.id}_client_non`} className="cursor-pointer">Non (autre partie)</Label>
                                </div>
                              </div>
                            </RadioGroup>
                          </div>

                          {/* Si c'est un client */}
                          {indivisaire.isClient ? (
                            <>
                              <div className="space-y-2 md:col-span-2">
                                <Label>S√©lectionner le client *</Label>
                                <Select
                                  value={indivisaire.clientId}
                                  onValueChange={async (value) => {
                                    const selectedClient = clients.find(c => c.id === value);
                                    const newIndivisaires = [...indivisionData.indivisaires];
                                    const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                    if (selectedClient) {
                                      console.log('üîç Client s√©lectionn√©:', selectedClient.nom, selectedClient.prenom);
                                      console.log('üìã situation_matrimoniale:', selectedClient.situation_matrimoniale);
                                      console.log('üìã situation_familiale:', selectedClient.situation_familiale);
                                      console.log('üìÑ id_doc_path:', selectedClient.id_doc_path);
                                      
                                      // Extraire la situation familiale et le r√©gime matrimonial
                                      // Priorit√© 1: utiliser situation_matrimoniale directement (c'est le champ principal)
                                      let situationFamiliale = selectedClient.situation_matrimoniale || "";
                                      let regimeMatrimonial = "";
                                      
                                      // Extraire le r√©gime matrimonial de l'objet situation_familiale si c'est un objet
                                      if (selectedClient.situation_familiale) {
                                        if (typeof selectedClient.situation_familiale === 'string') {
                                          if (!situationFamiliale) situationFamiliale = selectedClient.situation_familiale;
                                        } else if (typeof selectedClient.situation_familiale === 'object') {
                                          const sitFam = selectedClient.situation_familiale as any;
                                          regimeMatrimonial = sitFam.regime_matrimonial || "";
                                          // Si pas de situation_matrimoniale, essayer de l'extraire de l'objet
                                          if (!situationFamiliale && sitFam.situation_familiale) {
                                            situationFamiliale = sitFam.situation_familiale;
                                          }
                                        }
                                      }
                                      
                                      console.log('üìã situationFamiliale extraite:', situationFamiliale);
                                      console.log('üìã regimeMatrimonial extrait:', regimeMatrimonial);
                                      
                                      newIndivisaires[idx] = {
                                        ...newIndivisaires[idx],
                                        clientId: value,
                                        isClient: true,
                                        nom: selectedClient.nom || "",
                                        prenom: selectedClient.prenom || "",
                                        adresse: selectedClient.adresse || "",
                                        dateNaissance: selectedClient.date_naissance || "",
                                        lieuNaissance: selectedClient.lieu_naissance || "",
                                        nationalite: selectedClient.nationalite || "",
                                        profession: selectedClient.profession || "",
                                        situationFamiliale: situationFamiliale,
                                        regimeMatrimonial: regimeMatrimonial,
                                        typeIdentite: selectedClient.type_identite || "",
                                        numeroIdentite: selectedClient.numero_identite || "",
                                        email: selectedClient.email || "",
                                        telephone: selectedClient.telephone || "",
                                      };
                                      
                                      // Charger automatiquement la carte d'identit√© depuis Supabase storage
                                      if (selectedClient.id_doc_path) {
                                        console.log('‚úÖ D√©but chargement document:', selectedClient.id_doc_path);
                                        try {
                                          const { data, error } = await supabase.storage
                                            .from('documents')
                                            .download(selectedClient.id_doc_path);
                                          
                                          if (data && !error) {
                                            console.log('‚úÖ Document t√©l√©charg√© avec succ√®s');
                                            const fileName = selectedClient.id_doc_path.split('/').pop() || 'identite.pdf';
                                            const file = new File([data], fileName, { type: data.type });
                                            console.log('üìÅ Fichier cr√©√©:', fileName, 'taille:', file.size);
                                            setIndivisairesIdentiteFiles(prev => {
                                              const newState = {
                                                ...prev,
                                                [indivisaire.id]: [file]
                                              };
                                              console.log('üìä Nouveau state identiteFiles:', newState);
                                              return newState;
                                            });
                                            setIndivisairesIdentiteUrls(prev => ({
                                              ...prev,
                                              [indivisaire.id]: [selectedClient.id_doc_path]
                                            }));
                                          } else {
                                            console.error('‚ùå Erreur t√©l√©chargement:', error);
                                          }
                                        } catch (error) {
                                          console.error('‚ùå Erreur chargement carte identit√©:', error);
                                        }
                                      } else {
                                        console.log('‚ö†Ô∏è Pas de id_doc_path, recherche dans client_documents pour client:', selectedClient.id);
                                        // Chercher dans client_documents si pas de id_doc_path
                                        try {
                                          const { data: docs, error: docsError } = await supabase
                                            .from('client_documents')
                                            .select('file_path, file_name, document_type')
                                            .eq('client_id', selectedClient.id)
                                            .eq('document_type', 'piece_identite')
                                            .order('uploaded_at', { ascending: false })
                                            .limit(1);
                                          
                                          if (docsError) {
                                            console.error('‚ùå Erreur recherche documents:', docsError);
                                          } else if (docs && docs.length > 0) {
                                            const idDoc = docs[0];
                                            console.log('üìÑ Document pi√®ce identit√© trouv√©:', idDoc.file_name);
                                            
                                            const { data, error } = await supabase.storage
                                              .from('documents')
                                              .download(idDoc.file_path);
                                            
                                            if (data && !error) {
                                              console.log('‚úÖ Document t√©l√©charg√© avec succ√®s depuis client_documents');
                                              const file = new File([data], idDoc.file_name, { type: data.type });
                                              setIndivisairesIdentiteFiles(prev => ({
                                                ...prev,
                                                [indivisaire.id]: [file]
                                              }));
                                              setIndivisairesIdentiteUrls(prev => ({
                                                ...prev,
                                                [indivisaire.id]: [idDoc.file_path]
                                              }));
                                            } else {
                                              console.error('‚ùå Erreur t√©l√©chargement depuis storage:', error);
                                            }
                                          } else {
                                            console.log('‚ÑπÔ∏è Aucune pi√®ce d\'identit√© trouv√©e dans client_documents');
                                          }
                                        } catch (error) {
                                          console.error('‚ùå Erreur recherche client_documents:', error);
                                        }
                                      }
                                    }
                                    setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                                  }}
                                >
                                  <SelectTrigger><SelectValue placeholder="Choisir un client..." /></SelectTrigger>
                                  <SelectContent>
                                    {clients.map((client) => (
                                      <SelectItem key={client.id} value={client.id}>
                                        {client.nom} {client.prenom}
                                      </SelectItem>
                                    ))}
                                  </SelectContent>
                                </Select>
                              </div>

                              {/* Affichage des infos du client */}
                              {indivisaire.clientId && (
                                <div className="md:col-span-2 p-3 bg-green-50 border border-green-200 rounded-lg">
                                  <p className="text-sm font-medium text-green-800">‚úì Informations charg√©es depuis la fiche client</p>
                                  <p className="text-sm text-green-700 mt-1">{indivisaire.nom} {indivisaire.prenom} - {indivisaire.adresse}</p>
                                </div>
                              )}
                            </>
                          ) : (
                            <>
                              {/* Saisie manuelle pour non-client */}
                              <div className="space-y-2">
                                <Label>Nom *</Label>
                                <Input
                                  value={indivisaire.nom}
                                  onChange={(e) => {
                                    const newIndivisaires = [...indivisionData.indivisaires];
                                    const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                    newIndivisaires[idx] = {...newIndivisaires[idx], nom: e.target.value};
                                    setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                                  }}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Pr√©nom *</Label>
                                <Input
                                  value={indivisaire.prenom}
                                  onChange={(e) => {
                                    const newIndivisaires = [...indivisionData.indivisaires];
                                    const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                    newIndivisaires[idx] = {...newIndivisaires[idx], prenom: e.target.value};
                                    setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                                  }}
                                />
                              </div>
                              <div className="space-y-2 md:col-span-2">
                                <Label>Adresse *</Label>
                                <Input
                                  value={indivisaire.adresse}
                                  onChange={(e) => {
                                    const newIndivisaires = [...indivisionData.indivisaires];
                                    const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                    newIndivisaires[idx] = {...newIndivisaires[idx], adresse: e.target.value};
                                    setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                                  }}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Date de naissance</Label>
                                <Input
                                  type="date"
                                  value={indivisaire.dateNaissance}
                                  onChange={(e) => {
                                    const newIndivisaires = [...indivisionData.indivisaires];
                                    const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                    newIndivisaires[idx] = {...newIndivisaires[idx], dateNaissance: e.target.value};
                                    setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                                  }}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Lieu de naissance</Label>
                                <Input
                                  value={indivisaire.lieuNaissance}
                                  onChange={(e) => {
                                    const newIndivisaires = [...indivisionData.indivisaires];
                                    const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                    newIndivisaires[idx] = {...newIndivisaires[idx], lieuNaissance: e.target.value};
                                    setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                                  }}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Nationalit√©</Label>
                                <Input
                                  value={indivisaire.nationalite}
                                  onChange={(e) => {
                                    const newIndivisaires = [...indivisionData.indivisaires];
                                    const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                    newIndivisaires[idx] = {...newIndivisaires[idx], nationalite: e.target.value};
                                    setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                                  }}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Profession</Label>
                                <Input
                                  value={indivisaire.profession}
                                  onChange={(e) => {
                                    const newIndivisaires = [...indivisionData.indivisaires];
                                    const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                    newIndivisaires[idx] = {...newIndivisaires[idx], profession: e.target.value};
                                    setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                                  }}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Email</Label>
                                <Input
                                  type="email"
                                  value={indivisaire.email}
                                  onChange={(e) => {
                                    const newIndivisaires = [...indivisionData.indivisaires];
                                    const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                    newIndivisaires[idx] = {...newIndivisaires[idx], email: e.target.value};
                                    setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                                  }}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>T√©l√©phone</Label>
                                <Input
                                  value={indivisaire.telephone}
                                  onChange={(e) => {
                                    const newIndivisaires = [...indivisionData.indivisaires];
                                    const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                    newIndivisaires[idx] = {...newIndivisaires[idx], telephone: e.target.value};
                                    setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                                  }}
                                />
                              </div>
                            </>
                          )}

                          {/* Situation familiale */}
                          <div className="space-y-2">
                            <Label>Situation familiale</Label>
                            <Input
                              value={indivisaire.situationFamiliale}
                              onChange={(e) => {
                                const newIndivisaires = [...indivisionData.indivisaires];
                                const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                newIndivisaires[idx] = {...newIndivisaires[idx], situationFamiliale: e.target.value};
                                setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                              }}
                              placeholder="Ex: C√©libataire, Mari√©, Divorc√©..."
                            />
                          </div>

                          {indivisaire.situationFamiliale && ['mari√©', 'marie', 'mari√©e', 'pacs√©', 'pacse', 'pacs'].some(term => indivisaire.situationFamiliale.toLowerCase().includes(term)) && (
                            <div className="space-y-2">
                              <Label>R√©gime matrimonial</Label>
                              <Input
                                value={indivisaire.regimeMatrimonial}
                                onChange={(e) => {
                                  const newIndivisaires = [...indivisionData.indivisaires];
                                  const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                  newIndivisaires[idx] = {...newIndivisaires[idx], regimeMatrimonial: e.target.value};
                                  setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                                }}
                                placeholder="Ex: Communaut√© l√©gale, S√©paration de biens..."
                              />
                            </div>
                          )}

                          {/* Quote-part */}
                          <div className="space-y-2">
                            <Label>Quote-part (%) *</Label>
                            <Input
                              type="number"
                              min="0"
                              max="100"
                              value={indivisaire.quotePart}
                              onChange={(e) => {
                                const newIndivisaires = [...indivisionData.indivisaires];
                                const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                newIndivisaires[idx] = {...newIndivisaires[idx], quotePart: e.target.value};
                                setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                              }}
                              placeholder="Ex: 50"
                            />
                          </div>
                          <div className="space-y-2">
                            <Label>Origine de la quote-part</Label>
                            <Select
                              value={indivisaire.origineQuotePart}
                              onValueChange={(value) => {
                                const newIndivisaires = [...indivisionData.indivisaires];
                                const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                newIndivisaires[idx] = {...newIndivisaires[idx], origineQuotePart: value};
                                setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="heritage">H√©ritage</SelectItem>
                                <SelectItem value="achat">Achat</SelectItem>
                                <SelectItem value="donation">Donation</SelectItem>
                                <SelectItem value="succession">Succession</SelectItem>
                                <SelectItem value="investissement">Investissement</SelectItem>
                                <SelectItem value="autre">Autre</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>
                          {indivisaire.origineQuotePart === "autre" && (
                            <div className="space-y-2">
                              <Label>Pr√©ciser l'origine</Label>
                              <Input
                                value={indivisaire.origineQuotePartAutre || ""}
                                onChange={(e) => {
                                  const newIndivisaires = [...indivisionData.indivisaires];
                                  const idx = newIndivisaires.findIndex(i => i.id === indivisaire.id);
                                  newIndivisaires[idx] = {...newIndivisaires[idx], origineQuotePartAutre: e.target.value};
                                  setIndivisionData({...indivisionData, indivisaires: newIndivisaires});
                                }}
                                placeholder="Ex: Partage amiable..."
                              />
                            </div>
                          )}

                          {/* Upload pi√®ces jointes pour cet indivisaire */}
                          {!indivisaire.isClient && (
                            <div className="md:col-span-2">
                              <MultiFileUpload
                                label="üìé Pi√®ce d'identit√©"
                                files={indivisairesIdentiteFiles[indivisaire.id] || []}
                                onFilesChange={(files) => setIndivisairesIdentiteFiles(prev => ({...prev, [indivisaire.id]: files}))}
                                accept="application/pdf,image/*"
                              />
                            </div>
                          )}

                          {/* Affichage de la carte d'identit√© charg√©e depuis le client */}
                          {indivisaire.isClient && indivisairesIdentiteFiles[indivisaire.id]?.length > 0 && (
                            <div className="space-y-2 md:col-span-2">
                              <div className="flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg">
                                <svg className="w-5 h-5 text-green-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                                <div className="flex-1">
                                  <p className="text-sm font-medium text-green-800">‚úì Pi√®ce d'identit√© charg√©e depuis la fiche client</p>
                                  <p className="text-xs text-green-700 mt-1">
                                    {indivisairesIdentiteFiles[indivisaire.id].map((file, idx) => file.name).join(', ')}
                                  </p>
                                </div>
                              </div>
                            </div>
                          )}

                          {/* Upload justificatif de domicile */}
                          <div className="md:col-span-2">
                            <MultiFileUpload
                              label="üìé Justificatif de domicile"
                              files={indivisairesDomicileFiles[indivisaire.id] || []}
                              onFilesChange={(files) => setIndivisairesDomicileFiles(prev => ({...prev, [indivisaire.id]: files}))}
                              accept="application/pdf,image/*"
                            />
                          </div>

                          {/* Upload contrat de mariage si mari√© */}
                          {indivisaire.statutMatrimonial === "marie" && (
                            <div className="md:col-span-2">
                              <MultiFileUpload
                                label="üìé Contrat de mariage (si applicable)"
                                files={indivisairesContratMariageFiles[indivisaire.id] || []}
                                onFilesChange={(files) => setIndivisairesContratMariageFiles(prev => ({...prev, [indivisaire.id]: files}))}
                                accept="application/pdf"
                              />
                            </div>
                          )}

                          {/* Upload livret de famille si succession */}
                          {indivisionData.origine === "succession" && (
                            <div className="md:col-span-2">
                              <MultiFileUpload
                                label="üìé Livret de famille (si succession)"
                                files={indivisairesLivretFamilleFiles[indivisaire.id] || []}
                                onFilesChange={(files) => setIndivisairesLivretFamilleFiles(prev => ({...prev, [indivisaire.id]: files}))}
                                accept="application/pdf,image/*"
                              />
                            </div>
                          )}
                        </div>
                      </div>
                    ))}
                  </div>

                  {/* 3. Description du bien */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üè† Description du bien indivis</h3>
                    
                    {indivisionData.description.typeBien === "immobilier" && (
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2 md:col-span-2">
                          <Label>Adresse compl√®te *</Label>
                          <Input
                            value={indivisionData.description.immobilier.adresse}
                            onChange={(e) => setIndivisionData({
                              ...indivisionData,
                              description: {
                                ...indivisionData.description,
                                immobilier: {...indivisionData.description.immobilier, adresse: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>Nature du bien *</Label>
                          <Select
                            value={indivisionData.description.immobilier.nature}
                            onValueChange={(value) => setIndivisionData({
                              ...indivisionData,
                              description: {
                                ...indivisionData.description,
                                immobilier: {...indivisionData.description.immobilier, nature: value}
                              }
                            })}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="maison">Maison</SelectItem>
                              <SelectItem value="appartement">Appartement</SelectItem>
                              <SelectItem value="terrain">Terrain</SelectItem>
                              <SelectItem value="immeuble">Immeuble</SelectItem>
                              <SelectItem value="local_commercial">Local commercial</SelectItem>
                              <SelectItem value="autre">Autre</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="space-y-2">
                          <Label>Surface (m¬≤)</Label>
                          <Input
                            type="number"
                            value={indivisionData.description.immobilier.surface}
                            onChange={(e) => setIndivisionData({
                              ...indivisionData,
                              description: {
                                ...indivisionData.description,
                                immobilier: {...indivisionData.description.immobilier, surface: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div className="space-y-2 md:col-span-2">
                          <Label>Description d√©taill√©e</Label>
                          <Textarea
                            rows={3}
                            value={indivisionData.description.immobilier.description}
                            onChange={(e) => setIndivisionData({
                              ...indivisionData,
                              description: {
                                ...indivisionData.description,
                                immobilier: {...indivisionData.description.immobilier, description: e.target.value}
                              }
                            })}
                            placeholder="Description du bien..."
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>√âtat locatif</Label>
                          <Select
                            value={indivisionData.description.immobilier.etatLocatif}
                            onValueChange={(value) => setIndivisionData({
                              ...indivisionData,
                              description: {
                                ...indivisionData.description,
                                immobilier: {...indivisionData.description.immobilier, etatLocatif: value}
                              }
                            })}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="libre">Libre</SelectItem>
                              <SelectItem value="loue">Lou√©</SelectItem>
                              <SelectItem value="occupe">Occup√© par un indivisaire</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        {indivisionData.description.immobilier.etatLocatif === "loue" && (
                          <div className="space-y-2">
                            <Label>Loyer mensuel (‚Ç¨)</Label>
                            <Input
                              type="number"
                              value={indivisionData.description.immobilier.loyer}
                              onChange={(e) => setIndivisionData({
                                ...indivisionData,
                                description: {
                                  ...indivisionData.description,
                                  immobilier: {...indivisionData.description.immobilier, loyer: e.target.value}
                                }
                              })}
                            />
                          </div>
                        )}
                        <div className="space-y-2">
                          <Label>Valeur v√©nale estim√©e (‚Ç¨)</Label>
                          <Input
                            type="number"
                            value={indivisionData.description.immobilier.valeurVenale}
                            onChange={(e) => setIndivisionData({
                              ...indivisionData,
                              description: {
                                ...indivisionData.description,
                                immobilier: {...indivisionData.description.immobilier, valeurVenale: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>R√©f√©rences cadastrales</Label>
                          <Input
                            value={indivisionData.description.immobilier.cadastre}
                            onChange={(e) => setIndivisionData({
                              ...indivisionData,
                              description: {
                                ...indivisionData.description,
                                immobilier: {...indivisionData.description.immobilier, cadastre: e.target.value}
                              }
                            })}
                            placeholder="Ex: Section AB n¬∞ 123"
                          />
                        </div>

                        {/* Uploads pour bien immobilier */}
                        <MultiFileUpload
                          label="üìé Titre de propri√©t√© *"
                          files={indivisionTitreProprietFiles}
                          onFilesChange={setIndivisionTitreProprietFiles}
                          accept="application/pdf"
                        />

                        <MultiFileUpload
                          label="üìé √âvaluation du bien"
                          files={indivisionEvaluationFiles}
                          onFilesChange={setIndivisionEvaluationFiles}
                          accept="application/pdf"
                        />

                        <MultiFileUpload
                          label="üìé Plan cadastral"
                          files={indivisionCadastreFiles}
                          onFilesChange={setIndivisionCadastreFiles}
                          accept="application/pdf,image/*"
                        />

                        <MultiFileUpload
                          label="üìé Diagnostics techniques"
                          files={indivisionDiagnosticsFiles}
                          onFilesChange={setIndivisionDiagnosticsFiles}
                          accept="application/pdf"
                        />

                        {indivisionData.description.immobilier.etatLocatif === "loue" && (
                          <MultiFileUpload
                            label="üìé Bail en cours"
                            files={indivisionBailFiles}
                            onFilesChange={setIndivisionBailFiles}
                            accept="application/pdf"
                          />
                        )}
                      </div>
                    )}

                    {indivisionData.description.typeBien === "mobilier" && (
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2 md:col-span-2">
                          <Label>Description des biens mobiliers *</Label>
                          <Textarea
                            rows={4}
                            value={indivisionData.description.mobilier.description}
                            onChange={(e) => setIndivisionData({
                              ...indivisionData,
                              description: {
                                ...indivisionData.description,
                                mobilier: {...indivisionData.description.mobilier, description: e.target.value}
                              }
                            })}
                            placeholder="Description d√©taill√©e des biens mobiliers..."
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>Valeur estim√©e (‚Ç¨)</Label>
                          <Input
                            type="number"
                            value={indivisionData.description.mobilier.valeurEstimee}
                            onChange={(e) => setIndivisionData({
                              ...indivisionData,
                              description: {
                                ...indivisionData.description,
                                mobilier: {...indivisionData.description.mobilier, valeurEstimee: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>Num√©ros de s√©rie / identifiants</Label>
                          <Input
                            value={indivisionData.description.mobilier.numerosIdentification}
                            onChange={(e) => setIndivisionData({
                              ...indivisionData,
                              description: {
                                ...indivisionData.description,
                                mobilier: {...indivisionData.description.mobilier, numerosIdentification: e.target.value}
                              }
                            })}
                            placeholder="Si applicable"
                          />
                        </div>
                      </div>
                    )}
                  </div>

                  {/* 4. Dur√©e de la convention */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">‚è±Ô∏è Dur√©e de la convention</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label>Type de dur√©e *</Label>
                        <RadioGroup
                          value={indivisionData.duree.type}
                          onValueChange={(value) => setIndivisionData({
                            ...indivisionData,
                            duree: {...indivisionData.duree, type: value}
                          })}
                        >
                          <div className="flex gap-4">
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="indeterminee" id="duree_indeterminee" />
                              <Label htmlFor="duree_indeterminee" className="cursor-pointer">Ind√©termin√©e</Label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="determinee" id="duree_determinee" />
                              <Label htmlFor="duree_determinee" className="cursor-pointer">D√©termin√©e (max 5 ans)</Label>
                            </div>
                          </div>
                        </RadioGroup>
                      </div>

                      {indivisionData.duree.type === "determinee" && (
                        <div className="space-y-2">
                          <Label>Dur√©e (en ann√©es) *</Label>
                          <Input
                            type="number"
                            min="1"
                            max="5"
                            value={indivisionData.duree.annees}
                            onChange={(e) => setIndivisionData({
                              ...indivisionData,
                              duree: {...indivisionData.duree, annees: e.target.value}
                            })}
                          />
                        </div>
                      )}

                      <div className="space-y-2 md:col-span-2">
                        <Label>Conditions de renouvellement</Label>
                        <Textarea
                          rows={2}
                          value={indivisionData.duree.conditionsRenouvellement}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            duree: {...indivisionData.duree, conditionsRenouvellement: e.target.value}
                          })}
                          placeholder="Pr√©ciser les conditions..."
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Conditions de sortie anticip√©e</Label>
                        <Textarea
                          rows={2}
                          value={indivisionData.duree.conditionsSortie}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            duree: {...indivisionData.duree, conditionsSortie: e.target.value}
                          })}
                          placeholder="Pr√©ciser les conditions..."
                        />
                      </div>
                    </div>
                  </div>

                  {/* 5. Gestion de l'indivision */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">‚öôÔ∏è Gestion de l'indivision</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label>G√©rant d√©sign√©</Label>
                        <Input
                          value={indivisionData.gestion.gerant}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            gestion: {...indivisionData.gestion, gerant: e.target.value}
                          })}
                          placeholder="Nom du g√©rant (peut √™tre un indivisaire ou une personne externe)"
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Pouvoirs du g√©rant</Label>
                        <div className="space-y-2">
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="pouvoir_gestion"
                              checked={indivisionData.gestion.pouvoirs.gestion_courante}
                              onChange={(e) => setIndivisionData({
                                ...indivisionData,
                                gestion: {
                                  ...indivisionData.gestion,
                                  pouvoirs: {...indivisionData.gestion.pouvoirs, gestion_courante: e.target.checked}
                                }
                              })}
                              className="rounded border-gray-300"
                            />
                            <Label htmlFor="pouvoir_gestion" className="cursor-pointer">Gestion courante</Label>
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="pouvoir_travaux"
                              checked={indivisionData.gestion.pouvoirs.travaux}
                              onChange={(e) => setIndivisionData({
                                ...indivisionData,
                                gestion: {
                                  ...indivisionData.gestion,
                                  pouvoirs: {...indivisionData.gestion.pouvoirs, travaux: e.target.checked}
                                }
                              })}
                              className="rounded border-gray-300"
                            />
                            <Label htmlFor="pouvoir_travaux" className="cursor-pointer">Autorisation des travaux</Label>
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="pouvoir_representation"
                              checked={indivisionData.gestion.pouvoirs.representation}
                              onChange={(e) => setIndivisionData({
                                ...indivisionData,
                                gestion: {
                                  ...indivisionData.gestion,
                                  pouvoirs: {...indivisionData.gestion.pouvoirs, representation: e.target.checked}
                                }
                              })}
                              className="rounded border-gray-300"
                            />
                            <Label htmlFor="pouvoir_representation" className="cursor-pointer">Repr√©sentation de l'indivision</Label>
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="pouvoir_signature"
                              checked={indivisionData.gestion.pouvoirs.signature_actes}
                              onChange={(e) => setIndivisionData({
                                ...indivisionData,
                                gestion: {
                                  ...indivisionData.gestion,
                                  pouvoirs: {...indivisionData.gestion.pouvoirs, signature_actes: e.target.checked}
                                }
                              })}
                              className="rounded border-gray-300"
                            />
                            <Label htmlFor="pouvoir_signature" className="cursor-pointer">Signature d'actes au nom de l'indivision</Label>
                          </div>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <Label>Type de d√©cisions *</Label>
                        <Select
                          value={indivisionData.gestion.decisions}
                          onValueChange={(value) => setIndivisionData({
                            ...indivisionData,
                            gestion: {...indivisionData.gestion, decisions: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="unanimite">Unanimit√©</SelectItem>
                            <SelectItem value="majorite_2_3">Majorit√© des 2/3</SelectItem>
                            <SelectItem value="majorite_simple">Majorit√© simple</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="space-y-2">
                        <Label>R√©partition des charges</Label>
                        <Input
                          value={indivisionData.gestion.charges}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            gestion: {...indivisionData.gestion, charges: e.target.value}
                          })}
                          placeholder="Ex: Proportionnellement aux quote-parts"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>R√©partition des d√©penses exceptionnelles</Label>
                        <Input
                          value={indivisionData.gestion.repartitionDepensesExceptionnelles}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            gestion: {...indivisionData.gestion, repartitionDepensesExceptionnelles: e.target.value}
                          })}
                          placeholder="Ex: Gros travaux, sinistres, proc√©dures..."
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>R√©partition des revenus tir√©s du bien</Label>
                        <Input
                          value={indivisionData.gestion.repartitionRevenus}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            gestion: {...indivisionData.gestion, repartitionRevenus: e.target.value}
                          })}
                          placeholder="Ex: Loyers, indemnit√©s d'occupation, revenus divers..."
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Compte bancaire d√©di√©</Label>
                        <Input
                          value={indivisionData.gestion.compteBancaire}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            gestion: {...indivisionData.gestion, compteBancaire: e.target.value}
                          })}
                          placeholder="Coordonn√©es du compte (IBAN, nom de la banque...)"
                        />
                      </div>

                      {/* Upload mandat du g√©rant */}
                      {indivisionData.gestion.gerant && (
                        <div className="md:col-span-2">
                          <MultiFileUpload
                            label="üìé Mandat du g√©rant"
                            files={indivisionMandatGerantFiles}
                            onFilesChange={setIndivisionMandatGerantFiles}
                            accept="application/pdf"
                          />
                        </div>
                      )}
                    </div>
                  </div>

                  {/* 6. Utilisation du bien */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üîë Utilisation du bien</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label>Utilisation par les indivisaires</Label>
                        <RadioGroup
                          value={indivisionData.utilisation.utilisationParIndivisaires}
                          onValueChange={(value) => setIndivisionData({
                            ...indivisionData,
                            utilisation: {...indivisionData.utilisation, utilisationParIndivisaires: value}
                          })}
                        >
                          <div className="flex gap-4">
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="oui" id="util_oui" />
                              <Label htmlFor="util_oui" className="cursor-pointer">Autoris√©e</Label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="non" id="util_non" />
                              <Label htmlFor="util_non" className="cursor-pointer">Non autoris√©e</Label>
                            </div>
                          </div>
                        </RadioGroup>
                      </div>

                      {indivisionData.utilisation.utilisationParIndivisaires === "oui" && (
                        <>
                          <div className="space-y-2 md:col-span-2">
                            <Label>Conditions d'utilisation</Label>
                            <Textarea
                              rows={2}
                              value={indivisionData.utilisation.conditionsUtilisation}
                              onChange={(e) => setIndivisionData({
                                ...indivisionData,
                                utilisation: {...indivisionData.utilisation, conditionsUtilisation: e.target.value}
                              })}
                              placeholder="Pr√©ciser les conditions..."
                            />
                          </div>

                          <div className="space-y-2 md:col-span-2">
                            <Label>Indemnit√© d'occupation (clause centrale)</Label>
                            <RadioGroup
                              value={indivisionData.utilisation.indemniteOccupation}
                              onValueChange={(value) => setIndivisionData({
                                ...indivisionData,
                                utilisation: {...indivisionData.utilisation, indemniteOccupation: value}
                              })}
                            >
                              <div className="flex gap-4">
                                <div className="flex items-center space-x-2">
                                  <RadioGroupItem value="oui" id="indem_oui" />
                                  <Label htmlFor="indem_oui" className="cursor-pointer">Oui, indemnit√© obligatoire</Label>
                                </div>
                                <div className="flex items-center space-x-2">
                                  <RadioGroupItem value="non" id="indem_non" />
                                  <Label htmlFor="indem_non" className="cursor-pointer">Non, aucune indemnit√©</Label>
                                </div>
                                <div className="flex items-center space-x-2">
                                  <RadioGroupItem value="conditions" id="indem_cond" />
                                  <Label htmlFor="indem_cond" className="cursor-pointer">Selon conditions</Label>
                                </div>
                              </div>
                            </RadioGroup>
                          </div>

                          {(indivisionData.utilisation.indemniteOccupation === "oui" || indivisionData.utilisation.indemniteOccupation === "conditions") && (
                            <>
                              <div className="space-y-2">
                                <Label>Montant de l'indemnit√© d'occupation (‚Ç¨)</Label>
                                <Input
                                  type="number"
                                  value={indivisionData.utilisation.indemniteOccupationMontant}
                                  onChange={(e) => setIndivisionData({
                                    ...indivisionData,
                                    utilisation: {...indivisionData.utilisation, indemniteOccupationMontant: e.target.value}
                                  })}
                                  placeholder="Montant mensuel ou annuel"
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Fr√©quence de l'indemnit√©</Label>
                                <Select
                                  value={indivisionData.utilisation.indemniteFrequence}
                                  onValueChange={(value) => setIndivisionData({
                                    ...indivisionData,
                                    utilisation: {...indivisionData.utilisation, indemniteFrequence: value}
                                  })}
                                >
                                  <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                  <SelectContent>
                                    <SelectItem value="mensuelle">Mensuelle</SelectItem>
                                    <SelectItem value="trimestrielle">Trimestrielle</SelectItem>
                                    <SelectItem value="annuelle">Annuelle</SelectItem>
                                  </SelectContent>
                                </Select>
                              </div>
                            </>
                          )}

                          {indivisionData.utilisation.indemniteOccupation === "conditions" && (
                            <div className="space-y-2 md:col-span-2">
                              <Label>Conditions pour l'indemnit√© d'occupation</Label>
                              <Textarea
                                rows={2}
                                value={indivisionData.utilisation.indemniteOccupationConditions}
                                onChange={(e) => setIndivisionData({
                                  ...indivisionData,
                                  utilisation: {...indivisionData.utilisation, indemniteOccupationConditions: e.target.value}
                                })}
                                placeholder="Ex: Indemnit√© due uniquement si occupation exclusive pendant plus de 6 mois..."
                              />
                            </div>
                          )}
                        </>
                      )}

                      <div className="space-y-2 md:col-span-2">
                        <Label>Location autoris√©e</Label>
                        <RadioGroup
                          value={indivisionData.utilisation.locationAutorisee}
                          onValueChange={(value) => setIndivisionData({
                            ...indivisionData,
                            utilisation: {...indivisionData.utilisation, locationAutorisee: value}
                          })}
                        >
                          <div className="flex gap-4">
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="oui" id="location_oui" />
                              <Label htmlFor="location_oui" className="cursor-pointer">Oui</Label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="non" id="location_non" />
                              <Label htmlFor="location_non" className="cursor-pointer">Non</Label>
                            </div>
                          </div>
                        </RadioGroup>
                      </div>

                      {indivisionData.utilisation.locationAutorisee === "oui" && (
                        <>
                          <div className="space-y-2">
                            <Label>Mandataire pour la location</Label>
                            <Input
                              value={indivisionData.utilisation.mandataireLocation}
                              onChange={(e) => setIndivisionData({
                                ...indivisionData,
                                utilisation: {...indivisionData.utilisation, mandataireLocation: e.target.value}
                              })}
                              placeholder="Nom du mandataire"
                            />
                          </div>
                          <div className="space-y-2">
                            <Label>R√©partition des loyers</Label>
                            <Input
                              value={indivisionData.utilisation.repartitionLoyers}
                              onChange={(e) => setIndivisionData({
                                ...indivisionData,
                                utilisation: {...indivisionData.utilisation, repartitionLoyers: e.target.value}
                              })}
                              placeholder="Ex: Proportionnellement aux quote-parts"
                            />
                          </div>
                        </>
                      )}
                    </div>
                  </div>

                  {/* 7. Travaux et am√©liorations */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üî® Travaux et am√©liorations</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label>Types de travaux autoris√©s</Label>
                        <Textarea
                          rows={2}
                          value={indivisionData.travaux.typesAutorises}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            travaux: {...indivisionData.travaux, typesAutorises: e.target.value}
                          })}
                          placeholder="Pr√©ciser les types de travaux..."
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>D√©cision requise *</Label>
                        <Select
                          value={indivisionData.travaux.decisionRequise}
                          onValueChange={(value) => setIndivisionData({
                            ...indivisionData,
                            travaux: {...indivisionData.travaux, decisionRequise: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="unanimite">Unanimit√©</SelectItem>
                            <SelectItem value="majorite_2_3">Majorit√© des 2/3</SelectItem>
                            <SelectItem value="majorite_simple">Majorit√© simple</SelectItem>
                            <SelectItem value="gerant">D√©cision du g√©rant</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="space-y-2">
                        <Label>R√©partition des co√ªts</Label>
                        <Input
                          value={indivisionData.travaux.repartitionCouts}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            travaux: {...indivisionData.travaux, repartitionCouts: e.target.value}
                          })}
                          placeholder="Ex: Proportionnellement aux quote-parts"
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Travaux urgents (proc√©dure)</Label>
                        <Textarea
                          rows={2}
                          value={indivisionData.travaux.travauxUrgents}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            travaux: {...indivisionData.travaux, travauxUrgents: e.target.value}
                          })}
                          placeholder="Proc√©dure en cas de travaux urgents..."
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Exigences de documentation</Label>
                        <Textarea
                          rows={2}
                          value={indivisionData.travaux.documentation}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            travaux: {...indivisionData.travaux, documentation: e.target.value}
                          })}
                          placeholder="Pr√©ciser les documents requis (devis, factures, autorisations...)..."
                        />
                      </div>
                    </div>
                  </div>

                  {/* 8. Sortie d'un indivisaire */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üö™ Sortie d'un indivisaire</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label>Modalit√©s de vente de la part *</Label>
                        <RadioGroup
                          value={indivisionData.sortie.venteLibre}
                          onValueChange={(value) => setIndivisionData({
                            ...indivisionData,
                            sortie: {...indivisionData.sortie, venteLibre: value}
                          })}
                        >
                          <div className="flex flex-col gap-2">
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="libre" id="vente_libre" />
                              <Label htmlFor="vente_libre" className="cursor-pointer">Vente libre</Label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="droit_preemption" id="vente_preemption" />
                              <Label htmlFor="vente_preemption" className="cursor-pointer">Droit de pr√©emption des autres indivisaires</Label>
                            </div>
                          </div>
                        </RadioGroup>
                      </div>

                      <div className="space-y-2">
                        <Label>√âvaluation de la part *</Label>
                        <Select
                          value={indivisionData.sortie.evaluationPart}
                          onValueChange={(value) => setIndivisionData({
                            ...indivisionData,
                            sortie: {...indivisionData.sortie, evaluationPart: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="gerant">Par le g√©rant</SelectItem>
                            <SelectItem value="accord_indivisaires">Accord des indivisaires</SelectItem>
                            <SelectItem value="expert">Expert ind√©pendant</SelectItem>
                            <SelectItem value="juge">D√©cision du juge</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="space-y-2">
                        <Label>D√©lai de rachat (jours)</Label>
                        <Input
                          type="number"
                          value={indivisionData.sortie.delaiRachat}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            sortie: {...indivisionData.sortie, delaiRachat: e.target.value}
                          })}
                          placeholder="Ex: 60"
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Modalit√©s de paiement</Label>
                        <Textarea
                          rows={2}
                          value={indivisionData.sortie.modalitesPaiement}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            sortie: {...indivisionData.sortie, modalitesPaiement: e.target.value}
                          })}
                          placeholder="Pr√©ciser les conditions de paiement..."
                        />
                      </div>
                    </div>
                  </div>

                  {/* 9. Vente du bien */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üí∞ Vente du bien</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label>Conditions de mise en vente</Label>
                        <Textarea
                          rows={2}
                          value={indivisionData.vente.conditionsMiseEnVente}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            vente: {...indivisionData.vente, conditionsMiseEnVente: e.target.value}
                          })}
                          placeholder="Pr√©ciser les conditions..."
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>D√©cision requise *</Label>
                        <Select
                          value={indivisionData.vente.decisionRequise}
                          onValueChange={(value) => setIndivisionData({
                            ...indivisionData,
                            vente: {...indivisionData.vente, decisionRequise: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="unanimite">Unanimit√©</SelectItem>
                            <SelectItem value="majorite_2_3">Majorit√© des 2/3</SelectItem>
                            <SelectItem value="majorite_simple">Majorit√© simple</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="space-y-2">
                        <Label>Mandataire pour la vente</Label>
                        <Input
                          value={indivisionData.vente.mandataire}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            vente: {...indivisionData.vente, mandataire: e.target.value}
                          })}
                          placeholder="Nom du mandataire"
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>R√©partition du prix de vente</Label>
                        <Input
                          value={indivisionData.vente.repartitionPrix}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            vente: {...indivisionData.vente, repartitionPrix: e.target.value}
                          })}
                          placeholder="Ex: Proportionnellement aux quote-parts"
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Gestion des plus-values</Label>
                        <Textarea
                          rows={2}
                          value={indivisionData.vente.gestionPlusValues}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            vente: {...indivisionData.vente, gestionPlusValues: e.target.value}
                          })}
                          placeholder="Pr√©ciser la gestion fiscale et la r√©partition..."
                        />
                      </div>
                    </div>
                  </div>

                  {/* 10. Comptabilit√© */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üìä Comptabilit√©</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label>Tenue d'un registre des d√©penses</Label>
                        <RadioGroup
                          value={indivisionData.comptabilite.registreDepenses}
                          onValueChange={(value) => setIndivisionData({
                            ...indivisionData,
                            comptabilite: {...indivisionData.comptabilite, registreDepenses: value}
                          })}
                        >
                          <div className="flex gap-4">
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="oui" id="registre_oui" />
                              <Label htmlFor="registre_oui" className="cursor-pointer">Oui</Label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="non" id="registre_non" />
                              <Label htmlFor="registre_non" className="cursor-pointer">Non</Label>
                            </div>
                          </div>
                        </RadioGroup>
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Archivage des factures et justificatifs</Label>
                        <Textarea
                          rows={2}
                          value={indivisionData.comptabilite.archivageFactures}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            comptabilite: {...indivisionData.comptabilite, archivageFactures: e.target.value}
                          })}
                          placeholder="Modalit√©s d'archivage..."
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Modalit√©s de remboursement des avances</Label>
                        <Textarea
                          rows={2}
                          value={indivisionData.comptabilite.remboursementAvances}
                          onChange={(e) => setIndivisionData({
                            ...indivisionData,
                            comptabilite: {...indivisionData.comptabilite, remboursementAvances: e.target.value}
                          })}
                          placeholder="Pr√©ciser les conditions..."
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Rapport annuel de gestion</Label>
                        <RadioGroup
                          value={indivisionData.comptabilite.rapportAnnuel}
                          onValueChange={(value) => setIndivisionData({
                            ...indivisionData,
                            comptabilite: {...indivisionData.comptabilite, rapportAnnuel: value}
                          })}
                        >
                          <div className="flex gap-4">
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="oui" id="rapport_oui" />
                              <Label htmlFor="rapport_oui" className="cursor-pointer">Oui</Label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="non" id="rapport_non" />
                              <Label htmlFor="rapport_non" className="cursor-pointer">Non</Label>
                            </div>
                          </div>
                        </RadioGroup>
                      </div>
                    </div>
                  </div>

                  {/* 11. Litiges */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">‚öñÔ∏è R√®glement des litiges</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label>Modes de r√©solution des litiges</Label>
                        <div className="space-y-2">
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="litige_mediation"
                              checked={indivisionData.litiges.modesResolution.mediation}
                              onChange={(e) => setIndivisionData({
                                ...indivisionData,
                                litiges: {
                                  ...indivisionData.litiges,
                                  modesResolution: {...indivisionData.litiges.modesResolution, mediation: e.target.checked}
                                }
                              })}
                              className="rounded border-gray-300"
                            />
                            <Label htmlFor="litige_mediation" className="cursor-pointer">M√©diation</Label>
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="litige_arbitrage"
                              checked={indivisionData.litiges.modesResolution.arbitrage}
                              onChange={(e) => setIndivisionData({
                                ...indivisionData,
                                litiges: {
                                  ...indivisionData.litiges,
                                  modesResolution: {...indivisionData.litiges.modesResolution, arbitrage: e.target.checked}
                                }
                              })}
                              className="rounded border-gray-300"
                            />
                            <Label htmlFor="litige_arbitrage" className="cursor-pointer">Arbitrage</Label>
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="litige_tribunal"
                              checked={indivisionData.litiges.modesResolution.tribunal}
                              onChange={(e) => setIndivisionData({
                                ...indivisionData,
                                litiges: {
                                  ...indivisionData.litiges,
                                  modesResolution: {...indivisionData.litiges.modesResolution, tribunal: e.target.checked}
                                }
                              })}
                              className="rounded border-gray-300"
                            />
                            <Label htmlFor="litige_tribunal" className="cursor-pointer">Tribunal comp√©tent</Label>
                          </div>
                        </div>
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Clause de solidarit√© pour les dettes</Label>
                        <RadioGroup
                          value={indivisionData.litiges.solidariteDettes}
                          onValueChange={(value) => setIndivisionData({
                            ...indivisionData,
                            litiges: {...indivisionData.litiges, solidariteDettes: value}
                          })}
                        >
                          <div className="flex gap-4">
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="oui" id="solidarite_oui" />
                              <Label htmlFor="solidarite_oui" className="cursor-pointer">Oui (indivisaires solidaires)</Label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="non" id="solidarite_non" />
                              <Label htmlFor="solidarite_non" className="cursor-pointer">Non (chacun √† hauteur de sa quote-part)</Label>
                            </div>
                          </div>
                        </RadioGroup>
                      </div>
                    </div>
                  </div>

                  {/* 12. Assurance du bien indivis */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üõ°Ô∏è Assurance du bien indivis</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label>Assurance obligatoire</Label>
                        <RadioGroup
                          value={indivisionData.assurance.assuranceObligatoire}
                          onValueChange={(value) => setIndivisionData({
                            ...indivisionData,
                            assurance: {...indivisionData.assurance, assuranceObligatoire: value}
                          })}
                        >
                          <div className="flex gap-4">
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="oui" id="assur_oui" />
                              <Label htmlFor="assur_oui" className="cursor-pointer">Oui</Label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="non" id="assur_non" />
                              <Label htmlFor="assur_non" className="cursor-pointer">Non</Label>
                            </div>
                          </div>
                        </RadioGroup>
                      </div>

                      {indivisionData.assurance.assuranceObligatoire === "oui" && (
                        <>
                          <div className="space-y-2">
                            <Label>Nom de l'assureur</Label>
                            <Input
                              value={indivisionData.assurance.nomAssureur}
                              onChange={(e) => setIndivisionData({
                                ...indivisionData,
                                assurance: {...indivisionData.assurance, nomAssureur: e.target.value}
                              })}
                              placeholder="Ex: AXA, MAIF, Allianz..."
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Num√©ro de police d'assurance</Label>
                            <Input
                              value={indivisionData.assurance.numeroPolice}
                              onChange={(e) => setIndivisionData({
                                ...indivisionData,
                                assurance: {...indivisionData.assurance, numeroPolice: e.target.value}
                              })}
                              placeholder="Num√©ro de contrat"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>R√©partition de la prime d'assurance</Label>
                            <Input
                              value={indivisionData.assurance.repartitionPrime}
                              onChange={(e) => setIndivisionData({
                                ...indivisionData,
                                assurance: {...indivisionData.assurance, repartitionPrime: e.target.value}
                              })}
                              placeholder="Ex: Proportionnellement aux quote-parts"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Date d'√©ch√©ance</Label>
                            <Input
                              type="date"
                              value={indivisionData.assurance.dateEcheance}
                              onChange={(e) => setIndivisionData({
                                ...indivisionData,
                                assurance: {...indivisionData.assurance, dateEcheance: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2 md:col-span-2">
                            <Label>üìé Attestation d'assurance</Label>
                            <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-4 hover:border-muted-foreground/50 transition-colors">
                              <input
                                type="file"
                                accept="application/pdf"
                                multiple
                                className="hidden"
                                id="indivision_assurance_upload"
                                onChange={(e) => {
                                  const files = Array.from(e.target.files || []);
                                  setIndivisionAssuranceFiles(prev => [...prev, ...files]);
                                }}
                              />
                              <label htmlFor="indivision_assurance_upload" className="cursor-pointer">
                                <div className="flex items-center gap-2 text-sm text-muted-foreground">
                                  <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                                  </svg>
                                  <div>
                                    <div className="font-medium text-foreground">Cliquez pour joindre l'attestation d'assurance</div>
                                    <div className="text-xs">PDF uniquement</div>
                                  </div>
                                </div>
                              </label>
                              {indivisionAssuranceFiles.length > 0 && (
                                <div className="mt-3 space-y-2">
                                  {indivisionAssuranceFiles.map((file, idx) => (
                                    <div key={idx} className="flex items-center justify-between p-2 bg-muted rounded">
                                      <span className="text-sm">{file.name}</span>
                                      <button
                                        type="button"
                                        onClick={() => setIndivisionAssuranceFiles(prev => prev.filter((_, i) => i !== idx))}
                                        className="text-red-600 hover:text-red-800 text-sm"
                                      >
                                        Supprimer
                                      </button>
                                    </div>
                                  ))}
                                </div>
                              )}
                            </div>
                          </div>
                        </>
                      )}
                    </div>
                  </div>

                  {/* 13. Procurations et documents compl√©mentaires */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üìé Procurations et documents compl√©mentaires</h3>
                    <div className="grid grid-cols-1 gap-4">
                      <div className="space-y-2">
                        <Label>Procurations (si applicable)</Label>
                        <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-4 hover:border-muted-foreground/50 transition-colors">
                          <input
                            type="file"
                            accept="application/pdf"
                            multiple
                            className="hidden"
                            id="procurations_upload"
                            onChange={(e) => {
                              const files = Array.from(e.target.files || []);
                              if (files.length > 0) {
                                setIndivisionProcurationFiles(files);
                                toast.success(`${files.length} fichier(s) ajout√©(s)`);
                              }
                              e.target.value = '';
                            }}
                          />
                          <label htmlFor="procurations_upload" className="cursor-pointer flex items-center gap-3">
                            <div className="w-10 h-10 rounded bg-primary/10 flex items-center justify-center flex-shrink-0">
                              <svg className="w-5 h-5 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                              </svg>
                            </div>
                            <div className="flex-1">
                              <p className="text-sm font-medium">Joindre les procurations</p>
                              <p className="text-xs text-muted-foreground">Si un indivisaire est repr√©sent√©</p>
                            </div>
                          </label>
                        </div>
                        {indivisionProcurationFiles.length > 0 && (
                          <div className="space-y-2 mt-2">
                            {indivisionProcurationFiles.map((file, idx) => (
                              <div key={idx} className="flex items-center gap-2 p-2 bg-muted/50 rounded-lg">
                                <svg className="w-4 h-4 text-muted-foreground flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                                <span className="text-sm flex-1 truncate">{file.name}</span>
                                <Button
                                  type="button"
                                  variant="ghost"
                                  size="sm"
                                  className="text-red-600 hover:text-red-700 hover:bg-red-50"
                                  onClick={() => {
                                    setIndivisionProcurationFiles(indivisionProcurationFiles.filter((_, i) => i !== idx));
                                    toast.success('Fichier supprim√©');
                                  }}
                                >
                                  <Trash2 className="w-4 h-4" />
                                </Button>
                              </div>
                            ))}
                          </div>
                        )}
                      </div>
                    </div>
                  </div>

                </div>
              </>
            )}

            {/* Formulaire sp√©cifique pour Mainlev√©e d'hypoth√®que */}
            {pendingContractType === "Mainlev√©e d'hypoth√®que" && (
              <>
                <div className="space-y-6 max-h-[60vh] overflow-y-auto px-1">
                  {/* 1. Informations g√©n√©rales sur l'hypoth√®que */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üìã Informations g√©n√©rales sur l'hypoth√®que</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Type de mainlev√©e *</Label>
                        <Select 
                          value={mainleveeData.typeMainlevee} 
                          onValueChange={(value) => setMainleveeData({...mainleveeData, typeMainlevee: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="totale">Mainlev√©e totale</SelectItem>
                            <SelectItem value="partielle">Mainlev√©e partielle</SelectItem>
                            <SelectItem value="renonciation">Renonciation √† l'inscription</SelectItem>
                            <SelectItem value="substitution">Substitution</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {mainleveeData.typeMainlevee === "partielle" && (
                        <div className="space-y-2">
                          <Label>Pr√©cision sur la mainlev√©e partielle</Label>
                          <Input
                            value={mainleveeData.precisionPartielle}
                            onChange={(e) => setMainleveeData({...mainleveeData, precisionPartielle: e.target.value})}
                            placeholder="Ex: Sur le lot n¬∞2 uniquement..."
                          />
                        </div>
                      )}

                      <div className="space-y-2">
                        <Label>Nature de l'inscription √† radier *</Label>
                        <Select 
                          value={mainleveeData.natureInscription} 
                          onValueChange={(value) => setMainleveeData({...mainleveeData, natureInscription: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="hypotheque_conventionnelle">Hypoth√®que conventionnelle</SelectItem>
                            <SelectItem value="hypotheque_legale">Hypoth√®que l√©gale</SelectItem>
                            <SelectItem value="hypotheque_judiciaire">Hypoth√®que judiciaire</SelectItem>
                            <SelectItem value="privilege_ppd">Privil√®ge de pr√™teur de deniers (PPD)</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="space-y-2">
                        <Label>Num√©ro d'inscription hypoth√©caire *</Label>
                        <Input
                          value={mainleveeData.numeroInscription}
                          onChange={(e) => setMainleveeData({...mainleveeData, numeroInscription: e.target.value})}
                          placeholder="Num√©ro exact au SPF"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Date de l'inscription</Label>
                        <Input
                          type="date"
                          value={mainleveeData.dateInscription}
                          onChange={(e) => setMainleveeData({...mainleveeData, dateInscription: e.target.value})}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Volume / Num√©ro d'ordre (ancien format)</Label>
                        <Input
                          value={mainleveeData.volumeNumero}
                          onChange={(e) => setMainleveeData({...mainleveeData, volumeNumero: e.target.value})}
                          placeholder="Volume X, n¬∞ Y"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>R√©f√©rence partenaire bancaire</Label>
                        <Input
                          value={mainleveeData.referencePartenaire}
                          onChange={(e) => setMainleveeData({...mainleveeData, referencePartenaire: e.target.value})}
                          placeholder="Facultatif"
                        />
                      </div>
                    </div>
                  </div>

                  {/* 2. Identit√© du cr√©ancier */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üè¶ Identit√© du cr√©ancier (donneur de mainlev√©e)</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label>Type de cr√©ancier *</Label>
                        <RadioGroup
                          value={mainleveeData.creancierType}
                          onValueChange={(value) => setMainleveeData({...mainleveeData, creancierType: value})}
                        >
                          <div className="flex gap-4">
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="banque" id="creancier_banque" />
                              <Label htmlFor="creancier_banque" className="cursor-pointer">Banque / √âtablissement financier</Label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="personne_physique" id="creancier_personne" />
                              <Label htmlFor="creancier_personne" className="cursor-pointer">Personne physique</Label>
                            </div>
                          </div>
                        </RadioGroup>
                      </div>

                      {mainleveeData.creancierType === "banque" ? (
                        <>
                          <div className="space-y-2">
                            <Label>D√©nomination sociale *</Label>
                            <Input
                              value={mainleveeData.creancierBanque.denominationSociale}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierBanque: {...mainleveeData.creancierBanque, denominationSociale: e.target.value}
                              })}
                              placeholder="Ex: Soci√©t√© G√©n√©rale"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Forme juridique</Label>
                            <Input
                              value={mainleveeData.creancierBanque.formeJuridique}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierBanque: {...mainleveeData.creancierBanque, formeJuridique: e.target.value}
                              })}
                              placeholder="Ex: SA, SAS..."
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Capital social</Label>
                            <Input
                              value={mainleveeData.creancierBanque.capitalSocial}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierBanque: {...mainleveeData.creancierBanque, capitalSocial: e.target.value}
                              })}
                              placeholder="Ex: 1 000 000 ‚Ç¨"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Adresse du si√®ge *</Label>
                            <Input
                              value={mainleveeData.creancierBanque.adresseSiege}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierBanque: {...mainleveeData.creancierBanque, adresseSiege: e.target.value}
                              })}
                              placeholder="Adresse compl√®te"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>RCS</Label>
                            <Input
                              value={mainleveeData.creancierBanque.rcs}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierBanque: {...mainleveeData.creancierBanque, rcs: e.target.value}
                              })}
                              placeholder="Ex: RCS Paris B 123 456 789"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>SIREN</Label>
                            <Input
                              value={mainleveeData.creancierBanque.siren}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierBanque: {...mainleveeData.creancierBanque, siren: e.target.value}
                              })}
                              placeholder="9 chiffres"
                            />
                          </div>

                          <div className="space-y-2 md:col-span-2 bg-muted/30 p-3 rounded-lg">
                            <h4 className="font-medium text-sm">Repr√©sentant habilit√©</h4>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                              <div className="space-y-2">
                                <Label>Nom du repr√©sentant</Label>
                                <Input
                                  value={mainleveeData.creancierBanque.representantNom}
                                  onChange={(e) => setMainleveeData({
                                    ...mainleveeData,
                                    creancierBanque: {...mainleveeData.creancierBanque, representantNom: e.target.value}
                                  })}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Pr√©nom du repr√©sentant</Label>
                                <Input
                                  value={mainleveeData.creancierBanque.representantPrenom}
                                  onChange={(e) => setMainleveeData({
                                    ...mainleveeData,
                                    creancierBanque: {...mainleveeData.creancierBanque, representantPrenom: e.target.value}
                                  })}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Fonction</Label>
                                <Input
                                  value={mainleveeData.creancierBanque.representantFonction}
                                  onChange={(e) => setMainleveeData({
                                    ...mainleveeData,
                                    creancierBanque: {...mainleveeData.creancierBanque, representantFonction: e.target.value}
                                  })}
                                  placeholder="Ex: Directeur d'agence"
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Type de pouvoirs</Label>
                                <Select 
                                  value={mainleveeData.creancierBanque.pouvoirsType} 
                                  onValueChange={(value) => setMainleveeData({
                                    ...mainleveeData,
                                    creancierBanque: {...mainleveeData.creancierBanque, pouvoirsType: value}
                                  })}
                                >
                                  <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                  <SelectContent>
                                    <SelectItem value="mandat">Mandat</SelectItem>
                                    <SelectItem value="delegation">D√©l√©gation interne</SelectItem>
                                    <SelectItem value="pv">PV d√©signant les pouvoirs</SelectItem>
                                  </SelectContent>
                                </Select>
                              </div>
                            </div>
                          </div>

                          {/* Upload pi√®ces cr√©ancier banque */}
                          <div className="space-y-2 md:col-span-2">
                            <Label>üìé Pi√®ces justificatives du cr√©ancier</Label>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                              {/* KBIS */}
                              <div className="space-y-2">
                                <Label className="text-sm">KBIS</Label>
                                <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                                  <input
                                    type="file"
                                    accept="application/pdf"
                                    multiple
                                    className="hidden"
                                    id="mainlevee_kbis_upload"
                                    onChange={(e) => {
                                      const files = Array.from(e.target.files || []);
                                      setMainleveeCreancierKbisFiles(prev => [...prev, ...files]);
                                    }}
                                  />
                                  <label htmlFor="mainlevee_kbis_upload" className="cursor-pointer text-sm text-muted-foreground">
                                    Cliquez pour joindre le KBIS
                                  </label>
                                  {mainleveeCreancierKbisFiles.length > 0 && (
                                    <div className="mt-2 space-y-1">
                                      {mainleveeCreancierKbisFiles.map((file, idx) => (
                                        <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                          <span className="truncate">{file.name}</span>
                                          <button
                                            type="button"
                                            onClick={() => setMainleveeCreancierKbisFiles(prev => prev.filter((_, i) => i !== idx))}
                                            className="text-red-600 ml-2"
                                          >
                                            ‚úï
                                          </button>
                                        </div>
                                      ))}
                                    </div>
                                  )}
                                </div>
                              </div>

                              {/* Mandat du repr√©sentant */}
                              <div className="space-y-2">
                                <Label className="text-sm">Mandat / D√©l√©gation de pouvoir</Label>
                                <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                                  <input
                                    type="file"
                                    accept="application/pdf"
                                    multiple
                                    className="hidden"
                                    id="mainlevee_mandat_upload"
                                    onChange={(e) => {
                                      const files = Array.from(e.target.files || []);
                                      setMainleveeCreancierMandatFiles(prev => [...prev, ...files]);
                                    }}
                                  />
                                  <label htmlFor="mainlevee_mandat_upload" className="cursor-pointer text-sm text-muted-foreground">
                                    Cliquez pour joindre le mandat
                                  </label>
                                  {mainleveeCreancierMandatFiles.length > 0 && (
                                    <div className="mt-2 space-y-1">
                                      {mainleveeCreancierMandatFiles.map((file, idx) => (
                                        <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                          <span className="truncate">{file.name}</span>
                                          <button
                                            type="button"
                                            onClick={() => setMainleveeCreancierMandatFiles(prev => prev.filter((_, i) => i !== idx))}
                                            className="text-red-600 ml-2"
                                          >
                                            ‚úï
                                          </button>
                                        </div>
                                      ))}
                                    </div>
                                  )}
                                </div>
                              </div>

                              {/* Pi√®ce d'identit√© repr√©sentant */}
                              <div className="space-y-2">
                                <Label className="text-sm">Pi√®ce d'identit√© du repr√©sentant</Label>
                                <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                                  <input
                                    type="file"
                                    accept="application/pdf"
                                    multiple
                                    className="hidden"
                                    id="mainlevee_identite_rep_upload"
                                    onChange={(e) => {
                                      const files = Array.from(e.target.files || []);
                                      setMainleveeCreancierIdentiteFiles(prev => [...prev, ...files]);
                                    }}
                                  />
                                  <label htmlFor="mainlevee_identite_rep_upload" className="cursor-pointer text-sm text-muted-foreground">
                                    Cliquez pour joindre la pi√®ce d'identit√©
                                  </label>
                                  {mainleveeCreancierIdentiteFiles.length > 0 && (
                                    <div className="mt-2 space-y-1">
                                      {mainleveeCreancierIdentiteFiles.map((file, idx) => (
                                        <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                          <span className="truncate">{file.name}</span>
                                          <button
                                            type="button"
                                            onClick={() => setMainleveeCreancierIdentiteFiles(prev => prev.filter((_, i) => i !== idx))}
                                            className="text-red-600 ml-2"
                                          >
                                            ‚úï
                                          </button>
                                        </div>
                                      ))}
                                    </div>
                                  )}
                                </div>
                              </div>
                            </div>
                          </div>
                        </>
                      ) : (
                        <>
                          {/* Cr√©ancier personne physique */}
                          <div className="space-y-2">
                            <Label>Nom *</Label>
                            <Input
                              value={mainleveeData.creancierPersonne.nom}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierPersonne: {...mainleveeData.creancierPersonne, nom: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Pr√©nom *</Label>
                            <Input
                              value={mainleveeData.creancierPersonne.prenom}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierPersonne: {...mainleveeData.creancierPersonne, prenom: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Adresse</Label>
                            <Input
                              value={mainleveeData.creancierPersonne.adresse}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierPersonne: {...mainleveeData.creancierPersonne, adresse: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Date de naissance</Label>
                            <Input
                              type="date"
                              value={mainleveeData.creancierPersonne.dateNaissance}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierPersonne: {...mainleveeData.creancierPersonne, dateNaissance: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Lieu de naissance</Label>
                            <Input
                              value={mainleveeData.creancierPersonne.lieuNaissance}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierPersonne: {...mainleveeData.creancierPersonne, lieuNaissance: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Nationalit√©</Label>
                            <Input
                              value={mainleveeData.creancierPersonne.nationalite}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierPersonne: {...mainleveeData.creancierPersonne, nationalite: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Profession</Label>
                            <Input
                              value={mainleveeData.creancierPersonne.profession}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierPersonne: {...mainleveeData.creancierPersonne, profession: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Situation familiale</Label>
                            <Input
                              value={mainleveeData.creancierPersonne.statutMatrimonial}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierPersonne: {...mainleveeData.creancierPersonne, statutMatrimonial: e.target.value}
                              })}
                              placeholder="Ex: C√©libataire, Mari√©..."
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Type de pi√®ce d'identit√©</Label>
                            <Input
                              value={mainleveeData.creancierPersonne.typeIdentite}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierPersonne: {...mainleveeData.creancierPersonne, typeIdentite: e.target.value}
                              })}
                              placeholder="Ex: CNI, Passeport..."
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Num√©ro de pi√®ce d'identit√©</Label>
                            <Input
                              value={mainleveeData.creancierPersonne.numeroIdentite}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                creancierPersonne: {...mainleveeData.creancierPersonne, numeroIdentite: e.target.value}
                              })}
                            />
                          </div>
                        </>
                      )}
                    </div>
                  </div>

                  {/* 3. D√©biteurs hypoth√©caires - √Ä CONTINUER */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üë• D√©biteurs hypoth√©caires (emprunteurs)</h3>
                    <p className="text-sm text-muted-foreground">Les personnes qui avaient contract√© le pr√™t</p>
                    
                    {mainleveeData.debiteurs.map((debiteur, index) => (
                      <div key={debiteur.id} className="p-4 border rounded-lg space-y-4">
                        <div className="flex justify-between items-center">
                          <h4 className="font-medium">D√©biteur #{index + 1}</h4>
                          {mainleveeData.debiteurs.length > 1 && (
                            <Button
                              type="button"
                              variant="ghost"
                              size="sm"
                              className="text-red-600 hover:text-red-700 hover:bg-red-50"
                              onClick={() => {
                                setMainleveeData({
                                  ...mainleveeData,
                                  debiteurs: mainleveeData.debiteurs.filter(d => d.id !== debiteur.id)
                                });
                              }}
                            >
                              Supprimer
                            </Button>
                          )}
                        </div>

                        {/* S√©lection client pour ce d√©biteur - m√™me logique que Convention d'indivision */}
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          <div className="space-y-2 md:col-span-2">
                            <Label>Ce d√©biteur est-il votre client ?</Label>
                            <RadioGroup
                              value={debiteur.isClient ? "client" : "autre"}
                              onValueChange={(value) => {
                                const newDebiteurs = [...mainleveeData.debiteurs];
                                const idx = newDebiteurs.findIndex(d => d.id === debiteur.id);
                                newDebiteurs[idx] = {...newDebiteurs[idx], isClient: value === "client"};
                                setMainleveeData({...mainleveeData, debiteurs: newDebiteurs});
                              }}
                            >
                              <div className="flex gap-4">
                                <div className="flex items-center space-x-2">
                                  <RadioGroupItem value="client" id={`deb_client_${debiteur.id}`} />
                                  <Label htmlFor={`deb_client_${debiteur.id}`} className="cursor-pointer">Oui (client)</Label>
                                </div>
                                <div className="flex items-center space-x-2">
                                  <RadioGroupItem value="autre" id={`deb_autre_${debiteur.id}`} />
                                  <Label htmlFor={`deb_autre_${debiteur.id}`} className="cursor-pointer">Non (autre partie)</Label>
                                </div>
                              </div>
                            </RadioGroup>
                          </div>

                          {debiteur.isClient && (
                            <div className="space-y-2 md:col-span-2">
                              <Label>S√©lectionner le client *</Label>
                              <Select
                                value={debiteur.clientId}
                                onValueChange={async (value) => {
                                  const selectedClient = clients.find(c => c.id === value);
                                  const newDebiteurs = [...mainleveeData.debiteurs];
                                  const idx = newDebiteurs.findIndex(d => d.id === debiteur.id);
                                  
                                  if (selectedClient) {
                                    let situationFamiliale = selectedClient.situation_matrimoniale || "";
                                    let regimeMatrimonial = "";
                                    
                                    if (selectedClient.situation_familiale) {
                                      if (typeof selectedClient.situation_familiale === 'object') {
                                        const sitFam = selectedClient.situation_familiale as any;
                                        situationFamiliale = selectedClient.situation_matrimoniale || sitFam.situation_familiale || "";
                                        regimeMatrimonial = sitFam.regime_matrimonial || "";
                                      }
                                    }

                                    newDebiteurs[idx] = {
                                      ...newDebiteurs[idx],
                                      clientId: value,
                                      nom: selectedClient.nom || "",
                                      prenom: selectedClient.prenom || "",
                                      adresse: selectedClient.adresse || "",
                                      dateNaissance: selectedClient.date_naissance || "",
                                      lieuNaissance: selectedClient.lieu_naissance || "",
                                      nationalite: selectedClient.nationalite || "",
                                      profession: selectedClient.profession || "",
                                      situationFamiliale: situationFamiliale,
                                      regimeMatrimonial: regimeMatrimonial,
                                      typeIdentite: selectedClient.type_identite || "",
                                      numeroIdentite: selectedClient.numero_identite || "",
                                    };

                                    // Auto-load identit√©
                                    if (selectedClient.id_doc_path) {
                                      try {
                                        const { data, error } = await supabase.storage
                                          .from('documents')
                                          .download(selectedClient.id_doc_path);
                                        
                                        if (data && !error) {
                                          const fileName = selectedClient.id_doc_path.split('/').pop() || 'identite.pdf';
                                          const file = new File([data], fileName, { type: data.type });
                                          setMainleveeDebiteursIdentiteFiles(prev => ({
                                            ...prev,
                                            [debiteur.id]: [file]
                                          }));
                                        }
                                      } catch (error) {
                                        console.error('Erreur chargement identit√©:', error);
                                      }
                                    } else {
                                      // Chercher dans client_documents
                                      try {
                                        const { data: docs, error: docsError } = await supabase
                                          .from('client_documents')
                                          .select('file_path, file_name')
                                          .eq('client_id', selectedClient.id)
                                          .eq('document_type', 'piece_identite')
                                          .order('uploaded_at', { ascending: false })
                                          .limit(1);
                                        
                                        if (docs && docs.length > 0) {
                                          const { data, error } = await supabase.storage
                                            .from('documents')
                                            .download(docs[0].file_path);
                                          
                                          if (data && !error) {
                                            const file = new File([data], docs[0].file_name, { type: data.type });
                                            setMainleveeDebiteursIdentiteFiles(prev => ({
                                              ...prev,
                                              [debiteur.id]: [file]
                                            }));
                                          }
                                        }
                                      } catch (error) {
                                        console.error('Erreur recherche client_documents:', error);
                                      }
                                    }
                                  }
                                  setMainleveeData({...mainleveeData, debiteurs: newDebiteurs});
                                }}
                              >
                                <SelectTrigger><SelectValue placeholder="Choisir un client..." /></SelectTrigger>
                                <SelectContent>
                                  {clients.map((client) => (
                                    <SelectItem key={client.id} value={client.id}>
                                      {client.nom} {client.prenom}
                                    </SelectItem>
                                  ))}
                                </SelectContent>
                              </Select>

                              {debiteur.clientId && (
                                <div className="mt-2 p-3 bg-green-50 border border-green-200 rounded-lg text-sm text-green-800">
                                  ‚úì Informations charg√©es depuis la fiche client
                                </div>
                              )}
                            </div>
                          )}

                          <div className="space-y-2">
                            <Label>Nom</Label>
                            <Input
                              value={debiteur.nom}
                              onChange={(e) => {
                                const newDebiteurs = [...mainleveeData.debiteurs];
                                const idx = newDebiteurs.findIndex(d => d.id === debiteur.id);
                                newDebiteurs[idx] = {...newDebiteurs[idx], nom: e.target.value};
                                setMainleveeData({...mainleveeData, debiteurs: newDebiteurs});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Pr√©nom</Label>
                            <Input
                              value={debiteur.prenom}
                              onChange={(e) => {
                                const newDebiteurs = [...mainleveeData.debiteurs];
                                const idx = newDebiteurs.findIndex(d => d.id === debiteur.id);
                                newDebiteurs[idx] = {...newDebiteurs[idx], prenom: e.target.value};
                                setMainleveeData({...mainleveeData, debiteurs: newDebiteurs});
                              }}
                            />
                          </div>

                          <div className="space-y-2 md:col-span-2">
                            <Label>Adresse personnelle</Label>
                            <Input
                              value={debiteur.adresse}
                              onChange={(e) => {
                                const newDebiteurs = [...mainleveeData.debiteurs];
                                const idx = newDebiteurs.findIndex(d => d.id === debiteur.id);
                                newDebiteurs[idx] = {...newDebiteurs[idx], adresse: e.target.value};
                                setMainleveeData({...mainleveeData, debiteurs: newDebiteurs});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Date de naissance</Label>
                            <Input
                              type="date"
                              value={debiteur.dateNaissance}
                              onChange={(e) => {
                                const newDebiteurs = [...mainleveeData.debiteurs];
                                const idx = newDebiteurs.findIndex(d => d.id === debiteur.id);
                                newDebiteurs[idx] = {...newDebiteurs[idx], dateNaissance: e.target.value};
                                setMainleveeData({...mainleveeData, debiteurs: newDebiteurs});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Lieu de naissance</Label>
                            <Input
                              value={debiteur.lieuNaissance}
                              onChange={(e) => {
                                const newDebiteurs = [...mainleveeData.debiteurs];
                                const idx = newDebiteurs.findIndex(d => d.id === debiteur.id);
                                newDebiteurs[idx] = {...newDebiteurs[idx], lieuNaissance: e.target.value};
                                setMainleveeData({...mainleveeData, debiteurs: newDebiteurs});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Nationalit√©</Label>
                            <Input
                              value={debiteur.nationalite}
                              onChange={(e) => {
                                const newDebiteurs = [...mainleveeData.debiteurs];
                                const idx = newDebiteurs.findIndex(d => d.id === debiteur.id);
                                newDebiteurs[idx] = {...newDebiteurs[idx], nationalite: e.target.value};
                                setMainleveeData({...mainleveeData, debiteurs: newDebiteurs});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Profession</Label>
                            <Input
                              value={debiteur.profession}
                              onChange={(e) => {
                                const newDebiteurs = [...mainleveeData.debiteurs];
                                const idx = newDebiteurs.findIndex(d => d.id === debiteur.id);
                                newDebiteurs[idx] = {...newDebiteurs[idx], profession: e.target.value};
                                setMainleveeData({...mainleveeData, debiteurs: newDebiteurs});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Situation familiale</Label>
                            <Input
                              value={debiteur.situationFamiliale}
                              onChange={(e) => {
                                const newDebiteurs = [...mainleveeData.debiteurs];
                                const idx = newDebiteurs.findIndex(d => d.id === debiteur.id);
                                newDebiteurs[idx] = {...newDebiteurs[idx], situationFamiliale: e.target.value};
                                setMainleveeData({...mainleveeData, debiteurs: newDebiteurs});
                              }}
                              placeholder="Ex: C√©libataire, Mari√©..."
                            />
                          </div>

                          {debiteur.situationFamiliale && ['mari√©', 'marie', 'mari√©e', 'pacs√©', 'pacse', 'pacs'].some(term => debiteur.situationFamiliale.toLowerCase().includes(term)) && (
                            <div className="space-y-2">
                              <Label>R√©gime matrimonial</Label>
                              <Input
                                value={debiteur.regimeMatrimonial}
                                onChange={(e) => {
                                  const newDebiteurs = [...mainleveeData.debiteurs];
                                  const idx = newDebiteurs.findIndex(d => d.id === debiteur.id);
                                  newDebiteurs[idx] = {...newDebiteurs[idx], regimeMatrimonial: e.target.value};
                                  setMainleveeData({...mainleveeData, debiteurs: newDebiteurs});
                                }}
                                placeholder="Ex: Communaut√© l√©gale..."
                              />
                            </div>
                          )}

                          <div className="space-y-2">
                            <Label>Type de pi√®ce d'identit√©</Label>
                            <Input
                              value={debiteur.typeIdentite}
                              onChange={(e) => {
                                const newDebiteurs = [...mainleveeData.debiteurs];
                                const idx = newDebiteurs.findIndex(d => d.id === debiteur.id);
                                newDebiteurs[idx] = {...newDebiteurs[idx], typeIdentite: e.target.value};
                                setMainleveeData({...mainleveeData, debiteurs: newDebiteurs});
                              }}
                              placeholder="CNI, Passeport..."
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Num√©ro de pi√®ce d'identit√©</Label>
                            <Input
                              value={debiteur.numeroIdentite}
                              onChange={(e) => {
                                const newDebiteurs = [...mainleveeData.debiteurs];
                                const idx = newDebiteurs.findIndex(d => d.id === debiteur.id);
                                newDebiteurs[idx] = {...newDebiteurs[idx], numeroIdentite: e.target.value};
                                setMainleveeData({...mainleveeData, debiteurs: newDebiteurs});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Qualit√© dans l'acte</Label>
                            <Select 
                              value={debiteur.qualite} 
                              onValueChange={(value) => {
                                const newDebiteurs = [...mainleveeData.debiteurs];
                                const idx = newDebiteurs.findIndex(d => d.id === debiteur.id);
                                newDebiteurs[idx] = {...newDebiteurs[idx], qualite: value};
                                setMainleveeData({...mainleveeData, debiteurs: newDebiteurs});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="emprunteur">Emprunteur</SelectItem>
                                <SelectItem value="cofinanceur">Cofinanceur</SelectItem>
                                <SelectItem value="caution_hypothecaire">Caution hypoth√©caire</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          {/* Upload pi√®ces d√©biteur */}
                          {!debiteur.isClient && (
                            <div className="space-y-2 md:col-span-2">
                              <Label>üìé Pi√®ce d'identit√© du d√©biteur</Label>
                              <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                                <input
                                  type="file"
                                  accept="application/pdf"
                                  multiple
                                  className="hidden"
                                  id={`mainlevee_deb_identite_${debiteur.id}`}
                                  onChange={(e) => {
                                    const files = Array.from(e.target.files || []);
                                    setMainleveeDebiteursIdentiteFiles(prev => ({
                                      ...prev,
                                      [debiteur.id]: [...(prev[debiteur.id] || []), ...files]
                                    }));
                                  }}
                                />
                                <label htmlFor={`mainlevee_deb_identite_${debiteur.id}`} className="cursor-pointer text-sm text-muted-foreground">
                                  Cliquez pour joindre la pi√®ce d'identit√©
                                </label>
                              </div>
                            </div>
                          )}

                          {debiteur.isClient && mainleveeDebiteursIdentiteFiles[debiteur.id]?.length > 0 && (
                            <div className="md:col-span-2 p-3 bg-green-50 border border-green-200 rounded-lg text-sm text-green-800">
                              ‚úì Pi√®ce d'identit√© charg√©e depuis la fiche client
                            </div>
                          )}

                          {mainleveeDebiteursIdentiteFiles[debiteur.id]?.length > 0 && (
                            <div className="md:col-span-2 space-y-1">
                              {mainleveeDebiteursIdentiteFiles[debiteur.id].map((file, idx) => (
                                <div key={idx} className="flex items-center justify-between text-xs bg-muted p-2 rounded">
                                  <span className="truncate">{file.name}</span>
                                  <button
                                    type="button"
                                    onClick={() => {
                                      setMainleveeDebiteursIdentiteFiles(prev => ({
                                        ...prev,
                                        [debiteur.id]: prev[debiteur.id].filter((_, i) => i !== idx)
                                      }));
                                    }}
                                    className="text-red-600 ml-2"
                                  >
                                    Supprimer
                                  </button>
                                </div>
                              ))}
                            </div>
                          )}
                        </div>
                      </div>
                    ))}

                    <Button
                      type="button"
                      variant="outline"
                      className="w-full text-orange-600 hover:text-orange-700 hover:bg-orange-50 border-orange-300"
                      onClick={() => {
                        const newId = Math.max(...mainleveeData.debiteurs.map(d => d.id), 0) + 1;
                        setMainleveeData({
                          ...mainleveeData,
                          debiteurs: [...mainleveeData.debiteurs, {
                            id: newId,
                            isClient: false,
                            clientId: "",
                            nom: "",
                            prenom: "",
                            adresse: "",
                            dateNaissance: "",
                            lieuNaissance: "",
                            nationalite: "",
                            profession: "",
                            situationFamiliale: "",
                            regimeMatrimonial: "",
                            typeIdentite: "",
                            numeroIdentite: "",
                            qualite: "emprunteur",
                          }]
                        });
                      }}
                    >
                      + Ajouter un d√©biteur
                    </Button>
                  </div>

                  {/* 4. Acte constitutif de l'hypoth√®que */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üìÑ Informations sur l'acte constitutif</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <h4 className="font-medium md:col-span-2">A. Acte d'origine</h4>
                      
                      <div className="space-y-2">
                        <Label>Date de signature de l'acte</Label>
                        <Input
                          type="date"
                          value={mainleveeData.acteOrigine.dateSignature}
                          onChange={(e) => setMainleveeData({
                            ...mainleveeData,
                            acteOrigine: {...mainleveeData.acteOrigine, dateSignature: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Nature de l'acte</Label>
                        <Select 
                          value={mainleveeData.acteOrigine.natureActe} 
                          onValueChange={(value) => setMainleveeData({
                            ...mainleveeData,
                            acteOrigine: {...mainleveeData.acteOrigine, natureActe: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="acte_notarie">Acte notari√©</SelectItem>
                            <SelectItem value="acte_sous_seing_prive">Acte sous seing priv√©</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="space-y-2">
                        <Label>Notaire ou auteur de l'acte</Label>
                        <Input
                          value={mainleveeData.acteOrigine.notaireAuteur}
                          onChange={(e) => setMainleveeData({
                            ...mainleveeData,
                            acteOrigine: {...mainleveeData.acteOrigine, notaireAuteur: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Date de publication au SPF</Label>
                        <Input
                          type="date"
                          value={mainleveeData.acteOrigine.datePublication}
                          onChange={(e) => setMainleveeData({
                            ...mainleveeData,
                            acteOrigine: {...mainleveeData.acteOrigine, datePublication: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Num√©ro de publication</Label>
                        <Input
                          value={mainleveeData.acteOrigine.numeroPublication}
                          onChange={(e) => setMainleveeData({
                            ...mainleveeData,
                            acteOrigine: {...mainleveeData.acteOrigine, numeroPublication: e.target.value}
                          })}
                        />
                      </div>

                      <h4 className="font-medium md:col-span-2 mt-4">B. Conditions du pr√™t</h4>

                      <div className="space-y-2">
                        <Label>Montant initial du pr√™t (‚Ç¨)</Label>
                        <Input
                          type="number"
                          value={mainleveeData.conditionsPret.montantInitial}
                          onChange={(e) => setMainleveeData({
                            ...mainleveeData,
                            conditionsPret: {...mainleveeData.conditionsPret, montantInitial: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Taux d'int√©r√™t</Label>
                        <Input
                          value={mainleveeData.conditionsPret.tauxInteret}
                          onChange={(e) => setMainleveeData({
                            ...mainleveeData,
                            conditionsPret: {...mainleveeData.conditionsPret, tauxInteret: e.target.value}
                          })}
                          placeholder="Ex: 1,5%"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Dur√©e du pr√™t</Label>
                        <Input
                          value={mainleveeData.conditionsPret.dureePret}
                          onChange={(e) => setMainleveeData({
                            ...mainleveeData,
                            conditionsPret: {...mainleveeData.conditionsPret, dureePret: e.target.value}
                          })}
                          placeholder="Ex: 20 ans"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Num√©ro de contrat de pr√™t</Label>
                        <Input
                          value={mainleveeData.conditionsPret.numeroContrat}
                          onChange={(e) => setMainleveeData({
                            ...mainleveeData,
                            conditionsPret: {...mainleveeData.conditionsPret, numeroContrat: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>√âtablissement pr√™teur</Label>
                        <Input
                          value={mainleveeData.conditionsPret.etablissementPreteur}
                          onChange={(e) => setMainleveeData({
                            ...mainleveeData,
                            conditionsPret: {...mainleveeData.conditionsPret, etablissementPreteur: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Num√©ro de dossier</Label>
                        <Input
                          value={mainleveeData.conditionsPret.numeroDossier}
                          onChange={(e) => setMainleveeData({
                            ...mainleveeData,
                            conditionsPret: {...mainleveeData.conditionsPret, numeroDossier: e.target.value}
                          })}
                        />
                      </div>
                    </div>
                  </div>

                  {/* 5. Bien(s) hypoth√©qu√©(s) */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üè† Description du/des bien(s) hypoth√©qu√©(s)</h3>
                    
                    {mainleveeData.biens.map((bien, index) => (
                      <div key={bien.id} className="p-4 border rounded-lg space-y-4">
                        <div className="flex justify-between items-center">
                          <h4 className="font-medium">Bien #{index + 1}</h4>
                          {mainleveeData.biens.length > 1 && (
                            <Button
                              type="button"
                              variant="ghost"
                              size="sm"
                              className="text-red-600 hover:text-red-700 hover:bg-red-50"
                              onClick={() => {
                                setMainleveeData({
                                  ...mainleveeData,
                                  biens: mainleveeData.biens.filter(b => b.id !== bien.id)
                                });
                              }}
                            >
                              Supprimer
                            </Button>
                          )}
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          <div className="space-y-2 md:col-span-2">
                            <Label>Adresse compl√®te du bien</Label>
                            <Input
                              value={bien.adresse}
                              onChange={(e) => {
                                const newBiens = [...mainleveeData.biens];
                                const idx = newBiens.findIndex(b => b.id === bien.id);
                                newBiens[idx] = {...newBiens[idx], adresse: e.target.value};
                                setMainleveeData({...mainleveeData, biens: newBiens});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Type de bien</Label>
                            <Select 
                              value={bien.typeBien} 
                              onValueChange={(value) => {
                                const newBiens = [...mainleveeData.biens];
                                const idx = newBiens.findIndex(b => b.id === bien.id);
                                newBiens[idx] = {...newBiens[idx], typeBien: value};
                                setMainleveeData({...mainleveeData, biens: newBiens});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="maison">Maison</SelectItem>
                                <SelectItem value="appartement">Appartement</SelectItem>
                                <SelectItem value="terrain">Terrain</SelectItem>
                                <SelectItem value="locaux">Locaux commerciaux</SelectItem>
                                <SelectItem value="dependances">D√©pendances</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          <div className="space-y-2">
                            <Label>Description du bien</Label>
                            <Input
                              value={bien.descriptionBien}
                              onChange={(e) => {
                                const newBiens = [...mainleveeData.biens];
                                const idx = newBiens.findIndex(b => b.id === bien.id);
                                newBiens[idx] = {...newBiens[idx], descriptionBien: e.target.value};
                                setMainleveeData({...mainleveeData, biens: newBiens});
                              }}
                              placeholder="Ex: Villa 5 pi√®ces..."
                            />
                          </div>

                          <div className="space-y-2 md:col-span-2">
                            <Label>Mode de d√©tention du bien *</Label>
                            <Select 
                              value={bien.modeDetention} 
                              onValueChange={(value) => {
                                const newBiens = [...mainleveeData.biens];
                                const idx = newBiens.findIndex(b => b.id === bien.id);
                                newBiens[idx] = {...newBiens[idx], modeDetention: value};
                                setMainleveeData({...mainleveeData, biens: newBiens});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="propriete_exclusive">Propri√©t√© exclusive</SelectItem>
                                <SelectItem value="indivision">Indivision</SelectItem>
                                <SelectItem value="communaute_acquets">Communaut√© r√©duite aux acqu√™ts</SelectItem>
                                <SelectItem value="separation_biens">S√©paration de biens</SelectItem>
                                <SelectItem value="autre">Autre r√©gime (pr√©ciser)</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          {bien.modeDetention === "indivision" && (
                            <div className="space-y-2 md:col-span-2">
                              <Label>Quote-parts en indivision</Label>
                              <Input
                                value={bien.quotepartsIndivision}
                                onChange={(e) => {
                                  const newBiens = [...mainleveeData.biens];
                                  const idx = newBiens.findIndex(b => b.id === bien.id);
                                  newBiens[idx] = {...newBiens[idx], quotepartsIndivision: e.target.value};
                                  setMainleveeData({...mainleveeData, biens: newBiens});
                                }}
                                placeholder="Ex: 1/2, 1/3-2/3, etc."
                              />
                            </div>
                          )}

                          {bien.modeDetention === "autre" && (
                            <div className="space-y-2 md:col-span-2">
                              <Label>Pr√©ciser le r√©gime</Label>
                              <Input
                                value={bien.autreRegime}
                                onChange={(e) => {
                                  const newBiens = [...mainleveeData.biens];
                                  const idx = newBiens.findIndex(b => b.id === bien.id);
                                  newBiens[idx] = {...newBiens[idx], autreRegime: e.target.value};
                                  setMainleveeData({...mainleveeData, biens: newBiens});
                                }}
                                placeholder="Ex: Communaut√© universelle, participation aux acqu√™ts..."
                              />
                            </div>
                          )}

                          <div className="space-y-2">
                            <Label>Section cadastrale</Label>
                            <Input
                              value={bien.cadastreSection}
                              onChange={(e) => {
                                const newBiens = [...mainleveeData.biens];
                                const idx = newBiens.findIndex(b => b.id === bien.id);
                                newBiens[idx] = {...newBiens[idx], cadastreSection: e.target.value};
                                setMainleveeData({...mainleveeData, biens: newBiens});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Num√©ro de parcelle</Label>
                            <Input
                              value={bien.cadastreParcelle}
                              onChange={(e) => {
                                const newBiens = [...mainleveeData.biens];
                                const idx = newBiens.findIndex(b => b.id === bien.id);
                                newBiens[idx] = {...newBiens[idx], cadastreParcelle: e.target.value};
                                setMainleveeData({...mainleveeData, biens: newBiens});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Contenance (surface)</Label>
                            <Input
                              value={bien.cadastreContenance}
                              onChange={(e) => {
                                const newBiens = [...mainleveeData.biens];
                                const idx = newBiens.findIndex(b => b.id === bien.id);
                                newBiens[idx] = {...newBiens[idx], cadastreContenance: e.target.value};
                                setMainleveeData({...mainleveeData, biens: newBiens});
                              }}
                              placeholder="Ex: 500 m¬≤"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Est-ce en copropri√©t√© ?</Label>
                            <RadioGroup
                              value={bien.estCopropriete}
                              onValueChange={(value) => {
                                const newBiens = [...mainleveeData.biens];
                                const idx = newBiens.findIndex(b => b.id === bien.id);
                                newBiens[idx] = {...newBiens[idx], estCopropriete: value};
                                setMainleveeData({...mainleveeData, biens: newBiens});
                              }}
                            >
                              <div className="flex gap-4">
                                <div className="flex items-center space-x-2">
                                  <RadioGroupItem value="oui" id={`copro_oui_${bien.id}`} />
                                  <Label htmlFor={`copro_oui_${bien.id}`} className="cursor-pointer">Oui</Label>
                                </div>
                                <div className="flex items-center space-x-2">
                                  <RadioGroupItem value="non" id={`copro_non_${bien.id}`} />
                                  <Label htmlFor={`copro_non_${bien.id}`} className="cursor-pointer">Non</Label>
                                </div>
                              </div>
                            </RadioGroup>
                          </div>

                          {bien.estCopropriete === "oui" && (
                            <>
                              <div className="space-y-2">
                                <Label>Num√©ro de lot</Label>
                                <Input
                                  value={bien.numeroLot}
                                  onChange={(e) => {
                                    const newBiens = [...mainleveeData.biens];
                                    const idx = newBiens.findIndex(b => b.id === bien.id);
                                    newBiens[idx] = {...newBiens[idx], numeroLot: e.target.value};
                                    setMainleveeData({...mainleveeData, biens: newBiens});
                                  }}
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Quote-part dans les parties communes</Label>
                                <Input
                                  value={bien.quotePart}
                                  onChange={(e) => {
                                    const newBiens = [...mainleveeData.biens];
                                    const idx = newBiens.findIndex(b => b.id === bien.id);
                                    newBiens[idx] = {...newBiens[idx], quotePart: e.target.value};
                                    setMainleveeData({...mainleveeData, biens: newBiens});
                                  }}
                                  placeholder="Ex: 50/1000"
                                />
                              </div>
                            </>
                          )}
                        </div>
                      </div>
                    ))}

                    <Button
                      type="button"
                      variant="outline"
                      className="w-full text-orange-600 hover:text-orange-700 hover:bg-orange-50 border-orange-300"
                      onClick={() => {
                        const newId = Math.max(...mainleveeData.biens.map(b => b.id), 0) + 1;
                        setMainleveeData({
                          ...mainleveeData,
                          biens: [...mainleveeData.biens, {
                            id: newId,
                            adresse: "",
                            descriptionBien: "",
                            typeBien: "",
                            modeDetention: "",
                            quotepartsIndivision: "",
                            autreRegime: "",
                            cadastreSection: "",
                            cadastreParcelle: "",
                            cadastreContenance: "",
                            estCopropriete: "non",
                            numeroLot: "",
                            quotePart: "",
                          }]
                        });
                      }}
                    >
                      + Ajouter un bien
                    </Button>
                  </div>

                  {/* 6. D√©claration du cr√©ancier */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">‚úÖ D√©claration du cr√©ancier</h3>
                    <div className="p-4 bg-muted/30 rounded-lg space-y-3">
                      <p className="text-sm text-muted-foreground">Le cr√©ancier d√©clare :</p>
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="decl_payee"
                            checked={mainleveeData.declaration.creancePayee}
                            onChange={(e) => setMainleveeData({
                              ...mainleveeData,
                              declaration: {...mainleveeData.declaration, creancePayee: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="decl_payee" className="cursor-pointer">Que la cr√©ance est int√©gralement pay√©e</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="decl_aucune_dette"
                            checked={mainleveeData.declaration.aucuneDette}
                            onChange={(e) => setMainleveeData({
                              ...mainleveeData,
                              declaration: {...mainleveeData.declaration, aucuneDette: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="decl_aucune_dette" className="cursor-pointer">Qu'il n'existe plus de dette en principal, int√©r√™ts, p√©nalit√©s</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="decl_consent"
                            checked={mainleveeData.declaration.consentMainlevee}
                            onChange={(e) => setMainleveeData({
                              ...mainleveeData,
                              declaration: {...mainleveeData.declaration, consentMainlevee: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="decl_consent" className="cursor-pointer">Qu'il consent √† la mainlev√©e totale/partielle</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="decl_renonce"
                            checked={mainleveeData.declaration.renonciation}
                            onChange={(e) => setMainleveeData({
                              ...mainleveeData,
                              declaration: {...mainleveeData.declaration, renonciation: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="decl_renonce" className="cursor-pointer">Qu'il renonce √† l'inscription hypoth√©caire</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="decl_radiation"
                            checked={mainleveeData.declaration.demandeRadiation}
                            onChange={(e) => setMainleveeData({
                              ...mainleveeData,
                              declaration: {...mainleveeData.declaration, demandeRadiation: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="decl_radiation" className="cursor-pointer">Qu'il demande la radiation au SPF</Label>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* 7. Mandat/Procuration */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üìù Mandat ou procuration</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label>Y a-t-il un mandataire ?</Label>
                        <RadioGroup
                          value={mainleveeData.mandataire.existe}
                          onValueChange={(value) => setMainleveeData({
                            ...mainleveeData,
                            mandataire: {...mainleveeData.mandataire, existe: value}
                          })}
                        >
                          <div className="flex gap-4">
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="oui" id="mand_oui" />
                              <Label htmlFor="mand_oui" className="cursor-pointer">Oui</Label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="non" id="mand_non" />
                              <Label htmlFor="mand_non" className="cursor-pointer">Non</Label>
                            </div>
                          </div>
                        </RadioGroup>
                      </div>

                      {mainleveeData.mandataire.existe === "oui" && (
                        <>
                          <div className="space-y-2">
                            <Label>Nom du mandataire</Label>
                            <Input
                              value={mainleveeData.mandataire.nom}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                mandataire: {...mainleveeData.mandataire, nom: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Pr√©nom du mandataire</Label>
                            <Input
                              value={mainleveeData.mandataire.prenom}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                mandataire: {...mainleveeData.mandataire, prenom: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Fonction</Label>
                            <Input
                              value={mainleveeData.mandataire.fonction}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                mandataire: {...mainleveeData.mandataire, fonction: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2 md:col-span-2">
                            <Label>Pouvoirs du mandataire</Label>
                            <div className="space-y-2">
                              <div className="flex items-center space-x-2">
                                <input
                                  type="checkbox"
                                  id="pouvoir_signer"
                                  checked={mainleveeData.mandataire.pouvoirSigner}
                                  onChange={(e) => setMainleveeData({
                                    ...mainleveeData,
                                    mandataire: {...mainleveeData.mandataire, pouvoirSigner: e.target.checked}
                                  })}
                                  className="rounded"
                                />
                                <Label htmlFor="pouvoir_signer" className="cursor-pointer">Signer la mainlev√©e</Label>
                              </div>
                              <div className="flex items-center space-x-2">
                                <input
                                  type="checkbox"
                                  id="pouvoir_deposer"
                                  checked={mainleveeData.mandataire.pouvoirDeposer}
                                  onChange={(e) => setMainleveeData({
                                    ...mainleveeData,
                                    mandataire: {...mainleveeData.mandataire, pouvoirDeposer: e.target.checked}
                                  })}
                                  className="rounded"
                                />
                                <Label htmlFor="pouvoir_deposer" className="cursor-pointer">D√©poser au SPF</Label>
                              </div>
                            </div>
                          </div>
                        </>
                      )}
                    </div>
                  </div>

                  {/* 8. Consentement d√©biteur */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üë§ Consentement du d√©biteur</h3>
                    <div className="grid grid-cols-1 gap-4">
                      <div className="space-y-2">
                        <Label>Consentement du d√©biteur requis ?</Label>
                        <RadioGroup
                          value={mainleveeData.consentementDebiteur.requis}
                          onValueChange={(value) => setMainleveeData({
                            ...mainleveeData,
                            consentementDebiteur: {...mainleveeData.consentementDebiteur, requis: value}
                          })}
                        >
                          <div className="flex gap-4">
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="oui" id="consent_oui" />
                              <Label htmlFor="consent_oui" className="cursor-pointer">Oui</Label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="non" id="consent_non" />
                              <Label htmlFor="consent_non" className="cursor-pointer">Non</Label>
                            </div>
                          </div>
                        </RadioGroup>
                      </div>

                      {mainleveeData.consentementDebiteur.requis === "oui" && (
                        <>
                          <div className="space-y-2">
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="accord_rad"
                                checked={mainleveeData.consentementDebiteur.accordRadiation}
                                onChange={(e) => setMainleveeData({
                                  ...mainleveeData,
                                  consentementDebiteur: {...mainleveeData.consentementDebiteur, accordRadiation: e.target.checked}
                                })}
                                className="rounded"
                              />
                              <Label htmlFor="accord_rad" className="cursor-pointer">Accord pour la radiation</Label>
                            </div>
                          </div>

                          <div className="space-y-2">
                            <Label>D√©clarations compl√©mentaires</Label>
                            <Textarea
                              rows={3}
                              value={mainleveeData.consentementDebiteur.declarationsComplementaires}
                              onChange={(e) => setMainleveeData({
                                ...mainleveeData,
                                consentementDebiteur: {...mainleveeData.consentementDebiteur, declarationsComplementaires: e.target.value}
                              })}
                              placeholder="Ex: Aucune autre inscription li√©e..."
                            />
                          </div>
                        </>
                      )}
                    </div>
                  </div>

                  {/* 10. Frais et d√©bours */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üí∞ Frais et d√©bours</h3>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                      <div className="space-y-2">
                        <Label>Frais de radiation (‚Ç¨)</Label>
                        <Input
                          type="number"
                          value={mainleveeData.frais.fraisRadiation}
                          onChange={(e) => setMainleveeData({
                            ...mainleveeData,
                            frais: {...mainleveeData.frais, fraisRadiation: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Honoraires (‚Ç¨)</Label>
                        <Input
                          type="number"
                          value={mainleveeData.frais.honoraires}
                          onChange={(e) => setMainleveeData({
                            ...mainleveeData,
                            frais: {...mainleveeData.frais, honoraires: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Timbres fiscaux (‚Ç¨)</Label>
                        <Input
                          type="number"
                          value={mainleveeData.frais.timbresFiscaux}
                          onChange={(e) => setMainleveeData({
                            ...mainleveeData,
                            frais: {...mainleveeData.frais, timbresFiscaux: e.target.value}
                          })}
                        />
                      </div>
                    </div>
                  </div>

                  {/* 11. Pi√®ces justificatives obligatoires */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üìé Pi√®ces justificatives obligatoires</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      {/* Copie acte constitutif */}
                      <div className="space-y-2">
                        <Label>Copie de l'acte constitutif</Label>
                        <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                          <input
                            type="file"
                            accept="application/pdf"
                            multiple
                            className="hidden"
                            id="mainlevee_acte_upload"
                            onChange={(e) => {
                              const files = Array.from(e.target.files || []);
                              setMainleveeActeConstitutifFiles(prev => [...prev, ...files]);
                            }}
                          />
                          <label htmlFor="mainlevee_acte_upload" className="cursor-pointer text-sm text-muted-foreground">
                            Cliquez pour joindre l'acte constitutif
                          </label>
                          {mainleveeActeConstitutifFiles.length > 0 && (
                            <div className="mt-2 space-y-1">
                              {mainleveeActeConstitutifFiles.map((file, idx) => (
                                <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                  <span className="truncate">{file.name}</span>
                                  <button
                                    type="button"
                                    onClick={() => setMainleveeActeConstitutifFiles(prev => prev.filter((_, i) => i !== idx))}
                                    className="text-red-600 ml-2"
                                  >
                                    ‚úï
                                  </button>
                                </div>
                              ))}
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Copie inscription hypoth√©caire */}
                      <div className="space-y-2">
                        <Label>Copie de l'inscription hypoth√©caire (SPF)</Label>
                        <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                          <input
                            type="file"
                            accept="application/pdf"
                            multiple
                            className="hidden"
                            id="mainlevee_inscription_upload"
                            onChange={(e) => {
                              const files = Array.from(e.target.files || []);
                              setMainleveeInscriptionHypothequeFiles(prev => [...prev, ...files]);
                            }}
                          />
                          <label htmlFor="mainlevee_inscription_upload" className="cursor-pointer text-sm text-muted-foreground">
                            Cliquez pour joindre l'inscription
                          </label>
                          {mainleveeInscriptionHypothequeFiles.length > 0 && (
                            <div className="mt-2 space-y-1">
                              {mainleveeInscriptionHypothequeFiles.map((file, idx) => (
                                <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                  <span className="truncate">{file.name}</span>
                                  <button
                                    type="button"
                                    onClick={() => setMainleveeInscriptionHypothequeFiles(prev => prev.filter((_, i) => i !== idx))}
                                    className="text-red-600 ml-2"
                                  >
                                    ‚úï
                                  </button>
                                </div>
                              ))}
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Attestation remboursement */}
                      <div className="space-y-2 md:col-span-2">
                        <Label>Attestation de remboursement total du pr√™t</Label>
                        <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                          <input
                            type="file"
                            accept="application/pdf"
                            multiple
                            className="hidden"
                            id="mainlevee_attestation_upload"
                            onChange={(e) => {
                              const files = Array.from(e.target.files || []);
                              setMainleveeAttestationRemboursementFiles(prev => [...prev, ...files]);
                            }}
                          />
                          <label htmlFor="mainlevee_attestation_upload" className="cursor-pointer text-sm text-muted-foreground">
                            Cliquez pour joindre l'attestation de remboursement
                          </label>
                          {mainleveeAttestationRemboursementFiles.length > 0 && (
                            <div className="mt-2 space-y-1">
                              {mainleveeAttestationRemboursementFiles.map((file, idx) => (
                                <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                  <span className="truncate">{file.name}</span>
                                  <button
                                    type="button"
                                    onClick={() => setMainleveeAttestationRemboursementFiles(prev => prev.filter((_, i) => i !== idx))}
                                    className="text-red-600 ml-2"
                                  >
                                    ‚úï
                                  </button>
                                </div>
                              ))}
                            </div>
                          )}
                        </div>
                      </div>
                    </div>
                  </div>

                </div>
              </>
            )}

            {/* Formulaire sp√©cifique pour Contrat de mariage (r√©gimes matrimoniaux) */}
            {pendingContractType === "Contrat de mariage (r√©gimes matrimoniaux)" && (
              <>
                <div className="space-y-6 max-h-[60vh] overflow-y-auto px-1">
                  {/* 1. Informations g√©n√©rales sur le contrat */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üìã Informations g√©n√©rales</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label>Type de r√©gime matrimonial *</Label>
                        <Select 
                          value={contratMariageData.typeRegime} 
                          onValueChange={(value) => setContratMariageData({...contratMariageData, typeRegime: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="separation_biens">S√©paration de biens</SelectItem>
                            <SelectItem value="communaute_acquets">Communaut√© r√©duite aux acqu√™ts</SelectItem>
                            <SelectItem value="communaute_acquets_amenagee">Communaut√© r√©duite aux acqu√™ts am√©nag√©e</SelectItem>
                            <SelectItem value="communaute_universelle">Communaut√© universelle</SelectItem>
                            <SelectItem value="participation_acquets">Participation aux acqu√™ts</SelectItem>
                            <SelectItem value="autre">Autre am√©nagement</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {contratMariageData.typeRegime === "autre" && (
                        <div className="space-y-2 md:col-span-2">
                          <Label>Pr√©ciser le r√©gime</Label>
                          <Input
                            value={contratMariageData.autreRegimePrecision}
                            onChange={(e) => setContratMariageData({...contratMariageData, autreRegimePrecision: e.target.value})}
                            placeholder="Ex: Communaut√© de meubles et acqu√™ts..."
                          />
                        </div>
                      )}

                      {/* Date pr√©vue du mariage */}
                      <div className="space-y-2 md:col-span-2">
                        <Label className="flex items-center gap-2">
                          üìÖ Date pr√©vue du mariage
                          <span className="text-red-500">*</span>
                        </Label>
                        <Input
                          type="date"
                          value={contratMariageData.dateMariagePrevue}
                          onChange={(e) => setContratMariageData({...contratMariageData, dateMariagePrevue: e.target.value})}
                        />
                        <p className="text-xs text-muted-foreground">Le mariage sera c√©l√©br√© le...</p>
                      </div>

                      {/* Lieu pr√©vu du mariage */}
                      <div className="space-y-4 md:col-span-2 p-4 border rounded-lg bg-muted/30">
                        <h4 className="font-medium flex items-center gap-2">
                          üìç Lieu pr√©vu du mariage
                          <span className="text-red-500">*</span>
                        </h4>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          <div className="space-y-2">
                            <Label>Mairie</Label>
                            <Input
                              value={contratMariageData.lieuMariage.mairie}
                              onChange={(e) => setContratMariageData({
                                ...contratMariageData,
                                lieuMariage: {...contratMariageData.lieuMariage, mairie: e.target.value}
                              })}
                              placeholder="Ex: Mairie du 8√®me arrondissement"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Commune</Label>
                            <Input
                              value={contratMariageData.lieuMariage.commune}
                              onChange={(e) => setContratMariageData({
                                ...contratMariageData,
                                lieuMariage: {...contratMariageData.lieuMariage, commune: e.target.value}
                              })}
                              placeholder="Ex: Paris"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>D√©partement</Label>
                            <Input
                              value={contratMariageData.lieuMariage.departement}
                              onChange={(e) => setContratMariageData({
                                ...contratMariageData,
                                lieuMariage: {...contratMariageData.lieuMariage, departement: e.target.value}
                              })}
                              placeholder="Ex: Paris (75)"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Pays</Label>
                            <Input
                              value={contratMariageData.lieuMariage.pays}
                              onChange={(e) => setContratMariageData({
                                ...contratMariageData,
                                lieuMariage: {...contratMariageData.lieuMariage, pays: e.target.value}
                              })}
                              placeholder="France"
                            />
                          </div>
                        </div>
                        <p className="text-xs text-muted-foreground">Les futurs √©poux d√©clarent vouloir contracter mariage √† la mairie de...</p>
                      </div>
                    </div>
                  </div>

                  {/* 2. Choix de la loi applicable (cas internationaux) */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üåç Choix de la loi applicable au r√©gime matrimonial</h3>
                    
                    {contratMariageData.epoux.map((epoux, index) => (
                      <div key={epoux.id} className="p-4 border rounded-lg space-y-4">
                        <h4 className="font-medium">√âpoux #{index + 1}</h4>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          {/* S√©lection client */}
                          <div className="space-y-2 md:col-span-2">
                            <Label>S√©lectionner un client (optionnel)</Label>
                            <Select 
                              value={epoux.clientId} 
                              onValueChange={async (value) => {
                                const newEpoux = [...contratMariageData.epoux];
                                newEpoux[index] = {...newEpoux[index], clientId: value, isClient: !!value};
                                
                                if (value) {
                                  const client = clients.find(c => c.id === value);
                                  if (client) {
                                    newEpoux[index].nom = client.nom || "";
                                    newEpoux[index].prenom = client.prenom || "";
                                    newEpoux[index].adresse = client.adresse || "";
                                    newEpoux[index].dateNaissance = client.date_naissance || "";
                                    newEpoux[index].lieuNaissance = client.lieu_naissance || "";
                                    newEpoux[index].nationalite = client.nationalite || "";
                                    newEpoux[index].profession = client.profession || "";
                                    newEpoux[index].typeIdentite = client.type_identite || "";
                                    newEpoux[index].numeroIdentite = client.numero_identite || "";
                                    
                                    // Auto-remplir la situation familiale
                                    let situationFamiliale = client.situation_matrimoniale || "";
                                    if (!situationFamiliale && client.situation_familiale) {
                                      if (typeof client.situation_familiale === 'string') {
                                        situationFamiliale = client.situation_familiale;
                                      } else if (typeof client.situation_familiale === 'object') {
                                        const sitFam = client.situation_familiale as any;
                                        situationFamiliale = sitFam.situation_familiale || "";
                                      }
                                    }
                                    newEpoux[index].situationFamiliale = situationFamiliale;

                                    // Auto-charger le document d'identit√©
                                    if (client.id_doc_path) {
                                      try {
                                        const { data: fileData } = await supabase.storage
                                          .from('client_documents')
                                          .download(client.id_doc_path);
                                        if (fileData) {
                                          const file = new File([fileData], `identite_epoux_${index + 1}.pdf`, { type: 'application/pdf' });
                                          if (index === 0) {
                                            setContratMariageEpoux1IdentiteFiles([file]);
                                          } else {
                                            setContratMariageEpoux2IdentiteFiles([file]);
                                          }
                                        }
                                      } catch (err) {
                                        console.error('Erreur chargement document:', err);
                                      }
                                    }
                                  }
                                }
                                setContratMariageData({...contratMariageData, epoux: newEpoux});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner un client..." /></SelectTrigger>
                              <SelectContent>
                                {clients.map(client => (
                                  <SelectItem key={client.id} value={client.id}>
                                    {client.nom} {client.prenom}
                                  </SelectItem>
                                ))}
                              </SelectContent>
                            </Select>
                          </div>

                          <div className="space-y-2">
                            <Label>Nom *</Label>
                            <Input
                              value={epoux.nom}
                              onChange={(e) => {
                                const newEpoux = [...contratMariageData.epoux];
                                newEpoux[index] = {...newEpoux[index], nom: e.target.value};
                                setContratMariageData({...contratMariageData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Pr√©nom *</Label>
                            <Input
                              value={epoux.prenom}
                              onChange={(e) => {
                                const newEpoux = [...contratMariageData.epoux];
                                newEpoux[index] = {...newEpoux[index], prenom: e.target.value};
                                setContratMariageData({...contratMariageData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2 md:col-span-2">
                            <Label>Adresse</Label>
                            <Input
                              value={epoux.adresse}
                              onChange={(e) => {
                                const newEpoux = [...contratMariageData.epoux];
                                newEpoux[index] = {...newEpoux[index], adresse: e.target.value};
                                setContratMariageData({...contratMariageData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Date de naissance</Label>
                            <Input
                              type="date"
                              value={epoux.dateNaissance}
                              onChange={(e) => {
                                const newEpoux = [...contratMariageData.epoux];
                                newEpoux[index] = {...newEpoux[index], dateNaissance: e.target.value};
                                setContratMariageData({...contratMariageData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Lieu de naissance</Label>
                            <Input
                              value={epoux.lieuNaissance}
                              onChange={(e) => {
                                const newEpoux = [...contratMariageData.epoux];
                                newEpoux[index] = {...newEpoux[index], lieuNaissance: e.target.value};
                                setContratMariageData({...contratMariageData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Nationalit√©</Label>
                            <Input
                              value={epoux.nationalite}
                              onChange={(e) => {
                                const newEpoux = [...contratMariageData.epoux];
                                newEpoux[index] = {...newEpoux[index], nationalite: e.target.value};
                                setContratMariageData({...contratMariageData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Profession</Label>
                            <Input
                              value={epoux.profession}
                              onChange={(e) => {
                                const newEpoux = [...contratMariageData.epoux];
                                newEpoux[index] = {...newEpoux[index], profession: e.target.value};
                                setContratMariageData({...contratMariageData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2 md:col-span-2">
                            <Label>Situation familiale</Label>
                            <Select 
                              value={epoux.situationFamiliale} 
                              onValueChange={(value) => {
                                const newEpoux = [...contratMariageData.epoux];
                                newEpoux[index] = {...newEpoux[index], situationFamiliale: value};
                                setContratMariageData({...contratMariageData, epoux: newEpoux});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="celibataire">C√©libataire</SelectItem>
                                <SelectItem value="divorce">Divorc√©(e)</SelectItem>
                                <SelectItem value="veuf">Veuf/Veuve</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          <div className="space-y-2 md:col-span-2">
                            <Label>Domicile apr√®s mariage (si diff√©rent de l'adresse)</Label>
                            <Input
                              value={epoux.domicileApresMariage}
                              onChange={(e) => {
                                const newEpoux = [...contratMariageData.epoux];
                                newEpoux[index] = {...newEpoux[index], domicileApresMariage: e.target.value};
                                setContratMariageData({...contratMariageData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2 md:col-span-2">
                            <Label>Mariage ant√©rieur hors de France ?</Label>
                            <RadioGroup
                              value={epoux.mariageAnterieurtHorsFrance}
                              onValueChange={(value) => {
                                const newEpoux = [...contratMariageData.epoux];
                                newEpoux[index] = {...newEpoux[index], mariageAnterieurtHorsFrance: value};
                                setContratMariageData({...contratMariageData, epoux: newEpoux});
                              }}
                            >
                              <div className="flex gap-4">
                                <div className="flex items-center space-x-2">
                                  <RadioGroupItem value="oui" id={`mariage_etr_oui_${index}`} />
                                  <Label htmlFor={`mariage_etr_oui_${index}`} className="cursor-pointer">Oui</Label>
                                </div>
                                <div className="flex items-center space-x-2">
                                  <RadioGroupItem value="non" id={`mariage_etr_non_${index}`} />
                                  <Label htmlFor={`mariage_etr_non_${index}`} className="cursor-pointer">Non</Label>
                                </div>
                              </div>
                            </RadioGroup>
                          </div>

                          {epoux.mariageAnterieurtHorsFrance === "oui" && (
                            <>
                              <div className="space-y-2">
                                <Label>Date du premier mariage</Label>
                                <Input
                                  type="date"
                                  value={epoux.datePremierMariage}
                                  onChange={(e) => {
                                    const newEpoux = [...contratMariageData.epoux];
                                    newEpoux[index] = {...newEpoux[index], datePremierMariage: e.target.value};
                                    setContratMariageData({...contratMariageData, epoux: newEpoux});
                                  }}
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Lieu du premier mariage</Label>
                                <Input
                                  value={epoux.lieuPremierMariage}
                                  onChange={(e) => {
                                    const newEpoux = [...contratMariageData.epoux];
                                    newEpoux[index] = {...newEpoux[index], lieuPremierMariage: e.target.value};
                                    setContratMariageData({...contratMariageData, epoux: newEpoux});
                                  }}
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>R√©gime matrimonial initial</Label>
                                <Input
                                  value={epoux.regimeMatrimonialInitial}
                                  onChange={(e) => {
                                    const newEpoux = [...contratMariageData.epoux];
                                    newEpoux[index] = {...newEpoux[index], regimeMatrimonialInitial: e.target.value};
                                    setContratMariageData({...contratMariageData, epoux: newEpoux});
                                  }}
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Acte d'√©tat civil √©tranger</Label>
                                <Input
                                  value={epoux.acteEtatCivilEtranger}
                                  onChange={(e) => {
                                    const newEpoux = [...contratMariageData.epoux];
                                    newEpoux[index] = {...newEpoux[index], acteEtatCivilEtranger: e.target.value};
                                    setContratMariageData({...contratMariageData, epoux: newEpoux});
                                  }}
                                  placeholder="Nom du fichier ou r√©f√©rence"
                                />
                              </div>
                            </>
                          )}
                        </div>
                      </div>
                    ))}
                  </div>

                  {/* 2bis. Choix de la loi applicable (cas internationaux) */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üåç Choix de la loi applicable au r√©gime matrimonial</h3>
                    <p className="text-sm text-muted-foreground">Pour les couples de nationalit√©s diff√©rentes ou r√©sidant √† l'√©tranger</p>
                    
                    <div className="grid grid-cols-1 gap-4">
                      <div className="space-y-2">
                        <Label>Loi applicable *</Label>
                        <RadioGroup
                          value={contratMariageData.choixLoiApplicable}
                          onValueChange={(value) => setContratMariageData({...contratMariageData, choixLoiApplicable: value})}
                        >
                          <div className="flex flex-col gap-2">
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="loi_francaise" id="loi_fr" />
                              <Label htmlFor="loi_fr" className="cursor-pointer">Loi fran√ßaise</Label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="loi_residence" id="loi_res" />
                              <Label htmlFor="loi_res" className="cursor-pointer">Loi de la r√©sidence habituelle</Label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="loi_nationalite" id="loi_nat" />
                              <Label htmlFor="loi_nat" className="cursor-pointer">Loi de la nationalit√©</Label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <RadioGroupItem value="autre" id="loi_autre" />
                              <Label htmlFor="loi_autre" className="cursor-pointer">Autre (pr√©ciser)</Label>
                            </div>
                          </div>
                        </RadioGroup>
                      </div>

                      {contratMariageData.choixLoiApplicable === "autre" && (
                        <div className="space-y-2">
                          <Label>Pr√©ciser la loi applicable</Label>
                          <Input
                            value={contratMariageData.choixLoiApplicableAutre}
                            onChange={(e) => setContratMariageData({...contratMariageData, choixLoiApplicableAutre: e.target.value})}
                            placeholder="Ex: Loi suisse, loi belge..."
                          />
                        </div>
                      )}
                    </div>
                  </div>

                  {/* 2ter. Consentement des enfants majeurs - SUPPRIM√â (changement r√©gime uniquement) */}
                  {false && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">‚úçÔ∏è Consentement des enfants majeurs</h3>
                      <p className="text-sm text-muted-foreground">Obligatoire en cas de changement de r√©gime matrimonial</p>
                      
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2 md:col-span-2">
                          <Label>Consentement des enfants majeurs requis ? *</Label>
                          <RadioGroup
                            value={contratMariageData.consentementEnfantsMajeursRequis}
                            onValueChange={(value) => setContratMariageData({...contratMariageData, consentementEnfantsMajeursRequis: value})}
                          >
                            <div className="flex gap-4">
                              <div className="flex items-center space-x-2">
                                <RadioGroupItem value="oui" id="consent_oui" />
                                <Label htmlFor="consent_oui" className="cursor-pointer">Oui</Label>
                              </div>
                              <div className="flex items-center space-x-2">
                                <RadioGroupItem value="non" id="consent_non" />
                                <Label htmlFor="consent_non" className="cursor-pointer">Non</Label>
                              </div>
                            </div>
                          </RadioGroup>
                        </div>

                        {contratMariageData.consentementEnfantsMajeursRequis === "oui" && (
                          <div className="space-y-2 md:col-span-2">
                            <Label>Joindre le consentement des enfants majeurs (PDF)</Label>
                            <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                              <input
                                type="file"
                                accept="application/pdf"
                                multiple
                                className="hidden"
                                id="cm_consent_enfants"
                                onChange={(e) => {
                                  const files = Array.from(e.target.files || []);
                                  setContratMariageConsentementEnfantsFiles(prev => [...prev, ...files]);
                                }}
                              />
                              <label htmlFor="cm_consent_enfants" className="cursor-pointer text-sm text-muted-foreground">
                                Cliquez pour joindre
                              </label>
                              {contratMariageConsentementEnfantsFiles.length > 0 && (
                                <div className="mt-2 space-y-1">
                                  {contratMariageConsentementEnfantsFiles.map((file, idx) => (
                                    <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                      <span className="truncate">{file.name}</span>
                                      <button
                                        type="button"
                                        onClick={() => setContratMariageConsentementEnfantsFiles(prev => prev.filter((_, i) => i !== idx))}
                                        className="text-red-600 ml-2"
                                      >
                                        ‚úï
                                      </button>
                                    </div>
                                  ))}
                                </div>
                              )}
                            </div>
                          </div>
                        )}
                      </div>
                    </div>
                  )}

                  {/* 2quater. Biens communs actuels - SUPPRIM√â (changement r√©gime uniquement) */}
                  {false && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">üè† Biens communs actuels</h3>
                      <p className="text-sm text-muted-foreground">N√©cessaire si vous changez depuis un r√©gime de communaut√©</p>
                      
                      <div className="space-y-4">
                        {contratMariageData.biensCommuns.map((bien, idx) => (
                          <div key={bien.id} className="grid grid-cols-1 md:grid-cols-3 gap-2 p-3 border rounded">
                            <div className="space-y-2">
                              <Label>Description du bien</Label>
                              <Input
                                placeholder="Ex: Appartement Paris 15e"
                                value={bien.description}
                                onChange={(e) => {
                                  const newBiens = [...contratMariageData.biensCommuns];
                                  newBiens[idx] = {...newBiens[idx], description: e.target.value};
                                  setContratMariageData({...contratMariageData, biensCommuns: newBiens});
                                }}
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Valeur estim√©e (‚Ç¨)</Label>
                              <Input
                                type="number"
                                placeholder="250000"
                                value={bien.valeurEstimee}
                                onChange={(e) => {
                                  const newBiens = [...contratMariageData.biensCommuns];
                                  newBiens[idx] = {...newBiens[idx], valeurEstimee: e.target.value};
                                  setContratMariageData({...contratMariageData, biensCommuns: newBiens});
                                }}
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>R√©partition envisag√©e</Label>
                              <Input
                                placeholder="50/50 ou liquidation"
                                value={bien.repartitionEnvisagee}
                                onChange={(e) => {
                                  const newBiens = [...contratMariageData.biensCommuns];
                                  newBiens[idx] = {...newBiens[idx], repartitionEnvisagee: e.target.value};
                                  setContratMariageData({...contratMariageData, biensCommuns: newBiens});
                                }}
                              />
                            </div>
                          </div>
                        ))}
                        <Button
                          type="button"
                          variant="outline"
                          size="sm"
                          className="w-full text-orange-600 hover:text-orange-700 hover:bg-orange-50 border-orange-300"
                          onClick={() => {
                            const newId = Math.max(...contratMariageData.biensCommuns.map(b => b.id), 0) + 1;
                            setContratMariageData({
                              ...contratMariageData,
                              biensCommuns: [...contratMariageData.biensCommuns, {
                                id: newId,
                                description: "",
                                valeurEstimee: "",
                                repartitionEnvisagee: "",
                              }]
                            });
                          }}
                        >
                          + Ajouter un bien commun
                        </Button>
                      </div>
                    </div>
                  )}

                  {/* 2quinquies. Consentement du juge - SUPPRIM√â (changement r√©gime uniquement) */}
                  {false && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">‚öñÔ∏è Consentement du juge</h3>
                      <p className="text-sm text-muted-foreground">Requis si vous avez des enfants mineurs et changez de r√©gime</p>
                      
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2 md:col-span-2">
                          <Label>Accord du juge requis ? *</Label>
                          <RadioGroup
                            value={contratMariageData.accordJugeRequis}
                            onValueChange={(value) => setContratMariageData({...contratMariageData, accordJugeRequis: value})}
                          >
                            <div className="flex gap-4">
                              <div className="flex items-center space-x-2">
                                <RadioGroupItem value="oui" id="juge_oui" />
                                <Label htmlFor="juge_oui" className="cursor-pointer">Oui</Label>
                              </div>
                              <div className="flex items-center space-x-2">
                                <RadioGroupItem value="non" id="juge_non" />
                                <Label htmlFor="juge_non" className="cursor-pointer">Non</Label>
                              </div>
                            </div>
                          </RadioGroup>
                        </div>

                        {contratMariageData.accordJugeRequis === "oui" && (
                          <div className="space-y-2 md:col-span-2">
                            <Label>Joindre la d√©cision / autorisation judiciaire (PDF)</Label>
                            <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                              <input
                                type="file"
                                accept="application/pdf"
                                multiple
                                className="hidden"
                                id="cm_decision_juge"
                                onChange={(e) => {
                                  const files = Array.from(e.target.files || []);
                                  setContratMariageDecisionJugeFiles(prev => [...prev, ...files]);
                                }}
                              />
                              <label htmlFor="cm_decision_juge" className="cursor-pointer text-sm text-muted-foreground">
                                Cliquez pour joindre
                              </label>
                              {contratMariageDecisionJugeFiles.length > 0 && (
                                <div className="mt-2 space-y-1">
                                  {contratMariageDecisionJugeFiles.map((file, idx) => (
                                    <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                      <span className="truncate">{file.name}</span>
                                      <button
                                        type="button"
                                        onClick={() => setContratMariageDecisionJugeFiles(prev => prev.filter((_, i) => i !== idx))}
                                        className="text-red-600 ml-2"
                                      >
                                        ‚úï
                                      </button>
                                    </div>
                                  ))}
                                </div>
                              )}
                            </div>
                          </div>
                        )}
                      </div>
                    </div>
                  )}

                  {/* 3. Informations sur les enfants */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üë∂ Informations sur les enfants</h3>
                    <p className="text-sm text-muted-foreground">Obligatoire pour les changements de r√©gime matrimonial</p>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Nombre d'enfants</Label>
                        <Input
                          type="number"
                          value={contratMariageData.nombreEnfants}
                          onChange={(e) => setContratMariageData({...contratMariageData, nombreEnfants: e.target.value})}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Enfants mineurs (mention)</Label>
                        <Input
                          value={contratMariageData.enfantsMineurs}
                          onChange={(e) => setContratMariageData({...contratMariageData, enfantsMineurs: e.target.value})}
                          placeholder="Ex: 2 enfants mineurs"
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Information au juge n√©cessaire ?</Label>
                        <Input
                          value={contratMariageData.informationJugeNecessaire}
                          onChange={(e) => setContratMariageData({...contratMariageData, informationJugeNecessaire: e.target.value})}
                          placeholder="Oui / Non"
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Enfants majeurs (si applicable)</Label>
                        {contratMariageData.enfantsMajeurs.map((enfant, idx) => (
                          <div key={enfant.id} className="grid grid-cols-1 md:grid-cols-3 gap-2 p-2 border rounded">
                            <Input
                              placeholder="Nom"
                              value={enfant.nom}
                              onChange={(e) => {
                                const newEnfants = [...contratMariageData.enfantsMajeurs];
                                newEnfants[idx] = {...newEnfants[idx], nom: e.target.value};
                                setContratMariageData({...contratMariageData, enfantsMajeurs: newEnfants});
                              }}
                            />
                            <Input
                              placeholder="Pr√©nom"
                              value={enfant.prenom}
                              onChange={(e) => {
                                const newEnfants = [...contratMariageData.enfantsMajeurs];
                                newEnfants[idx] = {...newEnfants[idx], prenom: e.target.value};
                                setContratMariageData({...contratMariageData, enfantsMajeurs: newEnfants});
                              }}
                            />
                            <Input
                              placeholder="Accord/Information re√ßue"
                              value={enfant.accordInformation}
                              onChange={(e) => {
                                const newEnfants = [...contratMariageData.enfantsMajeurs];
                                newEnfants[idx] = {...newEnfants[idx], accordInformation: e.target.value};
                                setContratMariageData({...contratMariageData, enfantsMajeurs: newEnfants});
                              }}
                            />
                          </div>
                        ))}
                        <Button
                          type="button"
                          variant="outline"
                          size="sm"
                          className="w-full text-orange-600 hover:text-orange-700 hover:bg-orange-50 border-orange-300"
                          onClick={() => {
                            const newId = Math.max(...contratMariageData.enfantsMajeurs.map(e => e.id), 0) + 1;
                            setContratMariageData({
                              ...contratMariageData,
                              enfantsMajeurs: [...contratMariageData.enfantsMajeurs, {
                                id: newId,
                                nom: "",
                                prenom: "",
                                adresse: "",
                                accordInformation: "",
                              }]
                            });
                          }}
                        >
                          + Ajouter un enfant majeur
                        </Button>
                      </div>
                    </div>
                  </div>

                  {/* 4. Patrimoine des √©poux */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üí∞ Patrimoine actuel des √©poux</h3>
                    <p className="text-sm text-muted-foreground">N√©cessaire pour participation aux acqu√™ts ou communaut√© am√©nag√©e</p>
                    
                    {/* √âpoux 1 */}
                    <div className="p-4 border rounded-lg space-y-4">
                      <h4 className="font-medium">Patrimoine √âpoux 1</h4>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <Label>Biens propres (avant mariage)</Label>
                          <Textarea
                            rows={2}
                            value={contratMariageData.patrimoineEpoux1.biensPropres}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              patrimoineEpoux1: {...contratMariageData.patrimoineEpoux1, biensPropres: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Biens acquis pendant mariage</Label>
                          <Textarea
                            rows={2}
                            value={contratMariageData.patrimoineEpoux1.biensAcquisPendantMariage}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              patrimoineEpoux1: {...contratMariageData.patrimoineEpoux1, biensAcquisPendantMariage: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Valeur estim√©e totale (‚Ç¨)</Label>
                          <Input
                            type="number"
                            value={contratMariageData.patrimoineEpoux1.valeurEstimee}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              patrimoineEpoux1: {...contratMariageData.patrimoineEpoux1, valeurEstimee: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Dettes personnelles (‚Ç¨)</Label>
                          <Input
                            type="number"
                            value={contratMariageData.patrimoineEpoux1.dettesPersonnelles}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              patrimoineEpoux1: {...contratMariageData.patrimoineEpoux1, dettesPersonnelles: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Masse de d√©part (patrimoine initial)</Label>
                          <Input
                            value={contratMariageData.patrimoineEpoux1.masseDepart}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              patrimoineEpoux1: {...contratMariageData.patrimoineEpoux1, masseDepart: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Masse de fin (patrimoine final)</Label>
                          <Input
                            value={contratMariageData.patrimoineEpoux1.masseFin}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              patrimoineEpoux1: {...contratMariageData.patrimoineEpoux1, masseFin: e.target.value}
                            })}
                          />
                        </div>
                      </div>
                    </div>

                    {/* √âpoux 2 */}
                    <div className="p-4 border rounded-lg space-y-4">
                      <h4 className="font-medium">Patrimoine √âpoux 2</h4>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <Label>Biens propres (avant mariage)</Label>
                          <Textarea
                            rows={2}
                            value={contratMariageData.patrimoineEpoux2.biensPropres}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              patrimoineEpoux2: {...contratMariageData.patrimoineEpoux2, biensPropres: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Biens acquis pendant mariage</Label>
                          <Textarea
                            rows={2}
                            value={contratMariageData.patrimoineEpoux2.biensAcquisPendantMariage}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              patrimoineEpoux2: {...contratMariageData.patrimoineEpoux2, biensAcquisPendantMariage: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Valeur estim√©e totale (‚Ç¨)</Label>
                          <Input
                            type="number"
                            value={contratMariageData.patrimoineEpoux2.valeurEstimee}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              patrimoineEpoux2: {...contratMariageData.patrimoineEpoux2, valeurEstimee: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Dettes personnelles (‚Ç¨)</Label>
                          <Input
                            type="number"
                            value={contratMariageData.patrimoineEpoux2.dettesPersonnelles}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              patrimoineEpoux2: {...contratMariageData.patrimoineEpoux2, dettesPersonnelles: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Masse de d√©part (patrimoine initial)</Label>
                          <Input
                            value={contratMariageData.patrimoineEpoux2.masseDepart}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              patrimoineEpoux2: {...contratMariageData.patrimoineEpoux2, masseDepart: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Masse de fin (patrimoine final)</Label>
                          <Input
                            value={contratMariageData.patrimoineEpoux2.masseFin}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              patrimoineEpoux2: {...contratMariageData.patrimoineEpoux2, masseFin: e.target.value}
                            })}
                          />
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* 4bis. Liquidation du r√©gime matrimonial actuel - SUPPRIM√â (changement r√©gime uniquement) */}
                  {false && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">üì¶ Liquidation du r√©gime matrimonial actuel</h3>
                      <p className="text-sm text-muted-foreground">Obligatoire si vous quittez un r√©gime communautaire</p>
                      
                      <div className="space-y-4">
                        {/* Question principale */}
                        <div className="space-y-2">
                          <Label>Liquidation du r√©gime actuel pr√©vue dans l'acte ? *</Label>
                          <RadioGroup
                            value={contratMariageData.liquidationRegimeActuel}
                            onValueChange={(value) => setContratMariageData({...contratMariageData, liquidationRegimeActuel: value})}
                          >
                            <div className="flex gap-4">
                              <div className="flex items-center space-x-2">
                                <RadioGroupItem value="oui" id="liquid_oui" />
                                <Label htmlFor="liquid_oui" className="cursor-pointer">Oui</Label>
                              </div>
                              <div className="flex items-center space-x-2">
                                <RadioGroupItem value="non" id="liquid_non" />
                                <Label htmlFor="liquid_non" className="cursor-pointer">Non</Label>
                              </div>
                            </div>
                          </RadioGroup>
                        </div>

                        {contratMariageData.liquidationRegimeActuel === "oui" && (
                          <>
                            {/* Biens communs existants */}
                            <div className="space-y-3 p-4 border rounded-lg bg-muted/30">
                              <h4 className="font-medium">üè† Biens communs existants (avant le changement)</h4>
                              <p className="text-xs text-muted-foreground">Lister les biens appartenant aux deux √©poux en communaut√©</p>
                              
                              {contratMariageData.biensCommuns.map((bien, idx) => (
                                <div key={bien.id} className="grid grid-cols-1 md:grid-cols-2 gap-3 p-3 border rounded bg-background">
                                  <div className="space-y-2 md:col-span-2">
                                    <Label>Bien #{idx + 1} - Description</Label>
                                    <Input
                                      placeholder="Ex: Appartement 3 pi√®ces Paris 15e"
                                      value={bien.description}
                                      onChange={(e) => {
                                        const newBiens = [...contratMariageData.biensCommuns];
                                        newBiens[idx] = {...newBiens[idx], description: e.target.value};
                                        setContratMariageData({...contratMariageData, biensCommuns: newBiens});
                                      }}
                                    />
                                  </div>
                                  <div className="space-y-2">
                                    <Label>Valeur estim√©e (‚Ç¨)</Label>
                                    <Input
                                      type="number"
                                      placeholder="250000"
                                      value={bien.valeurEstimee}
                                      onChange={(e) => {
                                        const newBiens = [...contratMariageData.biensCommuns];
                                        newBiens[idx] = {...newBiens[idx], valeurEstimee: e.target.value};
                                        setContratMariageData({...contratMariageData, biensCommuns: newBiens});
                                      }}
                                    />
                                  </div>
                                  <div className="space-y-2">
                                    <Label>Dettes attach√©es au bien</Label>
                                    <Input
                                      type="number"
                                      placeholder="150000"
                                      value={bien.dettesAttachees}
                                      onChange={(e) => {
                                        const newBiens = [...contratMariageData.biensCommuns];
                                        newBiens[idx] = {...newBiens[idx], dettesAttachees: e.target.value};
                                        setContratMariageData({...contratMariageData, biensCommuns: newBiens});
                                      }}
                                    />
                                  </div>
                                  <div className="space-y-2 md:col-span-2">
                                    <Label>Affectation pr√©vue</Label>
                                    <Select 
                                      value={bien.affectationPrevue} 
                                      onValueChange={(value) => {
                                        const newBiens = [...contratMariageData.biensCommuns];
                                        newBiens[idx] = {...newBiens[idx], affectationPrevue: value};
                                        setContratMariageData({...contratMariageData, biensCommuns: newBiens});
                                      }}
                                    >
                                      <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                      <SelectContent>
                                        <SelectItem value="epoux1">Attribu√© √† √âpoux 1</SelectItem>
                                        <SelectItem value="epoux2">Attribu√© √† √âpoux 2</SelectItem>
                                        <SelectItem value="vente">Vente du bien</SelectItem>
                                        <SelectItem value="indivision">Maintien en indivision</SelectItem>
                                      </SelectContent>
                                    </Select>
                                  </div>
                                </div>
                              ))}
                              <Button
                                type="button"
                                variant="outline"
                                size="sm"
                                className="w-full text-orange-600 hover:text-orange-700 hover:bg-orange-50 border-orange-300"
                                onClick={() => {
                                  const newId = Math.max(...contratMariageData.biensCommuns.map(b => b.id), 0) + 1;
                                  setContratMariageData({
                                    ...contratMariageData,
                                    biensCommuns: [...contratMariageData.biensCommuns, {
                                      id: newId,
                                      description: "",
                                      valeurEstimee: "",
                                      dettesAttachees: "",
                                      affectationPrevue: "",
                                      repartitionEnvisagee: "",
                                    }]
                                  });
                                }}
                              >
                                + Ajouter un bien commun
                              </Button>
                            </div>

                            {/* Passif commun */}
                            <div className="space-y-3 p-4 border rounded-lg bg-muted/30">
                              <h4 className="font-medium">üí≥ Passif commun √† r√©partir</h4>
                              <p className="text-xs text-muted-foreground">Cr√©dits, dettes m√©nag√®res, pr√™ts en cours, comptes courants</p>
                              
                              {contratMariageData.passifCommun.map((dette, idx) => (
                                <div key={dette.id} className="grid grid-cols-1 md:grid-cols-3 gap-3 p-3 border rounded bg-background">
                                  <div className="space-y-2">
                                    <Label>Dette #{idx + 1} - Description</Label>
                                    <Input
                                      placeholder="Ex: Cr√©dit auto"
                                      value={dette.description}
                                      onChange={(e) => {
                                        const newDettes = [...contratMariageData.passifCommun];
                                        newDettes[idx] = {...newDettes[idx], description: e.target.value};
                                        setContratMariageData({...contratMariageData, passifCommun: newDettes});
                                      }}
                                    />
                                  </div>
                                  <div className="space-y-2">
                                    <Label>Montant (‚Ç¨)</Label>
                                    <Input
                                      type="number"
                                      placeholder="15000"
                                      value={dette.montant}
                                      onChange={(e) => {
                                        const newDettes = [...contratMariageData.passifCommun];
                                        newDettes[idx] = {...newDettes[idx], montant: e.target.value};
                                        setContratMariageData({...contratMariageData, passifCommun: newDettes});
                                      }}
                                    />
                                  </div>
                                  <div className="space-y-2">
                                    <Label>Mode de r√©partition</Label>
                                    <Select 
                                      value={dette.modeRepartition} 
                                      onValueChange={(value) => {
                                        const newDettes = [...contratMariageData.passifCommun];
                                        newDettes[idx] = {...newDettes[idx], modeRepartition: value};
                                        setContratMariageData({...contratMariageData, passifCommun: newDettes});
                                      }}
                                    >
                                      <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                      <SelectContent>
                                        <SelectItem value="epoux1">Pris en charge par √âpoux 1</SelectItem>
                                        <SelectItem value="epoux2">Pris en charge par √âpoux 2</SelectItem>
                                        <SelectItem value="50_50">R√©partition 50/50</SelectItem>
                                      </SelectContent>
                                    </Select>
                                  </div>
                                </div>
                              ))}
                              <Button
                                type="button"
                                variant="outline"
                                size="sm"
                                className="w-full text-orange-600 hover:text-orange-700 hover:bg-orange-50 border-orange-300"
                                onClick={() => {
                                  const newId = Math.max(...contratMariageData.passifCommun.map(d => d.id), 0) + 1;
                                  setContratMariageData({
                                    ...contratMariageData,
                                    passifCommun: [...contratMariageData.passifCommun, {
                                      id: newId,
                                      description: "",
                                      montant: "",
                                      modeRepartition: "",
                                    }]
                                  });
                                }}
                              >
                                + Ajouter une dette
                              </Button>
                            </div>

                            {/* Soulte */}
                            <div className="space-y-3 p-4 border rounded-lg bg-muted/30">
                              <h4 className="font-medium">üí∞ Soulte √©ventuelle</h4>
                              <p className="text-xs text-muted-foreground">Si l'un re√ßoit plus de biens que l'autre</p>
                              
                              <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <div className="space-y-2 md:col-span-2">
                                  <Label>Soulte due ?</Label>
                                  <RadioGroup
                                    value={contratMariageData.soulte.soulteDue}
                                    onValueChange={(value) => setContratMariageData({
                                      ...contratMariageData,
                                      soulte: {...contratMariageData.soulte, soulteDue: value}
                                    })}
                                  >
                                    <div className="flex gap-4">
                                      <div className="flex items-center space-x-2">
                                        <RadioGroupItem value="oui" id="soulte_oui" />
                                        <Label htmlFor="soulte_oui" className="cursor-pointer">Oui</Label>
                                      </div>
                                      <div className="flex items-center space-x-2">
                                        <RadioGroupItem value="non" id="soulte_non" />
                                        <Label htmlFor="soulte_non" className="cursor-pointer">Non</Label>
                                      </div>
                                    </div>
                                  </RadioGroup>
                                </div>

                                {contratMariageData.soulte.soulteDue === "oui" && (
                                  <>
                                    <div className="space-y-2">
                                      <Label>Montant de la soulte (‚Ç¨)</Label>
                                      <Input
                                        type="number"
                                        value={contratMariageData.soulte.montantSoulte}
                                        onChange={(e) => setContratMariageData({
                                          ...contratMariageData,
                                          soulte: {...contratMariageData.soulte, montantSoulte: e.target.value}
                                        })}
                                      />
                                    </div>
                                    <div className="space-y-2">
                                      <Label>√âpoux d√©biteur</Label>
                                      <Select 
                                        value={contratMariageData.soulte.epouxDebiteur} 
                                        onValueChange={(value) => setContratMariageData({
                                          ...contratMariageData,
                                          soulte: {...contratMariageData.soulte, epouxDebiteur: value}
                                        })}
                                      >
                                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                        <SelectContent>
                                          <SelectItem value="epoux1">√âpoux 1</SelectItem>
                                          <SelectItem value="epoux2">√âpoux 2</SelectItem>
                                        </SelectContent>
                                      </Select>
                                    </div>
                                    <div className="space-y-2">
                                      <Label>Modalit√©s de paiement</Label>
                                      <RadioGroup
                                        value={contratMariageData.soulte.modalitesPaiement}
                                        onValueChange={(value) => setContratMariageData({
                                          ...contratMariageData,
                                          soulte: {...contratMariageData.soulte, modalitesPaiement: value}
                                        })}
                                      >
                                        <div className="flex gap-4">
                                          <div className="flex items-center space-x-2">
                                            <RadioGroupItem value="comptant" id="paiement_comptant" />
                                            <Label htmlFor="paiement_comptant" className="cursor-pointer">Comptant</Label>
                                          </div>
                                          <div className="flex items-center space-x-2">
                                            <RadioGroupItem value="echelonne" id="paiement_echelonne" />
                                            <Label htmlFor="paiement_echelonne" className="cursor-pointer">Paiement √©chelonn√©</Label>
                                          </div>
                                        </div>
                                      </RadioGroup>
                                    </div>
                                    <div className="space-y-2">
                                      <Label>Date limite de paiement</Label>
                                      <Input
                                        type="date"
                                        value={contratMariageData.soulte.dateLimitePaiement}
                                        onChange={(e) => setContratMariageData({
                                          ...contratMariageData,
                                          soulte: {...contratMariageData.soulte, dateLimitePaiement: e.target.value}
                                        })}
                                      />
                                    </div>
                                  </>
                                )}
                              </div>
                            </div>

                            {/* Actifs financiers */}
                            <div className="space-y-3 p-4 border rounded-lg bg-muted/30">
                              <h4 className="font-medium">üè¶ Actifs financiers communs</h4>
                              <p className="text-xs text-muted-foreground">Comptes bancaires, placements, livrets, assurances-vie si communs</p>
                              
                              {contratMariageData.actifsFinanciers.map((actif, idx) => (
                                <div key={actif.id} className="grid grid-cols-1 md:grid-cols-2 gap-3 p-3 border rounded bg-background">
                                  <div className="space-y-2">
                                    <Label>Nature du compte</Label>
                                    <Input
                                      placeholder="Ex: Compte joint, Livret A"
                                      value={actif.natureCompte}
                                      onChange={(e) => {
                                        const newActifs = [...contratMariageData.actifsFinanciers];
                                        newActifs[idx] = {...newActifs[idx], natureCompte: e.target.value};
                                        setContratMariageData({...contratMariageData, actifsFinanciers: newActifs});
                                      }}
                                    />
                                  </div>
                                  <div className="space-y-2">
                                    <Label>√âtablissement bancaire</Label>
                                    <Input
                                      placeholder="Ex: Cr√©dit Agricole"
                                      value={actif.etablissement}
                                      onChange={(e) => {
                                        const newActifs = [...contratMariageData.actifsFinanciers];
                                        newActifs[idx] = {...newActifs[idx], etablissement: e.target.value};
                                        setContratMariageData({...contratMariageData, actifsFinanciers: newActifs});
                                      }}
                                    />
                                  </div>
                                  <div className="space-y-2">
                                    <Label>Solde (‚Ç¨)</Label>
                                    <Input
                                      type="number"
                                      placeholder="25000"
                                      value={actif.solde}
                                      onChange={(e) => {
                                        const newActifs = [...contratMariageData.actifsFinanciers];
                                        newActifs[idx] = {...newActifs[idx], solde: e.target.value};
                                        setContratMariageData({...contratMariageData, actifsFinanciers: newActifs});
                                      }}
                                    />
                                  </div>
                                  <div className="space-y-2">
                                    <Label>Mode de partage</Label>
                                    <Select 
                                      value={actif.modePartage} 
                                      onValueChange={(value) => {
                                        const newActifs = [...contratMariageData.actifsFinanciers];
                                        newActifs[idx] = {...newActifs[idx], modePartage: value};
                                        setContratMariageData({...contratMariageData, actifsFinanciers: newActifs});
                                      }}
                                    >
                                      <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                      <SelectContent>
                                        <SelectItem value="epoux1">Attribu√© √† √âpoux 1</SelectItem>
                                        <SelectItem value="epoux2">Attribu√© √† √âpoux 2</SelectItem>
                                        <SelectItem value="personnalise">R√©partition personnalis√©e</SelectItem>
                                      </SelectContent>
                                    </Select>
                                  </div>
                                  {actif.modePartage === "personnalise" && (
                                    <div className="space-y-2 md:col-span-2">
                                      <Label>Pr√©ciser la r√©partition</Label>
                                      <Input
                                        placeholder="Ex: 60% √âpoux 1, 40% √âpoux 2"
                                        value={actif.partagePersonnalise}
                                        onChange={(e) => {
                                          const newActifs = [...contratMariageData.actifsFinanciers];
                                          newActifs[idx] = {...newActifs[idx], partagePersonnalise: e.target.value};
                                          setContratMariageData({...contratMariageData, actifsFinanciers: newActifs});
                                        }}
                                      />
                                    </div>
                                  )}
                                </div>
                              ))}
                              <Button
                                type="button"
                                variant="outline"
                                size="sm"
                                className="w-full text-orange-600 hover:text-orange-700 hover:bg-orange-50 border-orange-300"
                                onClick={() => {
                                  const newId = Math.max(...contratMariageData.actifsFinanciers.map(a => a.id), 0) + 1;
                                  setContratMariageData({
                                    ...contratMariageData,
                                    actifsFinanciers: [...contratMariageData.actifsFinanciers, {
                                      id: newId,
                                      natureCompte: "",
                                      etablissement: "",
                                      solde: "",
                                      modePartage: "",
                                      partagePersonnalise: "",
                                    }]
                                  });
                                }}
                              >
                                + Ajouter un actif financier
                              </Button>
                            </div>

                            {/* Observations */}
                            <div className="space-y-2">
                              <Label>üìù Observations compl√©mentaires</Label>
                              <Textarea
                                rows={4}
                                value={contratMariageData.observationsLiquidation}
                                onChange={(e) => setContratMariageData({...contratMariageData, observationsLiquidation: e.target.value})}
                                placeholder="Avantage matrimonial ant√©rieur, biens indivis post-liquidation, modalit√©s particuli√®res..."
                              />
                            </div>
                          </>
                        )}
                      </div>
                    </div>
                  )}

                  {/* 5. Clauses selon le r√©gime choisi */}
                  {contratMariageData.typeRegime === "separation_biens" && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">üìù Clauses - S√©paration de biens</h3>
                      <div className="grid grid-cols-1 gap-4">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="admin_exclusive"
                            checked={contratMariageData.clausesSeparation.administrationExclusive}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              clausesSeparation: {...contratMariageData.clausesSeparation, administrationExclusive: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="admin_exclusive" className="cursor-pointer">Administration et jouissance exclusives par chaque √©poux</Label>
                        </div>

                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="comptes_sep"
                            checked={contratMariageData.clausesSeparation.comptesSepares}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              clausesSeparation: {...contratMariageData.clausesSeparation, comptesSepares: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="comptes_sep" className="cursor-pointer">Comptes bancaires s√©par√©s</Label>
                        </div>

                        <div className="space-y-2">
                          <Label>Contribution aux charges du mariage</Label>
                          <Select 
                            value={contratMariageData.clausesSeparation.contributionCharges} 
                            onValueChange={(value) => setContratMariageData({
                              ...contratMariageData,
                              clausesSeparation: {...contratMariageData.clausesSeparation, contributionCharges: value}
                            })}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="proportionnelle">Proportionnelle aux revenus</SelectItem>
                              <SelectItem value="50_50">50/50</SelectItem>
                              <SelectItem value="autre">Autre</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>

                        {contratMariageData.clausesSeparation.contributionCharges === "autre" && (
                          <div className="space-y-2">
                            <Label>Pr√©ciser</Label>
                            <Input
                              value={contratMariageData.clausesSeparation.contributionChargesAutre}
                              onChange={(e) => setContratMariageData({
                                ...contratMariageData,
                                clausesSeparation: {...contratMariageData.clausesSeparation, contributionChargesAutre: e.target.value}
                              })}
                            />
                          </div>
                        )}

                        <div className="space-y-2">
                          <Label>Mise en commun √©ventuelle d'un bien</Label>
                          <Textarea
                            rows={2}
                            value={contratMariageData.clausesSeparation.miseEnCommunBien}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              clausesSeparation: {...contratMariageData.clausesSeparation, miseEnCommunBien: e.target.value}
                            })}
                          />
                        </div>
                      </div>
                    </div>
                  )}

                  {contratMariageData.typeRegime === "communaute_acquets_amenagee" && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">üìù Clauses - Communaut√© am√©nag√©e</h3>
                      <div className="grid grid-cols-1 gap-4">
                        <div className="space-y-2">
                          <Label>D√©finition des biens communs et propres</Label>
                          <Textarea
                            rows={3}
                            value={contratMariageData.clausesCommunauteAmenagee.definitionBiensCommunsPropres}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              clausesCommunauteAmenagee: {...contratMariageData.clausesCommunauteAmenagee, definitionBiensCommunsPropres: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Am√©nagement des biens professionnels</Label>
                          <Textarea
                            rows={2}
                            value={contratMariageData.clausesCommunauteAmenagee.amenagementBiensProfessionnels}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              clausesCommunauteAmenagee: {...contratMariageData.clausesCommunauteAmenagee, amenagementBiensProfessionnels: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Type d'administration</Label>
                          <RadioGroup
                            value={contratMariageData.clausesCommunauteAmenagee.typeAdministration}
                            onValueChange={(value) => setContratMariageData({
                              ...contratMariageData,
                              clausesCommunauteAmenagee: {...contratMariageData.clausesCommunauteAmenagee, typeAdministration: value}
                            })}
                          >
                            <div className="flex gap-4">
                              <div className="flex items-center space-x-2">
                                <RadioGroupItem value="symetriques" id="admin_sym" />
                                <Label htmlFor="admin_sym" className="cursor-pointer">Pouvoirs sym√©triques</Label>
                              </div>
                              <div className="flex items-center space-x-2">
                                <RadioGroupItem value="unique" id="admin_uniq" />
                                <Label htmlFor="admin_uniq" className="cursor-pointer">Pouvoir unique pour certains biens</Label>
                              </div>
                            </div>
                          </RadioGroup>
                        </div>

                        {contratMariageData.clausesCommunauteAmenagee.typeAdministration === "unique" && (
                          <div className="space-y-2">
                            <Label>D√©tails du pouvoir unique</Label>
                            <Textarea
                              rows={2}
                              value={contratMariageData.clausesCommunauteAmenagee.pouvoirUniqueDetails}
                              onChange={(e) => setContratMariageData({
                                ...contratMariageData,
                                clausesCommunauteAmenagee: {...contratMariageData.clausesCommunauteAmenagee, pouvoirUniqueDetails: e.target.value}
                              })}
                            />
                          </div>
                        )}
                      </div>
                    </div>
                  )}

                  {contratMariageData.typeRegime === "communaute_universelle" && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">üìù Clauses - Communaut√© universelle</h3>
                      <div className="grid grid-cols-1 gap-4">
                        <div className="space-y-2">
                          <Label>Clause d'attribution int√©grale au survivant</Label>
                          <RadioGroup
                            value={contratMariageData.clausesCommunauteUniverselle.attributionIntegraleSurvivant}
                            onValueChange={(value) => setContratMariageData({
                              ...contratMariageData,
                              clausesCommunauteUniverselle: {...contratMariageData.clausesCommunauteUniverselle, attributionIntegraleSurvivant: value}
                            })}
                          >
                            <div className="flex gap-4">
                              <div className="flex items-center space-x-2">
                                <RadioGroupItem value="oui" id="attrib_oui" />
                                <Label htmlFor="attrib_oui" className="cursor-pointer">Oui</Label>
                              </div>
                              <div className="flex items-center space-x-2">
                                <RadioGroupItem value="non" id="attrib_non" />
                                <Label htmlFor="attrib_non" className="cursor-pointer">Non</Label>
                              </div>
                            </div>
                          </RadioGroup>
                        </div>

                        <div className="space-y-2">
                          <Label>Clause de pr√©ciput (le survivant prend un bien avant partage)</Label>
                          <Textarea
                            rows={2}
                            value={contratMariageData.clausesCommunauteUniverselle.clausesPreciput}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              clausesCommunauteUniverselle: {...contratMariageData.clausesCommunauteUniverselle, clausesPreciput: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Exclusion de certains biens</Label>
                          <Textarea
                            rows={2}
                            value={contratMariageData.clausesCommunauteUniverselle.exclusionCertainsBiens}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              clausesCommunauteUniverselle: {...contratMariageData.clausesCommunauteUniverselle, exclusionCertainsBiens: e.target.value}
                            })}
                            placeholder="Ex: h√©ritages, biens professionnels..."
                          />
                        </div>
                      </div>
                    </div>
                  )}

                  {contratMariageData.typeRegime === "participation_acquets" && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">üìù Clauses - Participation aux acqu√™ts</h3>
                      <div className="grid grid-cols-1 gap-4">
                        <div className="space-y-2">
                          <Label>D√©finition des patrimoines originels</Label>
                          <Textarea
                            rows={2}
                            value={contratMariageData.clausesParticipation.definitionPatrimoinesOriginels}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              clausesParticipation: {...contratMariageData.clausesParticipation, definitionPatrimoinesOriginels: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>D√©finition du patrimoine final</Label>
                          <Textarea
                            rows={2}
                            value={contratMariageData.clausesParticipation.definitionPatrimoineFinal}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              clausesParticipation: {...contratMariageData.clausesParticipation, definitionPatrimoineFinal: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Calcul de la cr√©ance de participation</Label>
                          <Textarea
                            rows={2}
                            value={contratMariageData.clausesParticipation.calculCreanceParticipation}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              clausesParticipation: {...contratMariageData.clausesParticipation, calculCreanceParticipation: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>D√©termination des biens propres par nature</Label>
                          <Textarea
                            rows={2}
                            value={contratMariageData.clausesParticipation.biensPropresParNature}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              clausesParticipation: {...contratMariageData.clausesParticipation, biensPropresParNature: e.target.value}
                            })}
                          />
                        </div>
                      </div>
                    </div>
                  )}

                  {/* 6. Clauses optionnelles avanc√©es */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">‚öôÔ∏è Clauses optionnelles avanc√©es</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Clause de remploi</Label>
                        <Textarea
                          rows={2}
                          value={contratMariageData.clausesAvancees.clauseRemploi}
                          onChange={(e) => setContratMariageData({
                            ...contratMariageData,
                            clausesAvancees: {...contratMariageData.clausesAvancees, clauseRemploi: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Clause de pr√©ciput</Label>
                        <Textarea
                          rows={2}
                          value={contratMariageData.clausesAvancees.clausePreciput}
                          onChange={(e) => setContratMariageData({
                            ...contratMariageData,
                            clausesAvancees: {...contratMariageData.clausesAvancees, clausePreciput: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Attribution pr√©f√©rentielle de biens</Label>
                        <Textarea
                          rows={2}
                          value={contratMariageData.clausesAvancees.attributionPreferentielle}
                          onChange={(e) => setContratMariageData({
                            ...contratMariageData,
                            clausesAvancees: {...contratMariageData.clausesAvancees, attributionPreferentielle: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Gestion s√©par√©e des biens professionnels</Label>
                        <Textarea
                          rows={2}
                          value={contratMariageData.clausesAvancees.gestionSepareeBiensProfessionnels}
                          onChange={(e) => setContratMariageData({
                            ...contratMariageData,
                            clausesAvancees: {...contratMariageData.clausesAvancees, gestionSepareeBiensProfessionnels: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Protection du conjoint survivant</Label>
                        <Textarea
                          rows={2}
                          value={contratMariageData.clausesAvancees.protectionConjointSurvivant}
                          onChange={(e) => setContratMariageData({
                            ...contratMariageData,
                            clausesAvancees: {...contratMariageData.clausesAvancees, protectionConjointSurvivant: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Donation entre √©poux (si int√©gr√©e)</Label>
                        <Textarea
                          rows={2}
                          value={contratMariageData.clausesAvancees.donationEntreEpoux}
                          onChange={(e) => setContratMariageData({
                            ...contratMariageData,
                            clausesAvancees: {...contratMariageData.clausesAvancees, donationEntreEpoux: e.target.value}
                          })}
                        />
                      </div>
                    </div>
                  </div>

                  {/* 7. D√©clarations obligatoires */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">‚úÖ D√©clarations obligatoires des √©poux</h3>
                    <div className="p-4 bg-muted/30 rounded-lg space-y-3">
                      <p className="text-sm text-muted-foreground">Les √©poux d√©clarent :</p>
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="decl_identite"
                            checked={contratMariageData.declarations.identite}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              declarations: {...contratMariageData.declarations, identite: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="decl_identite" className="cursor-pointer">Leur identit√©</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="decl_capacite"
                            checked={contratMariageData.declarations.capaciteJuridique}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              declarations: {...contratMariageData.declarations, capaciteJuridique: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="decl_capacite" className="cursor-pointer">Leur capacit√© juridique</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="decl_situation"
                            checked={contratMariageData.declarations.situationMatrimoniale}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              declarations: {...contratMariageData.declarations, situationMatrimoniale: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="decl_situation" className="cursor-pointer">Leur situation matrimoniale</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="decl_opposition"
                            checked={contratMariageData.declarations.absenceOpposition}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              declarations: {...contratMariageData.declarations, absenceOpposition: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="decl_opposition" className="cursor-pointer">L'absence d'opposition au mariage</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="decl_choix"
                            checked={contratMariageData.declarations.choixLibreEclaire}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              declarations: {...contratMariageData.declarations, choixLibreEclaire: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="decl_choix" className="cursor-pointer">Leur choix libre et √©clair√© du r√©gime</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="decl_connaissance"
                            checked={contratMariageData.declarations.connaissanceEffetsJuridiques}
                            onChange={(e) => setContratMariageData({
                              ...contratMariageData,
                              declarations: {...contratMariageData.declarations, connaissanceEffetsJuridiques: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="decl_connaissance" className="cursor-pointer">Leur connaissance des effets juridiques du r√©gime</Label>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* 8. Documents √† fournir */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üìé Documents √† fournir</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      {/* √âpoux 1 - Identit√© */}
                      <div className="space-y-2">
                        <Label>√âpoux 1 - Pi√®ce d'identit√©</Label>
                        <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                          <input
                            type="file"
                            accept="application/pdf,image/*"
                            multiple
                            className="hidden"
                            id="cm_epoux1_identite"
                            onChange={(e) => {
                              const files = Array.from(e.target.files || []);
                              setContratMariageEpoux1IdentiteFiles(prev => [...prev, ...files]);
                            }}
                          />
                          <label htmlFor="cm_epoux1_identite" className="cursor-pointer text-sm text-muted-foreground">
                            Cliquez pour joindre
                          </label>
                          {contratMariageEpoux1IdentiteFiles.length > 0 && (
                            <div className="mt-2 space-y-1">
                              {contratMariageEpoux1IdentiteFiles.map((file, idx) => (
                                <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                  <span className="truncate">{file.name}</span>
                                  <button
                                    type="button"
                                    onClick={() => setContratMariageEpoux1IdentiteFiles(prev => prev.filter((_, i) => i !== idx))}
                                    className="text-red-600 ml-2"
                                  >
                                    ‚úï
                                  </button>
                                </div>
                              ))}
                            </div>
                          )}
                        </div>
                      </div>

                      {/* √âpoux 2 - Identit√© */}
                      <div className="space-y-2">
                        <Label>√âpoux 2 - Pi√®ce d'identit√©</Label>
                        <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                          <input
                            type="file"
                            accept="application/pdf,image/*"
                            multiple
                            className="hidden"
                            id="cm_epoux2_identite"
                            onChange={(e) => {
                              const files = Array.from(e.target.files || []);
                              setContratMariageEpoux2IdentiteFiles(prev => [...prev, ...files]);
                            }}
                          />
                          <label htmlFor="cm_epoux2_identite" className="cursor-pointer text-sm text-muted-foreground">
                            Cliquez pour joindre
                          </label>
                          {contratMariageEpoux2IdentiteFiles.length > 0 && (
                            <div className="mt-2 space-y-1">
                              {contratMariageEpoux2IdentiteFiles.map((file, idx) => (
                                <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                  <span className="truncate">{file.name}</span>
                                  <button
                                    type="button"
                                    onClick={() => setContratMariageEpoux2IdentiteFiles(prev => prev.filter((_, i) => i !== idx))}
                                    className="text-red-600 ml-2"
                                  >
                                    ‚úï
                                  </button>
                                </div>
                              ))}
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Actes de naissance */}
                      <div className="space-y-2">
                        <Label>√âpoux 1 - Acte de naissance (&lt; 3 mois)</Label>
                        <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                          <input
                            type="file"
                            accept="application/pdf"
                            multiple
                            className="hidden"
                            id="cm_epoux1_naissance"
                            onChange={(e) => {
                              const files = Array.from(e.target.files || []);
                              setContratMariageEpoux1ActeNaissanceFiles(prev => [...prev, ...files]);
                            }}
                          />
                          <label htmlFor="cm_epoux1_naissance" className="cursor-pointer text-sm text-muted-foreground">
                            Cliquez pour joindre
                          </label>
                          {contratMariageEpoux1ActeNaissanceFiles.length > 0 && (
                            <div className="mt-2 space-y-1">
                              {contratMariageEpoux1ActeNaissanceFiles.map((file, idx) => (
                                <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                  <span className="truncate">{file.name}</span>
                                  <button
                                    type="button"
                                    onClick={() => setContratMariageEpoux1ActeNaissanceFiles(prev => prev.filter((_, i) => i !== idx))}
                                    className="text-red-600 ml-2"
                                  >
                                    ‚úï
                                  </button>
                                </div>
                              ))}
                            </div>
                          )}
                        </div>
                      </div>

                      <div className="space-y-2">
                        <Label>√âpoux 2 - Acte de naissance (&lt; 3 mois)</Label>
                        <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                          <input
                            type="file"
                            accept="application/pdf"
                            multiple
                            className="hidden"
                            id="cm_epoux2_naissance"
                            onChange={(e) => {
                              const files = Array.from(e.target.files || []);
                              setContratMariageEpoux2ActeNaissanceFiles(prev => [...prev, ...files]);
                            }}
                          />
                          <label htmlFor="cm_epoux2_naissance" className="cursor-pointer text-sm text-muted-foreground">
                            Cliquez pour joindre
                          </label>
                          {contratMariageEpoux2ActeNaissanceFiles.length > 0 && (
                            <div className="mt-2 space-y-1">
                              {contratMariageEpoux2ActeNaissanceFiles.map((file, idx) => (
                                <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                  <span className="truncate">{file.name}</span>
                                  <button
                                    type="button"
                                    onClick={() => setContratMariageEpoux2ActeNaissanceFiles(prev => prev.filter((_, i) => i !== idx))}
                                    className="text-red-600 ml-2"
                                  >
                                    ‚úï
                                  </button>
                                </div>
                              ))}
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Si changement de r√©gime - SUPPRIM√â */}
                      {false && (
                        <>
                          <div className="space-y-2">
                            <Label>Contrat de mariage initial</Label>
                            <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                              <input
                                type="file"
                                accept="application/pdf"
                                multiple
                                className="hidden"
                                id="cm_contrat_initial"
                                onChange={(e) => {
                                  const files = Array.from(e.target.files || []);
                                  setContratMariageContratInitialFiles(prev => [...prev, ...files]);
                                }}
                              />
                              <label htmlFor="cm_contrat_initial" className="cursor-pointer text-sm text-muted-foreground">
                                Cliquez pour joindre
                              </label>
                              {contratMariageContratInitialFiles.length > 0 && (
                                <div className="mt-2 space-y-1">
                                  {contratMariageContratInitialFiles.map((file, idx) => (
                                    <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                      <span className="truncate">{file.name}</span>
                                      <button
                                        type="button"
                                        onClick={() => setContratMariageContratInitialFiles(prev => prev.filter((_, i) => i !== idx))}
                                        className="text-red-600 ml-2"
                                      >
                                        ‚úï
                                      </button>
                                    </div>
                                  ))}
                                </div>
                              )}
                            </div>
                          </div>

                          <div className="space-y-2">
                            <Label>Accord enfants majeurs</Label>
                            <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                              <input
                                type="file"
                                accept="application/pdf"
                                multiple
                                className="hidden"
                                id="cm_accord_enfants"
                                onChange={(e) => {
                                  const files = Array.from(e.target.files || []);
                                  setContratMariageAccordEnfantsFiles(prev => [...prev, ...files]);
                                }}
                              />
                              <label htmlFor="cm_accord_enfants" className="cursor-pointer text-sm text-muted-foreground">
                                Cliquez pour joindre
                              </label>
                              {contratMariageAccordEnfantsFiles.length > 0 && (
                                <div className="mt-2 space-y-1">
                                  {contratMariageAccordEnfantsFiles.map((file, idx) => (
                                    <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                      <span className="truncate">{file.name}</span>
                                      <button
                                        type="button"
                                        onClick={() => setContratMariageAccordEnfantsFiles(prev => prev.filter((_, i) => i !== idx))}
                                        className="text-red-600 ml-2"
                                      >
                                        ‚úï
                                      </button>
                                    </div>
                                  ))}
                                </div>
                              )}
                            </div>
                          </div>
                        </>
                      )}

                      {/* Certificat de publication des bans */}
                      <div className="space-y-2 md:col-span-2">
                        <Label>Certificat de publication des bans</Label>
                        <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf"
                              multiple
                              className="hidden"
                              id="cm_certificat_bans"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setContratMariageCertificatBansFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="cm_certificat_bans" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {contratMariageCertificatBansFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {contratMariageCertificatBansFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setContratMariageCertificatBansFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                      {/* Documents optionnels */}
                      <div className="space-y-2 md:col-span-2">
                        <Label>Titres de propri√©t√© (si clause sur bien immobilier)</Label>
                        <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                          <input
                            type="file"
                            accept="application/pdf"
                            multiple
                            className="hidden"
                            id="cm_titres"
                            onChange={(e) => {
                              const files = Array.from(e.target.files || []);
                              setContratMariageTitresProprieteFiles(prev => [...prev, ...files]);
                            }}
                          />
                          <label htmlFor="cm_titres" className="cursor-pointer text-sm text-muted-foreground">
                            Cliquez pour joindre
                          </label>
                          {contratMariageTitresProprieteFiles.length > 0 && (
                            <div className="mt-2 space-y-1">
                              {contratMariageTitresProprieteFiles.map((file, idx) => (
                                <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                  <span className="truncate">{file.name}</span>
                                  <button
                                    type="button"
                                    onClick={() => setContratMariageTitresProprieteFiles(prev => prev.filter((_, i) => i !== idx))}
                                    className="text-red-600 ml-2"
                                  >
                                    ‚úï
                                  </button>
                                </div>
                              ))}
                            </div>
                          )}
                        </div>
                      </div>
                    </div>
                  </div>

                </div>
              </>
            )}

            {/* Formulaire sp√©cifique pour PACS */}
            {pendingContractType === "PACS (convention + enregistrement)" && (
              <>
                <div className="space-y-6">
                  <div className="bg-muted/30 p-4 rounded-lg">
                    <h3 className="font-semibold text-lg mb-4">üìã Convention de PACS</h3>
                    <p className="text-sm text-muted-foreground">
                      Compl√©tez les informations n√©cessaires pour la r√©daction de la convention de PACS.
                    </p>
                  </div>

                  {/* 1. Informations g√©n√©rales */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Informations g√©n√©rales sur le PACS</h3>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      {/* Objet du PACS */}
                      <div className="space-y-2">
                        <Label className="flex items-center gap-2">
                          Objet du PACS
                          <span className="text-red-500">*</span>
                        </Label>
                        <Select value={pacsData.objetPacs} onValueChange={(value) => setPacsData({...pacsData, objetPacs: value})}>
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="initial">PACS initial</SelectItem>
                            <SelectItem value="modification">Modification de PACS existant</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {/* R√©gime choisi */}
                      <div className="space-y-2">
                        <Label className="flex items-center gap-2">
                          R√©gime choisi
                          <span className="text-red-500">*</span>
                        </Label>
                        <Select value={pacsData.regimePacs} onValueChange={(value) => setPacsData({...pacsData, regimePacs: value})}>
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="separation">S√©paration de biens (r√©gime l√©gal par d√©faut)</SelectItem>
                            <SelectItem value="indivision">Indivision</SelectItem>
                            <SelectItem value="personnalise">R√©gime personnalis√©</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {/* Date prise d'effet */}
                      <div className="space-y-2">
                        <Label>Date de prise d'effet souhait√©e</Label>
                        <Input
                          type="date"
                          value={pacsData.datePriseEffetSouhaitee}
                          onChange={(e) => setPacsData({...pacsData, datePriseEffetSouhaitee: e.target.value})}
                        />
                        <p className="text-xs text-muted-foreground">Par d√©faut : √† l'enregistrement</p>
                      </div>
                    </div>

                    {/* R√©gime personnalis√© */}
                    {pacsData.regimePacs === "personnalise" && (
                      <div className="space-y-4 p-4 border rounded-lg bg-muted/30">
                        <h4 className="font-medium">R√©gime personnalis√©</h4>
                        <div className="space-y-2">
                          <Label>D√©finition des biens communs</Label>
                          <Textarea
                            value={pacsData.regimePersonnalise.definitionBiensCommuns}
                            onChange={(e) => setPacsData({
                              ...pacsData,
                              regimePersonnalise: {...pacsData.regimePersonnalise, definitionBiensCommuns: e.target.value}
                            })}
                            rows={3}
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>Biens propres</Label>
                          <Textarea
                            value={pacsData.regimePersonnalise.biensPropres}
                            onChange={(e) => setPacsData({
                              ...pacsData,
                              regimePersonnalise: {...pacsData.regimePersonnalise, biensPropres: e.target.value}
                            })}
                            rows={3}
                          />
                        </div>
                      </div>
                    )}
                  </div>

                  {/* 2. Adresse commune */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Adresse commune (obligatoire)</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label className="flex items-center gap-2">
                          Adresse commune d√©clar√©e
                          <span className="text-red-500">*</span>
                        </Label>
                        <Input
                          value={pacsData.adresseCommune}
                          onChange={(e) => setPacsData({...pacsData, adresseCommune: e.target.value})}
                          placeholder="Adresse compl√®te de r√©sidence commune"
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Date de d√©but de r√©sidence commune</Label>
                        <Input
                          type="date"
                          value={pacsData.dateDebutResidenceCommune}
                          onChange={(e) => setPacsData({...pacsData, dateDebutResidenceCommune: e.target.value})}
                        />
                      </div>
                    </div>
                  </div>

                  {/* 3. D√©clarations obligatoires */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">D√©clarations sur l'honneur (obligatoires)</h3>
                    <div className="space-y-3 p-4 border rounded-lg">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="decl1"
                          checked={pacsData.declarations.residenceCommune}
                          onChange={(e) => setPacsData({
                            ...pacsData,
                            declarations: {...pacsData.declarations, residenceCommune: e.target.checked}
                          })}
                        />
                        <label htmlFor="decl1" className="text-sm">
                          D√©claration de r√©sidence commune <span className="text-red-500">*</span>
                        </label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="decl2"
                          checked={pacsData.declarations.absenceLienParente}
                          onChange={(e) => setPacsData({
                            ...pacsData,
                            declarations: {...pacsData.declarations, absenceLienParente: e.target.checked}
                          })}
                        />
                        <label htmlFor="decl2" className="text-sm">
                          D√©claration d'absence de lien de parent√© <span className="text-red-500">*</span>
                        </label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="decl3"
                          checked={pacsData.declarations.absenceMariageEtPacs}
                          onChange={(e) => setPacsData({
                            ...pacsData,
                            declarations: {...pacsData.declarations, absenceMariageEtPacs: e.target.checked}
                          })}
                        />
                        <label htmlFor="decl3" className="text-sm">
                          D√©claration d'absence de mariage et PACS en cours <span className="text-red-500">*</span>
                        </label>
                      </div>
                    </div>
                  </div>

                  {/* 4. Identit√© des partenaires */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Identit√© compl√®te des partenaires</h3>
                    
                    {pacsData.partenaires.map((partenaire, index) => (
                      <div key={partenaire.id} className="p-4 border rounded-lg space-y-4 bg-muted/20">
                        <h4 className="font-medium text-base">Partenaire #{index + 1}</h4>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          {/* S√©lection client */}
                          <div className="space-y-2 md:col-span-2">
                            <Label>S√©lectionner un client (optionnel)</Label>
                            <Select 
                              value={partenaire.clientId} 
                              onValueChange={async (value) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index] = {...newPartenaires[index], clientId: value, isClient: !!value};
                                
                                if (value) {
                                  const client = clients.find(c => c.id === value);
                                  if (client) {
                                    newPartenaires[index].nom = client.nom || "";
                                    newPartenaires[index].prenom = client.prenom || "";
                                    newPartenaires[index].nomNaissance = client.nom || "";
                                    newPartenaires[index].adresseActuelle = client.adresse || "";
                                    newPartenaires[index].dateNaissance = client.date_naissance || "";
                                    newPartenaires[index].lieuNaissance = client.lieu_naissance || "";
                                    newPartenaires[index].nationalite = client.nationalite || "";
                                    newPartenaires[index].profession = client.profession || "";
                                    newPartenaires[index].telephone = client.telephone || "";
                                    newPartenaires[index].email = client.email || "";
                                    newPartenaires[index].typeIdentite = client.type_identite || "";
                                    newPartenaires[index].numeroIdentite = client.numero_identite || "";
                                    
                                    // Extraire la situation familiale de l'objet JSON
                                    let situationFamiliale = "";
                                    if (typeof client.situation_familiale === 'object' && client.situation_familiale !== null) {
                                      situationFamiliale = client.situation_familiale.situation_familiale || "";
                                    } else if (typeof client.situation_familiale === 'string') {
                                      situationFamiliale = client.situation_familiale;
                                    }
                                    newPartenaires[index].situationFamiliale = situationFamiliale || client.situation_matrimoniale || "";
                                  }
                                }
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="Choisir un client..." /></SelectTrigger>
                              <SelectContent>
                                {clients.map((c) => (
                                  <SelectItem key={c.id} value={c.id}>
                                    {c.nom} {c.prenom}
                                  </SelectItem>
                                ))}
                              </SelectContent>
                            </Select>
                          </div>

                          {/* Informations civiles */}
                          <div className="space-y-2">
                            <Label>Nom <span className="text-red-500">*</span></Label>
                            <Input
                              value={partenaire.nom}
                              onChange={(e) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index].nom = e.target.value;
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                            <Input
                              value={partenaire.prenom}
                              onChange={(e) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index].prenom = e.target.value;
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Nom de naissance</Label>
                            <Input
                              value={partenaire.nomNaissance}
                              onChange={(e) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index].nomNaissance = e.target.value;
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Date de naissance <span className="text-red-500">*</span></Label>
                            <Input
                              type="date"
                              value={partenaire.dateNaissance}
                              onChange={(e) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index].dateNaissance = e.target.value;
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Lieu de naissance <span className="text-red-500">*</span></Label>
                            <Input
                              value={partenaire.lieuNaissance}
                              onChange={(e) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index].lieuNaissance = e.target.value;
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Nationalit√© <span className="text-red-500">*</span></Label>
                            <Input
                              value={partenaire.nationalite}
                              onChange={(e) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index].nationalite = e.target.value;
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Profession</Label>
                            <Input
                              value={partenaire.profession}
                              onChange={(e) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index].profession = e.target.value;
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>T√©l√©phone</Label>
                            <Input
                              value={partenaire.telephone}
                              onChange={(e) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index].telephone = e.target.value;
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Email</Label>
                            <Input
                              type="email"
                              value={partenaire.email}
                              onChange={(e) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index].email = e.target.value;
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                            />
                          </div>

                          <div className="space-y-2 md:col-span-2">
                            <Label>Adresse actuelle <span className="text-red-500">*</span></Label>
                            <Input
                              value={partenaire.adresseActuelle}
                              onChange={(e) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index].adresseActuelle = e.target.value;
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                            />
                          </div>

                          {/* Situation familiale */}
                          <div className="space-y-2">
                            <Label>Situation familiale actuelle <span className="text-red-500">*</span></Label>
                            <Select 
                              value={partenaire.situationFamiliale}
                              onValueChange={(value) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index].situationFamiliale = value;
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="celibataire">C√©libataire</SelectItem>
                                <SelectItem value="divorce">Divorc√©(e)</SelectItem>
                                <SelectItem value="veuf">Veuf/Veuve</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          {/* Pi√®ce d'identit√© */}
                          <div className="space-y-2">
                            <Label>Type de pi√®ce d'identit√©</Label>
                            <Select 
                              value={partenaire.typeIdentite}
                              onValueChange={(value) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index].typeIdentite = value;
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="CNI">Carte Nationale d'Identit√©</SelectItem>
                                <SelectItem value="Passeport">Passeport</SelectItem>
                                <SelectItem value="Titre de s√©jour">Titre de s√©jour</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          <div className="space-y-2">
                            <Label>Num√©ro de pi√®ce d'identit√©</Label>
                            <Input
                              value={partenaire.numeroIdentite}
                              onChange={(e) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index].numeroIdentite = e.target.value;
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Date d'√©mission</Label>
                            <Input
                              type="date"
                              value={partenaire.dateEmissionIdentite}
                              onChange={(e) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index].dateEmissionIdentite = e.target.value;
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Autorit√© d√©livrante</Label>
                            <Input
                              value={partenaire.autoriteDelivrante}
                              onChange={(e) => {
                                const newPartenaires = [...pacsData.partenaires];
                                newPartenaires[index].autoriteDelivrante = e.target.value;
                                setPacsData({...pacsData, partenaires: newPartenaires});
                              }}
                              placeholder="Ex: Pr√©fecture de Paris"
                            />
                          </div>

                          {/* Partenaire √©tranger */}
                          <div className="space-y-2 md:col-span-2">
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id={`etranger-${index}`}
                                checked={partenaire.estEtranger}
                                onChange={(e) => {
                                  const newPartenaires = [...pacsData.partenaires];
                                  newPartenaires[index].estEtranger = e.target.checked;
                                  setPacsData({...pacsData, partenaires: newPartenaires});
                                }}
                              />
                              <label htmlFor={`etranger-${index}`} className="text-sm font-medium">
                                Partenaire √©tranger (n√©cessite documents suppl√©mentaires)
                              </label>
                            </div>
                          </div>

                          {partenaire.estEtranger && (
                            <div className="md:col-span-2 p-3 bg-yellow-50 border border-yellow-200 rounded space-y-2">
                              <p className="text-sm font-medium text-yellow-800">Documents suppl√©mentaires requis :</p>
                              <div className="space-y-2">
                                <div className="flex items-center space-x-2">
                                  <input
                                    type="checkbox"
                                    id={`attestation-${index}`}
                                    checked={partenaire.attestationNonPacsPaysOrigine}
                                    onChange={(e) => {
                                      const newPartenaires = [...pacsData.partenaires];
                                      newPartenaires[index].attestationNonPacsPaysOrigine = e.target.checked;
                                      setPacsData({...pacsData, partenaires: newPartenaires});
                                    }}
                                  />
                                  <label htmlFor={`attestation-${index}`} className="text-sm">Attestation de non-PACS du pays d'origine</label>
                                </div>
                                <div className="flex items-center space-x-2">
                                  <input
                                    type="checkbox"
                                    id={`coutume-${index}`}
                                    checked={partenaire.certificatCoutumeRequis}
                                    onChange={(e) => {
                                      const newPartenaires = [...pacsData.partenaires];
                                      newPartenaires[index].certificatCoutumeRequis = e.target.checked;
                                      setPacsData({...pacsData, partenaires: newPartenaires});
                                    }}
                                  />
                                  <label htmlFor={`coutume-${index}`} className="text-sm">Certificat de coutume</label>
                                </div>
                                <div className="flex items-center space-x-2">
                                  <input
                                    type="checkbox"
                                    id={`traduction-${index}`}
                                    checked={partenaire.traductionRequise}
                                    onChange={(e) => {
                                      const newPartenaires = [...pacsData.partenaires];
                                      newPartenaires[index].traductionRequise = e.target.checked;
                                      setPacsData({...pacsData, partenaires: newPartenaires});
                                    }}
                                  />
                                  <label htmlFor={`traduction-${index}`} className="text-sm">Traductions certifi√©es n√©cessaires</label>
                                </div>
                              </div>
                            </div>
                          )}
                        </div>
                      </div>
                    ))}
                  </div>

                  {/* 5. Modification de PACS (si applicable) */}
                  {pacsData.objetPacs === "modification" && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">R√©f√©rence du PACS initial</h3>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <Label>Date du PACS initial</Label>
                          <Input
                            type="date"
                            value={pacsData.pacsInitialDate}
                            onChange={(e) => setPacsData({...pacsData, pacsInitialDate: e.target.value})}
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>Mairie ou notaire d'enregistrement</Label>
                          <Input
                            value={pacsData.pacsInitialMairie}
                            onChange={(e) => setPacsData({...pacsData, pacsInitialMairie: e.target.value})}
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>Num√©ro d'enregistrement (si connu)</Label>
                          <Input
                            value={pacsData.pacsInitialNumero}
                            onChange={(e) => setPacsData({...pacsData, pacsInitialNumero: e.target.value})}
                          />
                        </div>
                        <div className="space-y-2 md:col-span-2">
                          <Label>Clauses modifi√©es</Label>
                          <Textarea
                            value={pacsData.clausesModifiees}
                            onChange={(e) => setPacsData({...pacsData, clausesModifiees: e.target.value})}
                            rows={4}
                            placeholder="D√©crivez les modifications apport√©es..."
                          />
                        </div>
                      </div>
                    </div>
                  )}

                  {/* 6. Clauses du PACS */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Clauses du PACS</h3>
                    
                    {/* A. Contribution aux charges */}
                    <div className="space-y-3 p-4 border rounded-lg">
                      <h4 className="font-medium">A. Contribution aux charges du m√©nage (obligatoire)</h4>
                      <div className="space-y-2">
                        <Select 
                          value={pacsData.contributionCharges}
                          onValueChange={(value) => setPacsData({...pacsData, contributionCharges: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="proportionnelle">Proportionnelle aux revenus</SelectItem>
                            <SelectItem value="50_50">50/50</SelectItem>
                            <SelectItem value="autre">Autre (pr√©ciser)</SelectItem>
                          </SelectContent>
                        </Select>
                        {pacsData.contributionCharges === "autre" && (
                          <Input
                            value={pacsData.contributionChargesAutre}
                            onChange={(e) => setPacsData({...pacsData, contributionChargesAutre: e.target.value})}
                            placeholder="Pr√©cisez la r√©partition..."
                          />
                        )}
                      </div>
                    </div>

                    {/* B. Clauses facultatives */}
                    <div className="space-y-3 p-4 border rounded-lg bg-muted/20">
                      <h4 className="font-medium">B. Clauses facultatives</h4>
                      
                      <div className="space-y-2">
                        <Label>Gestion des biens personnels</Label>
                        <Textarea
                          value={pacsData.clausesFacultatives.gestionBiensPersonnels}
                          onChange={(e) => setPacsData({
                            ...pacsData,
                            clausesFacultatives: {...pacsData.clausesFacultatives, gestionBiensPersonnels: e.target.value}
                          })}
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Gestion d'un bien commun</Label>
                        <Textarea
                          value={pacsData.clausesFacultatives.gestionBienCommun}
                          onChange={(e) => setPacsData({
                            ...pacsData,
                            clausesFacultatives: {...pacsData.clausesFacultatives, gestionBienCommun: e.target.value}
                          })}
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Usage d'un bien indivis</Label>
                        <Textarea
                          value={pacsData.clausesFacultatives.usageBienIndivis}
                          onChange={(e) => setPacsData({
                            ...pacsData,
                            clausesFacultatives: {...pacsData.clausesFacultatives, usageBienIndivis: e.target.value}
                          })}
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>R√©partition de d√©penses sp√©cifiques</Label>
                        <Textarea
                          value={pacsData.clausesFacultatives.repartitionDepensesSpecifiques}
                          onChange={(e) => setPacsData({
                            ...pacsData,
                            clausesFacultatives: {...pacsData.clausesFacultatives, repartitionDepensesSpecifiques: e.target.value}
                          })}
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Clause d'occupation du logement en cas de s√©paration</Label>
                        <Textarea
                          value={pacsData.clausesFacultatives.clauseOccupationLogementSeparation}
                          onChange={(e) => setPacsData({
                            ...pacsData,
                            clausesFacultatives: {...pacsData.clausesFacultatives, clauseOccupationLogementSeparation: e.target.value}
                          })}
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Clause de reprise de bien en cas de d√©c√®s</Label>
                        <Textarea
                          value={pacsData.clausesFacultatives.clauseRepriseBienDeces}
                          onChange={(e) => setPacsData({
                            ...pacsData,
                            clausesFacultatives: {...pacsData.clausesFacultatives, clauseRepriseBienDeces: e.target.value}
                          })}
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Clause d'abandon de cr√©ance entre partenaires</Label>
                        <Textarea
                          value={pacsData.clausesFacultatives.clauseAbandonCreance}
                          onChange={(e) => setPacsData({
                            ...pacsData,
                            clausesFacultatives: {...pacsData.clausesFacultatives, clauseAbandonCreance: e.target.value}
                          })}
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Modalit√©s d'utilisation d'un compte bancaire commun</Label>
                        <Textarea
                          value={pacsData.clausesFacultatives.modalitesCompteBancaireCommun}
                          onChange={(e) => setPacsData({
                            ...pacsData,
                            clausesFacultatives: {...pacsData.clausesFacultatives, modalitesCompteBancaireCommun: e.target.value}
                          })}
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Clauses financi√®res personnalis√©es</Label>
                        <Textarea
                          value={pacsData.clausesFacultatives.clausesFinancieresPersonnalisees}
                          onChange={(e) => setPacsData({
                            ...pacsData,
                            clausesFacultatives: {...pacsData.clausesFacultatives, clausesFinancieresPersonnalisees: e.target.value}
                          })}
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Clauses de solidarit√© sur certaines dettes</Label>
                        <Textarea
                          value={pacsData.clausesFacultatives.clausesSolidariteDettes}
                          onChange={(e) => setPacsData({
                            ...pacsData,
                            clausesFacultatives: {...pacsData.clausesFacultatives, clausesSolidariteDettes: e.target.value}
                          })}
                          rows={2}
                        />
                      </div>
                    </div>
                  </div>

                  {/* 7. Enfants en commun */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Enfant(s) en commun (optionnel)</h3>
                    <div className="space-y-2">
                      <Label>Avez-vous un ou plusieurs enfants en commun ?</Label>
                      <Select 
                        value={pacsData.enfantEnCommun}
                        onValueChange={(value) => setPacsData({...pacsData, enfantEnCommun: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="non">Non</SelectItem>
                          <SelectItem value="oui">Oui</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    {pacsData.enfantEnCommun === "oui" && (
                      <div className="space-y-4">
                        {pacsData.enfants.map((enfant, idx) => (
                          <div key={enfant.id} className="p-4 border rounded-lg space-y-3 bg-muted/10">
                            <div className="flex justify-between items-center">
                              <h5 className="font-medium">Enfant #{idx + 1}</h5>
                              {idx > 0 && (
                                <button
                                  type="button"
                                  onClick={() => {
                                    const newEnfants = pacsData.enfants.filter((_, i) => i !== idx);
                                    setPacsData({...pacsData, enfants: newEnfants});
                                  }}
                                  className="text-red-600 text-sm"
                                >
                                  Supprimer
                                </button>
                              )}
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                              <div className="space-y-2">
                                <Label>Nom</Label>
                                <Input
                                  value={enfant.nom}
                                  onChange={(e) => {
                                    const newEnfants = [...pacsData.enfants];
                                    newEnfants[idx].nom = e.target.value;
                                    setPacsData({...pacsData, enfants: newEnfants});
                                  }}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Pr√©nom</Label>
                                <Input
                                  value={enfant.prenom}
                                  onChange={(e) => {
                                    const newEnfants = [...pacsData.enfants];
                                    newEnfants[idx].prenom = e.target.value;
                                    setPacsData({...pacsData, enfants: newEnfants});
                                  }}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Date de naissance</Label>
                                <Input
                                  type="date"
                                  value={enfant.dateNaissance}
                                  onChange={(e) => {
                                    const newEnfants = [...pacsData.enfants];
                                    newEnfants[idx].dateNaissance = e.target.value;
                                    setPacsData({...pacsData, enfants: newEnfants});
                                  }}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Autorit√© parentale</Label>
                                <Input
                                  value={enfant.autoriteParentale}
                                  onChange={(e) => {
                                    const newEnfants = [...pacsData.enfants];
                                    newEnfants[idx].autoriteParentale = e.target.value;
                                    setPacsData({...pacsData, enfants: newEnfants});
                                  }}
                                  placeholder="Conjointe / Exclusive / Autre"
                                />
                              </div>
                            </div>
                          </div>
                        ))}
                        <Button
                          type="button"
                          variant="outline"
                          onClick={() => {
                            setPacsData({
                              ...pacsData,
                              enfants: [...pacsData.enfants, {
                                id: pacsData.enfants.length + 1,
                                nom: "",
                                prenom: "",
                                dateNaissance: "",
                                autoriteParentale: "",
                              }]
                            });
                          }}
                        >
                          + Ajouter un enfant
                        </Button>
                      </div>
                    )}
                  </div>

                  {/* 8. Biens pr√©existants */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Biens d√©j√† acquis ensemble</h3>
                    <div className="space-y-2">
                      <Label>Avez-vous d√©j√† des biens acquis ensemble ?</Label>
                      <Select 
                        value={pacsData.biensPreexistants}
                        onValueChange={(value) => setPacsData({...pacsData, biensPreexistants: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="non">Non</SelectItem>
                          <SelectItem value="oui">Oui</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    {pacsData.biensPreexistants === "oui" && (
                      <div className="space-y-4">
                        {pacsData.biensListe.map((bien, idx) => (
                          <div key={bien.id} className="p-4 border rounded-lg space-y-3 bg-muted/10">
                            <div className="flex justify-between items-center">
                              <h5 className="font-medium">Bien #{idx + 1}</h5>
                              {idx > 0 && (
                                <button
                                  type="button"
                                  onClick={() => {
                                    const newBiens = pacsData.biensListe.filter((_, i) => i !== idx);
                                    setPacsData({...pacsData, biensListe: newBiens});
                                  }}
                                  className="text-red-600 text-sm"
                                >
                                  Supprimer
                                </button>
                              )}
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                              <div className="space-y-2 md:col-span-2">
                                <Label>Description du bien</Label>
                                <Textarea
                                  value={bien.description}
                                  onChange={(e) => {
                                    const newBiens = [...pacsData.biensListe];
                                    newBiens[idx].description = e.target.value;
                                    setPacsData({...pacsData, biensListe: newBiens});
                                  }}
                                  rows={2}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Quote-part partenaire 1</Label>
                                <Input
                                  value={bien.quotePart1}
                                  onChange={(e) => {
                                    const newBiens = [...pacsData.biensListe];
                                    newBiens[idx].quotePart1 = e.target.value;
                                    setPacsData({...pacsData, biensListe: newBiens});
                                  }}
                                  placeholder="Ex: 50%"
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Quote-part partenaire 2</Label>
                                <Input
                                  value={bien.quotePart2}
                                  onChange={(e) => {
                                    const newBiens = [...pacsData.biensListe];
                                    newBiens[idx].quotePart2 = e.target.value;
                                    setPacsData({...pacsData, biensListe: newBiens});
                                  }}
                                  placeholder="Ex: 50%"
                                />
                              </div>
                              <div className="space-y-2 md:col-span-2">
                                <Label>Indivision</Label>
                                <Input
                                  value={bien.indivision}
                                  onChange={(e) => {
                                    const newBiens = [...pacsData.biensListe];
                                    newBiens[idx].indivision = e.target.value;
                                    setPacsData({...pacsData, biensListe: newBiens});
                                  }}
                                  placeholder="Modalit√©s d'indivision..."
                                />
                              </div>
                            </div>
                          </div>
                        ))}
                        <Button
                          type="button"
                          variant="outline"
                          onClick={() => {
                            setPacsData({
                              ...pacsData,
                              biensListe: [...pacsData.biensListe, {
                                id: pacsData.biensListe.length + 1,
                                description: "",
                                quotePart1: "",
                                quotePart2: "",
                                indivision: "",
                              }]
                            });
                          }}
                        >
                          + Ajouter un bien
                        </Button>
                      </div>
                    )}
                  </div>

                  {/* 9. Droit applicable */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Droit applicable</h3>
                    <div className="space-y-2">
                      <Label>Droit applicable au PACS</Label>
                      <Select 
                        value={pacsData.droitApplicable}
                        onValueChange={(value) => setPacsData({...pacsData, droitApplicable: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="francais">Droit fran√ßais</SelectItem>
                          <SelectItem value="autre">Autre droit (pr√©ciser)</SelectItem>
                        </SelectContent>
                      </Select>
                      {pacsData.droitApplicable === "autre" && (
                        <Input
                          value={pacsData.droitApplicableAutre}
                          onChange={(e) => setPacsData({...pacsData, droitApplicableAutre: e.target.value})}
                          placeholder="Pr√©cisez le droit applicable..."
                        />
                      )}
                    </div>
                  </div>

                  {/* 10. Pi√®ces justificatives */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Pi√®ces justificatives (obligatoires pour l'enregistrement)</h3>
                    
                    <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                      <p className="text-sm text-blue-800">
                        üìå <strong>Documents obligatoires pour chaque partenaire :</strong> pi√®ce d'identit√©, justificatif de domicile, acte de naissance int√©gral, 
                        + jugement de divorce (si divorc√©) ou acte de d√©c√®s (si veuf)
                      </p>
                    </div>

                    {/* Documents Partenaire 1 */}
                    <div className="p-4 border rounded-lg space-y-4 bg-muted/10">
                      <h4 className="font-medium text-base">üìÑ Documents Partenaire 1</h4>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        
                        {/* Pi√®ce d'identit√© P1 */}
                        <div className="space-y-2">
                          <Label>Pi√®ce d'identit√© (recto-verso) <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="pacs_p1_identite"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setPacsPartenaire1IdentiteFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="pacs_p1_identite" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {pacsPartenaire1IdentiteFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {pacsPartenaire1IdentiteFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setPacsPartenaire1IdentiteFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Justificatif domicile P1 */}
                        <div className="space-y-2">
                          <Label>Justificatif de domicile (&lt; 3 mois) <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="pacs_p1_domicile"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setPacsPartenaire1DomicileFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="pacs_p1_domicile" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {pacsPartenaire1DomicileFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {pacsPartenaire1DomicileFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setPacsPartenaire1DomicileFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Acte naissance P1 */}
                        <div className="space-y-2">
                          <Label>Acte de naissance int√©gral <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf"
                              multiple
                              className="hidden"
                              id="pacs_p1_naissance"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setPacsPartenaire1ActeNaissanceFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="pacs_p1_naissance" className="cursor-pointer text-sm text-muted-foreground">
                              &lt; 3 mois (France) ou &lt; 6 mois (√©tranger)
                            </label>
                            {pacsPartenaire1ActeNaissanceFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {pacsPartenaire1ActeNaissanceFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setPacsPartenaire1ActeNaissanceFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Jugement divorce P1 */}
                        <div className="space-y-2">
                          <Label>Jugement de divorce (si applicable)</Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf"
                              multiple
                              className="hidden"
                              id="pacs_p1_divorce"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setPacsPartenaire1DivorceFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="pacs_p1_divorce" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {pacsPartenaire1DivorceFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {pacsPartenaire1DivorceFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setPacsPartenaire1DivorceFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Acte d√©c√®s P1 */}
                        <div className="space-y-2">
                          <Label>Acte de d√©c√®s conjoint pr√©c√©dent (si veuf/ve)</Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf"
                              multiple
                              className="hidden"
                              id="pacs_p1_deces"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setPacsPartenaire1DecesFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="pacs_p1_deces" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {pacsPartenaire1DecesFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {pacsPartenaire1DecesFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setPacsPartenaire1DecesFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Documents √©tranger P1 */}
                        {pacsData.partenaires[0]?.estEtranger && (
                          <>
                            <div className="space-y-2">
                              <Label>Certificat de coutume</Label>
                              <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                                <input
                                  type="file"
                                  accept="application/pdf"
                                  multiple
                                  className="hidden"
                                  id="pacs_p1_coutume"
                                  onChange={(e) => {
                                    const files = Array.from(e.target.files || []);
                                    setPacsPartenaire1CertificatCoutumeFiles(prev => [...prev, ...files]);
                                  }}
                                />
                                <label htmlFor="pacs_p1_coutume" className="cursor-pointer text-sm text-muted-foreground">
                                  Cliquez pour joindre
                                </label>
                                {pacsPartenaire1CertificatCoutumeFiles.length > 0 && (
                                  <div className="mt-2 space-y-1">
                                    {pacsPartenaire1CertificatCoutumeFiles.map((file, idx) => (
                                      <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                        <span className="truncate">{file.name}</span>
                                        <button
                                          type="button"
                                          onClick={() => setPacsPartenaire1CertificatCoutumeFiles(prev => prev.filter((_, i) => i !== idx))}
                                          className="text-red-600 ml-2"
                                        >
                                          ‚úï
                                        </button>
                                      </div>
                                    ))}
                                  </div>
                                )}
                              </div>
                            </div>

                            <div className="space-y-2">
                              <Label>Certificat de non-PACS du pays d'origine</Label>
                              <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                                <input
                                  type="file"
                                  accept="application/pdf"
                                  multiple
                                  className="hidden"
                                  id="pacs_p1_nonpacs"
                                  onChange={(e) => {
                                    const files = Array.from(e.target.files || []);
                                    setPacsPartenaire1CertificatNonPacsFiles(prev => [...prev, ...files]);
                                  }}
                                />
                                <label htmlFor="pacs_p1_nonpacs" className="cursor-pointer text-sm text-muted-foreground">
                                  Cliquez pour joindre
                                </label>
                                {pacsPartenaire1CertificatNonPacsFiles.length > 0 && (
                                  <div className="mt-2 space-y-1">
                                    {pacsPartenaire1CertificatNonPacsFiles.map((file, idx) => (
                                      <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                        <span className="truncate">{file.name}</span>
                                        <button
                                          type="button"
                                          onClick={() => setPacsPartenaire1CertificatNonPacsFiles(prev => prev.filter((_, i) => i !== idx))}
                                          className="text-red-600 ml-2"
                                        >
                                          ‚úï
                                        </button>
                                      </div>
                                    ))}
                                  </div>
                                )}
                              </div>
                            </div>

                            <div className="space-y-2 md:col-span-2">
                              <Label>Traductions certifi√©es</Label>
                              <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                                <input
                                  type="file"
                                  accept="application/pdf"
                                  multiple
                                  className="hidden"
                                  id="pacs_p1_traductions"
                                  onChange={(e) => {
                                    const files = Array.from(e.target.files || []);
                                    setPacsPartenaire1TraductionsFiles(prev => [...prev, ...files]);
                                  }}
                                />
                                <label htmlFor="pacs_p1_traductions" className="cursor-pointer text-sm text-muted-foreground">
                                  Cliquez pour joindre
                                </label>
                                {pacsPartenaire1TraductionsFiles.length > 0 && (
                                  <div className="mt-2 space-y-1">
                                    {pacsPartenaire1TraductionsFiles.map((file, idx) => (
                                      <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                        <span className="truncate">{file.name}</span>
                                        <button
                                          type="button"
                                          onClick={() => setPacsPartenaire1TraductionsFiles(prev => prev.filter((_, i) => i !== idx))}
                                          className="text-red-600 ml-2"
                                        >
                                          ‚úï
                                        </button>
                                      </div>
                                    ))}
                                  </div>
                                )}
                              </div>
                            </div>
                          </>
                        )}
                      </div>
                    </div>

                    {/* Documents Partenaire 2 */}
                    <div className="p-4 border rounded-lg space-y-4 bg-muted/10">
                      <h4 className="font-medium text-base">üìÑ Documents Partenaire 2</h4>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        
                        {/* Pi√®ce d'identit√© P2 */}
                        <div className="space-y-2">
                          <Label>Pi√®ce d'identit√© (recto-verso) <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="pacs_p2_identite"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setPacsPartenaire2IdentiteFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="pacs_p2_identite" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {pacsPartenaire2IdentiteFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {pacsPartenaire2IdentiteFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setPacsPartenaire2IdentiteFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Justificatif domicile P2 */}
                        <div className="space-y-2">
                          <Label>Justificatif de domicile (&lt; 3 mois) <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="pacs_p2_domicile"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setPacsPartenaire2DomicileFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="pacs_p2_domicile" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {pacsPartenaire2DomicileFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {pacsPartenaire2DomicileFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setPacsPartenaire2DomicileFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Acte naissance P2 */}
                        <div className="space-y-2">
                          <Label>Acte de naissance int√©gral <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf"
                              multiple
                              className="hidden"
                              id="pacs_p2_naissance"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setPacsPartenaire2ActeNaissanceFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="pacs_p2_naissance" className="cursor-pointer text-sm text-muted-foreground">
                              &lt; 3 mois (France) ou &lt; 6 mois (√©tranger)
                            </label>
                            {pacsPartenaire2ActeNaissanceFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {pacsPartenaire2ActeNaissanceFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setPacsPartenaire2ActeNaissanceFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Jugement divorce P2 */}
                        <div className="space-y-2">
                          <Label>Jugement de divorce (si applicable)</Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf"
                              multiple
                              className="hidden"
                              id="pacs_p2_divorce"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setPacsPartenaire2DivorceFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="pacs_p2_divorce" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {pacsPartenaire2DivorceFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {pacsPartenaire2DivorceFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setPacsPartenaire2DivorceFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Acte d√©c√®s P2 */}
                        <div className="space-y-2">
                          <Label>Acte de d√©c√®s conjoint pr√©c√©dent (si veuf/ve)</Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf"
                              multiple
                              className="hidden"
                              id="pacs_p2_deces"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setPacsPartenaire2DecesFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="pacs_p2_deces" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {pacsPartenaire2DecesFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {pacsPartenaire2DecesFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setPacsPartenaire2DecesFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Documents √©tranger P2 */}
                        {pacsData.partenaires[1]?.estEtranger && (
                          <>
                            <div className="space-y-2">
                              <Label>Certificat de coutume</Label>
                              <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                                <input
                                  type="file"
                                  accept="application/pdf"
                                  multiple
                                  className="hidden"
                                  id="pacs_p2_coutume"
                                  onChange={(e) => {
                                    const files = Array.from(e.target.files || []);
                                    setPacsPartenaire2CertificatCoutumeFiles(prev => [...prev, ...files]);
                                  }}
                                />
                                <label htmlFor="pacs_p2_coutume" className="cursor-pointer text-sm text-muted-foreground">
                                  Cliquez pour joindre
                                </label>
                                {pacsPartenaire2CertificatCoutumeFiles.length > 0 && (
                                  <div className="mt-2 space-y-1">
                                    {pacsPartenaire2CertificatCoutumeFiles.map((file, idx) => (
                                      <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                        <span className="truncate">{file.name}</span>
                                        <button
                                          type="button"
                                          onClick={() => setPacsPartenaire2CertificatCoutumeFiles(prev => prev.filter((_, i) => i !== idx))}
                                          className="text-red-600 ml-2"
                                        >
                                          ‚úï
                                        </button>
                                      </div>
                                    ))}
                                  </div>
                                )}
                              </div>
                            </div>

                            <div className="space-y-2">
                              <Label>Certificat de non-PACS du pays d'origine</Label>
                              <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                                <input
                                  type="file"
                                  accept="application/pdf"
                                  multiple
                                  className="hidden"
                                  id="pacs_p2_nonpacs"
                                  onChange={(e) => {
                                    const files = Array.from(e.target.files || []);
                                    setPacsPartenaire2CertificatNonPacsFiles(prev => [...prev, ...files]);
                                  }}
                                />
                                <label htmlFor="pacs_p2_nonpacs" className="cursor-pointer text-sm text-muted-foreground">
                                  Cliquez pour joindre
                                </label>
                                {pacsPartenaire2CertificatNonPacsFiles.length > 0 && (
                                  <div className="mt-2 space-y-1">
                                    {pacsPartenaire2CertificatNonPacsFiles.map((file, idx) => (
                                      <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                        <span className="truncate">{file.name}</span>
                                        <button
                                          type="button"
                                          onClick={() => setPacsPartenaire2CertificatNonPacsFiles(prev => prev.filter((_, i) => i !== idx))}
                                          className="text-red-600 ml-2"
                                        >
                                          ‚úï
                                        </button>
                                      </div>
                                    ))}
                                  </div>
                                )}
                              </div>
                            </div>

                            <div className="space-y-2 md:col-span-2">
                              <Label>Traductions certifi√©es</Label>
                              <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                                <input
                                  type="file"
                                  accept="application/pdf"
                                  multiple
                                  className="hidden"
                                  id="pacs_p2_traductions"
                                  onChange={(e) => {
                                    const files = Array.from(e.target.files || []);
                                    setPacsPartenaire2TraductionsFiles(prev => [...prev, ...files]);
                                  }}
                                />
                                <label htmlFor="pacs_p2_traductions" className="cursor-pointer text-sm text-muted-foreground">
                                  Cliquez pour joindre
                                </label>
                                {pacsPartenaire2TraductionsFiles.length > 0 && (
                                  <div className="mt-2 space-y-1">
                                    {pacsPartenaire2TraductionsFiles.map((file, idx) => (
                                      <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                        <span className="truncate">{file.name}</span>
                                        <button
                                          type="button"
                                          onClick={() => setPacsPartenaire2TraductionsFiles(prev => prev.filter((_, i) => i !== idx))}
                                          className="text-red-600 ml-2"
                                        >
                                          ‚úï
                                        </button>
                                      </div>
                                    ))}
                                  </div>
                                )}
                              </div>
                            </div>
                          </>
                        )}
                      </div>
                    </div>
                  </div>

                </div>
              </>
            )}

            {/* Formulaire sp√©cifique pour Donation entre √©poux */}
            {pendingContractType === "Donation entre √©poux" && (
              <>
                <div className="space-y-6">
                  <div className="bg-muted/30 p-4 rounded-lg">
                    <h3 className="font-semibold text-lg mb-4">üìú Donation entre √©poux</h3>
                    <p className="text-sm text-muted-foreground">
                      Compl√©tez les informations n√©cessaires pour la r√©daction de la donation entre √©poux.
                    </p>
                  </div>

                  {/* 1. Informations g√©n√©rales sur la donation */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Informations g√©n√©rales sur la donation</h3>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      {/* Type de donation */}
                      <div className="space-y-2">
                        <Label className="flex items-center gap-2">
                          Type de donation choisie <span className="text-red-500">*</span>
                        </Label>
                        <Select 
                          value={donationEntreEpouxData.typeDonation}
                          onValueChange={(value) => setDonationEntreEpouxData({...donationEntreEpouxData, typeDonation: value})}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="au_dernier_vivant">Donation entre √©poux au dernier vivant (effets au d√©c√®s)</SelectItem>
                            <SelectItem value="biens_presents">Donation de biens pr√©sents (effets imm√©diats ‚Äì tr√®s r√©glement√©e)</SelectItem>
                            <SelectItem value="mixte">Donation mixte (rare)</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {/* Date pr√©vue de signature */}
                      <div className="space-y-2">
                        <Label>Date pr√©vue de signature de l'acte</Label>
                        <Input
                          type="date"
                          value={donationEntreEpouxData.datePrevueSignature}
                          onChange={(e) => setDonationEntreEpouxData({...donationEntreEpouxData, datePrevueSignature: e.target.value})}
                        />
                      </div>

                      {/* Objet de la donation */}
                      <div className="space-y-2 md:col-span-2">
                        <Label className="flex items-center gap-2">
                          Objet de la donation <span className="text-red-500">*</span>
                        </Label>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-2">
                          {[
                            { value: "protection_conjoint", label: "Protection du conjoint survivant" },
                            { value: "transmission_bien", label: "Transmission d'un bien particulier" },
                            { value: "partage_inegal", label: "Partage in√©gal" },
                            { value: "renforcement_droits", label: "Renforcement des droits successoraux" }
                          ].map(obj => (
                            <div key={obj.value} className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id={`objet_${obj.value}`}
                                checked={donationEntreEpouxData.objetDonation.includes(obj.value)}
                                onChange={(e) => {
                                  if (e.target.checked) {
                                    setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      objetDonation: [...donationEntreEpouxData.objetDonation, obj.value]
                                    });
                                  } else {
                                    setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      objetDonation: donationEntreEpouxData.objetDonation.filter(o => o !== obj.value)
                                    });
                                  }
                                }}
                              />
                              <label htmlFor={`objet_${obj.value}`} className="text-sm cursor-pointer">
                                {obj.label}
                              </label>
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* 2. Identit√© compl√®te des √©poux */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Identit√© compl√®te des √©poux</h3>
                    
                    {donationEntreEpouxData.epoux.map((epoux, index) => (
                      <div key={epoux.id} className="p-4 border rounded-lg space-y-4 bg-muted/20">
                        <h4 className="font-medium text-base">√âpoux #{index + 1}</h4>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          {/* S√©lection client */}
                          <div className="space-y-2 md:col-span-2">
                            <Label>S√©lectionner un client (optionnel)</Label>
                            <Select 
                              value={epoux.clientId} 
                              onValueChange={async (value) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index] = {...newEpoux[index], clientId: value, isClient: !!value};
                                
                                if (value) {
                                  const client = clients.find(c => c.id === value);
                                  if (client) {
                                    newEpoux[index].nom = client.nom || "";
                                    newEpoux[index].prenom = client.prenom || "";
                                    newEpoux[index].nomNaissance = client.nom || "";
                                    newEpoux[index].adresseComplete = client.adresse || "";
                                    newEpoux[index].dateNaissance = client.date_naissance || "";
                                    newEpoux[index].lieuNaissance = client.lieu_naissance || "";
                                    newEpoux[index].nationalite = client.nationalite || "";
                                    newEpoux[index].profession = client.profession || "";
                                    newEpoux[index].telephone = client.telephone || "";
                                    newEpoux[index].email = client.email || "";
                                    newEpoux[index].typeIdentite = client.type_identite || "";
                                    newEpoux[index].numeroIdentite = client.numero_identite || "";
                                    
                                    // Extraire la situation familiale et r√©gime matrimonial
                                    let situationFamiliale = "";
                                    let regimeMatrimonial = "";
                                    
                                    // Essayer d'abord situation_matrimoniale
                                    if (client.situation_matrimoniale) {
                                      if (typeof client.situation_matrimoniale === 'object' && client.situation_matrimoniale !== null) {
                                        situationFamiliale = client.situation_matrimoniale.situation_familiale || "";
                                        regimeMatrimonial = client.situation_matrimoniale.regime_matrimonial || "";
                                      } else if (typeof client.situation_matrimoniale === 'string') {
                                        situationFamiliale = client.situation_matrimoniale;
                                      }
                                    }
                                    
                                    // Si pas trouv√©, essayer situation_familiale
                                    if (!situationFamiliale && client.situation_familiale) {
                                      if (typeof client.situation_familiale === 'object' && client.situation_familiale !== null) {
                                        situationFamiliale = client.situation_familiale.situation_familiale || "";
                                        regimeMatrimonial = client.situation_familiale.regime_matrimonial || "";
                                      } else if (typeof client.situation_familiale === 'string') {
                                        situationFamiliale = client.situation_familiale;
                                      }
                                    }
                                    
                                    // Si pas trouv√© dans les objets, essayer le champ direct
                                    if (!regimeMatrimonial && client.regime_matrimonial) {
                                      regimeMatrimonial = client.regime_matrimonial;
                                    }
                                    
                                    newEpoux[index].situationMatrimoniale = situationFamiliale || "marie";
                                    newEpoux[index].regimeMatrimonial = regimeMatrimonial || "";
                                    newEpoux[index].dateMariage = client.date_mariage || "";
                                  }
                                }
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="Choisir un client..." /></SelectTrigger>
                              <SelectContent>
                                {clients.map((c) => (
                                  <SelectItem key={c.id} value={c.id}>
                                    {c.nom} {c.prenom}
                                  </SelectItem>
                                ))}
                              </SelectContent>
                            </Select>
                          </div>

                          {/* Informations civiles */}
                          <div className="space-y-2">
                            <Label>Nom <span className="text-red-500">*</span></Label>
                            <Input
                              value={epoux.nom}
                              onChange={(e) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].nom = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                            <Input
                              value={epoux.prenom}
                              onChange={(e) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].prenom = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Nom de naissance</Label>
                            <Input
                              value={epoux.nomNaissance}
                              onChange={(e) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].nomNaissance = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Date de naissance <span className="text-red-500">*</span></Label>
                            <Input
                              type="date"
                              value={epoux.dateNaissance}
                              onChange={(e) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].dateNaissance = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2 md:col-span-2">
                            <Label>Lieu de naissance</Label>
                            <Input
                              value={epoux.lieuNaissance}
                              onChange={(e) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].lieuNaissance = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Nationalit√©</Label>
                            <Input
                              value={epoux.nationalite}
                              onChange={(e) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].nationalite = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Profession</Label>
                            <Input
                              value={epoux.profession}
                              onChange={(e) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].profession = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2 md:col-span-2">
                            <Label>Adresse compl√®te <span className="text-red-500">*</span></Label>
                            <Input
                              value={epoux.adresseComplete}
                              onChange={(e) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].adresseComplete = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>T√©l√©phone</Label>
                            <Input
                              value={epoux.telephone}
                              onChange={(e) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].telephone = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Email</Label>
                            <Input
                              type="email"
                              value={epoux.email}
                              onChange={(e) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].email = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          {/* R√©gime matrimonial */}
                          <div className="space-y-2">
                            <Label>R√©gime matrimonial <span className="text-red-500">*</span></Label>
                            <Select 
                              value={epoux.regimeMatrimonial}
                              onValueChange={(value) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].regimeMatrimonial = value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="communaute_legale">Communaut√© l√©gale</SelectItem>
                                <SelectItem value="communaute_universelle">Communaut√© universelle</SelectItem>
                                <SelectItem value="separation_biens">S√©paration de biens</SelectItem>
                                <SelectItem value="participation_acquets">Participation aux acqu√™ts</SelectItem>
                                <SelectItem value="autre">Autre (pr√©ciser)</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          {epoux.regimeMatrimonial === "autre" && (
                            <div className="space-y-2">
                              <Label>Pr√©ciser le r√©gime</Label>
                              <Input
                                value={epoux.regimeMatrimonialAutre}
                                onChange={(e) => {
                                  const newEpoux = [...donationEntreEpouxData.epoux];
                                  newEpoux[index].regimeMatrimonialAutre = e.target.value;
                                  setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                                }}
                              />
                            </div>
                          )}

                          <div className="space-y-2">
                            <Label>Date du mariage <span className="text-red-500">*</span></Label>
                            <Input
                              type="date"
                              value={epoux.dateMariage}
                              onChange={(e) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].dateMariage = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Lieu du mariage</Label>
                            <Input
                              value={epoux.lieuMariage}
                              onChange={(e) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].lieuMariage = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Existence d'un contrat de mariage</Label>
                            <Select 
                              value={epoux.existenceContratMariage}
                              onValueChange={(value) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].existenceContratMariage = value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="oui">Oui (joindre copie)</SelectItem>
                                <SelectItem value="non">Non</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          {/* Pi√®ce d'identit√© */}
                          <div className="space-y-2">
                            <Label>Type de pi√®ce d'identit√©</Label>
                            <Select 
                              value={epoux.typeIdentite}
                              onValueChange={(value) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].typeIdentite = value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="CNI">Carte Nationale d'Identit√©</SelectItem>
                                <SelectItem value="Passeport">Passeport</SelectItem>
                                <SelectItem value="Titre de s√©jour">Titre de s√©jour</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          <div className="space-y-2">
                            <Label>Num√©ro d'identit√©</Label>
                            <Input
                              value={epoux.numeroIdentite}
                              onChange={(e) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].numeroIdentite = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Autorit√© de d√©livrance</Label>
                            <Input
                              value={epoux.autoriteDelivrance}
                              onChange={(e) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].autoriteDelivrance = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Date d'expiration</Label>
                            <Input
                              type="date"
                              value={epoux.dateExpiration}
                              onChange={(e) => {
                                const newEpoux = [...donationEntreEpouxData.epoux];
                                newEpoux[index].dateExpiration = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, epoux: newEpoux});
                              }}
                            />
                          </div>
                        </div>
                      </div>
                    ))}
                  </div>

                  {/* 3. Enfants et h√©ritiers potentiels */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Enfants et h√©ritiers potentiels</h3>
                    
                    <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                      <p className="text-sm text-blue-800">
                        ‚ÑπÔ∏è Ces informations sont obligatoires pour d√©terminer les limites juridiques de la donation (r√©serve h√©r√©ditaire)
                      </p>
                    </div>

                    {/* A. Enfants communs */}
                    <div className="space-y-3">
                      <div className="flex items-center justify-between">
                        <Label className="font-medium">A. Enfants communs</Label>
                        <Button
                          type="button"
                          size="sm"
                          variant="outline"
                          onClick={() => {
                            const newId = Math.max(...donationEntreEpouxData.enfantsCommuns.map(e => e.id), 0) + 1;
                            setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              enfantsCommuns: [...donationEntreEpouxData.enfantsCommuns, { id: newId, nom: "", prenom: "", dateNaissance: "" }]
                            });
                          }}
                        >
                          + Ajouter enfant commun
                        </Button>
                      </div>

                      {donationEntreEpouxData.enfantsCommuns.map((enfant, index) => (
                        <div key={enfant.id} className="p-3 border rounded-lg bg-muted/10">
                          <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
                            <Input
                              placeholder="Nom"
                              value={enfant.nom}
                              onChange={(e) => {
                                const newEnfants = [...donationEntreEpouxData.enfantsCommuns];
                                newEnfants[index].nom = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, enfantsCommuns: newEnfants});
                              }}
                            />
                            <Input
                              placeholder="Pr√©nom"
                              value={enfant.prenom}
                              onChange={(e) => {
                                const newEnfants = [...donationEntreEpouxData.enfantsCommuns];
                                newEnfants[index].prenom = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, enfantsCommuns: newEnfants});
                              }}
                            />
                            <div className="flex gap-2">
                              <Input
                                type="date"
                                placeholder="Date de naissance"
                                value={enfant.dateNaissance}
                                onChange={(e) => {
                                  const newEnfants = [...donationEntreEpouxData.enfantsCommuns];
                                  newEnfants[index].dateNaissance = e.target.value;
                                  setDonationEntreEpouxData({...donationEntreEpouxData, enfantsCommuns: newEnfants});
                                }}
                              />
                              {donationEntreEpouxData.enfantsCommuns.length > 1 && (
                                <Button
                                  type="button"
                                  size="sm"
                                  variant="destructive"
                                  onClick={() => {
                                    setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      enfantsCommuns: donationEntreEpouxData.enfantsCommuns.filter((_, i) => i !== index)
                                    });
                                  }}
                                >
                                  ‚úï
                                </Button>
                              )}
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* B. Enfants non communs */}
                    <div className="space-y-3">
                      <div className="flex items-center justify-between">
                        <Label className="font-medium">B. Enfants non communs (importante limitation de quotit√© disponible)</Label>
                        <Button
                          type="button"
                          size="sm"
                          variant="outline"
                          onClick={() => {
                            const newId = Math.max(...donationEntreEpouxData.enfantsNonCommuns.map(e => e.id), 0) + 1;
                            setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              enfantsNonCommuns: [...donationEntreEpouxData.enfantsNonCommuns, { id: newId, epoux: "1", nom: "", prenom: "", dateNaissance: "" }]
                            });
                          }}
                        >
                          + Ajouter enfant non commun
                        </Button>
                      </div>

                      {donationEntreEpouxData.enfantsNonCommuns.map((enfant, index) => (
                        <div key={enfant.id} className="p-3 border rounded-lg bg-muted/10">
                          <div className="grid grid-cols-1 md:grid-cols-4 gap-3">
                            <Select
                              value={enfant.epoux}
                              onValueChange={(value) => {
                                const newEnfants = [...donationEntreEpouxData.enfantsNonCommuns];
                                newEnfants[index].epoux = value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, enfantsNonCommuns: newEnfants});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="√âpoux..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="1">√âpoux 1</SelectItem>
                                <SelectItem value="2">√âpoux 2</SelectItem>
                              </SelectContent>
                            </Select>
                            <Input
                              placeholder="Nom"
                              value={enfant.nom}
                              onChange={(e) => {
                                const newEnfants = [...donationEntreEpouxData.enfantsNonCommuns];
                                newEnfants[index].nom = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, enfantsNonCommuns: newEnfants});
                              }}
                            />
                            <Input
                              placeholder="Pr√©nom"
                              value={enfant.prenom}
                              onChange={(e) => {
                                const newEnfants = [...donationEntreEpouxData.enfantsNonCommuns];
                                newEnfants[index].prenom = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, enfantsNonCommuns: newEnfants});
                              }}
                            />
                            <div className="flex gap-2">
                              <Input
                                type="date"
                                placeholder="Date de naissance"
                                value={enfant.dateNaissance}
                                onChange={(e) => {
                                  const newEnfants = [...donationEntreEpouxData.enfantsNonCommuns];
                                  newEnfants[index].dateNaissance = e.target.value;
                                  setDonationEntreEpouxData({...donationEntreEpouxData, enfantsNonCommuns: newEnfants});
                                }}
                              />
                              {donationEntreEpouxData.enfantsNonCommuns.length > 1 && (
                                <Button
                                  type="button"
                                  size="sm"
                                  variant="destructive"
                                  onClick={() => {
                                    setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      enfantsNonCommuns: donationEntreEpouxData.enfantsNonCommuns.filter((_, i) => i !== index)
                                    });
                                  }}
                                >
                                  ‚úï
                                </Button>
                              )}
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* C. Parents vivants */}
                    <div className="space-y-3">
                      <Label className="font-medium">C. Pr√©sence d'autres h√©ritiers r√©servataires</Label>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <Label>Parents du d√©funt (√©poux 1) vivants ?</Label>
                          <Select 
                            value={donationEntreEpouxData.parentsVivants.epoux1}
                            onValueChange={(value) => setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              parentsVivants: {...donationEntreEpouxData.parentsVivants, epoux1: value}
                            })}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="oui">Oui</SelectItem>
                              <SelectItem value="non">Non</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="space-y-2">
                          <Label>Parents du d√©funt (√©poux 2) vivants ?</Label>
                          <Select 
                            value={donationEntreEpouxData.parentsVivants.epoux2}
                            onValueChange={(value) => setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              parentsVivants: {...donationEntreEpouxData.parentsVivants, epoux2: value}
                            })}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="oui">Oui</SelectItem>
                              <SelectItem value="non">Non</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                      </div>
                    </div>

                    {/* D. Autres h√©ritiers */}
                    <div className="space-y-2">
                      <Label>D. Autres h√©ritiers (fr√®res/s≈ìurs, etc.)</Label>
                      <textarea
                        className="w-full min-h-[80px] p-2 border rounded-md"
                        value={donationEntreEpouxData.autresHeritiers}
                        onChange={(e) => setDonationEntreEpouxData({...donationEntreEpouxData, autresHeritiers: e.target.value})}
                        placeholder="Pr√©ciser les autres h√©ritiers potentiels..."
                      />
                    </div>
                  </div>

                  {/* 4. Patrimoine des √©poux */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Patrimoine des √©poux</h3>
                    
                    <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                      <p className="text-sm text-blue-800">
                        ‚ÑπÔ∏è Indispensable pour savoir ce qui peut √™tre donn√© selon le r√©gime matrimonial
                      </p>
                    </div>

                    {/* A. Biens propres √©poux 1 */}
                    <div className="space-y-3">
                      <div className="flex items-center justify-between">
                        <Label className="font-medium">A. Biens propres √âpoux 1</Label>
                        <Button
                          type="button"
                          size="sm"
                          variant="outline"
                          onClick={() => {
                            const newId = Math.max(...donationEntreEpouxData.biensPropresEpoux1.map(b => b.id), 0) + 1;
                            setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              biensPropresEpoux1: [...donationEntreEpouxData.biensPropresEpoux1, { id: newId, type: "", description: "", valeur: "", origine: "" }]
                            });
                          }}
                        >
                          + Ajouter bien
                        </Button>
                      </div>

                      {donationEntreEpouxData.biensPropresEpoux1.map((bien, index) => (
                        <div key={bien.id} className="p-3 border rounded-lg bg-muted/10">
                          <div className="grid grid-cols-1 md:grid-cols-4 gap-3">
                            <Select
                              value={bien.type}
                              onValueChange={(value) => {
                                const newBiens = [...donationEntreEpouxData.biensPropresEpoux1];
                                newBiens[index].type = value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, biensPropresEpoux1: newBiens});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="Type..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="immobilier">Immobilier</SelectItem>
                                <SelectItem value="meuble">Meuble</SelectItem>
                                <SelectItem value="financier">Financier</SelectItem>
                                <SelectItem value="autre">Autre</SelectItem>
                              </SelectContent>
                            </Select>
                            <Input
                              placeholder="Description"
                              value={bien.description}
                              onChange={(e) => {
                                const newBiens = [...donationEntreEpouxData.biensPropresEpoux1];
                                newBiens[index].description = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, biensPropresEpoux1: newBiens});
                              }}
                            />
                            <Input
                              placeholder="Valeur (‚Ç¨)"
                              value={bien.valeur}
                              onChange={(e) => {
                                const newBiens = [...donationEntreEpouxData.biensPropresEpoux1];
                                newBiens[index].valeur = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, biensPropresEpoux1: newBiens});
                              }}
                            />
                            <div className="flex gap-2">
                              <Select
                                value={bien.origine}
                                onValueChange={(value) => {
                                  const newBiens = [...donationEntreEpouxData.biensPropresEpoux1];
                                  newBiens[index].origine = value;
                                  setDonationEntreEpouxData({...donationEntreEpouxData, biensPropresEpoux1: newBiens});
                                }}
                              >
                                <SelectTrigger><SelectValue placeholder="Origine..." /></SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="heritage">H√©ritage</SelectItem>
                                  <SelectItem value="donation">Donation</SelectItem>
                                  <SelectItem value="achat">Achat</SelectItem>
                                </SelectContent>
                              </Select>
                              {donationEntreEpouxData.biensPropresEpoux1.length > 1 && (
                                <Button
                                  type="button"
                                  size="sm"
                                  variant="destructive"
                                  onClick={() => {
                                    setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      biensPropresEpoux1: donationEntreEpouxData.biensPropresEpoux1.filter((_, i) => i !== index)
                                    });
                                  }}
                                >
                                  ‚úï
                                </Button>
                              )}
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* B. Biens propres √©poux 2 */}
                    <div className="space-y-3">
                      <div className="flex items-center justify-between">
                        <Label className="font-medium">B. Biens propres √âpoux 2</Label>
                        <Button
                          type="button"
                          size="sm"
                          variant="outline"
                          onClick={() => {
                            const newId = Math.max(...donationEntreEpouxData.biensPropresEpoux2.map(b => b.id), 0) + 1;
                            setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              biensPropresEpoux2: [...donationEntreEpouxData.biensPropresEpoux2, { id: newId, type: "", description: "", valeur: "", origine: "" }]
                            });
                          }}
                        >
                          + Ajouter bien
                        </Button>
                      </div>

                      {donationEntreEpouxData.biensPropresEpoux2.map((bien, index) => (
                        <div key={bien.id} className="p-3 border rounded-lg bg-muted/10">
                          <div className="grid grid-cols-1 md:grid-cols-4 gap-3">
                            <Select
                              value={bien.type}
                              onValueChange={(value) => {
                                const newBiens = [...donationEntreEpouxData.biensPropresEpoux2];
                                newBiens[index].type = value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, biensPropresEpoux2: newBiens});
                              }}
                            >
                              <SelectTrigger><SelectValue placeholder="Type..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="immobilier">Immobilier</SelectItem>
                                <SelectItem value="meuble">Meuble</SelectItem>
                                <SelectItem value="financier">Financier</SelectItem>
                                <SelectItem value="autre">Autre</SelectItem>
                              </SelectContent>
                            </Select>
                            <Input
                              placeholder="Description"
                              value={bien.description}
                              onChange={(e) => {
                                const newBiens = [...donationEntreEpouxData.biensPropresEpoux2];
                                newBiens[index].description = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, biensPropresEpoux2: newBiens});
                              }}
                            />
                            <Input
                              placeholder="Valeur (‚Ç¨)"
                              value={bien.valeur}
                              onChange={(e) => {
                                const newBiens = [...donationEntreEpouxData.biensPropresEpoux2];
                                newBiens[index].valeur = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, biensPropresEpoux2: newBiens});
                              }}
                            />
                            <div className="flex gap-2">
                              <Select
                                value={bien.origine}
                                onValueChange={(value) => {
                                  const newBiens = [...donationEntreEpouxData.biensPropresEpoux2];
                                  newBiens[index].origine = value;
                                  setDonationEntreEpouxData({...donationEntreEpouxData, biensPropresEpoux2: newBiens});
                                }}
                              >
                                <SelectTrigger><SelectValue placeholder="Origine..." /></SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="heritage">H√©ritage</SelectItem>
                                  <SelectItem value="donation">Donation</SelectItem>
                                  <SelectItem value="achat">Achat</SelectItem>
                                </SelectContent>
                              </Select>
                              {donationEntreEpouxData.biensPropresEpoux2.length > 1 && (
                                <Button
                                  type="button"
                                  size="sm"
                                  variant="destructive"
                                  onClick={() => {
                                    setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      biensPropresEpoux2: donationEntreEpouxData.biensPropresEpoux2.filter((_, i) => i !== index)
                                    });
                                  }}
                                >
                                  ‚úï
                                </Button>
                              )}
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* C. Biens communs */}
                    <div className="space-y-3">
                      <div className="flex items-center justify-between">
                        <Label className="font-medium">C. Biens communs (si r√©gime communautaire)</Label>
                        <Button
                          type="button"
                          size="sm"
                          variant="outline"
                          onClick={() => {
                            const newId = Math.max(...donationEntreEpouxData.biensCommuns.map(b => b.id), 0) + 1;
                            setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              biensCommuns: [...donationEntreEpouxData.biensCommuns, { id: newId, description: "", valeur: "", partEpoux1: "50", partEpoux2: "50" }]
                            });
                          }}
                        >
                          + Ajouter bien commun
                        </Button>
                      </div>

                      {donationEntreEpouxData.biensCommuns.map((bien, index) => (
                        <div key={bien.id} className="p-3 border rounded-lg bg-muted/10">
                          <div className="grid grid-cols-1 md:grid-cols-4 gap-3">
                            <Input
                              placeholder="Description"
                              className="md:col-span-2"
                              value={bien.description}
                              onChange={(e) => {
                                const newBiens = [...donationEntreEpouxData.biensCommuns];
                                newBiens[index].description = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, biensCommuns: newBiens});
                              }}
                            />
                            <Input
                              placeholder="Valeur (‚Ç¨)"
                              value={bien.valeur}
                              onChange={(e) => {
                                const newBiens = [...donationEntreEpouxData.biensCommuns];
                                newBiens[index].valeur = e.target.value;
                                setDonationEntreEpouxData({...donationEntreEpouxData, biensCommuns: newBiens});
                              }}
                            />
                            <div className="flex gap-2 items-center">
                              <Input
                                placeholder="Part E1 %"
                                value={bien.partEpoux1}
                                onChange={(e) => {
                                  const newBiens = [...donationEntreEpouxData.biensCommuns];
                                  newBiens[index].partEpoux1 = e.target.value;
                                  setDonationEntreEpouxData({...donationEntreEpouxData, biensCommuns: newBiens});
                                }}
                              />
                              <span className="text-sm">/</span>
                              <Input
                                placeholder="Part E2 %"
                                value={bien.partEpoux2}
                                onChange={(e) => {
                                  const newBiens = [...donationEntreEpouxData.biensCommuns];
                                  newBiens[index].partEpoux2 = e.target.value;
                                  setDonationEntreEpouxData({...donationEntreEpouxData, biensCommuns: newBiens});
                                }}
                              />
                              {donationEntreEpouxData.biensCommuns.length > 1 && (
                                <Button
                                  type="button"
                                  size="sm"
                                  variant="destructive"
                                  onClick={() => {
                                    setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      biensCommuns: donationEntreEpouxData.biensCommuns.filter((_, i) => i !== index)
                                    });
                                  }}
                                >
                                  ‚úï
                                </Button>
                              )}
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* D. Droits particuliers */}
                    <div className="space-y-3">
                      <Label className="font-medium">D. Droits √©ventuels sur des biens</Label>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <Label>Nue-propri√©t√© / usufruit</Label>
                          <textarea
                            className="w-full min-h-[60px] p-2 border rounded-md text-sm"
                            value={donationEntreEpouxData.droitsParticuliers.nueProprieteBiens}
                            onChange={(e) => setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              droitsParticuliers: {...donationEntreEpouxData.droitsParticuliers, nueProprieteBiens: e.target.value}
                            })}
                            placeholder="D√©tails..."
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>Usufruit sur biens</Label>
                          <textarea
                            className="w-full min-h-[60px] p-2 border rounded-md text-sm"
                            value={donationEntreEpouxData.droitsParticuliers.usufruitBiens}
                            onChange={(e) => setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              droitsParticuliers: {...donationEntreEpouxData.droitsParticuliers, usufruitBiens: e.target.value}
                            })}
                            placeholder="D√©tails..."
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>Biens indivis</Label>
                          <textarea
                            className="w-full min-h-[60px] p-2 border rounded-md text-sm"
                            value={donationEntreEpouxData.droitsParticuliers.biensIndivis}
                            onChange={(e) => setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              droitsParticuliers: {...donationEntreEpouxData.droitsParticuliers, biensIndivis: e.target.value}
                            })}
                            placeholder="D√©tails..."
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>Biens grev√©s d'hypoth√®ques</Label>
                          <textarea
                            className="w-full min-h-[60px] p-2 border rounded-md text-sm"
                            value={donationEntreEpouxData.droitsParticuliers.biensHypotheques}
                            onChange={(e) => setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              droitsParticuliers: {...donationEntreEpouxData.droitsParticuliers, biensHypotheques: e.target.value}
                            })}
                            placeholder="D√©tails..."
                          />
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* 5. Clauses de donation - Donation au dernier vivant */}
                  {(donationEntreEpouxData.typeDonation === "au_dernier_vivant" || donationEntreEpouxData.typeDonation === "mixte") && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">Clauses de donation au dernier vivant</h3>
                      
                      {/* Options successorales */}
                      <div className="space-y-3">
                        <Label className="font-medium">Options successorales offertes au conjoint survivant</Label>
                        <div className="grid grid-cols-1 gap-2">
                          {[
                            { value: "pleine_propriete_quotite", label: "Pleine propri√©t√© de la quotit√© disponible" },
                            { value: "usufruit_universel", label: "Usufruit universel de la succession" },
                            { value: "quart_pleine_3quarts_usufruit", label: "1/4 en pleine propri√©t√© + 3/4 en usufruit" },
                            { value: "choix_multiple", label: "Choix entre plusieurs options au d√©c√®s" },
                            { value: "attribution_biens_specifiques", label: "Attribution de biens sp√©cifiques" }
                          ].map(opt => (
                            <div key={opt.value} className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id={`opt_${opt.value}`}
                                checked={donationEntreEpouxData.donationDernierVivant.optionsSuccessorales.includes(opt.value)}
                                onChange={(e) => {
                                  const current = donationEntreEpouxData.donationDernierVivant.optionsSuccessorales;
                                  const newOpts = e.target.checked 
                                    ? [...current, opt.value]
                                    : current.filter(o => o !== opt.value);
                                  setDonationEntreEpouxData({
                                    ...donationEntreEpouxData,
                                    donationDernierVivant: {...donationEntreEpouxData.donationDernierVivant, optionsSuccessorales: newOpts}
                                  });
                                }}
                              />
                              <label htmlFor={`opt_${opt.value}`} className="text-sm cursor-pointer">{opt.label}</label>
                            </div>
                          ))}
                        </div>
                        {donationEntreEpouxData.donationDernierVivant.optionsSuccessorales.includes("attribution_biens_specifiques") && (
                          <div className="space-y-2 mt-3">
                            <Label>Pr√©ciser les biens sp√©cifiques</Label>
                            <textarea
                              className="w-full min-h-[80px] p-2 border rounded-md text-sm"
                              value={donationEntreEpouxData.donationDernierVivant.biensSpecifiques}
                              onChange={(e) => setDonationEntreEpouxData({
                                ...donationEntreEpouxData,
                                donationDernierVivant: {...donationEntreEpouxData.donationDernierVivant, biensSpecifiques: e.target.value}
                              })}
                              placeholder="Ex: logement familial situ√© √†..."
                            />
                          </div>
                        )}
                      </div>

                      {/* Clause d'attribution pr√©f√©rentielle */}
                      <div className="space-y-3 p-4 border rounded-lg bg-muted/10">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="attr_pref_active"
                            checked={donationEntreEpouxData.donationDernierVivant.attributionPreferentielle.active}
                            onChange={(e) => setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              donationDernierVivant: {
                                ...donationEntreEpouxData.donationDernierVivant,
                                attributionPreferentielle: {...donationEntreEpouxData.donationDernierVivant.attributionPreferentielle, active: e.target.checked}
                              }
                            })}
                          />
                          <Label htmlFor="attr_pref_active" className="font-medium cursor-pointer">Clause d'attribution pr√©f√©rentielle</Label>
                        </div>
                        {donationEntreEpouxData.donationDernierVivant.attributionPreferentielle.active && (
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3 ml-6">
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="attr_logement"
                                checked={donationEntreEpouxData.donationDernierVivant.attributionPreferentielle.logementFamilial}
                                onChange={(e) => setDonationEntreEpouxData({
                                  ...donationEntreEpouxData,
                                  donationDernierVivant: {
                                    ...donationEntreEpouxData.donationDernierVivant,
                                    attributionPreferentielle: {...donationEntreEpouxData.donationDernierVivant.attributionPreferentielle, logementFamilial: e.target.checked}
                                  }
                                })}
                              />
                              <label htmlFor="attr_logement" className="text-sm cursor-pointer">Logement familial</label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="attr_mobilier"
                                checked={donationEntreEpouxData.donationDernierVivant.attributionPreferentielle.mobilier}
                                onChange={(e) => setDonationEntreEpouxData({
                                  ...donationEntreEpouxData,
                                  donationDernierVivant: {
                                    ...donationEntreEpouxData.donationDernierVivant,
                                    attributionPreferentielle: {...donationEntreEpouxData.donationDernierVivant.attributionPreferentielle, mobilier: e.target.checked}
                                  }
                                })}
                              />
                              <label htmlFor="attr_mobilier" className="text-sm cursor-pointer">Mobilier</label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="attr_professionnel"
                                checked={donationEntreEpouxData.donationDernierVivant.attributionPreferentielle.bienProfessionnel}
                                onChange={(e) => setDonationEntreEpouxData({
                                  ...donationEntreEpouxData,
                                  donationDernierVivant: {
                                    ...donationEntreEpouxData.donationDernierVivant,
                                    attributionPreferentielle: {...donationEntreEpouxData.donationDernierVivant.attributionPreferentielle, bienProfessionnel: e.target.checked}
                                  }
                                })}
                              />
                              <label htmlFor="attr_professionnel" className="text-sm cursor-pointer">Bien professionnel</label>
                            </div>
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="attr_vehicule"
                                checked={donationEntreEpouxData.donationDernierVivant.attributionPreferentielle.vehicule}
                                onChange={(e) => setDonationEntreEpouxData({
                                  ...donationEntreEpouxData,
                                  donationDernierVivant: {
                                    ...donationEntreEpouxData.donationDernierVivant,
                                    attributionPreferentielle: {...donationEntreEpouxData.donationDernierVivant.attributionPreferentielle, vehicule: e.target.checked}
                                  }
                                })}
                              />
                              <label htmlFor="attr_vehicule" className="text-sm cursor-pointer">V√©hicule</label>
                            </div>
                            <div className="space-y-2 md:col-span-2">
                              <Label>Autres biens</Label>
                              <Input
                                placeholder="Pr√©ciser..."
                                value={donationEntreEpouxData.donationDernierVivant.attributionPreferentielle.autresBiens}
                                onChange={(e) => setDonationEntreEpouxData({
                                  ...donationEntreEpouxData,
                                  donationDernierVivant: {
                                    ...donationEntreEpouxData.donationDernierVivant,
                                    attributionPreferentielle: {...donationEntreEpouxData.donationDernierVivant.attributionPreferentielle, autresBiens: e.target.value}
                                  }
                                })}
                              />
                            </div>
                          </div>
                        )}
                      </div>

                      {/* Clause de pr√©ciput */}
                      <div className="space-y-3 p-4 border rounded-lg bg-muted/10">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="preciput_active"
                            checked={donationEntreEpouxData.donationDernierVivant.clausePreciput.active}
                            onChange={(e) => setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              donationDernierVivant: {
                                ...donationEntreEpouxData.donationDernierVivant,
                                clausePreciput: {...donationEntreEpouxData.donationDernierVivant.clausePreciput, active: e.target.checked}
                              }
                            })}
                          />
                          <Label htmlFor="preciput_active" className="font-medium cursor-pointer">Clause de pr√©ciput (prendre un bien avant tout partage)</Label>
                        </div>
                        {donationEntreEpouxData.donationDernierVivant.clausePreciput.active && (
                          <div className="space-y-3 ml-6">
                            <div className="space-y-2">
                              <Label>Description du bien</Label>
                              <textarea
                                className="w-full min-h-[60px] p-2 border rounded-md text-sm"
                                value={donationEntreEpouxData.donationDernierVivant.clausePreciput.descriptionBien}
                                onChange={(e) => setDonationEntreEpouxData({
                                  ...donationEntreEpouxData,
                                  donationDernierVivant: {
                                    ...donationEntreEpouxData.donationDernierVivant,
                                    clausePreciput: {...donationEntreEpouxData.donationDernierVivant.clausePreciput, descriptionBien: e.target.value}
                                  }
                                })}
                                placeholder="D√©crire le bien concern√©..."
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Effet</Label>
                              <Select
                                value={donationEntreEpouxData.donationDernierVivant.clausePreciput.effet}
                                onValueChange={(value) => setDonationEntreEpouxData({
                                  ...donationEntreEpouxData,
                                  donationDernierVivant: {
                                    ...donationEntreEpouxData.donationDernierVivant,
                                    clausePreciput: {...donationEntreEpouxData.donationDernierVivant.clausePreciput, effet: value}
                                  }
                                })}
                              >
                                <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="hors_part">Hors part successorale</SelectItem>
                                  <SelectItem value="valorise_part">Valoris√© dans la part</SelectItem>
                                </SelectContent>
                              </Select>
                            </div>
                          </div>
                        )}
                      </div>

                      {/* Clause de cantonnement */}
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="cantonnement"
                          checked={donationEntreEpouxData.donationDernierVivant.clauseCantonnement}
                          onChange={(e) => setDonationEntreEpouxData({
                            ...donationEntreEpouxData,
                            donationDernierVivant: {...donationEntreEpouxData.donationDernierVivant, clauseCantonnement: e.target.checked}
                          })}
                        />
                        <label htmlFor="cantonnement" className="text-sm cursor-pointer">
                          Clause de cantonnement (permet au survivant de renoncer √† une partie pour optimiser la fiscalit√©)
                        </label>
                      </div>

                      {/* Clause d'exclusion */}
                      <div className="space-y-3 p-4 border rounded-lg bg-muted/10">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="exclusion_active"
                            checked={donationEntreEpouxData.donationDernierVivant.clauseExclusion.active}
                            onChange={(e) => setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              donationDernierVivant: {
                                ...donationEntreEpouxData.donationDernierVivant,
                                clauseExclusion: {...donationEntreEpouxData.donationDernierVivant.clauseExclusion, active: e.target.checked}
                              }
                            })}
                          />
                          <Label htmlFor="exclusion_active" className="font-medium cursor-pointer">Clause d'exclusion / exception</Label>
                        </div>
                        {donationEntreEpouxData.donationDernierVivant.clauseExclusion.active && (
                          <div className="space-y-3 ml-6">
                            <div className="space-y-2">
                              <Label>Biens exclus du champ de la donation</Label>
                              <textarea
                                className="w-full min-h-[60px] p-2 border rounded-md text-sm"
                                value={donationEntreEpouxData.donationDernierVivant.clauseExclusion.biensExclus}
                                onChange={(e) => setDonationEntreEpouxData({
                                  ...donationEntreEpouxData,
                                  donationDernierVivant: {
                                    ...donationEntreEpouxData.donationDernierVivant,
                                    clauseExclusion: {...donationEntreEpouxData.donationDernierVivant.clauseExclusion, biensExclus: e.target.value}
                                  }
                                })}
                                placeholder="Liste des biens exclus..."
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Cas particuliers (biens professionnels, h√©ritages...)</Label>
                              <textarea
                                className="w-full min-h-[60px] p-2 border rounded-md text-sm"
                                value={donationEntreEpouxData.donationDernierVivant.clauseExclusion.casParticuliers}
                                onChange={(e) => setDonationEntreEpouxData({
                                  ...donationEntreEpouxData,
                                  donationDernierVivant: {
                                    ...donationEntreEpouxData.donationDernierVivant,
                                    clauseExclusion: {...donationEntreEpouxData.donationDernierVivant.clauseExclusion, casParticuliers: e.target.value}
                                  }
                                })}
                                placeholder="Pr√©cisions..."
                              />
                            </div>
                          </div>
                        )}
                      </div>
                    </div>
                  )}

                  {/* 6. Clauses de donation - Donation de biens pr√©sents */}
                  {(donationEntreEpouxData.typeDonation === "biens_presents" || donationEntreEpouxData.typeDonation === "mixte") && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">Clauses de donation de biens pr√©sents</h3>
                      
                      <div className="bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4">
                        <p className="text-sm text-orange-800">
                          ‚ö†Ô∏è Prend effet imm√©diatement - Plus rare et tr√®s encadr√©e juridiquement
                        </p>
                      </div>

                      {/* Biens donn√©s */}
                      <div className="space-y-3">
                        <div className="flex items-center justify-between">
                          <Label className="font-medium">Biens donn√©s imm√©diatement</Label>
                          <Button
                            type="button"
                            size="sm"
                            variant="outline"
                            onClick={() => {
                              const newId = Math.max(...donationEntreEpouxData.donationBiensPresents.biensDonnes.map(b => b.id), 0) + 1;
                              setDonationEntreEpouxData({
                                ...donationEntreEpouxData,
                                donationBiensPresents: {
                                  ...donationEntreEpouxData.donationBiensPresents,
                                  biensDonnes: [...donationEntreEpouxData.donationBiensPresents.biensDonnes, { id: newId, nature: "", description: "", valeur: "", regimePropriete: "" }]
                                }
                              });
                            }}
                          >
                            + Ajouter bien
                          </Button>
                        </div>

                        {donationEntreEpouxData.donationBiensPresents.biensDonnes.map((bien, index) => (
                          <div key={bien.id} className="p-3 border rounded-lg bg-muted/10">
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-3">
                              <Select
                                value={bien.nature}
                                onValueChange={(value) => {
                                  const newBiens = [...donationEntreEpouxData.donationBiensPresents.biensDonnes];
                                  newBiens[index].nature = value;
                                  setDonationEntreEpouxData({
                                    ...donationEntreEpouxData,
                                    donationBiensPresents: {...donationEntreEpouxData.donationBiensPresents, biensDonnes: newBiens}
                                  });
                                }}
                              >
                                <SelectTrigger><SelectValue placeholder="Nature..." /></SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="immobilier">Immobilier</SelectItem>
                                  <SelectItem value="financier">Financier</SelectItem>
                                  <SelectItem value="meuble">Meuble</SelectItem>
                                  <SelectItem value="entreprise">Entreprise</SelectItem>
                                  <SelectItem value="autre">Autre</SelectItem>
                                </SelectContent>
                              </Select>
                              <Input
                                placeholder="Description compl√®te"
                                value={bien.description}
                                onChange={(e) => {
                                  const newBiens = [...donationEntreEpouxData.donationBiensPresents.biensDonnes];
                                  newBiens[index].description = e.target.value;
                                  setDonationEntreEpouxData({
                                    ...donationEntreEpouxData,
                                    donationBiensPresents: {...donationEntreEpouxData.donationBiensPresents, biensDonnes: newBiens}
                                  });
                                }}
                              />
                              <Input
                                placeholder="Valeur (‚Ç¨)"
                                value={bien.valeur}
                                onChange={(e) => {
                                  const newBiens = [...donationEntreEpouxData.donationBiensPresents.biensDonnes];
                                  newBiens[index].valeur = e.target.value;
                                  setDonationEntreEpouxData({
                                    ...donationEntreEpouxData,
                                    donationBiensPresents: {...donationEntreEpouxData.donationBiensPresents, biensDonnes: newBiens}
                                  });
                                }}
                              />
                              <div className="flex gap-2">
                                <Select
                                  value={bien.regimePropriete}
                                  onValueChange={(value) => {
                                    const newBiens = [...donationEntreEpouxData.donationBiensPresents.biensDonnes];
                                    newBiens[index].regimePropriete = value;
                                    setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      donationBiensPresents: {...donationEntreEpouxData.donationBiensPresents, biensDonnes: newBiens}
                                    });
                                  }}
                                >
                                  <SelectTrigger><SelectValue placeholder="R√©gime..." /></SelectTrigger>
                                  <SelectContent>
                                    <SelectItem value="propre">Propre</SelectItem>
                                    <SelectItem value="commun">Commun</SelectItem>
                                    <SelectItem value="indivis">Indivis</SelectItem>
                                  </SelectContent>
                                </Select>
                                {donationEntreEpouxData.donationBiensPresents.biensDonnes.length > 1 && (
                                  <Button
                                    type="button"
                                    size="sm"
                                    variant="destructive"
                                    onClick={() => {
                                      setDonationEntreEpouxData({
                                        ...donationEntreEpouxData,
                                        donationBiensPresents: {
                                          ...donationEntreEpouxData.donationBiensPresents,
                                          biensDonnes: donationEntreEpouxData.donationBiensPresents.biensDonnes.filter((_, i) => i !== index)
                                        }
                                      });
                                    }}
                                  >
                                    ‚úï
                                  </Button>
                                )}
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>

                      {/* Irr√©vocabilit√© */}
                      <div className="space-y-2">
                        <Label>D√©claration d'irr√©vocabilit√©</Label>
                        <Select
                          value={donationEntreEpouxData.donationBiensPresents.irrevocabilite}
                          onValueChange={(value) => setDonationEntreEpouxData({
                            ...donationEntreEpouxData,
                            donationBiensPresents: {...donationEntreEpouxData.donationBiensPresents, irrevocabilite: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="oui">Oui (donation irr√©vocable)</SelectItem>
                            <SelectItem value="non">Non (sauf clauses sp√©cifiques)</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {/* Clause de retour */}
                      <div className="space-y-2">
                        <Label>Clause de retour en cas de pr√©d√©c√®s</Label>
                        <Select
                          value={donationEntreEpouxData.donationBiensPresents.clauseRetourPredeces}
                          onValueChange={(value) => setDonationEntreEpouxData({
                            ...donationEntreEpouxData,
                            donationBiensPresents: {...donationEntreEpouxData.donationBiensPresents, clauseRetourPredeces: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="oui">Oui (retour automatique)</SelectItem>
                            <SelectItem value="non">Non (pas de retour)</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {/* R√©serve d'usufruit */}
                      <div className="space-y-3 p-4 border rounded-lg bg-muted/10">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="usufruit_active"
                            checked={donationEntreEpouxData.donationBiensPresents.reserveUsufruit.active}
                            onChange={(e) => setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              donationBiensPresents: {
                                ...donationEntreEpouxData.donationBiensPresents,
                                reserveUsufruit: {...donationEntreEpouxData.donationBiensPresents.reserveUsufruit, active: e.target.checked}
                              }
                            })}
                          />
                          <Label htmlFor="usufruit_active" className="font-medium cursor-pointer">R√©serve d'usufruit</Label>
                        </div>
                        {donationEntreEpouxData.donationBiensPresents.reserveUsufruit.active && (
                          <div className="space-y-2 ml-6">
                            <Label>Conditions</Label>
                            <textarea
                              className="w-full min-h-[60px] p-2 border rounded-md text-sm"
                              value={donationEntreEpouxData.donationBiensPresents.reserveUsufruit.conditions}
                              onChange={(e) => setDonationEntreEpouxData({
                                ...donationEntreEpouxData,
                                donationBiensPresents: {
                                  ...donationEntreEpouxData.donationBiensPresents,
                                  reserveUsufruit: {...donationEntreEpouxData.donationBiensPresents.reserveUsufruit, conditions: e.target.value}
                                }
                              })}
                              placeholder="Pr√©ciser les conditions de l'usufruit r√©serv√©..."
                            />
                          </div>
                        )}
                      </div>
                    </div>
                  )}

                  {/* 7. Clauses communes aux deux types de donation */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Clauses communes</h3>
                    
                    <div className="space-y-3">
                      <div className="space-y-2">
                        <Label>Administration et gestion</Label>
                        <textarea
                          className="w-full min-h-[80px] p-2 border rounded-md text-sm"
                          value={donationEntreEpouxData.clausesCommunes.administrationGestion}
                          onChange={(e) => setDonationEntreEpouxData({
                            ...donationEntreEpouxData,
                            clausesCommunes: {...donationEntreEpouxData.clausesCommunes, administrationGestion: e.target.value}
                          })}
                          placeholder="Qui g√®re les biens ? Usufruit, nue-propri√©t√©, pleine propri√©t√©..."
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Condition suspensive ou r√©solutoire (tr√®s rare mais n√©cessaire dans certains cas)</Label>
                        <textarea
                          className="w-full min-h-[80px] p-2 border rounded-md text-sm"
                          value={donationEntreEpouxData.clausesCommunes.conditionSuspensiveResolutoire}
                          onChange={(e) => setDonationEntreEpouxData({
                            ...donationEntreEpouxData,
                            clausesCommunes: {...donationEntreEpouxData.clausesCommunes, conditionSuspensiveResolutoire: e.target.value}
                          })}
                          placeholder="Pr√©ciser la condition..."
                        />
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="acceptation_beneficiaire"
                          checked={donationEntreEpouxData.clausesCommunes.acceptationBeneficiaire}
                          onChange={(e) => setDonationEntreEpouxData({
                            ...donationEntreEpouxData,
                            clausesCommunes: {...donationEntreEpouxData.clausesCommunes, acceptationBeneficiaire: e.target.checked}
                          })}
                        />
                        <label htmlFor="acceptation_beneficiaire" className="text-sm cursor-pointer">
                          Acceptation claire et non √©quivoque de l'√©poux b√©n√©ficiaire <span className="text-red-500">*</span> (obligatoire pour la validit√©)
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="renonciation_droits"
                          checked={donationEntreEpouxData.clausesCommunes.renonciationDroitsSuccessorauxStandards}
                          onChange={(e) => setDonationEntreEpouxData({
                            ...donationEntreEpouxData,
                            clausesCommunes: {...donationEntreEpouxData.clausesCommunes, renonciationDroitsSuccessorauxStandards: e.target.checked}
                          })}
                        />
                        <label htmlFor="renonciation_droits" className="text-sm cursor-pointer">
                          Renonciation aux droits successoraux standards
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="non_revocation"
                          checked={donationEntreEpouxData.clausesCommunes.clauseNonRevocation}
                          onChange={(e) => setDonationEntreEpouxData({
                            ...donationEntreEpouxData,
                            clausesCommunes: {...donationEntreEpouxData.clausesCommunes, clauseNonRevocation: e.target.checked}
                          })}
                        />
                        <label htmlFor="non_revocation" className="text-sm cursor-pointer">
                          Clause de non-r√©vocation (selon type de donation)
                        </label>
                      </div>

                      {/* R√©vocabilit√© - Section compl√®te obligatoire */}
                      <div className="space-y-3 pt-3 mt-3 border-t-2 border-blue-200 bg-blue-50/30 p-4 rounded-lg">
                        <h4 className="font-medium text-base text-blue-900">üîÑ R√©gime de r√©vocabilit√© de la donation</h4>
                        <p className="text-xs text-blue-700">
                          La donation entre √©poux est toujours r√©vocable par d√©faut, sauf clause contraire explicite.
                        </p>
                        
                        <div className="space-y-2">
                          <Label>R√©vocabilit√© <span className="text-red-500">*</span></Label>
                          <Select
                            value={donationEntreEpouxData.clausesCommunes.revocabilite}
                            onValueChange={(value) => setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              clausesCommunes: {...donationEntreEpouxData.clausesCommunes, revocabilite: value}
                            })}
                          >
                            <SelectTrigger className="w-full">
                              <SelectValue placeholder="S√©lectionner" />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="revocable">Donation r√©vocable (r√®gle l√©gale par d√©faut)</SelectItem>
                              <SelectItem value="irrevocable">Donation irr√©vocable (exceptionnelle ‚Äì n√©cessite accord explicite)</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>

                        {donationEntreEpouxData.clausesCommunes.revocabilite === "revocable" && (
                          <div className="space-y-2 bg-white p-3 rounded border">
                            <Label className="text-sm font-medium">Motifs de r√©vocation possibles</Label>
                            <div className="space-y-2">
                              <div className="flex items-center space-x-2">
                                <input
                                  type="checkbox"
                                  id="motif_survenance"
                                  checked={donationEntreEpouxData.clausesCommunes.motifsRevocation?.includes("survenance_enfants")}
                                  onChange={(e) => {
                                    const current = donationEntreEpouxData.clausesCommunes.motifsRevocation || [];
                                    const updated = e.target.checked 
                                      ? [...current, "survenance_enfants"]
                                      : current.filter(m => m !== "survenance_enfants");
                                    setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      clausesCommunes: {...donationEntreEpouxData.clausesCommunes, motifsRevocation: updated}
                                    });
                                  }}
                                />
                                <label htmlFor="motif_survenance" className="text-sm cursor-pointer">
                                  Survenance d'enfants
                                </label>
                              </div>
                              <div className="flex items-center space-x-2">
                                <input
                                  type="checkbox"
                                  id="motif_ingratitude"
                                  checked={donationEntreEpouxData.clausesCommunes.motifsRevocation?.includes("ingratitude")}
                                  onChange={(e) => {
                                    const current = donationEntreEpouxData.clausesCommunes.motifsRevocation || [];
                                    const updated = e.target.checked 
                                      ? [...current, "ingratitude"]
                                      : current.filter(m => m !== "ingratitude");
                                    setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      clausesCommunes: {...donationEntreEpouxData.clausesCommunes, motifsRevocation: updated}
                                    });
                                  }}
                                />
                                <label htmlFor="motif_ingratitude" className="text-sm cursor-pointer">
                                  Ingratitude
                                </label>
                              </div>
                              <div className="flex items-center space-x-2">
                                <input
                                  type="checkbox"
                                  id="motif_non_execution"
                                  checked={donationEntreEpouxData.clausesCommunes.motifsRevocation?.includes("non_execution")}
                                  onChange={(e) => {
                                    const current = donationEntreEpouxData.clausesCommunes.motifsRevocation || [];
                                    const updated = e.target.checked 
                                      ? [...current, "non_execution"]
                                      : current.filter(m => m !== "non_execution");
                                    setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      clausesCommunes: {...donationEntreEpouxData.clausesCommunes, motifsRevocation: updated}
                                    });
                                  }}
                                />
                                <label htmlFor="motif_non_execution" className="text-sm cursor-pointer">
                                  Non-ex√©cution des obligations
                                </label>
                              </div>
                              <div className="flex items-center space-x-2">
                                <input
                                  type="checkbox"
                                  id="motif_revocation_libre"
                                  checked={donationEntreEpouxData.clausesCommunes.motifsRevocation?.includes("revocation_libre")}
                                  onChange={(e) => {
                                    const current = donationEntreEpouxData.clausesCommunes.motifsRevocation || [];
                                    const updated = e.target.checked 
                                      ? [...current, "revocation_libre"]
                                      : current.filter(m => m !== "revocation_libre");
                                    setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      clausesCommunes: {...donationEntreEpouxData.clausesCommunes, motifsRevocation: updated}
                                    });
                                  }}
                                />
                                <label htmlFor="motif_revocation_libre" className="text-sm cursor-pointer">
                                  R√©vocation libre (selon option)
                                </label>
                              </div>
                            </div>
                          </div>
                        )}
                      </div>

                      {/* Signature par mandataire */}
                      <div className="space-y-3 pt-3 mt-3 border-t-2 border-purple-200 bg-purple-50/30 p-4 rounded-lg">
                        <h4 className="font-medium text-base text-purple-900">üë§ Signature par mandataire</h4>
                        <p className="text-xs text-purple-700">
                          Si l'un des √©poux ne peut pas signer physiquement (hospitalisation, impossibilit√© de d√©placement).
                        </p>
                        
                        <Label>Signature par mandataire ?</Label>
                        <Select
                          value={donationEntreEpouxData.clausesCommunes.signatureMandataire}
                          onValueChange={(value) => setDonationEntreEpouxData({
                            ...donationEntreEpouxData,
                            clausesCommunes: {...donationEntreEpouxData.clausesCommunes, signatureMandataire: value}
                          })}
                        >
                          <SelectTrigger className="w-full">
                            <SelectValue placeholder="S√©lectionner" />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="non">Non</SelectItem>
                            <SelectItem value="oui">Oui (hospitalisation, impossibilit√©)</SelectItem>
                          </SelectContent>
                        </Select>

                        {donationEntreEpouxData.clausesCommunes.signatureMandataire === "oui" && (
                          <div className="space-y-4 bg-muted/30 p-4 rounded-lg">
                            <div className="space-y-3">
                              <h4 className="font-medium text-sm">Mandataire pour √âpoux 1</h4>
                              <div className="grid grid-cols-2 gap-3">
                                <div className="space-y-2">
                                  <Label className="text-xs">Nom du mandataire</Label>
                                  <Input
                                    value={donationEntreEpouxData.clausesCommunes.mandataireEpoux1.nom}
                                    onChange={(e) => setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      clausesCommunes: {
                                        ...donationEntreEpouxData.clausesCommunes,
                                        mandataireEpoux1: {...donationEntreEpouxData.clausesCommunes.mandataireEpoux1, nom: e.target.value}
                                      }
                                    })}
                                    placeholder="Nom"
                                  />
                                </div>
                                <div className="space-y-2">
                                  <Label className="text-xs">Pr√©nom</Label>
                                  <Input
                                    value={donationEntreEpouxData.clausesCommunes.mandataireEpoux1.prenom}
                                    onChange={(e) => setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      clausesCommunes: {
                                        ...donationEntreEpouxData.clausesCommunes,
                                        mandataireEpoux1: {...donationEntreEpouxData.clausesCommunes.mandataireEpoux1, prenom: e.target.value}
                                      }
                                    })}
                                    placeholder="Pr√©nom"
                                  />
                                </div>
                              </div>
                              <div className="space-y-2">
                                <Label className="text-xs">Type de procuration <span className="text-red-500">*</span></Label>
                                <Select
                                  value={donationEntreEpouxData.clausesCommunes.mandataireEpoux1.typeProcuration}
                                  onValueChange={(value) => setDonationEntreEpouxData({
                                    ...donationEntreEpouxData,
                                    clausesCommunes: {
                                      ...donationEntreEpouxData.clausesCommunes,
                                      mandataireEpoux1: {...donationEntreEpouxData.clausesCommunes.mandataireEpoux1, typeProcuration: value}
                                    }
                                  })}
                                >
                                  <SelectTrigger>
                                    <SelectValue placeholder="S√©lectionner" />
                                  </SelectTrigger>
                                  <SelectContent>
                                    <SelectItem value="sous_seing_prive">Procuration sous seing priv√©</SelectItem>
                                    <SelectItem value="acte_notarie">Acte notari√©</SelectItem>
                                  </SelectContent>
                                </Select>
                              </div>
                            </div>

                            <div className="space-y-3">
                              <h4 className="font-medium text-sm">Mandataire pour √âpoux 2</h4>
                              <div className="grid grid-cols-2 gap-3">
                                <div className="space-y-2">
                                  <Label className="text-xs">Nom du mandataire</Label>
                                  <Input
                                    value={donationEntreEpouxData.clausesCommunes.mandataireEpoux2.nom}
                                    onChange={(e) => setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      clausesCommunes: {
                                        ...donationEntreEpouxData.clausesCommunes,
                                        mandataireEpoux2: {...donationEntreEpouxData.clausesCommunes.mandataireEpoux2, nom: e.target.value}
                                      }
                                    })}
                                    placeholder="Nom"
                                  />
                                </div>
                                <div className="space-y-2">
                                  <Label className="text-xs">Pr√©nom</Label>
                                  <Input
                                    value={donationEntreEpouxData.clausesCommunes.mandataireEpoux2.prenom}
                                    onChange={(e) => setDonationEntreEpouxData({
                                      ...donationEntreEpouxData,
                                      clausesCommunes: {
                                        ...donationEntreEpouxData.clausesCommunes,
                                        mandataireEpoux2: {...donationEntreEpouxData.clausesCommunes.mandataireEpoux2, prenom: e.target.value}
                                      }
                                    })}
                                    placeholder="Pr√©nom"
                                  />
                                </div>
                              </div>
                              <div className="space-y-2">
                                <Label className="text-xs">Type de procuration <span className="text-red-500">*</span></Label>
                                <Select
                                  value={donationEntreEpouxData.clausesCommunes.mandataireEpoux2.typeProcuration}
                                  onValueChange={(value) => setDonationEntreEpouxData({
                                    ...donationEntreEpouxData,
                                    clausesCommunes: {
                                      ...donationEntreEpouxData.clausesCommunes,
                                      mandataireEpoux2: {...donationEntreEpouxData.clausesCommunes.mandataireEpoux2, typeProcuration: value}
                                    }
                                  })}
                                >
                                  <SelectTrigger>
                                    <SelectValue placeholder="S√©lectionner" />
                                  </SelectTrigger>
                                  <SelectContent>
                                    <SelectItem value="sous_seing_prive">Procuration sous seing priv√©</SelectItem>
                                    <SelectItem value="acte_notarie">Acte notari√©</SelectItem>
                                  </SelectContent>
                                </Select>
                              </div>
                            </div>
                          </div>
                        )}
                      </div>

                      {/* Information sur les effets successoraux (OBLIGATOIRE) */}
                      <div className="p-4 bg-amber-50 border-2 border-amber-300 rounded-lg space-y-3 mt-4">
                        <h4 className="font-medium text-sm text-amber-900">‚öñÔ∏è Information sur les effets successoraux</h4>
                        <p className="text-xs text-amber-800">
                          Les √©poux doivent √™tre inform√©s des limites l√©gales de la donation, notamment en pr√©sence d'enfants non communs, 
                          de la r√©serve h√©r√©ditaire, et des cas de r√©duction possibles.
                        </p>
                        <div className="flex items-start space-x-2">
                          <input
                            type="checkbox"
                            id="information_effets"
                            checked={donationEntreEpouxData.clausesCommunes.informationEffetsSuccessoraux}
                            onChange={(e) => setDonationEntreEpouxData({
                              ...donationEntreEpouxData,
                              clausesCommunes: {...donationEntreEpouxData.clausesCommunes, informationEffetsSuccessoraux: e.target.checked}
                            })}
                            className="mt-1"
                          />
                          <label htmlFor="information_effets" className="text-sm cursor-pointer">
                            <span className="text-red-500 font-bold">*</span> Les √©poux reconnaissent avoir √©t√© pleinement inform√©s des effets successoraux 
                            de cette donation, des limites l√©gales, de la r√©serve des enfants non communs, et de l'impact sur la succession 
                            <span className="block mt-1 text-xs text-amber-700 font-medium">(D√©claration obligatoire)</span>
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* 8. Documents √† joindre / √† collecter */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Documents √† joindre / √† collecter</h3>
                    
                    <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                      <p className="text-sm text-blue-800">
                        üìå <strong>Documents obligatoires :</strong> pi√®ces d'identit√©, livret de famille, acte de mariage, contrat de mariage (si existant), justificatifs de domicile
                      </p>
                    </div>

                    {/* Documents √âpoux 1 */}
                    <div className="p-4 border rounded-lg space-y-4 bg-muted/10">
                      <h4 className="font-medium text-base">üìÑ Documents √âpoux 1</h4>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        
                        {/* Pi√®ce d'identit√© E1 */}
                        <div className="space-y-2">
                          <Label>Pi√®ce d'identit√© (recto-verso) <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="donation_e1_identite"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationEpoux1IdentiteFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_e1_identite" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationEpoux1IdentiteFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationEpoux1IdentiteFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationEpoux1IdentiteFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Livret famille E1 */}
                        <div className="space-y-2">
                          <Label>Livret de famille <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="donation_e1_livret"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationEpoux1LivretFamilleFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_e1_livret" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationEpoux1LivretFamilleFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationEpoux1LivretFamilleFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationEpoux1LivretFamilleFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Acte mariage E1 */}
                        <div className="space-y-2">
                          <Label>Acte de mariage <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf"
                              multiple
                              className="hidden"
                              id="donation_e1_mariage"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationEpoux1ActeMariageFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_e1_mariage" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationEpoux1ActeMariageFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationEpoux1ActeMariageFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationEpoux1ActeMariageFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Contrat mariage E1 */}
                        {donationEntreEpouxData.epoux[0].existenceContratMariage === "oui" && (
                          <div className="space-y-2">
                            <Label>Contrat de mariage</Label>
                            <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                              <input
                                type="file"
                                accept="application/pdf"
                                multiple
                                className="hidden"
                                id="donation_e1_contrat"
                                onChange={(e) => {
                                  const files = Array.from(e.target.files || []);
                                  setDonationEpoux1ContratMariageFiles(prev => [...prev, ...files]);
                                }}
                              />
                              <label htmlFor="donation_e1_contrat" className="cursor-pointer text-sm text-muted-foreground">
                                Cliquez pour joindre
                              </label>
                              {donationEpoux1ContratMariageFiles.length > 0 && (
                                <div className="mt-2 space-y-1">
                                  {donationEpoux1ContratMariageFiles.map((file, idx) => (
                                    <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                      <span className="truncate">{file.name}</span>
                                      <button
                                        type="button"
                                        onClick={() => setDonationEpoux1ContratMariageFiles(prev => prev.filter((_, i) => i !== idx))}
                                        className="text-red-600 ml-2"
                                      >
                                        ‚úï
                                      </button>
                                    </div>
                                  ))}
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        {/* Justificatif domicile E1 */}
                        <div className="space-y-2">
                          <Label>Justificatif de domicile (&lt; 3 mois) <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="donation_e1_domicile"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationEpoux1DomicileFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_e1_domicile" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationEpoux1DomicileFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationEpoux1DomicileFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationEpoux1DomicileFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Documents √âpoux 2 */}
                    <div className="p-4 border rounded-lg space-y-4 bg-muted/10">
                      <h4 className="font-medium text-base">üìÑ Documents √âpoux 2</h4>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        
                        {/* Pi√®ce d'identit√© E2 */}
                        <div className="space-y-2">
                          <Label>Pi√®ce d'identit√© (recto-verso) <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="donation_e2_identite"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationEpoux2IdentiteFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_e2_identite" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationEpoux2IdentiteFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationEpoux2IdentiteFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationEpoux2IdentiteFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Livret famille E2 */}
                        <div className="space-y-2">
                          <Label>Livret de famille <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="donation_e2_livret"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationEpoux2LivretFamilleFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_e2_livret" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationEpoux2LivretFamilleFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationEpoux2LivretFamilleFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationEpoux2LivretFamilleFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Acte mariage E2 */}
                        <div className="space-y-2">
                          <Label>Acte de mariage <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf"
                              multiple
                              className="hidden"
                              id="donation_e2_mariage"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationEpoux2ActeMariageFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_e2_mariage" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationEpoux2ActeMariageFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationEpoux2ActeMariageFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationEpoux2ActeMariageFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Contrat mariage E2 */}
                        {donationEntreEpouxData.epoux[1].existenceContratMariage === "oui" && (
                          <div className="space-y-2">
                            <Label>Contrat de mariage</Label>
                            <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                              <input
                                type="file"
                                accept="application/pdf"
                                multiple
                                className="hidden"
                                id="donation_e2_contrat"
                                onChange={(e) => {
                                  const files = Array.from(e.target.files || []);
                                  setDonationEpoux2ContratMariageFiles(prev => [...prev, ...files]);
                                }}
                              />
                              <label htmlFor="donation_e2_contrat" className="cursor-pointer text-sm text-muted-foreground">
                                Cliquez pour joindre
                              </label>
                              {donationEpoux2ContratMariageFiles.length > 0 && (
                                <div className="mt-2 space-y-1">
                                  {donationEpoux2ContratMariageFiles.map((file, idx) => (
                                    <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                      <span className="truncate">{file.name}</span>
                                      <button
                                        type="button"
                                        onClick={() => setDonationEpoux2ContratMariageFiles(prev => prev.filter((_, i) => i !== idx))}
                                        className="text-red-600 ml-2"
                                      >
                                        ‚úï
                                      </button>
                                    </div>
                                  ))}
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        {/* Justificatif domicile E2 */}
                        <div className="space-y-2">
                          <Label>Justificatif de domicile (&lt; 3 mois) <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="donation_e2_domicile"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationEpoux2DomicileFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_e2_domicile" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationEpoux2DomicileFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationEpoux2DomicileFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationEpoux2DomicileFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Documents pour biens immobiliers / financiers */}
                    <div className="p-4 border rounded-lg space-y-4 bg-muted/10">
                      <h4 className="font-medium text-base">üìÑ Documents pour les biens</h4>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        
                        {/* Titres propri√©t√© */}
                        <div className="space-y-2">
                          <Label>Titres de propri√©t√© (biens immobiliers)</Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf"
                              multiple
                              className="hidden"
                              id="donation_titres"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationTitresProprieteBiensFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_titres" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationTitresProprieteBiensFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationTitresProprieteBiensFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationTitresProprieteBiensFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Estimations */}
                        <div className="space-y-2">
                          <Label>Estimations / √©valuations</Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf"
                              multiple
                              className="hidden"
                              id="donation_estimation"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationEstimationBiensFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_estimation" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationEstimationBiensFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationEstimationBiensFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationEstimationBiensFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Hypoth√®ques */}
                        <div className="space-y-2">
                          <Label>Hypoth√®ques</Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf"
                              multiple
                              className="hidden"
                              id="donation_hypotheques"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationHypothequesFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_hypotheques" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationHypothequesFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationHypothequesFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationHypothequesFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Situation locative */}
                        <div className="space-y-2">
                          <Label>Situation locative</Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf"
                              multiple
                              className="hidden"
                              id="donation_locative"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationSituationLocativeFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_locative" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationSituationLocativeFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationSituationLocativeFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationSituationLocativeFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* RIB */}
                        <div className="space-y-2">
                          <Label>RIB (si donation financi√®re)</Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="donation_rib"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationRIBFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_rib" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationRIBFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationRIBFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationRIBFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Carte grise */}
                        <div className="space-y-2">
                          <Label>Carte grise v√©hicule</Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="donation_carte_grise"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationCarteGriseFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_carte_grise" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationCarteGriseFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationCarteGriseFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationCarteGriseFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Autres documents */}
                        <div className="space-y-2">
                          <Label>Autres documents</Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="donation_autres"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationAutresDocumentsFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_autres" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationAutresDocumentsFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationAutresDocumentsFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationAutresDocumentsFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Documents procuration (si mandataire) */}
                    {donationEntreEpouxData.clausesCommunes.signatureMandataire === "oui" && (
                      <div className="p-4 border-2 border-amber-300 bg-amber-50 rounded-lg space-y-4">
                        <h4 className="font-medium text-base text-amber-900">üìÑ Procurations</h4>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          {/* Procuration √âpoux 1 */}
                          {donationEntreEpouxData.clausesCommunes.mandataireEpoux1.nom && (
                            <div className="space-y-2">
                              <Label>Procuration √âpoux 1 <span className="text-red-500">*</span></Label>
                              <div className="border-2 border-dashed border-amber-400 rounded-lg p-3">
                                <input
                                  type="file"
                                  accept="application/pdf"
                                  multiple
                                  className="hidden"
                                  id="donation_procuration_e1"
                                  onChange={(e) => {
                                    const files = Array.from(e.target.files || []);
                                    setDonationEpoux1IdentiteFiles(prev => [...prev, ...files]);
                                  }}
                                />
                                <label htmlFor="donation_procuration_e1" className="cursor-pointer text-sm text-amber-800">
                                  Cliquez pour joindre la procuration
                                </label>
                              </div>
                            </div>
                          )}
                          {/* Procuration √âpoux 2 */}
                          {donationEntreEpouxData.clausesCommunes.mandataireEpoux2.nom && (
                            <div className="space-y-2">
                              <Label>Procuration √âpoux 2 <span className="text-red-500">*</span></Label>
                              <div className="border-2 border-dashed border-amber-400 rounded-lg p-3">
                                <input
                                  type="file"
                                  accept="application/pdf"
                                  multiple
                                  className="hidden"
                                  id="donation_procuration_e2"
                                  onChange={(e) => {
                                    const files = Array.from(e.target.files || []);
                                    setDonationEpoux2IdentiteFiles(prev => [...prev, ...files]);
                                  }}
                                />
                                <label htmlFor="donation_procuration_e2" className="cursor-pointer text-sm text-amber-800">
                                  Cliquez pour joindre la procuration
                                </label>
                              </div>
                            </div>
                          )}
                        </div>
                      </div>
                    )}
                  </div>

                </div>
              </>
            )}

            {/* Formulaire Donation Simple */}
            {pendingContractType === "Donation simple (parent ‚Üí enfant, etc.)" && (
              <>
                <div className="space-y-6 max-h-[calc(100vh-250px)] overflow-y-auto pr-2">
                  
                  {/* 1. Type de donation */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Type de donation</h3>
                    
                    <div className="space-y-3">
                      <Label>Type de donation <span className="text-red-500">*</span></Label>
                      <Select
                        value={donationSimpleData.typeDonation}
                        onValueChange={(value) => setDonationSimpleData({...donationSimpleData, typeDonation: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="biens_meubles">Donation simple de biens meubles</SelectItem>
                          <SelectItem value="biens_immobiliers">Donation simple de biens immobiliers</SelectItem>
                          <SelectItem value="sommes_argent">Donation de sommes d'argent</SelectItem>
                          <SelectItem value="nue_propriete">Donation de nue-propri√©t√©</SelectItem>
                          <SelectItem value="usufruit">Donation d'usufruit temporaire / viager</SelectItem>
                          <SelectItem value="parts_sociales">Donation de parts sociales / actions</SelectItem>
                          <SelectItem value="manuelle">Donation manuelle (argent, bijoux, voiture, mobilier‚Ä¶)</SelectItem>
                          <SelectItem value="mixte">Donation mixte (plusieurs biens)</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="grid grid-cols-2 gap-4">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="donation_avec_charges"
                          checked={donationSimpleData.donationAvecCharges}
                          onChange={(e) => setDonationSimpleData({...donationSimpleData, donationAvecCharges: e.target.checked})}
                        />
                        <label htmlFor="donation_avec_charges" className="text-sm cursor-pointer">
                          Donation avec charges
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="donation_reserve_usufruit"
                          checked={donationSimpleData.donationAvecReserveUsufruit}
                          onChange={(e) => setDonationSimpleData({...donationSimpleData, donationAvecReserveUsufruit: e.target.checked})}
                        />
                        <label htmlFor="donation_reserve_usufruit" className="text-sm cursor-pointer">
                          Donation avec r√©serve d'usufruit
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="donation_droit_retour"
                          checked={donationSimpleData.donationAvecDroitRetour}
                          onChange={(e) => setDonationSimpleData({...donationSimpleData, donationAvecDroitRetour: e.target.checked})}
                        />
                        <label htmlFor="donation_droit_retour" className="text-sm cursor-pointer">
                          Donation avec droit de retour conventionnel
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="donation_effet_immediat"
                          checked={donationSimpleData.donationEffetImmediat}
                          onChange={(e) => setDonationSimpleData({...donationSimpleData, donationEffetImmediat: e.target.checked})}
                          disabled
                        />
                        <label htmlFor="donation_effet_immediat" className="text-sm cursor-pointer text-muted-foreground">
                          Donation √† effet imm√©diat (toujours le cas)
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="donation_presente_irrevocable"
                          checked={donationSimpleData.donationPresenteIrrevocable}
                          onChange={(e) => setDonationSimpleData({...donationSimpleData, donationPresenteIrrevocable: e.target.checked})}
                          disabled
                        />
                        <label htmlFor="donation_presente_irrevocable" className="text-sm cursor-pointer text-muted-foreground">
                          Donation pr√©sente et irr√©vocable (principe l√©gal)
                        </label>
                      </div>
                    </div>

                    {donationSimpleData.donationAvecCharges && (
                      <div className="space-y-2">
                        <Label>Description des charges</Label>
                        <textarea
                          className="w-full min-h-[80px] p-2 border rounded-md text-sm"
                          value={donationSimpleData.descriptionCharges}
                          onChange={(e) => setDonationSimpleData({...donationSimpleData, descriptionCharges: e.target.value})}
                          placeholder="Somme √† payer, obligation, entretien..."
                        />
                      </div>
                    )}
                  </div>

                  {/* 2. Identit√© du donateur */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Identit√© compl√®te du donateur</h3>
                    
                    <div className="space-y-2">
                      <Label>S√©lectionner un client (optionnel)</Label>
                      <Select
                        value={donationSimpleData.donateur.clientId}
                        onValueChange={(value) => {
                          const client = clients.find(c => c.id === value);
                          if (client) {
                            // Extraire situation familiale
                            let situationFam = "";
                            // D'abord v√©rifier si c'est directement une string dans situation_familiale
                            if (typeof client.situation_familiale === "string") {
                              situationFam = client.situation_familiale;
                            }
                            // Sinon v√©rifier situation_matrimoniale
                            else if (typeof client.situation_matrimoniale === "string") {
                              situationFam = client.situation_matrimoniale;
                            }
                            // Sinon si c'est un objet, extraire les donn√©es
                            else if (client.situation_familiale && typeof client.situation_familiale === "object") {
                              const sitFam = client.situation_familiale;
                              situationFam = sitFam.situation_matrimoniale || sitFam.situation_familiale || sitFam.etat_civil || "";
                            }
                            
                            // Extraire r√©gime matrimonial si mari√©
                            let regimeMat = "";
                            if (client.situation_familiale && typeof client.situation_familiale === "object") {
                              regimeMat = client.situation_familiale.regime_matrimonial || "";
                            }
                            
                            console.log('Client s√©lectionn√©:', client);
                            console.log('Situation familiale extraite:', situationFam);
                            console.log('R√©gime matrimonial extrait:', regimeMat);
                            
                            setDonationSimpleData({
                              ...donationSimpleData,
                              donateur: {
                                ...donationSimpleData.donateur,
                                isClient: true,
                                clientId: value,
                                nom: client.nom || "",
                                prenom: client.prenom || "",
                                nomNaissance: client.nom || "",
                                adresseComplete: client.adresse || "",
                                telephone: client.telephone || "",
                                email: client.email || "",
                                dateNaissance: client.date_naissance || "",
                                lieuNaissance: client.lieu_naissance || "",
                                nationalite: client.nationalite || "",
                                profession: client.profession || "",
                                situationFamiliale: situationFam,
                                regimeMatrimonial: regimeMat,
                              }
                            });
                          }
                        }}
                      >
                        <SelectTrigger><SelectValue placeholder="Choisir un client..." /></SelectTrigger>
                        <SelectContent>
                          {clients.map((c) => (
                            <SelectItem key={c.id} value={c.id}>{c.nom} {c.prenom}</SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Nom <span className="text-red-500">*</span></Label>
                        <Input
                          value={donationSimpleData.donateur.nom}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donateur: {...donationSimpleData.donateur, nom: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                        <Input
                          value={donationSimpleData.donateur.prenom}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donateur: {...donationSimpleData.donateur, prenom: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Nom de naissance</Label>
                        <Input
                          value={donationSimpleData.donateur.nomNaissance}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donateur: {...donationSimpleData.donateur, nomNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Date de naissance <span className="text-red-500">*</span></Label>
                        <Input
                          type="date"
                          value={donationSimpleData.donateur.dateNaissance}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donateur: {...donationSimpleData.donateur, dateNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Lieu de naissance</Label>
                        <Input
                          value={donationSimpleData.donateur.lieuNaissance}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donateur: {...donationSimpleData.donateur, lieuNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Nationalit√©</Label>
                        <Input
                          value={donationSimpleData.donateur.nationalite}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donateur: {...donationSimpleData.donateur, nationalite: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Profession</Label>
                        <Input
                          value={donationSimpleData.donateur.profession}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donateur: {...donationSimpleData.donateur, profession: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Situation familiale <span className="text-red-500">*</span></Label>
                        <Input
                          value={donationSimpleData.donateur.situationFamiliale}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donateur: {...donationSimpleData.donateur, situationFamiliale: e.target.value}
                          })}
                          className="bg-muted/30"
                        />
                      </div>

                      {(donationSimpleData.donateur.situationFamiliale === "marie" || donationSimpleData.donateur.situationFamiliale === "Mari√©" || donationSimpleData.donateur.situationFamiliale === "mari√©" || donationSimpleData.donateur.situationFamiliale === "mari√©e" || donationSimpleData.donateur.situationFamiliale === "Mari√©e") && (
                        <div className="space-y-2">
                          <Label>R√©gime matrimonial</Label>
                          <Input
                            value={donationSimpleData.donateur.regimeMatrimonial}
                            onChange={(e) => setDonationSimpleData({
                              ...donationSimpleData,
                              donateur: {...donationSimpleData.donateur, regimeMatrimonial: e.target.value}
                            })}
                            className="bg-muted/30"
                          />
                        </div>
                      )}

                      <div className="space-y-2 md:col-span-2">
                        <Label>Adresse compl√®te <span className="text-red-500">*</span></Label>
                        <Input
                          value={donationSimpleData.donateur.adresseComplete}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donateur: {...donationSimpleData.donateur, adresseComplete: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>T√©l√©phone</Label>
                        <Input
                          value={donationSimpleData.donateur.telephone}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donateur: {...donationSimpleData.donateur, telephone: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Email</Label>
                        <Input
                          type="email"
                          value={donationSimpleData.donateur.email}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donateur: {...donationSimpleData.donateur, email: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Situation fiscale (utile pour seuils d'abattement)</Label>
                        <Input
                          value={donationSimpleData.donateur.situationFiscale}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donateur: {...donationSimpleData.donateur, situationFiscale: e.target.value}
                          })}
                          placeholder="Ex: Imposable / Non imposable / Montant revenus..."
                        />
                      </div>
                    </div>
                  </div>

                  {/* 3. Identit√© du donataire */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Identit√© compl√®te du donataire</h3>
                    <p className="text-sm text-muted-foreground">Personne qui re√ßoit la donation</p>
                    
                    <div className="space-y-2">
                      <Label>S√©lectionner un client (optionnel)</Label>
                      <Select
                        value={donationSimpleData.donataire.clientId}
                        onValueChange={(value) => {
                          const client = clients.find(c => c.id === value);
                          if (client) {
                            setDonationSimpleData({
                              ...donationSimpleData,
                              donataire: {
                                ...donationSimpleData.donataire,
                                isClient: true,
                                clientId: value,
                                nom: client.nom || "",
                                prenom: client.prenom || "",
                                nomNaissance: client.nom || "",
                                adresseComplete: client.adresse || "",
                                telephone: client.telephone || "",
                                email: client.email || "",
                                dateNaissance: client.date_naissance || "",
                                lieuNaissance: client.lieu_naissance || "",
                                nationalite: client.nationalite || "",
                                profession: client.profession || "",
                              }
                            });
                          }
                        }}
                      >
                        <SelectTrigger><SelectValue placeholder="Choisir un client..." /></SelectTrigger>
                        <SelectContent>
                          {clients.map((c) => (
                            <SelectItem key={c.id} value={c.id}>{c.nom} {c.prenom}</SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Nom <span className="text-red-500">*</span></Label>
                        <Input
                          value={donationSimpleData.donataire.nom}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donataire: {...donationSimpleData.donataire, nom: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                        <Input
                          value={donationSimpleData.donataire.prenom}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donataire: {...donationSimpleData.donataire, prenom: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Nom de naissance</Label>
                        <Input
                          value={donationSimpleData.donataire.nomNaissance}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donataire: {...donationSimpleData.donataire, nomNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Date de naissance <span className="text-red-500">*</span></Label>
                        <Input
                          type="date"
                          value={donationSimpleData.donataire.dateNaissance}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donataire: {...donationSimpleData.donataire, dateNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Lieu de naissance</Label>
                        <Input
                          value={donationSimpleData.donataire.lieuNaissance}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donataire: {...donationSimpleData.donataire, lieuNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Nationalit√©</Label>
                        <Input
                          value={donationSimpleData.donataire.nationalite}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donataire: {...donationSimpleData.donataire, nationalite: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Profession</Label>
                        <Input
                          value={donationSimpleData.donataire.profession}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donataire: {...donationSimpleData.donataire, profession: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Lien avec le donateur <span className="text-red-500">*</span> (important fiscalement)</Label>
                        <Select
                          value={donationSimpleData.donataire.lienDonateur}
                          onValueChange={(value) => setDonationSimpleData({
                            ...donationSimpleData,
                            donataire: {...donationSimpleData.donataire, lienDonateur: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="enfant">Enfant</SelectItem>
                            <SelectItem value="parent">Parent</SelectItem>
                            <SelectItem value="frere_soeur">Fr√®re / S≈ìur</SelectItem>
                            <SelectItem value="neveu_niece">Neveu / Ni√®ce</SelectItem>
                            <SelectItem value="cousin">Cousin</SelectItem>
                            <SelectItem value="ami">Ami</SelectItem>
                            <SelectItem value="conjoint_pacse">Conjoint pacs√©</SelectItem>
                            <SelectItem value="autre">Autre</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {donationSimpleData.donataire.lienDonateur === "autre" && (
                        <div className="space-y-2 md:col-span-2">
                          <Label>Pr√©cisez le lien <span className="text-red-500">*</span></Label>
                          <Input
                            value={donationSimpleData.donataire.lienDonateurAutrePrecision}
                            onChange={(e) => setDonationSimpleData({
                              ...donationSimpleData,
                              donataire: {...donationSimpleData.donataire, lienDonateurAutrePrecision: e.target.value}
                            })}
                            placeholder="Ex: beau-fils, concubin, petit-neveu, etc."
                          />
                        </div>
                      )}

                      <div className="space-y-2 md:col-span-2">
                        <Label>Adresse compl√®te <span className="text-red-500">*</span></Label>
                        <Input
                          value={donationSimpleData.donataire.adresseComplete}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donataire: {...donationSimpleData.donataire, adresseComplete: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>T√©l√©phone</Label>
                        <Input
                          value={donationSimpleData.donataire.telephone}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donataire: {...donationSimpleData.donataire, telephone: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Email</Label>
                        <Input
                          type="email"
                          value={donationSimpleData.donataire.email}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            donataire: {...donationSimpleData.donataire, email: e.target.value}
                          })}
                        />
                      </div>
                    </div>
                  </div>

                  {/* 4. Enfants / h√©ritiers du donateur */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Enfants / h√©ritiers du donateur</h3>
                    <p className="text-sm text-muted-foreground">Obligatoire pour v√©rifier qu'on n'empi√®te pas sur la r√©serve h√©r√©ditaire</p>
                    
                    <div className="space-y-3">
                      <div className="space-y-2">
                        <Label>Nombre d'enfants</Label>
                        <Input
                          type="number"
                          value={donationSimpleData.nombreEnfants}
                          onChange={(e) => setDonationSimpleData({...donationSimpleData, nombreEnfants: e.target.value})}
                          placeholder="0"
                        />
                      </div>

                      {donationSimpleData.nombreEnfants && parseInt(donationSimpleData.nombreEnfants) > 0 && (
                        <div className="space-y-3">
                          <Label>Identit√© des enfants</Label>
                          {donationSimpleData.enfants.map((enfant, idx) => (
                            <div key={enfant.id} className="p-3 border rounded-lg space-y-2 bg-muted/10">
                              <div className="flex justify-between items-center">
                                <span className="text-sm font-medium">Enfant #{idx + 1}</span>
                                {donationSimpleData.enfants.length > 1 && (
                                  <button
                                    type="button"
                                    onClick={() => {
                                      const newEnfants = donationSimpleData.enfants.filter((_, i) => i !== idx);
                                      setDonationSimpleData({...donationSimpleData, enfants: newEnfants});
                                    }}
                                    className="text-red-600 text-xs"
                                  >
                                    Supprimer
                                  </button>
                                )}
                              </div>
                              <div className="grid grid-cols-3 gap-2">
                                <Input
                                  placeholder="Nom"
                                  value={enfant.nom}
                                  onChange={(e) => {
                                    const newEnfants = [...donationSimpleData.enfants];
                                    newEnfants[idx].nom = e.target.value;
                                    setDonationSimpleData({...donationSimpleData, enfants: newEnfants});
                                  }}
                                />
                                <Input
                                  placeholder="Pr√©nom"
                                  value={enfant.prenom}
                                  onChange={(e) => {
                                    const newEnfants = [...donationSimpleData.enfants];
                                    newEnfants[idx].prenom = e.target.value;
                                    setDonationSimpleData({...donationSimpleData, enfants: newEnfants});
                                  }}
                                />
                                <Input
                                  type="date"
                                  placeholder="Date naissance"
                                  value={enfant.dateNaissance}
                                  onChange={(e) => {
                                    const newEnfants = [...donationSimpleData.enfants];
                                    newEnfants[idx].dateNaissance = e.target.value;
                                    setDonationSimpleData({...donationSimpleData, enfants: newEnfants});
                                  }}
                                />
                              </div>
                            </div>
                          ))}
                          <button
                            type="button"
                            onClick={() => {
                              setDonationSimpleData({
                                ...donationSimpleData,
                                enfants: [...donationSimpleData.enfants, {
                                  id: Date.now(),
                                  nom: "",
                                  prenom: "",
                                  dateNaissance: "",
                                }]
                              });
                            }}
                            className="text-sm text-blue-600 hover:underline"
                          >
                            + Ajouter un enfant
                          </button>
                        </div>
                      )}

                      <div className="space-y-2 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                        <Label className="text-sm font-medium">Type de donation (impact sur succession)</Label>
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="hors_part"
                            checked={donationSimpleData.donationHorsPartSuccessorale}
                            onChange={(e) => setDonationSimpleData({
                              ...donationSimpleData,
                              donationHorsPartSuccessorale: e.target.checked,
                              donationAvancementPart: e.target.checked ? false : donationSimpleData.donationAvancementPart
                            })}
                          />
                          <label htmlFor="hors_part" className="text-sm cursor-pointer">
                            Donation hors part successorale (non rapportable)
                          </label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="avancement_part"
                            checked={donationSimpleData.donationAvancementPart}
                            onChange={(e) => setDonationSimpleData({
                              ...donationSimpleData,
                              donationAvancementPart: e.target.checked,
                              donationHorsPartSuccessorale: e.target.checked ? false : donationSimpleData.donationHorsPartSuccessorale
                            })}
                          />
                          <label htmlFor="avancement_part" className="text-sm cursor-pointer">
                            Donation en avancement de part successorale (rapportable)
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* 5. Description compl√®te du ou des biens donn√©s */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Description compl√®te du ou des biens donn√©s</h3>
                    
                    {/* A. Bien immobilier */}
                    {donationSimpleData.typeDonation === "biens_immobiliers" && (
                      <div className="p-4 border rounded-lg space-y-3 bg-muted/10">
                        <h4 className="font-medium">üè† Bien immobilier</h4>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          <div className="space-y-2 md:col-span-2">
                            <Label>Adresse compl√®te <span className="text-red-500">*</span></Label>
                            <Input
                              value={donationSimpleData.bienImmobilier.adresseComplete}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                bienImmobilier: {...donationSimpleData.bienImmobilier, adresseComplete: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Nature du bien</Label>
                            <Select
                              value={donationSimpleData.bienImmobilier.natureBien}
                              onValueChange={(value) => setDonationSimpleData({
                                ...donationSimpleData,
                                bienImmobilier: {...donationSimpleData.bienImmobilier, natureBien: value}
                              })}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="maison">Maison</SelectItem>
                                <SelectItem value="appartement">Appartement</SelectItem>
                                <SelectItem value="terrain">Terrain</SelectItem>
                                <SelectItem value="dependances">D√©pendances</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          <div className="space-y-2">
                            <Label>Situation locative</Label>
                            <Select
                              value={donationSimpleData.bienImmobilier.situationLocative}
                              onValueChange={(value) => setDonationSimpleData({
                                ...donationSimpleData,
                                bienImmobilier: {...donationSimpleData.bienImmobilier, situationLocative: value}
                              })}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="libre">Libre</SelectItem>
                                <SelectItem value="loue">Lou√©</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          <div className="space-y-2">
                            <Label>Section cadastrale</Label>
                            <Input
                              value={donationSimpleData.bienImmobilier.sectionCadastrale}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                bienImmobilier: {...donationSimpleData.bienImmobilier, sectionCadastrale: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Num√©ro cadastral</Label>
                            <Input
                              value={donationSimpleData.bienImmobilier.numeroCadastral}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                bienImmobilier: {...donationSimpleData.bienImmobilier, numeroCadastral: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Contenance</Label>
                            <Input
                              value={donationSimpleData.bienImmobilier.contenance}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                bienImmobilier: {...donationSimpleData.bienImmobilier, contenance: e.target.value}
                              })}
                              placeholder="Ex: 500m¬≤"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Valeur v√©nale <span className="text-red-500">*</span></Label>
                            <Input
                              type="number"
                              value={donationSimpleData.bienImmobilier.valeurVenale}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                bienImmobilier: {...donationSimpleData.bienImmobilier, valeurVenale: e.target.value}
                              })}
                              placeholder="‚Ç¨"
                            />
                          </div>

                          <div className="space-y-2 md:col-span-2">
                            <Label>Description d√©taill√©e</Label>
                            <textarea
                              className="w-full min-h-[80px] p-2 border rounded-md text-sm"
                              value={donationSimpleData.bienImmobilier.descriptionDetaille}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                bienImmobilier: {...donationSimpleData.bienImmobilier, descriptionDetaille: e.target.value}
                              })}
                            />
                          </div>

                          <div className="flex items-center space-x-2 md:col-span-2">
                            <input
                              type="checkbox"
                              id="existence_hypotheques"
                              checked={donationSimpleData.bienImmobilier.existenceHypotheques}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                bienImmobilier: {...donationSimpleData.bienImmobilier, existenceHypotheques: e.target.checked}
                              })}
                            />
                            <label htmlFor="existence_hypotheques" className="text-sm cursor-pointer">
                              Existence d'hypoth√®ques
                            </label>
                          </div>

                          {donationSimpleData.bienImmobilier.existenceHypotheques && (
                            <div className="space-y-2 md:col-span-2">
                              <Label>Montant des hypoth√®ques</Label>
                              <Input
                                type="number"
                                value={donationSimpleData.bienImmobilier.montantHypotheques}
                                onChange={(e) => setDonationSimpleData({
                                  ...donationSimpleData,
                                  bienImmobilier: {...donationSimpleData.bienImmobilier, montantHypotheques: e.target.value}
                                })}
                                placeholder="‚Ç¨"
                              />
                            </div>
                          )}

                          <div className="space-y-2">
                            <Label>R√©partition usufruit</Label>
                            <Input
                              value={donationSimpleData.bienImmobilier.repartitionUsufruit}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                bienImmobilier: {...donationSimpleData.bienImmobilier, repartitionUsufruit: e.target.value}
                              })}
                              placeholder="Ex: 40%"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>R√©partition nue-propri√©t√©</Label>
                            <Input
                              value={donationSimpleData.bienImmobilier.repartitionNuePropriete}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                bienImmobilier: {...donationSimpleData.bienImmobilier, repartitionNuePropriete: e.target.value}
                              })}
                              placeholder="Ex: 60%"
                            />
                          </div>
                        </div>
                      </div>
                    )}

                    {/* B. Bien mobilier corporel */}
                    {donationSimpleData.typeDonation === "biens_meubles" && (
                      <div className="p-4 border rounded-lg space-y-3 bg-muted/10">
                        <h4 className="font-medium">üöó Bien mobilier corporel</h4>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          <div className="space-y-2 md:col-span-2">
                            <Label>Description pr√©cise du bien <span className="text-red-500">*</span></Label>
                            <textarea
                              className="w-full min-h-[80px] p-2 border rounded-md text-sm"
                              value={donationSimpleData.bienMobilier.descriptionPrecise}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                bienMobilier: {...donationSimpleData.bienMobilier, descriptionPrecise: e.target.value}
                              })}
                              placeholder="Voiture, bijoux, ≈ìuvre d'art, mobilier, mat√©riel..."
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Num√©ro de s√©rie (si v√©hicule ou mat√©riel)</Label>
                            <Input
                              value={donationSimpleData.bienMobilier.numeroSerie}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                bienMobilier: {...donationSimpleData.bienMobilier, numeroSerie: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Valeur estim√©e <span className="text-red-500">*</span></Label>
                            <Input
                              type="number"
                              value={donationSimpleData.bienMobilier.valeurEstimee}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                bienMobilier: {...donationSimpleData.bienMobilier, valeurEstimee: e.target.value}
                              })}
                              placeholder="‚Ç¨"
                            />
                          </div>

                          <div className="flex items-center space-x-2 md:col-span-2">
                            <input
                              type="checkbox"
                              id="facture_existante"
                              checked={donationSimpleData.bienMobilier.factureExistante}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                bienMobilier: {...donationSimpleData.bienMobilier, factureExistante: e.target.checked}
                              })}
                            />
                            <label htmlFor="facture_existante" className="text-sm cursor-pointer">
                              Facture existante
                            </label>
                          </div>
                        </div>
                      </div>
                    )}

                    {/* C. Somme d'argent */}
                    {donationSimpleData.typeDonation === "sommes_argent" && (
                      <div className="p-4 border rounded-lg space-y-3 bg-muted/10">
                        <h4 className="font-medium">üí∞ Somme d'argent</h4>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          <div className="space-y-2">
                            <Label>Montant exact <span className="text-red-500">*</span></Label>
                            <Input
                              type="number"
                              value={donationSimpleData.sommesArgent.montantExact}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                sommesArgent: {...donationSimpleData.sommesArgent, montantExact: e.target.value}
                              })}
                              placeholder="‚Ç¨"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Provenance du fonds</Label>
                            <Input
                              value={donationSimpleData.sommesArgent.provenanceFonds}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                sommesArgent: {...donationSimpleData.sommesArgent, provenanceFonds: e.target.value}
                              })}
                              placeholder="Ex: √âpargne, vente bien, h√©ritage..."
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Modalit√© <span className="text-red-500">*</span></Label>
                            <Select
                              value={donationSimpleData.sommesArgent.modalite}
                              onValueChange={(value) => setDonationSimpleData({
                                ...donationSimpleData,
                                sommesArgent: {...donationSimpleData.sommesArgent, modalite: value}
                              })}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="virement">Virement</SelectItem>
                                <SelectItem value="cheque">Ch√®que</SelectItem>
                                <SelectItem value="especes">Esp√®ces</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          <div className="space-y-2">
                            <Label>Date du transfert</Label>
                            <Input
                              type="date"
                              value={donationSimpleData.sommesArgent.dateTransfert}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                sommesArgent: {...donationSimpleData.sommesArgent, dateTransfert: e.target.value}
                              })}
                            />
                          </div>
                        </div>
                      </div>
                    )}

                    {/* D. Parts sociales / actions */}
                    {donationSimpleData.typeDonation === "parts_sociales" && (
                      <div className="p-4 border rounded-lg space-y-3 bg-muted/10">
                        <h4 className="font-medium">üìà Parts sociales / Actions</h4>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          <div className="space-y-2">
                            <Label>Type de soci√©t√© <span className="text-red-500">*</span></Label>
                            <Input
                              value={donationSimpleData.partsSociales.typeSociete}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                partsSociales: {...donationSimpleData.partsSociales, typeSociete: e.target.value}
                              })}
                              placeholder="Ex: SARL, SAS, SA..."
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Nombre de parts/actions <span className="text-red-500">*</span></Label>
                            <Input
                              type="number"
                              value={donationSimpleData.partsSociales.nombreParts}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                partsSociales: {...donationSimpleData.partsSociales, nombreParts: e.target.value}
                              })}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Valeur unitaire <span className="text-red-500">*</span></Label>
                            <Input
                              type="number"
                              value={donationSimpleData.partsSociales.valeurUnitaire}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                partsSociales: {...donationSimpleData.partsSociales, valeurUnitaire: e.target.value}
                              })}
                              placeholder="‚Ç¨"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Pourcentage du capital</Label>
                            <Input
                              type="number"
                              value={donationSimpleData.partsSociales.pourcentageCapital}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                partsSociales: {...donationSimpleData.partsSociales, pourcentageCapital: e.target.value}
                              })}
                              placeholder="%"
                            />
                          </div>

                          <div className="flex items-center space-x-2 md:col-span-2">
                            <input
                              type="checkbox"
                              id="agrement_obligatoire"
                              checked={donationSimpleData.partsSociales.agrementObligatoire}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                partsSociales: {...donationSimpleData.partsSociales, agrementObligatoire: e.target.checked}
                              })}
                            />
                            <label htmlFor="agrement_obligatoire" className="text-sm cursor-pointer">
                              Agr√©ment obligatoire
                            </label>
                          </div>

                          <div className="space-y-2 md:col-span-2">
                            <Label>Clauses sp√©cifiques (inali√©nabilit√©...)</Label>
                            <textarea
                              className="w-full min-h-[60px] p-2 border rounded-md text-sm"
                              value={donationSimpleData.partsSociales.clausesSpecifiques}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                partsSociales: {...donationSimpleData.partsSociales, clausesSpecifiques: e.target.value}
                              })}
                            />
                          </div>
                        </div>
                      </div>
                    )}

                    {/* E. Nue-propri√©t√© / Usufruit */}
                    {(donationSimpleData.typeDonation === "nue_propriete" || donationSimpleData.typeDonation === "usufruit") && (
                      <div className="p-4 border rounded-lg space-y-3 bg-muted/10">
                        <h4 className="font-medium">üîì Nue-propri√©t√© / Usufruit</h4>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          <div className="space-y-2">
                            <Label>Valeur de la nue-propri√©t√© <span className="text-red-500">*</span></Label>
                            <Input
                              type="number"
                              value={donationSimpleData.nueProprieteUsufruit.valeurNuePropriete}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                nueProprieteUsufruit: {...donationSimpleData.nueProprieteUsufruit, valeurNuePropriete: e.target.value}
                              })}
                              placeholder="‚Ç¨"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Valeur de l'usufruit <span className="text-red-500">*</span></Label>
                            <Input
                              type="number"
                              value={donationSimpleData.nueProprieteUsufruit.valeurUsufruit}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                nueProprieteUsufruit: {...donationSimpleData.nueProprieteUsufruit, valeurUsufruit: e.target.value}
                              })}
                              placeholder="‚Ç¨"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Dur√©e</Label>
                            <Select
                              value={donationSimpleData.nueProprieteUsufruit.duree}
                              onValueChange={(value) => setDonationSimpleData({
                                ...donationSimpleData,
                                nueProprieteUsufruit: {...donationSimpleData.nueProprieteUsufruit, duree: value}
                              })}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="temporaire">Temporaire</SelectItem>
                                <SelectItem value="viager">Viager</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          <div className="space-y-2">
                            <Label>R√©partition des charges</Label>
                            <Input
                              value={donationSimpleData.nueProprieteUsufruit.repartitionCharges}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                nueProprieteUsufruit: {...donationSimpleData.nueProprieteUsufruit, repartitionCharges: e.target.value}
                              })}
                              placeholder="Ex: Charges courantes / grosses r√©parations..."
                            />
                          </div>

                          <div className="flex items-center space-x-2 md:col-span-2">
                            <input
                              type="checkbox"
                              id="usufruit_simultane"
                              checked={donationSimpleData.nueProprieteUsufruit.usufruitSimultaneConjoint}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                nueProprieteUsufruit: {...donationSimpleData.nueProprieteUsufruit, usufruitSimultaneConjoint: e.target.checked}
                              })}
                            />
                            <label htmlFor="usufruit_simultane" className="text-sm cursor-pointer">
                              Usufruit simultan√© du conjoint (rare)
                            </label>
                          </div>
                        </div>
                      </div>
                    )}
                  </div>

                  {/* 6. Clauses optionnelles */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Clauses optionnelles de donation</h3>
                    
                    {/* A. R√©serve d'usufruit */}
                    <div className="p-3 border rounded-lg space-y-3 bg-blue-50/30">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="reserve_usufruit"
                          checked={donationSimpleData.clausesOptionnelles.reserveUsufruit}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, reserveUsufruit: e.target.checked}
                          })}
                        />
                        <label htmlFor="reserve_usufruit" className="font-medium cursor-pointer">
                          A. R√©serve d'usufruit
                        </label>
                      </div>
                      {donationSimpleData.clausesOptionnelles.reserveUsufruit && (
                        <div className="space-y-2 ml-6">
                          <div className="space-y-2">
                            <Label>√âtendue de l'usufruit</Label>
                            <textarea
                              className="w-full min-h-[60px] p-2 border rounded-md text-sm"
                              value={donationSimpleData.clausesOptionnelles.etendueUsufruit}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, etendueUsufruit: e.target.value}
                              })}
                            />
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="droit_usage_habitation"
                              checked={donationSimpleData.clausesOptionnelles.droitUsageHabitation}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, droitUsageHabitation: e.target.checked}
                              })}
                            />
                            <label htmlFor="droit_usage_habitation" className="text-sm cursor-pointer">
                              Droit d'usage / habitation
                            </label>
                          </div>
                        </div>
                      )}
                    </div>

                    {/* B. Droit de retour conventionnel */}
                    <div className="p-3 border rounded-lg space-y-3 bg-green-50/30">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="droit_retour_clause"
                          checked={donationSimpleData.clausesOptionnelles.droitRetour}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, droitRetour: e.target.checked}
                          })}
                        />
                        <label htmlFor="droit_retour_clause" className="font-medium cursor-pointer">
                          B. Droit de retour conventionnel
                        </label>
                      </div>
                      <p className="text-xs text-muted-foreground ml-6">
                        Permet au donateur de r√©cup√©rer le bien si le donataire d√©c√®de avant lui
                      </p>
                      {donationSimpleData.clausesOptionnelles.droitRetour && (
                        <div className="space-y-2 ml-6">
                          <Label>√âtendue du droit de retour</Label>
                          <Select
                            value={donationSimpleData.clausesOptionnelles.etendueRetour}
                            onValueChange={(value) => setDonationSimpleData({
                              ...donationSimpleData,
                              clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, etendueRetour: value}
                            })}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="totalite">Sur totalit√© du bien</SelectItem>
                              <SelectItem value="part_recue">Sur part re√ßue seulement</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                      )}
                    </div>

                    {/* C. Charge impos√©e */}
                    <div className="p-3 border rounded-lg space-y-3 bg-orange-50/30">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="charge_imposee"
                          checked={donationSimpleData.clausesOptionnelles.chargeImposee}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, chargeImposee: e.target.checked}
                          })}
                        />
                        <label htmlFor="charge_imposee" className="font-medium cursor-pointer">
                          C. Charge impos√©e au donataire
                        </label>
                      </div>
                      {donationSimpleData.clausesOptionnelles.chargeImposee && (
                        <div className="space-y-2 ml-6">
                          <div className="space-y-2">
                            <Label>Description compl√®te de la charge</Label>
                            <textarea
                              className="w-full min-h-[60px] p-2 border rounded-md text-sm"
                              value={donationSimpleData.clausesOptionnelles.descriptionCharge}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, descriptionCharge: e.target.value}
                              })}
                              placeholder="Ex: Payer des frais, entretenir un bien, laisser l'usage au donateur..."
                            />
                          </div>
                          <div className="space-y-2">
                            <Label>Montant ou nature</Label>
                            <Input
                              value={donationSimpleData.clausesOptionnelles.montantNatureCharge}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, montantNatureCharge: e.target.value}
                              })}
                            />
                          </div>
                          <div className="space-y-2">
                            <Label>Conditions d'ex√©cution</Label>
                            <textarea
                              className="w-full min-h-[60px] p-2 border rounded-md text-sm"
                              value={donationSimpleData.clausesOptionnelles.conditionsExecution}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, conditionsExecution: e.target.value}
                              })}
                            />
                          </div>
                        </div>
                      )}
                    </div>

                    {/* D. Affectation particuli√®re */}
                    <div className="p-3 border rounded-lg space-y-2 bg-purple-50/30">
                      <label className="font-medium">D. Affectation particuli√®re</label>
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="usage_professionnel"
                          checked={donationSimpleData.clausesOptionnelles.usageProfessionnel}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, usageProfessionnel: e.target.checked}
                          })}
                        />
                        <label htmlFor="usage_professionnel" className="text-sm cursor-pointer">
                          Bien donn√© pour usage professionnel
                        </label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="exclusion_communaute"
                          checked={donationSimpleData.clausesOptionnelles.exclusionCommunaute}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, exclusionCommunaute: e.target.checked}
                          })}
                        />
                        <label htmlFor="exclusion_communaute" className="text-sm cursor-pointer">
                          Exclusion de la communaut√© en cas de mariage du donataire
                        </label>
                      </div>
                    </div>

                    {/* E. Donation rapportable */}
                    <div className="p-3 border rounded-lg space-y-2 bg-teal-50/30">
                      <label className="font-medium">E. Donation rapportable ou non</label>
                      <Select
                        value={donationSimpleData.clausesOptionnelles.donationRapportable}
                        onValueChange={(value) => setDonationSimpleData({
                          ...donationSimpleData,
                          clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, donationRapportable: value}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="avancement_hoirie">Donation en avancement d'hoirie (rapportable)</SelectItem>
                          <SelectItem value="hors_part">Donation hors part successorale (non rapportable)</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    {/* F. Clause d'inali√©nabilit√© */}
                    <div className="p-3 border rounded-lg space-y-3 bg-red-50/30">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="clause_inalienabilite"
                          checked={donationSimpleData.clausesOptionnelles.clauseInalienabilite}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, clauseInalienabilite: e.target.checked}
                          })}
                        />
                        <label htmlFor="clause_inalienabilite" className="font-medium cursor-pointer">
                          F. Clause d'inali√©nabilit√© (rare et encadr√©e)
                        </label>
                      </div>
                      {donationSimpleData.clausesOptionnelles.clauseInalienabilite && (
                        <div className="space-y-2 ml-6">
                          <div className="space-y-2">
                            <Label>Dur√©e</Label>
                            <Input
                              value={donationSimpleData.clausesOptionnelles.dureeInalienabilite}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, dureeInalienabilite: e.target.value}
                              })}
                              placeholder="Ex: 10 ans"
                            />
                          </div>
                          <div className="space-y-2">
                            <Label>Motif l√©gitime <span className="text-red-500">*</span></Label>
                            <textarea
                              className="w-full min-h-[60px] p-2 border rounded-md text-sm"
                              value={donationSimpleData.clausesOptionnelles.motifLegitime}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, motifLegitime: e.target.value}
                              })}
                              placeholder="Requis par la loi"
                            />
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="autorisation_requise"
                              checked={donationSimpleData.clausesOptionnelles.autorisationRequise}
                              onChange={(e) => setDonationSimpleData({
                                ...donationSimpleData,
                                clausesOptionnelles: {...donationSimpleData.clausesOptionnelles, autorisationRequise: e.target.checked}
                              })}
                            />
                            <label htmlFor="autorisation_requise" className="text-sm cursor-pointer">
                              Autorisation du donateur requise pour vendre
                            </label>
                          </div>
                        </div>
                      )}
                    </div>
                  </div>

                  {/* 7. Acceptation du donataire */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Acceptation du donataire</h3>
                    <p className="text-sm text-muted-foreground">La donation n'existe l√©galement que si l'acceptation est expresse</p>
                    
                    <div className="p-4 border rounded-lg space-y-4 bg-blue-50/30">
                      <div className="space-y-3">
                        <Label className="font-medium">Le donataire accepte-t-il la donation dans cet acte ?</Label>
                        <div className="flex items-center space-x-4">
                          <div className="flex items-center space-x-2">
                            <input
                              type="radio"
                              id="acceptation_dans_acte"
                              checked={donationSimpleData.acceptationDonataire.dansActe === true}
                              onChange={() => setDonationSimpleData({
                                ...donationSimpleData,
                                acceptationDonataire: {...donationSimpleData.acceptationDonataire, dansActe: true}
                              })}
                            />
                            <label htmlFor="acceptation_dans_acte" className="text-sm cursor-pointer">Oui, dans cet acte</label>
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="radio"
                              id="acceptation_acte_separe"
                              checked={donationSimpleData.acceptationDonataire.dansActe === false}
                              onChange={() => setDonationSimpleData({
                                ...donationSimpleData,
                                acceptationDonataire: {...donationSimpleData.acceptationDonataire, dansActe: false}
                              })}
                            />
                            <label htmlFor="acceptation_acte_separe" className="text-sm cursor-pointer">Non, acceptation dans un acte s√©par√©</label>
                          </div>
                        </div>
                      </div>

                      {!donationSimpleData.acceptationDonataire.dansActe && (
                        <div className="space-y-3 p-3 bg-amber-50 border border-amber-200 rounded-lg">
                          <p className="text-sm font-medium text-amber-800">‚ö†Ô∏è Informations sur l'acte d'acceptation s√©par√©</p>
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="space-y-2">
                              <Label>Date de l'acte d'acceptation <span className="text-red-500">*</span></Label>
                              <Input
                                type="date"
                                value={donationSimpleData.acceptationDonataire.dateAcceptation}
                                onChange={(e) => setDonationSimpleData({
                                  ...donationSimpleData,
                                  acceptationDonataire: {...donationSimpleData.acceptationDonataire, dateAcceptation: e.target.value}
                                })}
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Lieu de signature <span className="text-red-500">*</span></Label>
                              <Input
                                value={donationSimpleData.acceptationDonataire.lieuAcceptation}
                                onChange={(e) => setDonationSimpleData({
                                  ...donationSimpleData,
                                  acceptationDonataire: {...donationSimpleData.acceptationDonataire, lieuAcceptation: e.target.value}
                                })}
                                placeholder="Ville"
                              />
                            </div>
                          </div>
                          <p className="text-xs text-amber-700">üìé N'oubliez pas de joindre l'acte d'acceptation dans la section Documents</p>
                        </div>
                      )}

                      {donationSimpleData.acceptationDonataire.dansActe && (
                        <div className="p-3 bg-green-50 border border-green-200 rounded-lg">
                          <p className="text-sm text-green-800">‚úì L'acceptation sera formalis√©e dans l'acte de donation lui-m√™me</p>
                        </div>
                      )}
                    </div>
                  </div>

                  {/* 8. Modalit√©s de remise du bien */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Modalit√©s de remise / transfert du bien</h3>
                    <p className="text-sm text-muted-foreground">Le Code civil exige de pr√©ciser quand et comment le donataire re√ßoit r√©ellement la chose</p>
                    
                    <div className="p-4 border rounded-lg space-y-4 bg-purple-50/30">
                      <div className="space-y-2">
                        <Label>Mode de remise <span className="text-red-500">*</span></Label>
                        <Select
                          value={donationSimpleData.modalitesRemise.modeRemise}
                          onValueChange={(value) => setDonationSimpleData({
                            ...donationSimpleData,
                            modalitesRemise: {...donationSimpleData.modalitesRemise, modeRemise: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="immediate">Remise mat√©rielle imm√©diate</SelectItem>
                            <SelectItem value="differee">Remise diff√©r√©e</SelectItem>
                            <SelectItem value="don_manuel_deja_realise">Don manuel d√©j√† r√©alis√© (donation post√©rieure)</SelectItem>
                            <SelectItem value="symbolique">Remise symbolique (cl√©, document, certificat...)</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <Label>Lieu de remise</Label>
                          <Input
                            value={donationSimpleData.modalitesRemise.lieuRemise}
                            onChange={(e) => setDonationSimpleData({
                              ...donationSimpleData,
                              modalitesRemise: {...donationSimpleData.modalitesRemise, lieuRemise: e.target.value}
                            })}
                            placeholder="Adresse ou lieu"
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>Date pr√©vue de remise</Label>
                          <Input
                            type="date"
                            value={donationSimpleData.modalitesRemise.dateRemise}
                            onChange={(e) => setDonationSimpleData({
                              ...donationSimpleData,
                              modalitesRemise: {...donationSimpleData.modalitesRemise, dateRemise: e.target.value}
                            })}
                          />
                        </div>
                      </div>

                      <div className="space-y-2">
                        <Label>Personne responsable de la remise</Label>
                        <Input
                          value={donationSimpleData.modalitesRemise.personneResponsable}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            modalitesRemise: {...donationSimpleData.modalitesRemise, personneResponsable: e.target.value}
                          })}
                          placeholder="Nom de la personne"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Document remis avec le bien</Label>
                        <Select
                          value={donationSimpleData.modalitesRemise.documentRemis}
                          onValueChange={(value) => setDonationSimpleData({
                            ...donationSimpleData,
                            modalitesRemise: {...donationSimpleData.modalitesRemise, documentRemis: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="carte_grise">Carte grise</SelectItem>
                            <SelectItem value="certificat">Certificat</SelectItem>
                            <SelectItem value="facture">Facture</SelectItem>
                            <SelectItem value="cle">Cl√©</SelectItem>
                            <SelectItem value="titre_propriete">Titre de propri√©t√©</SelectItem>
                            <SelectItem value="autre">Autre document</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="p-3 bg-blue-50 border border-blue-200 rounded-lg">
                        <p className="text-xs text-blue-800">
                          üí° <strong>Exemple de clause g√©n√©r√©e :</strong><br/>
                          "La propri√©t√© est transf√©r√©e imm√©diatement, et la remise mat√©rielle du bien interviendra le [date] √† [lieu], avec remise de [document]."
                        </p>
                      </div>
                    </div>
                  </div>

                  {/* 9. Mentions l√©gales obligatoires */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Mentions l√©gales obligatoires</h3>
                    <p className="text-sm text-muted-foreground">L'acte doit imp√©rativement contenir :</p>
                    
                    <div className="space-y-2 p-4 bg-amber-50 border border-amber-200 rounded-lg">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="acceptation_expresse"
                          checked={donationSimpleData.mentionsLegales.acceptationExpresse}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            mentionsLegales: {...donationSimpleData.mentionsLegales, acceptationExpresse: e.target.checked}
                          })}
                        />
                        <label htmlFor="acceptation_expresse" className="text-sm cursor-pointer">
                          <span className="text-red-500 font-bold">*</span> Acceptation expresse du donataire (obligatoire)
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="consentement_eclaire"
                          checked={donationSimpleData.mentionsLegales.consentementEclaire}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            mentionsLegales: {...donationSimpleData.mentionsLegales, consentementEclaire: e.target.checked}
                          })}
                        />
                        <label htmlFor="consentement_eclaire" className="text-sm cursor-pointer">
                          <span className="text-red-500 font-bold">*</span> Consentement √©clair√© du donateur (obligatoire)
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="caractere_present"
                          checked={donationSimpleData.mentionsLegales.caracterePresentIrrevocable}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            mentionsLegales: {...donationSimpleData.mentionsLegales, caracterePresentIrrevocable: e.target.checked}
                          })}
                          disabled
                        />
                        <label htmlFor="caractere_present" className="text-sm cursor-pointer text-muted-foreground">
                          Caract√®re pr√©sent et irr√©vocable de la donation
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="mention_reserve"
                          checked={donationSimpleData.mentionsLegales.mentionReserveHereditaire}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            mentionsLegales: {...donationSimpleData.mentionsLegales, mentionReserveHereditaire: e.target.checked}
                          })}
                          disabled
                        />
                        <label htmlFor="mention_reserve" className="text-sm cursor-pointer text-muted-foreground">
                          Mention du non-respect possible de la r√©serve h√©r√©ditaire
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="modalites_transfert"
                          checked={donationSimpleData.mentionsLegales.modalitesTransfertPropriete}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            mentionsLegales: {...donationSimpleData.mentionsLegales, modalitesTransfertPropriete: e.target.checked}
                          })}
                          disabled
                        />
                        <label htmlFor="modalites_transfert" className="text-sm cursor-pointer text-muted-foreground">
                          Modalit√©s de transfert de propri√©t√©
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="rappel_articles"
                          checked={donationSimpleData.mentionsLegales.rappelArticlesCodeCivil}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            mentionsLegales: {...donationSimpleData.mentionsLegales, rappelArticlesCodeCivil: e.target.checked}
                          })}
                          disabled
                        />
                        <label htmlFor="rappel_articles" className="text-sm cursor-pointer text-muted-foreground">
                          Rappel des articles du Code civil
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="obligations_fiscales"
                          checked={donationSimpleData.mentionsLegales.obligationsFiscales}
                          onChange={(e) => setDonationSimpleData({
                            ...donationSimpleData,
                            mentionsLegales: {...donationSimpleData.mentionsLegales, obligationsFiscales: e.target.checked}
                          })}
                          disabled
                        />
                        <label htmlFor="obligations_fiscales" className="text-sm cursor-pointer text-muted-foreground">
                          Obligations fiscales (d√©claration de don manuel ou IFI)
                        </label>
                      </div>
                    </div>
                  </div>

                  {/* 10. Documents obligatoires √† collecter */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Documents obligatoires √† collecter</h3>
                    
                    {/* Documents donateur */}
                    <div className="p-4 border rounded-lg space-y-4 bg-muted/10">
                      <h4 className="font-medium text-base">üìÑ Pour le donateur</h4>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        
                        {/* Carte identit√© donateur */}
                        <div className="space-y-2">
                          <Label>Carte d'identit√© <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="donation_simple_donateur_identite"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationSimpleDonateurIdentiteFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_simple_donateur_identite" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationSimpleDonateurIdentiteFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationSimpleDonateurIdentiteFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationSimpleDonateurIdentiteFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Livret famille */}
                        <div className="space-y-2">
                          <Label>Livret de famille</Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="donation_simple_donateur_livret"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationSimpleDonateurLivretFamilleFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_simple_donateur_livret" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationSimpleDonateurLivretFamilleFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationSimpleDonateurLivretFamilleFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationSimpleDonateurLivretFamilleFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Justificatif domicile donateur */}
                        <div className="space-y-2">
                          <Label>Justificatif de domicile <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="donation_simple_donateur_domicile"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationSimpleDonateurDomicileFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_simple_donateur_domicile" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationSimpleDonateurDomicileFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationSimpleDonateurDomicileFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationSimpleDonateurDomicileFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Documents donataire */}
                    <div className="p-4 border rounded-lg space-y-4 bg-muted/10">
                      <h4 className="font-medium text-base">üìÑ Pour le donataire</h4>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        
                        {/* Pi√®ce identit√© donataire */}
                        <div className="space-y-2">
                          <Label>Pi√®ce d'identit√© <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="donation_simple_donataire_identite"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationSimpleDonatairePieceIdentiteFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_simple_donataire_identite" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationSimpleDonatairePieceIdentiteFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationSimpleDonatairePieceIdentiteFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationSimpleDonatairePieceIdentiteFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Justificatif domicile donataire */}
                        <div className="space-y-2">
                          <Label>Justificatif de domicile <span className="text-red-500">*</span></Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="donation_simple_donataire_domicile"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationSimpleDonataireDomicileFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_simple_donataire_domicile" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationSimpleDonataireDomicileFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationSimpleDonataireDomicileFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationSimpleDonataireDomicileFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Documents selon type de bien */}
                    <div className="p-4 border rounded-lg space-y-4 bg-muted/10">
                      <h4 className="font-medium text-base">üìÑ Documents selon le type de bien</h4>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        
                        {/* Titre propri√©t√© */}
                        {donationSimpleData.typeDonation === "biens_immobiliers" && (
                          <div className="space-y-2">
                            <Label>Titre de propri√©t√©</Label>
                            <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                              <input
                                type="file"
                                accept="application/pdf"
                                multiple
                                className="hidden"
                                id="donation_simple_titre_propriete"
                                onChange={(e) => {
                                  const files = Array.from(e.target.files || []);
                                  setDonationSimpleTitreProprieteFiles(prev => [...prev, ...files]);
                                }}
                              />
                              <label htmlFor="donation_simple_titre_propriete" className="cursor-pointer text-sm text-muted-foreground">
                                Cliquez pour joindre
                              </label>
                              {donationSimpleTitreProprieteFiles.length > 0 && (
                                <div className="mt-2 space-y-1">
                                  {donationSimpleTitreProprieteFiles.map((file, idx) => (
                                    <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                      <span className="truncate">{file.name}</span>
                                      <button
                                        type="button"
                                        onClick={() => setDonationSimpleTitreProprieteFiles(prev => prev.filter((_, i) => i !== idx))}
                                        className="text-red-600 ml-2"
                                      >
                                        ‚úï
                                      </button>
                                    </div>
                                  ))}
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        {/* √âvaluation bien */}
                        <div className="space-y-2">
                          <Label>√âvaluation du bien</Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf"
                              multiple
                              className="hidden"
                              id="donation_simple_evaluation"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationSimpleEvaluationBienFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_simple_evaluation" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre
                            </label>
                            {donationSimpleEvaluationBienFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationSimpleEvaluationBienFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationSimpleEvaluationBienFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Autres documents */}
                        <div className="space-y-2 md:col-span-2">
                          <Label>Autres documents</Label>
                          <div className="border-2 border-dashed border-muted-foreground/25 rounded-lg p-3">
                            <input
                              type="file"
                              accept="application/pdf,image/*"
                              multiple
                              className="hidden"
                              id="donation_simple_autres"
                              onChange={(e) => {
                                const files = Array.from(e.target.files || []);
                                setDonationSimpleAutresDocumentsFiles(prev => [...prev, ...files]);
                              }}
                            />
                            <label htmlFor="donation_simple_autres" className="cursor-pointer text-sm text-muted-foreground">
                              Cliquez pour joindre (statuts soci√©t√©, RIB, diagnostics, etc.)
                            </label>
                            {donationSimpleAutresDocumentsFiles.length > 0 && (
                              <div className="mt-2 space-y-1">
                                {donationSimpleAutresDocumentsFiles.map((file, idx) => (
                                  <div key={idx} className="flex items-center justify-between text-xs bg-muted p-1 rounded">
                                    <span className="truncate">{file.name}</span>
                                    <button
                                      type="button"
                                      onClick={() => setDonationSimpleAutresDocumentsFiles(prev => prev.filter((_, i) => i !== idx))}
                                      className="text-red-600 ml-2"
                                    >
                                      ‚úï
                                    </button>
                                  </div>
                                ))}
                              </div>
                            )}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                </div>
              </>
            )}

            {/* Formulaire Testament */}
            {pendingContractType === "Testament authentique ou mystique" && (
              <>
                <div className="space-y-6 max-h-[calc(100vh-250px)] overflow-y-auto pr-2">
                  
                  {/* S√©lecteur de type de testament */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Quel type de testament souhaitez-vous r√©diger ?</h3>
                    
                    <div className="space-y-2">
                      <Label>Type de testament <span className="text-red-500">*</span></Label>
                      <Select
                        value={testamentData.typeTestament || undefined}
                        onValueChange={(value) => setTestamentData({...testamentData, typeTestament: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner le type de testament..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="authentique">Testament authentique (dict√© au notaire)</SelectItem>
                          <SelectItem value="mystique">Testament mystique (cachet√© et remis au notaire)</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>

                  {/* Testament authentique - STRUCTURE COMPL√àTE */}
                  {testamentData.typeTestament === "authentique" && (
                    <div className="space-y-6">
                      
                      {/* Informations g√©n√©rales */}
                      <div className="space-y-4">
                        <h3 className="font-semibold text-lg border-b pb-2">Informations g√©n√©rales sur le testament</h3>
                        <div className="p-4 border-2 rounded-lg space-y-4 bg-gray-50/50 border-gray-300">
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="space-y-2">
                              <Label>Type de testament <span className="text-red-500">*</span></Label>
                              <Input value="Testament authentique (dict√© au notaire)" disabled className="bg-gray-100" />
                            </div>

                            <div className="space-y-2">
                              <Label>Caract√®re du testament <span className="text-red-500">*</span></Label>
                              <Select
                                value={testamentData.testamentAuthentique.caractere || undefined}
                                onValueChange={(value) => setTestamentData({
                                  ...testamentData,
                                  testamentAuthentique: {...testamentData.testamentAuthentique, caractere: value}
                                })}
                              >
                                <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="initial">Testament initial</SelectItem>
                                  <SelectItem value="modificatif">Testament modificatif</SelectItem>
                                  <SelectItem value="revocatoire">Testament r√©vocatoire</SelectItem>
                                </SelectContent>
                              </Select>
                            </div>

                            <div className="space-y-2">
                              <Label>Date souhait√©e de r√©daction</Label>
                              <Input
                                type="date"
                                value={testamentData.testamentAuthentique.dateSouhaitee}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentAuthentique: {...testamentData.testamentAuthentique, dateSouhaitee: e.target.value}
                                })}
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>Langue comprise par le testateur <span className="text-red-500">*</span></Label>
                              <Select
                                value={testamentData.langueTestateur || undefined}
                                onValueChange={(value) => setTestamentData({...testamentData, langueTestateur: value})}
                              >
                                <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="francais">Fran√ßais</SelectItem>
                                  <SelectItem value="anglais">Anglais</SelectItem>
                                  <SelectItem value="espagnol">Espagnol</SelectItem>
                                  <SelectItem value="italien">Italien</SelectItem>
                                  <SelectItem value="allemand">Allemand</SelectItem>
                                  <SelectItem value="portugais">Portugais</SelectItem>
                                  <SelectItem value="arabe">Arabe</SelectItem>
                                  <SelectItem value="autre">Autre langue</SelectItem>
                                </SelectContent>
                              </Select>
                            </div>

                            {testamentData.langueTestateur === "autre" && (
                              <div className="space-y-2 md:col-span-2">
                                <Label>Pr√©ciser la langue <span className="text-red-500">*</span></Label>
                                <Input
                                  value={testamentData.autreLangue}
                                  onChange={(e) => setTestamentData({...testamentData, autreLangue: e.target.value})}
                                  placeholder="Ex: Mandarin, Russe, etc."
                                />
                              </div>
                            )}
                          </div>

                          {/* Testament ant√©rieur */}
                          <div className="border-t pt-4 space-y-3">
                            <h4 className="font-medium">Testament ant√©rieur existant ?</h4>
                            <div className="flex items-center space-x-4">
                              <label className="flex items-center space-x-2 cursor-pointer">
                                <input
                                  type="radio"
                                  name="testamentAnterieur"
                                  checked={testamentData.testamentAnterieur === true}
                                  onChange={() => setTestamentData({...testamentData, testamentAnterieur: true})}
                                  className="w-4 h-4"
                                />
                                <span>Oui</span>
                              </label>
                              <label className="flex items-center space-x-2 cursor-pointer">
                                <input
                                  type="radio"
                                  name="testamentAnterieur"
                                  checked={testamentData.testamentAnterieur === false}
                                  onChange={() => setTestamentData({...testamentData, testamentAnterieur: false})}
                                  className="w-4 h-4"
                                />
                                <span>Non</span>
                              </label>
                            </div>

                            {testamentData.testamentAnterieur && (
                              <div className="ml-6 p-3 bg-yellow-50 rounded-lg border border-yellow-300 space-y-3">
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                  <div className="space-y-2">
                                    <Label>Date du pr√©c√©dent testament</Label>
                                    <Input
                                      type="date"
                                      value={testamentData.testamentAnterieurDate}
                                      onChange={(e) => setTestamentData({...testamentData, testamentAnterieurDate: e.target.value})}
                                    />
                                  </div>
                                  <div className="space-y-2">
                                    <Label>Type du pr√©c√©dent testament</Label>
                                    <Select
                                      value={testamentData.testamentAnterieurType || undefined}
                                      onValueChange={(value) => setTestamentData({...testamentData, testamentAnterieurType: value})}
                                    >
                                      <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                      <SelectContent>
                                        <SelectItem value="authentique">Testament authentique</SelectItem>
                                        <SelectItem value="mystique">Testament mystique</SelectItem>
                                        <SelectItem value="olographe">Testament olographe</SelectItem>
                                      </SelectContent>
                                    </Select>
                                  </div>
                                  <div className="space-y-2 md:col-span-2">
                                    <Label>Notaire d√©positaire (si connu)</Label>
                                    <Input
                                      value={testamentData.testamentAnterieurNotaire}
                                      onChange={(e) => setTestamentData({...testamentData, testamentAnterieurNotaire: e.target.value})}
                                      placeholder="Nom et adresse du notaire"
                                    />
                                  </div>
                                </div>
                              </div>
                            )}
                          </div>

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="interprete"
                              checked={testamentData.interpreteNecessaire}
                              onChange={(e) => setTestamentData({...testamentData, interpreteNecessaire: e.target.checked})}
                            />
                            <label htmlFor="interprete" className="text-sm cursor-pointer font-medium">
                              Recours √† un interpr√®te n√©cessaire
                            </label>
                          </div>

                          {testamentData.interpreteNecessaire && (
                            <div className="ml-6 p-3 bg-white rounded-lg space-y-3 border border-purple-300">
                              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div className="space-y-2">
                                  <Label>Nom de l'interpr√®te <span className="text-red-500">*</span></Label>
                                  <Input
                                    value={testamentData.interpreteNom}
                                    onChange={(e) => setTestamentData({...testamentData, interpreteNom: e.target.value})}
                                  />
                                </div>
                                <div className="space-y-2">
                                  <Label>Langue traduite <span className="text-red-500">*</span></Label>
                                  <Input
                                    value={testamentData.interpreteLangueTraduite}
                                    onChange={(e) => setTestamentData({...testamentData, interpreteLangueTraduite: e.target.value})}
                                    placeholder="Ex: Arabe vers Fran√ßais"
                                  />
                                </div>
                                <div className="space-y-2">
                                  <Label>Attestation de fid√©lit√© <span className="text-red-500">*</span></Label>
                                  <Input
                                    value={testamentData.interpreteAttestationFidelite}
                                    onChange={(e) => setTestamentData({...testamentData, interpreteAttestationFidelite: e.target.value})}
                                    placeholder="R√©f√©rence attestation asserment√©e"
                                  />
                                </div>
                                <div className="space-y-2">
                                  <Label>Signature de l'interpr√®te <span className="text-red-500">*</span></Label>
                                  <Input
                                    value={testamentData.interpreteSignature}
                                    onChange={(e) => setTestamentData({...testamentData, interpreteSignature: e.target.value})}
                                    placeholder="Mention de signature"
                                  />
                                </div>
                              </div>
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Identit√© testateur */}
                      <div className="space-y-4">
                        <h3 className="font-semibold text-lg border-b pb-2">Identit√© compl√®te du testateur</h3>
                        <div className="p-4 border-2 rounded-lg space-y-4 bg-blue-50/50 border-blue-300">
                          <div className="space-y-2">
                            <Label>S√©lectionner un client (optionnel)</Label>
                            <Select
                              value={testamentData.clientId || undefined}
                              onValueChange={(value) => setTestamentData({...testamentData, clientId: value})}
                            >
                              <SelectTrigger><SelectValue placeholder="Choisir un client..." /></SelectTrigger>
                              <SelectContent>
                                {/* Ici on mappera les clients r√©els */}
                              </SelectContent>
                            </Select>
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="space-y-2">
                              <Label>Nom <span className="text-red-500">*</span></Label>
                              <Input
                                value={testamentData.testateurNom}
                                onChange={(e) => setTestamentData({...testamentData, testateurNom: e.target.value})}
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                              <Input
                                value={testamentData.testateurPrenom}
                                onChange={(e) => setTestamentData({...testamentData, testateurPrenom: e.target.value})}
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Nom de naissance</Label>
                              <Input
                                value={testamentData.testateurNomNaissance}
                                onChange={(e) => setTestamentData({...testamentData, testateurNomNaissance: e.target.value})}
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Date de naissance <span className="text-red-500">*</span></Label>
                              <Input
                                type="date"
                                value={testamentData.testateurDateNaissance}
                                onChange={(e) => setTestamentData({...testamentData, testateurDateNaissance: e.target.value})}
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Lieu de naissance</Label>
                              <Input
                                value={testamentData.testateurLieuNaissance}
                                onChange={(e) => setTestamentData({...testamentData, testateurLieuNaissance: e.target.value})}
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Nationalit√©</Label>
                              <Input
                                value={testamentData.testateurNationalite}
                                onChange={(e) => setTestamentData({...testamentData, testateurNationalite: e.target.value})}
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Profession</Label>
                              <Input
                                value={testamentData.testateurProfession}
                                onChange={(e) => setTestamentData({...testamentData, testateurProfession: e.target.value})}
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Situation familiale <span className="text-red-500">*</span></Label>
                              <Select
                                value={testamentData.testateurSituationFamiliale || undefined}
                                onValueChange={(value) => setTestamentData({...testamentData, testateurSituationFamiliale: value})}
                              >
                                <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="celibataire">C√©libataire</SelectItem>
                                  <SelectItem value="marie">Mari√©(e)</SelectItem>
                                  <SelectItem value="pacse">Pacs√©(e)</SelectItem>
                                  <SelectItem value="concubinage">Concubinage</SelectItem>
                                  <SelectItem value="divorce">Divorc√©(e)</SelectItem>
                                  <SelectItem value="veuf">Veuf(ve)</SelectItem>
                                  <SelectItem value="separe">S√©par√©(e)</SelectItem>
                                </SelectContent>
                              </Select>
                            </div>
                          </div>

                          <div className="space-y-2">
                            <Label>Adresse compl√®te <span className="text-red-500">*</span></Label>
                            <Input
                              value={testamentData.testateurAdresse}
                              onChange={(e) => setTestamentData({...testamentData, testateurAdresse: e.target.value})}
                            />
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="space-y-2">
                              <Label>T√©l√©phone</Label>
                              <Input
                                value={testamentData.testateurTelephone}
                                onChange={(e) => setTestamentData({...testamentData, testateurTelephone: e.target.value})}
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Email</Label>
                              <Input
                                type="email"
                                value={testamentData.testateurEmail}
                                onChange={(e) => setTestamentData({...testamentData, testateurEmail: e.target.value})}
                              />
                            </div>
                          </div>

                          {/* Pi√®ce d'identit√© */}
                          <div className="border-t pt-3 space-y-3">
                            <h4 className="font-medium">Pi√®ce d'identit√©</h4>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                              <div className="space-y-2">
                                <Label>Type</Label>
                                <Select
                                  value={testamentData.testateurPieceType || undefined}
                                  onValueChange={(value) => setTestamentData({...testamentData, testateurPieceType: value})}
                                >
                                  <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                  <SelectContent>
                                    <SelectItem value="cni">Carte Nationale d'Identit√©</SelectItem>
                                    <SelectItem value="passeport">Passeport</SelectItem>
                                    <SelectItem value="titre_sejour">Titre de s√©jour</SelectItem>
                                  </SelectContent>
                                </Select>
                              </div>
                              <div className="space-y-2">
                                <Label>Num√©ro</Label>
                                <Input
                                  value={testamentData.testateurPieceNumero}
                                  onChange={(e) => setTestamentData({...testamentData, testateurPieceNumero: e.target.value})}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Autorit√© de d√©livrance</Label>
                                <Input
                                  value={testamentData.testateurPieceAutorite}
                                  onChange={(e) => setTestamentData({...testamentData, testateurPieceAutorite: e.target.value})}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Date d'expiration</Label>
                                <Input
                                  type="date"
                                  value={testamentData.testateurPieceExpiration}
                                  onChange={(e) => setTestamentData({...testamentData, testateurPieceExpiration: e.target.value})}
                                />
                              </div>
                            </div>
                          </div>

                          {/* Capacit√© juridique */}
                          <div className="border-t pt-3 space-y-3">
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="capacite_juridique"
                                checked={testamentData.capaciteJuridiqueConfirmee}
                                onChange={(e) => setTestamentData({...testamentData, capaciteJuridiqueConfirmee: e.target.checked})}
                              />
                              <label htmlFor="capacite_juridique" className="text-sm cursor-pointer font-medium">
                                <span className="text-red-500">*</span> Capacit√© juridique confirm√©e
                              </label>
                            </div>

                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="sous_protection"
                                checked={testamentData.sousTutelleCuratelle}
                                onChange={(e) => setTestamentData({...testamentData, sousTutelleCuratelle: e.target.checked})}
                              />
                              <label htmlFor="sous_protection" className="text-sm cursor-pointer">
                                Sous tutelle / curatelle
                              </label>
                            </div>
                          </div>
                        </div>
                      </div>

                      {/* H√©ritiers r√©servataires */}
                      <div className="space-y-4">
                        <h3 className="font-semibold text-lg border-b pb-2">H√©ritiers r√©servataires (personnes prot√©g√©es par la loi)</h3>
                        <div className="p-4 border-2 rounded-lg space-y-4 bg-green-50/50 border-green-300">
                          
                          {/* Enfants */}
                          <div className="space-y-3">
                            <h4 className="font-medium">Enfants du testateur</h4>
                            {testamentData.heritiersReservataires.enfants.map((enfant, index) => (
                              <div key={index} className="p-3 bg-white rounded-lg border space-y-2">
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
                                  <Input
                                    placeholder="Nom"
                                    value={enfant.nom}
                                    onChange={(e) => {
                                      const newEnfants = [...testamentData.heritiersReservataires.enfants];
                                      newEnfants[index].nom = e.target.value;
                                      setTestamentData({
                                        ...testamentData,
                                        heritiersReservataires: {...testamentData.heritiersReservataires, enfants: newEnfants}
                                      });
                                    }}
                                  />
                                  <Input
                                    placeholder="Pr√©nom"
                                    value={enfant.prenom}
                                    onChange={(e) => {
                                      const newEnfants = [...testamentData.heritiersReservataires.enfants];
                                      newEnfants[index].prenom = e.target.value;
                                      setTestamentData({
                                        ...testamentData,
                                        heritiersReservataires: {...testamentData.heritiersReservataires, enfants: newEnfants}
                                      });
                                    }}
                                  />
                                  <Input
                                    type="date"
                                    placeholder="Date de naissance"
                                    value={enfant.dateNaissance}
                                    onChange={(e) => {
                                      const newEnfants = [...testamentData.heritiersReservataires.enfants];
                                      newEnfants[index].dateNaissance = e.target.value;
                                      setTestamentData({
                                        ...testamentData,
                                        heritiersReservataires: {...testamentData.heritiersReservataires, enfants: newEnfants}
                                      });
                                    }}
                                  />
                                </div>
                                <Button
                                  type="button"
                                  variant="destructive"
                                  size="sm"
                                  onClick={() => {
                                    const newEnfants = testamentData.heritiersReservataires.enfants.filter((_, i) => i !== index);
                                    setTestamentData({
                                      ...testamentData,
                                      heritiersReservataires: {...testamentData.heritiersReservataires, enfants: newEnfants}
                                    });
                                  }}
                                >
                                  Supprimer
                                </Button>
                              </div>
                            ))}
                            <Button
                              type="button"
                              onClick={() => {
                                setTestamentData({
                                  ...testamentData,
                                  heritiersReservataires: {
                                    ...testamentData.heritiersReservataires,
                                    enfants: [...testamentData.heritiersReservataires.enfants, {nom: "", prenom: "", dateNaissance: ""}]
                                  }
                                });
                              }}
                              className="bg-orange-500 hover:bg-orange-600"
                            >
                              + Ajouter un enfant
                            </Button>
                          </div>

                          {/* Descendants */}
                          <div className="space-y-3 border-t pt-3">
                            <h4 className="font-medium">Descendants (petits-enfants, arri√®re-petits-enfants...)</h4>
                            {testamentData.heritiersReservataires.descendants.map((desc, index) => (
                              <div key={index} className="p-3 bg-white rounded-lg border space-y-2">
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
                                  <Input
                                    placeholder="Nom"
                                    value={desc.nom}
                                    onChange={(e) => {
                                      const newDesc = [...testamentData.heritiersReservataires.descendants];
                                      newDesc[index].nom = e.target.value;
                                      setTestamentData({
                                        ...testamentData,
                                        heritiersReservataires: {...testamentData.heritiersReservataires, descendants: newDesc}
                                      });
                                    }}
                                  />
                                  <Input
                                    placeholder="Pr√©nom"
                                    value={desc.prenom}
                                    onChange={(e) => {
                                      const newDesc = [...testamentData.heritiersReservataires.descendants];
                                      newDesc[index].prenom = e.target.value;
                                      setTestamentData({
                                        ...testamentData,
                                        heritiersReservataires: {...testamentData.heritiersReservataires, descendants: newDesc}
                                      });
                                    }}
                                  />
                                  <Input
                                    placeholder="Lien (ex: petit-fils de...)"
                                    value={desc.lien}
                                    onChange={(e) => {
                                      const newDesc = [...testamentData.heritiersReservataires.descendants];
                                      newDesc[index].lien = e.target.value;
                                      setTestamentData({
                                        ...testamentData,
                                        heritiersReservataires: {...testamentData.heritiersReservataires, descendants: newDesc}
                                      });
                                    }}
                                  />
                                </div>
                                <Button
                                  type="button"
                                  variant="destructive"
                                  size="sm"
                                  onClick={() => {
                                    const newDesc = testamentData.heritiersReservataires.descendants.filter((_, i) => i !== index);
                                    setTestamentData({
                                      ...testamentData,
                                      heritiersReservataires: {...testamentData.heritiersReservataires, descendants: newDesc}
                                    });
                                  }}
                                >
                                  Supprimer
                                </Button>
                              </div>
                            ))}
                            <Button
                              type="button"
                              onClick={() => {
                                setTestamentData({
                                  ...testamentData,
                                  heritiersReservataires: {
                                    ...testamentData.heritiersReservataires,
                                    descendants: [...testamentData.heritiersReservataires.descendants, {nom: "", prenom: "", lien: ""}]
                                  }
                                });
                              }}
                              className="bg-orange-500 hover:bg-orange-600"
                            >
                              + Ajouter un descendant
                            </Button>
                          </div>

                          {/* Parents */}
                          <div className="space-y-3 border-t pt-3">
                            <h4 className="font-medium">Parents du testateur (p√®re et m√®re)</h4>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                              <div className="space-y-2">
                                <Label>Nom et pr√©nom du p√®re</Label>
                                <Input
                                  value={testamentData.heritiersReservataires.nomPrenomPere}
                                  onChange={(e) => setTestamentData({
                                    ...testamentData,
                                    heritiersReservataires: {...testamentData.heritiersReservataires, nomPrenomPere: e.target.value}
                                  })}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Nom et pr√©nom de la m√®re</Label>
                                <Input
                                  value={testamentData.heritiersReservataires.nomPrenomMere}
                                  onChange={(e) => setTestamentData({
                                    ...testamentData,
                                    heritiersReservataires: {...testamentData.heritiersReservataires, nomPrenomMere: e.target.value}
                                  })}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>P√®re vivant ?</Label>
                                <Select
                                  value={testamentData.heritiersReservataires.pereVivant}
                                  onValueChange={(value) => setTestamentData({
                                    ...testamentData,
                                    heritiersReservataires: {...testamentData.heritiersReservataires, pereVivant: value}
                                  })}
                                >
                                  <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                  <SelectContent>
                                    <SelectItem value="oui">Oui</SelectItem>
                                    <SelectItem value="non">Non</SelectItem>
                                    <SelectItem value="inconnu">Inconnu</SelectItem>
                                  </SelectContent>
                                </Select>
                              </div>
                              <div className="space-y-2">
                                <Label>M√®re vivante ?</Label>
                                <Select
                                  value={testamentData.heritiersReservataires.mereVivante}
                                  onValueChange={(value) => setTestamentData({
                                    ...testamentData,
                                    heritiersReservataires: {...testamentData.heritiersReservataires, mereVivante: value}
                                  })}
                                >
                                  <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                  <SelectContent>
                                    <SelectItem value="oui">Oui</SelectItem>
                                    <SelectItem value="non">Non</SelectItem>
                                    <SelectItem value="inconnu">Inconnu</SelectItem>
                                  </SelectContent>
                                </Select>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      {/* L√©gataires */}
                      <div className="space-y-4">
                        <h3 className="font-semibold text-lg border-b pb-2">L√©gataires (b√©n√©ficiaires du testament)</h3>
                        <div className="p-4 border-2 rounded-lg space-y-4 bg-purple-50/50 border-purple-300">
                          <p className="text-sm text-gray-600">Personnes ou entit√©s d√©sign√©es pour recevoir des biens</p>
                          
                          {testamentData.legataires.map((legataire, index) => (
                            <div key={index} className="p-3 bg-white rounded-lg border space-y-3">
                              <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <Input
                                  placeholder="Nom / D√©nomination"
                                  value={legataire.nom}
                                  onChange={(e) => {
                                    const newLegataires = [...testamentData.legataires];
                                    newLegataires[index].nom = e.target.value;
                                    setTestamentData({...testamentData, legataires: newLegataires});
                                  }}
                                />
                                <Input
                                  placeholder="Pr√©nom (si personne physique)"
                                  value={legataire.prenom}
                                  onChange={(e) => {
                                    const newLegataires = [...testamentData.legataires];
                                    newLegataires[index].prenom = e.target.value;
                                    setTestamentData({...testamentData, legataires: newLegataires});
                                  }}
                                />
                                <Input
                                  placeholder="Lien avec le testateur"
                                  value={legataire.lien}
                                  onChange={(e) => {
                                    const newLegataires = [...testamentData.legataires];
                                    newLegataires[index].lien = e.target.value;
                                    setTestamentData({...testamentData, legataires: newLegataires});
                                  }}
                                />
                                <Input
                                  placeholder="Adresse compl√®te"
                                  value={legataire.adresse}
                                  onChange={(e) => {
                                    const newLegataires = [...testamentData.legataires];
                                    newLegataires[index].adresse = e.target.value;
                                    setTestamentData({...testamentData, legataires: newLegataires});
                                  }}
                                />
                              </div>
                              <Button
                                type="button"
                                variant="destructive"
                                size="sm"
                                onClick={() => {
                                  const newLegataires = testamentData.legataires.filter((_, i) => i !== index);
                                  setTestamentData({...testamentData, legataires: newLegataires});
                                }}
                              >
                                Supprimer
                              </Button>
                            </div>
                          ))}
                          
                          <Button
                            type="button"
                            onClick={() => {
                              setTestamentData({
                                ...testamentData,
                                legataires: [...testamentData.legataires, {nom: "", prenom: "", lien: "", adresse: ""}]
                              });
                            }}
                            className="bg-orange-500 hover:bg-orange-600"
                          >
                            + Ajouter un l√©gataire
                          </Button>
                        </div>
                      </div>

                      {/* Dispositions testamentaires */}
                      <div className="space-y-4">
                        <h3 className="font-semibold text-lg border-b pb-2">Dispositions testamentaires</h3>
                        <div className="p-4 border-2 rounded-lg space-y-4 bg-yellow-50/50 border-yellow-300">
                          
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="legs_universel"
                              checked={testamentData.dispositions.legsUniversel}
                              onChange={(e) => setTestamentData({
                                ...testamentData,
                                dispositions: {...testamentData.dispositions, legsUniversel: e.target.checked}
                              })}
                            />
                            <label htmlFor="legs_universel" className="text-sm cursor-pointer font-medium">
                              Legs universel (totalit√© du patrimoine)
                            </label>
                          </div>

                          {testamentData.dispositions.legsUniversel && (
                            <div className="ml-6 p-3 bg-white rounded-lg">
                              <textarea
                                className="w-full min-h-[80px] p-2 border rounded-md text-sm"
                                placeholder="D√©tails du legs universel..."
                                value={testamentData.dispositions.detailsLegsUniversel}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  dispositions: {...testamentData.dispositions, detailsLegsUniversel: e.target.value}
                                })}
                              />
                            </div>
                          )}

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="legs_titre_universel"
                              checked={testamentData.dispositions.legsTitreUniversel}
                              onChange={(e) => setTestamentData({
                                ...testamentData,
                                dispositions: {...testamentData.dispositions, legsTitreUniversel: e.target.checked}
                              })}
                            />
                            <label htmlFor="legs_titre_universel" className="text-sm cursor-pointer font-medium">
                              Legs √† titre universel (quote-part ou cat√©gorie de biens)
                            </label>
                          </div>

                          {testamentData.dispositions.legsTitreUniversel && (
                            <div className="ml-6 p-3 bg-white rounded-lg">
                              <textarea
                                className="w-full min-h-[80px] p-2 border rounded-md text-sm"
                                placeholder="D√©tails du legs √† titre universel..."
                                value={testamentData.dispositions.detailsLegsTitreUniversel}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  dispositions: {...testamentData.dispositions, detailsLegsTitreUniversel: e.target.value}
                                })}
                              />
                            </div>
                          )}

                          <div className="space-y-3">
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="legs_particuliers"
                                checked={testamentData.dispositions.legsParticuliers}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  dispositions: {...testamentData.dispositions, legsParticuliers: e.target.checked}
                                })}
                              />
                              <label htmlFor="legs_particuliers" className="text-sm cursor-pointer font-medium">
                                Legs particuliers (biens d√©termin√©s)
                              </label>
                            </div>

                            {testamentData.dispositions.legsParticuliers && (
                              <div className="ml-6 space-y-3">
                                {testamentData.dispositions.listeLegsParticuliers.map((legs, index) => (
                                  <div key={index} className="p-3 bg-white rounded-lg border space-y-2">
                                    <Input
                                      placeholder="Description du bien"
                                      value={legs.description}
                                      onChange={(e) => {
                                        const newLegs = [...testamentData.dispositions.listeLegsParticuliers];
                                        newLegs[index].description = e.target.value;
                                        setTestamentData({
                                          ...testamentData,
                                          dispositions: {...testamentData.dispositions, listeLegsParticuliers: newLegs}
                                        });
                                      }}
                                    />
                                    <Input
                                      placeholder="B√©n√©ficiaire"
                                      value={legs.beneficiaire}
                                      onChange={(e) => {
                                        const newLegs = [...testamentData.dispositions.listeLegsParticuliers];
                                        newLegs[index].beneficiaire = e.target.value;
                                        setTestamentData({
                                          ...testamentData,
                                          dispositions: {...testamentData.dispositions, listeLegsParticuliers: newLegs}
                                        });
                                      }}
                                    />
                                    <Button
                                      type="button"
                                      variant="destructive"
                                      size="sm"
                                      onClick={() => {
                                        const newLegs = testamentData.dispositions.listeLegsParticuliers.filter((_, i) => i !== index);
                                        setTestamentData({
                                          ...testamentData,
                                          dispositions: {...testamentData.dispositions, listeLegsParticuliers: newLegs}
                                        });
                                      }}
                                    >
                                      Supprimer
                                    </Button>
                                  </div>
                                ))}
                                <Button
                                  type="button"
                                  onClick={() => {
                                    setTestamentData({
                                      ...testamentData,
                                      dispositions: {
                                        ...testamentData.dispositions,
                                        listeLegsParticuliers: [...testamentData.dispositions.listeLegsParticuliers, {description: "", beneficiaire: ""}]
                                      }
                                    });
                                  }}
                                  className="bg-orange-500 hover:bg-orange-600"
                                >
                                  + Ajouter un legs particulier
                                </Button>
                              </div>
                            )}
                          </div>

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="charges_conditions"
                              checked={testamentData.dispositions.chargesConditions}
                              onChange={(e) => setTestamentData({
                                ...testamentData,
                                dispositions: {...testamentData.dispositions, chargesConditions: e.target.checked}
                              })}
                            />
                            <label htmlFor="charges_conditions" className="text-sm cursor-pointer font-medium">
                              Charges et conditions
                            </label>
                          </div>

                          {testamentData.dispositions.chargesConditions && (
                            <div className="ml-6 p-3 bg-white rounded-lg">
                              <textarea
                                className="w-full min-h-[80px] p-2 border rounded-md text-sm"
                                placeholder="D√©tails des charges et conditions..."
                                value={testamentData.dispositions.detailsChargesConditions}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  dispositions: {...testamentData.dispositions, detailsChargesConditions: e.target.value}
                                })}
                              />
                            </div>
                          )}

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="demembrement"
                              checked={testamentData.dispositions.demembrement}
                              onChange={(e) => setTestamentData({
                                ...testamentData,
                                dispositions: {...testamentData.dispositions, demembrement: e.target.checked}
                              })}
                            />
                            <label htmlFor="demembrement" className="text-sm cursor-pointer font-medium">
                              D√©membrement de propri√©t√© (usufruit / nue-propri√©t√©)
                            </label>
                          </div>

                          {testamentData.dispositions.demembrement && (
                            <div className="ml-6 p-3 bg-white rounded-lg">
                              <textarea
                                className="w-full min-h-[80px] p-2 border rounded-md text-sm"
                                placeholder="D√©tails du d√©membrement..."
                                value={testamentData.dispositions.detailsDemembrement}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  dispositions: {...testamentData.dispositions, detailsDemembrement: e.target.value}
                                })}
                              />
                            </div>
                          )}

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="droit_retour"
                              checked={testamentData.dispositions.droitRetour}
                              onChange={(e) => setTestamentData({
                                ...testamentData,
                                dispositions: {...testamentData.dispositions, droitRetour: e.target.checked}
                              })}
                            />
                            <label htmlFor="droit_retour" className="text-sm cursor-pointer font-medium">
                              Clause de droit de retour
                            </label>
                          </div>

                          {testamentData.dispositions.droitRetour && (
                            <div className="ml-6 p-3 bg-white rounded-lg">
                              <textarea
                                className="w-full min-h-[80px] p-2 border rounded-md text-sm"
                                placeholder="D√©tails du droit de retour..."
                                value={testamentData.dispositions.detailsDroitRetour}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  dispositions: {...testamentData.dispositions, detailsDroitRetour: e.target.value}
                                })}
                              />
                            </div>
                          )}

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="exheredation"
                              checked={testamentData.dispositions.exheredation}
                              onChange={(e) => setTestamentData({
                                ...testamentData,
                                dispositions: {...testamentData.dispositions, exheredation: e.target.checked}
                              })}
                            />
                            <label htmlFor="exheredation" className="text-sm cursor-pointer font-medium">
                              Exh√©r√©dation (dans la limite de la quotit√© disponible)
                            </label>
                          </div>

                          {testamentData.dispositions.exheredation && (
                            <div className="ml-6 p-3 bg-white rounded-lg">
                              <textarea
                                className="w-full min-h-[80px] p-2 border rounded-md text-sm"
                                placeholder="D√©tails de l'exh√©r√©dation..."
                                value={testamentData.dispositions.detailsExheredation}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  dispositions: {...testamentData.dispositions, detailsExheredation: e.target.value}
                                })}
                              />
                            </div>
                          )}

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="executeur_testamentaire"
                              checked={testamentData.dispositions.executeurTestamentaire}
                              onChange={(e) => setTestamentData({
                                ...testamentData,
                                dispositions: {...testamentData.dispositions, executeurTestamentaire: e.target.checked}
                              })}
                            />
                            <label htmlFor="executeur_testamentaire" className="text-sm cursor-pointer font-medium">
                              D√©signation d'un ex√©cuteur testamentaire
                            </label>
                          </div>

                          {testamentData.dispositions.executeurTestamentaire && (
                            <div className="ml-6 p-3 bg-white rounded-lg space-y-2">
                              <Input
                                placeholder="Nom et pr√©nom de l'ex√©cuteur"
                                value={testamentData.dispositions.nomExecuteur}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  dispositions: {...testamentData.dispositions, nomExecuteur: e.target.value}
                                })}
                              />
                              <Input
                                placeholder="Adresse de l'ex√©cuteur"
                                value={testamentData.dispositions.adresseExecuteur}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  dispositions: {...testamentData.dispositions, adresseExecuteur: e.target.value}
                                })}
                              />
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Patrimoine */}
                      <div className="space-y-4">
                        <h3 className="font-semibold text-lg border-b pb-2">Description du patrimoine du testateur</h3>
                        <div className="p-4 border-2 rounded-lg space-y-4 bg-orange-50/50 border-orange-300">
                          
                          {/* Biens immobiliers */}
                          <div className="space-y-3">
                            <h4 className="font-medium">Biens immobiliers</h4>
                            {testamentData.patrimoine.immobiliers.map((bien, index) => (
                              <div key={index} className="p-3 bg-white rounded-lg border space-y-2">
                                <Input
                                  placeholder="Adresse du bien"
                                  value={bien.adresse}
                                  onChange={(e) => {
                                    const newBiens = [...testamentData.patrimoine.immobiliers];
                                    newBiens[index].adresse = e.target.value;
                                    setTestamentData({
                                      ...testamentData,
                                      patrimoine: {...testamentData.patrimoine, immobiliers: newBiens}
                                    });
                                  }}
                                />
                                <Input
                                  placeholder="Type (maison, appartement, terrain...)"
                                  value={bien.type}
                                  onChange={(e) => {
                                    const newBiens = [...testamentData.patrimoine.immobiliers];
                                    newBiens[index].type = e.target.value;
                                    setTestamentData({
                                      ...testamentData,
                                      patrimoine: {...testamentData.patrimoine, immobiliers: newBiens}
                                    });
                                  }}
                                />
                                <Input
                                  placeholder="Valeur estim√©e (‚Ç¨)"
                                  value={bien.valeur}
                                  onChange={(e) => {
                                    const newBiens = [...testamentData.patrimoine.immobiliers];
                                    newBiens[index].valeur = e.target.value;
                                    setTestamentData({
                                      ...testamentData,
                                      patrimoine: {...testamentData.patrimoine, immobiliers: newBiens}
                                    });
                                  }}
                                />
                                <Button
                                  type="button"
                                  variant="destructive"
                                  size="sm"
                                  onClick={() => {
                                    const newBiens = testamentData.patrimoine.immobiliers.filter((_, i) => i !== index);
                                    setTestamentData({
                                      ...testamentData,
                                      patrimoine: {...testamentData.patrimoine, immobiliers: newBiens}
                                    });
                                  }}
                                >
                                  Supprimer
                                </Button>
                              </div>
                            ))}
                            <Button
                              type="button"
                              onClick={() => {
                                setTestamentData({
                                  ...testamentData,
                                  patrimoine: {
                                    ...testamentData.patrimoine,
                                    immobiliers: [...testamentData.patrimoine.immobiliers, {adresse: "", type: "", valeur: ""}]
                                  }
                                });
                              }}
                              className="bg-orange-500 hover:bg-orange-600"
                            >
                              + Ajouter un bien immobilier
                            </Button>
                          </div>

                          {/* Avoirs financiers */}
                          <div className="space-y-3 border-t pt-3">
                            <h4 className="font-medium">Avoirs financiers (comptes, placements)</h4>
                            {testamentData.patrimoine.avoirsFinanciers.map((avoir, index) => (
                              <div key={index} className="p-3 bg-white rounded-lg border space-y-2">
                                <Input
                                  placeholder="Type (compte courant, livret, assurance-vie...)"
                                  value={avoir.type}
                                  onChange={(e) => {
                                    const newAvoirs = [...testamentData.patrimoine.avoirsFinanciers];
                                    newAvoirs[index].type = e.target.value;
                                    setTestamentData({
                                      ...testamentData,
                                      patrimoine: {...testamentData.patrimoine, avoirsFinanciers: newAvoirs}
                                    });
                                  }}
                                />
                                <Input
                                  placeholder="√âtablissement"
                                  value={avoir.etablissement}
                                  onChange={(e) => {
                                    const newAvoirs = [...testamentData.patrimoine.avoirsFinanciers];
                                    newAvoirs[index].etablissement = e.target.value;
                                    setTestamentData({
                                      ...testamentData,
                                      patrimoine: {...testamentData.patrimoine, avoirsFinanciers: newAvoirs}
                                    });
                                  }}
                                />
                                <Input
                                  placeholder="Montant estim√© (‚Ç¨)"
                                  value={avoir.montant}
                                  onChange={(e) => {
                                    const newAvoirs = [...testamentData.patrimoine.avoirsFinanciers];
                                    newAvoirs[index].montant = e.target.value;
                                    setTestamentData({
                                      ...testamentData,
                                      patrimoine: {...testamentData.patrimoine, avoirsFinanciers: newAvoirs}
                                    });
                                  }}
                                />
                                <Button
                                  type="button"
                                  variant="destructive"
                                  size="sm"
                                  onClick={() => {
                                    const newAvoirs = testamentData.patrimoine.avoirsFinanciers.filter((_, i) => i !== index);
                                    setTestamentData({
                                      ...testamentData,
                                      patrimoine: {...testamentData.patrimoine, avoirsFinanciers: newAvoirs}
                                    });
                                  }}
                                >
                                  Supprimer
                                </Button>
                              </div>
                            ))}
                            <Button
                              type="button"
                              onClick={() => {
                                setTestamentData({
                                  ...testamentData,
                                  patrimoine: {
                                    ...testamentData.patrimoine,
                                    avoirsFinanciers: [...testamentData.patrimoine.avoirsFinanciers, {type: "", etablissement: "", montant: ""}]
                                  }
                                });
                              }}
                              className="bg-orange-500 hover:bg-orange-600"
                            >
                              + Ajouter un avoir financier
                            </Button>
                          </div>

                          {/* Biens meubles */}
                          <div className="space-y-3 border-t pt-3">
                            <h4 className="font-medium">Biens meubles (v√©hicules, ≈ìuvres d'art, bijoux...)</h4>
                            {testamentData.patrimoine.biensMeubles.map((meuble, index) => (
                              <div key={index} className="p-3 bg-white rounded-lg border space-y-2">
                                <Input
                                  placeholder="Description"
                                  value={meuble.description}
                                  onChange={(e) => {
                                    const newMeubles = [...testamentData.patrimoine.biensMeubles];
                                    newMeubles[index].description = e.target.value;
                                    setTestamentData({
                                      ...testamentData,
                                      patrimoine: {...testamentData.patrimoine, biensMeubles: newMeubles}
                                    });
                                  }}
                                />
                                <Input
                                  placeholder="Valeur estim√©e (‚Ç¨)"
                                  value={meuble.valeur}
                                  onChange={(e) => {
                                    const newMeubles = [...testamentData.patrimoine.biensMeubles];
                                    newMeubles[index].valeur = e.target.value;
                                    setTestamentData({
                                      ...testamentData,
                                      patrimoine: {...testamentData.patrimoine, biensMeubles: newMeubles}
                                    });
                                  }}
                                />
                                <Button
                                  type="button"
                                  variant="destructive"
                                  size="sm"
                                  onClick={() => {
                                    const newMeubles = testamentData.patrimoine.biensMeubles.filter((_, i) => i !== index);
                                    setTestamentData({
                                      ...testamentData,
                                      patrimoine: {...testamentData.patrimoine, biensMeubles: newMeubles}
                                    });
                                  }}
                                >
                                  Supprimer
                                </Button>
                              </div>
                            ))}
                            <Button
                              type="button"
                              onClick={() => {
                                setTestamentData({
                                  ...testamentData,
                                  patrimoine: {
                                    ...testamentData.patrimoine,
                                    biensMeubles: [...testamentData.patrimoine.biensMeubles, {description: "", valeur: ""}]
                                  }
                                });
                              }}
                              className="bg-orange-500 hover:bg-orange-600"
                            >
                              + Ajouter un bien meuble
                            </Button>
                          </div>

                          {/* Parts sociales */}
                          <div className="space-y-3 border-t pt-3">
                            <h4 className="font-medium">Parts sociales / actions</h4>
                            {testamentData.patrimoine.partsSociales.map((parts, index) => (
                              <div key={index} className="p-3 bg-white rounded-lg border space-y-2">
                                <Input
                                  placeholder="Soci√©t√©"
                                  value={parts.societe}
                                  onChange={(e) => {
                                    const newParts = [...testamentData.patrimoine.partsSociales];
                                    newParts[index].societe = e.target.value;
                                    setTestamentData({
                                      ...testamentData,
                                      patrimoine: {...testamentData.patrimoine, partsSociales: newParts}
                                    });
                                  }}
                                />
                                <Input
                                  placeholder="Nombre de parts/actions"
                                  value={parts.nombre}
                                  onChange={(e) => {
                                    const newParts = [...testamentData.patrimoine.partsSociales];
                                    newParts[index].nombre = e.target.value;
                                    setTestamentData({
                                      ...testamentData,
                                      patrimoine: {...testamentData.patrimoine, partsSociales: newParts}
                                    });
                                  }}
                                />
                                <Input
                                  placeholder="Valeur estim√©e (‚Ç¨)"
                                  value={parts.valeur}
                                  onChange={(e) => {
                                    const newParts = [...testamentData.patrimoine.partsSociales];
                                    newParts[index].valeur = e.target.value;
                                    setTestamentData({
                                      ...testamentData,
                                      patrimoine: {...testamentData.patrimoine, partsSociales: newParts}
                                    });
                                  }}
                                />
                                <Button
                                  type="button"
                                  variant="destructive"
                                  size="sm"
                                  onClick={() => {
                                    const newParts = testamentData.patrimoine.partsSociales.filter((_, i) => i !== index);
                                    setTestamentData({
                                      ...testamentData,
                                      patrimoine: {...testamentData.patrimoine, partsSociales: newParts}
                                    });
                                  }}
                                >
                                  Supprimer
                                </Button>
                              </div>
                            ))}
                            <Button
                              type="button"
                              onClick={() => {
                                setTestamentData({
                                  ...testamentData,
                                  patrimoine: {
                                    ...testamentData.patrimoine,
                                    partsSociales: [...testamentData.patrimoine.partsSociales, {societe: "", nombre: "", valeur: ""}]
                                  }
                                });
                              }}
                              className="bg-orange-500 hover:bg-orange-600"
                            >
                              + Ajouter des parts sociales
                            </Button>
                          </div>
                        </div>
                      </div>

                      {/* R√©gime matrimonial d√©taill√© */}
                      <div className="space-y-4">
                        <h3 className="font-semibold text-lg border-b pb-2">R√©gime matrimonial du testateur</h3>
                        <div className="p-4 border-2 rounded-lg space-y-4 bg-purple-50/50 border-purple-300">
                          <p className="text-sm text-gray-600">Informations sur le r√©gime matrimonial (utile pour l'automatisation et le contr√¥le notarial)</p>
                          
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="space-y-2">
                              <Label>Nature du r√©gime matrimonial</Label>
                              <Select
                                value={testamentData.regimeMatrimonial.nature || undefined}
                                onValueChange={(value) => setTestamentData({
                                  ...testamentData,
                                  regimeMatrimonial: {...testamentData.regimeMatrimonial, nature: value}
                                })}
                              >
                                <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="legal">R√©gime l√©gal (communaut√© r√©duite aux acqu√™ts)</SelectItem>
                                  <SelectItem value="separation">S√©paration de biens</SelectItem>
                                  <SelectItem value="communaute_universelle">Communaut√© universelle</SelectItem>
                                  <SelectItem value="participation">Participation aux acqu√™ts</SelectItem>
                                  <SelectItem value="autre">Autre r√©gime</SelectItem>
                                </SelectContent>
                              </Select>
                            </div>

                            <div className="space-y-2">
                              <Label>Date du contrat de mariage</Label>
                              <Input
                                type="date"
                                value={testamentData.regimeMatrimonial.contratMariage}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  regimeMatrimonial: {...testamentData.regimeMatrimonial, contratMariage: e.target.value}
                                })}
                              />
                            </div>

                            <div className="space-y-2 md:col-span-2">
                              <Label>Notaire ayant re√ßu le contrat</Label>
                              <Input
                                value={testamentData.regimeMatrimonial.notaireContrat}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  regimeMatrimonial: {...testamentData.regimeMatrimonial, notaireContrat: e.target.value}
                                })}
                                placeholder="Nom et office du notaire"
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>Biens propres (description sommaire)</Label>
                              <textarea
                                className="w-full p-2 border rounded-md"
                                rows={2}
                                value={testamentData.regimeMatrimonial.biensPropres}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  regimeMatrimonial: {...testamentData.regimeMatrimonial, biensPropres: e.target.value}
                                })}
                                placeholder="Ex: Biens acquis avant mariage, donations, successions..."
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>Biens communs (description sommaire)</Label>
                              <textarea
                                className="w-full p-2 border rounded-md"
                                rows={2}
                                value={testamentData.regimeMatrimonial.biensCommuns}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  regimeMatrimonial: {...testamentData.regimeMatrimonial, biensCommuns: e.target.value}
                                })}
                                placeholder="Ex: R√©sidence principale, comptes joints..."
                              />
                            </div>
                          </div>

                          <div className="border-t pt-3">
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="preciput"
                                checked={testamentData.regimeMatrimonial.preciput}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  regimeMatrimonial: {...testamentData.regimeMatrimonial, preciput: e.target.checked}
                                })}
                                className="w-4 h-4"
                              />
                              <Label htmlFor="preciput" className="cursor-pointer">Clause de pr√©ciput pr√©sente dans le contrat</Label>
                            </div>

                            {testamentData.regimeMatrimonial.preciput && (
                              <div className="ml-6 mt-3">
                                <Label>D√©tails du pr√©ciput</Label>
                                <textarea
                                  className="w-full p-2 border rounded-md mt-2"
                                  rows={2}
                                  value={testamentData.regimeMatrimonial.detailsPreciput}
                                  onChange={(e) => setTestamentData({
                                    ...testamentData,
                                    regimeMatrimonial: {...testamentData.regimeMatrimonial, detailsPreciput: e.target.value}
                                  })}
                                  placeholder="Pr√©ciser les biens concern√©s par le pr√©ciput..."
                                />
                              </div>
                            )}
                          </div>
                        </div>
                      </div>

                      {/* Formalit√©s sp√©cifiques */}
                      <div className="space-y-4">
                        <h3 className="font-semibold text-lg border-b pb-2">Formalit√©s sp√©cifiques - Testament authentique</h3>
                        <div className="p-4 border-2 rounded-lg space-y-4 bg-blue-50/50 border-blue-300">
                        {/* Notaire */}
                        <div className="space-y-3">
                          <h4 className="font-medium">Notaire instrumentaire</h4>
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="space-y-2">
                              <Label>Nom du notaire <span className="text-red-500">*</span></Label>
                              <Input
                                value={testamentData.testamentAuthentique.notaireNom}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentAuthentique: {...testamentData.testamentAuthentique, notaireNom: e.target.value}
                                })}
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>Office notarial <span className="text-red-500">*</span></Label>
                              <Input
                                value={testamentData.testamentAuthentique.notaireOffice}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentAuthentique: {...testamentData.testamentAuthentique, notaireOffice: e.target.value}
                                })}
                              />
                            </div>

                            <div className="space-y-2 md:col-span-2">
                              <Label>Adresse compl√®te de l'office</Label>
                              <Input
                                value={testamentData.testamentAuthentique.notaireAdresse}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentAuthentique: {...testamentData.testamentAuthentique, notaireAdresse: e.target.value}
                                })}
                              />
                            </div>
                          </div>
                        </div>

                        {/* Modalit√©s r√©ception - DOIT √äTRE EN PREMIER */}
                        <div className="space-y-3 p-3 bg-yellow-50 rounded-lg border border-yellow-300">
                          <h4 className="font-medium">Mode de r√©ception du testament <span className="text-red-500">*</span></h4>
                          <p className="text-sm text-gray-600 mb-2">Choisissez la modalit√© de r√©ception (ce choix conditionne le reste du formulaire)</p>
                          <div className="space-y-2">
                            <Label>Testament re√ßu par <span className="text-red-500">*</span></Label>
                            <Select
                              value={testamentData.testamentAuthentique.modaliteReception || undefined}
                              onValueChange={(value) => setTestamentData({
                                ...testamentData,
                                testamentAuthentique: {...testamentData.testamentAuthentique, modaliteReception: value}
                              })}
                            >
                              <SelectTrigger><SelectValue placeholder="S√©lectionner le mode de r√©ception..." /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="1notaire_2temoins">1 notaire + 2 t√©moins</SelectItem>
                                <SelectItem value="2notaires">2 notaires (sans t√©moins)</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-3">
                            <div className="space-y-2">
                              <Label>Lieu de r√©ception <span className="text-red-500">*</span></Label>
                              <Input
                                value={testamentData.testamentAuthentique.lieuReception}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentAuthentique: {...testamentData.testamentAuthentique, lieuReception: e.target.value}
                                })}
                                placeholder="Ex: Office notarial, domicile du testateur..."
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>Date de r√©ception</Label>
                              <Input
                                type="date"
                                value={testamentData.testamentAuthentique.dateReception}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentAuthentique: {...testamentData.testamentAuthentique, dateReception: e.target.value}
                                })}
                              />
                            </div>
                          </div>
                        </div>

                        {/* T√©moins (conditionnels selon modalit√©) */}
                        {testamentData.testamentAuthentique.modaliteReception === "1notaire_2temoins" && (
                          <div className="space-y-3">
                            <div className="flex justify-between items-center">
                              <h4 className="font-medium">T√©moins (2 t√©moins obligatoires) <span className="text-red-500">*</span></h4>
                              <Button
                                type="button"
                                variant="outline"
                                size="sm"
                                onClick={() => setTestamentData({
                                  ...testamentData,
                                  testamentAuthentique: {
                                    ...testamentData.testamentAuthentique,
                                    temoins: [...testamentData.testamentAuthentique.temoins, {
                                      nom: "", prenom: "", dateNaissance: "", lieuNaissance: "", nationalite: "", 
                                      profession: "", adresse: "", lienAvecTestateur: "",
                                      nonHeritier: false, nonLegataire: false, nonConjoint: false, 
                                      nonParentJusque4eDegre: false, capaciteJuridique: false, 
                                      comprendLangue: false, agitLibrement: false, signature: false
                                    }]
                                  }
                                })}
                              >
                                + Ajouter un t√©moin
                              </Button>
                            </div>

                            {testamentData.testamentAuthentique.temoins.map((temoin, idx) => (
                              <div key={idx} className="p-4 bg-white rounded-lg space-y-3 border-2 border-blue-200">
                                <div className="flex justify-between">
                                  <h5 className="text-sm font-medium">T√©moin {idx + 1}</h5>
                                  <Button
                                    type="button"
                                    variant="ghost"
                                    size="sm"
                                    onClick={() => {
                                      const newTemoins = testamentData.testamentAuthentique.temoins.filter((_, i) => i !== idx);
                                      setTestamentData({
                                        ...testamentData,
                                        testamentAuthentique: {...testamentData.testamentAuthentique, temoins: newTemoins}
                                      });
                                    }}
                                  >
                                    üóëÔ∏è
                                  </Button>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                  <div className="space-y-2">
                                    <Label>Nom <span className="text-red-500">*</span></Label>
                                    <Input
                                      value={temoin.nom}
                                      onChange={(e) => {
                                        const newTemoins = [...testamentData.testamentAuthentique.temoins];
                                        newTemoins[idx].nom = e.target.value;
                                        setTestamentData({
                                          ...testamentData,
                                          testamentAuthentique: {...testamentData.testamentAuthentique, temoins: newTemoins}
                                        });
                                      }}
                                    />
                                  </div>

                                  <div className="space-y-2">
                                    <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                                    <Input
                                      value={temoin.prenom}
                                      onChange={(e) => {
                                        const newTemoins = [...testamentData.testamentAuthentique.temoins];
                                        newTemoins[idx].prenom = e.target.value;
                                        setTestamentData({
                                          ...testamentData,
                                          testamentAuthentique: {...testamentData.testamentAuthentique, temoins: newTemoins}
                                        });
                                      }}
                                    />
                                  </div>

                                  <div className="space-y-2">
                                    <Label>Date de naissance <span className="text-red-500">*</span></Label>
                                    <Input
                                      type="date"
                                      value={temoin.dateNaissance}
                                      onChange={(e) => {
                                        const newTemoins = [...testamentData.testamentAuthentique.temoins];
                                        newTemoins[idx].dateNaissance = e.target.value;
                                        setTestamentData({
                                          ...testamentData,
                                          testamentAuthentique: {...testamentData.testamentAuthentique, temoins: newTemoins}
                                        });
                                      }}
                                    />
                                  </div>

                                  <div className="space-y-2">
                                    <Label>Lieu de naissance</Label>
                                    <Input
                                      value={temoin.lieuNaissance}
                                      onChange={(e) => {
                                        const newTemoins = [...testamentData.testamentAuthentique.temoins];
                                        newTemoins[idx].lieuNaissance = e.target.value;
                                        setTestamentData({
                                          ...testamentData,
                                          testamentAuthentique: {...testamentData.testamentAuthentique, temoins: newTemoins}
                                        });
                                      }}
                                    />
                                  </div>

                                  <div className="space-y-2">
                                    <Label>Nationalit√© <span className="text-red-500">*</span></Label>
                                    <Input
                                      value={temoin.nationalite}
                                      onChange={(e) => {
                                        const newTemoins = [...testamentData.testamentAuthentique.temoins];
                                        newTemoins[idx].nationalite = e.target.value;
                                        setTestamentData({
                                          ...testamentData,
                                          testamentAuthentique: {...testamentData.testamentAuthentique, temoins: newTemoins}
                                        });
                                      }}
                                      placeholder="Ex: Fran√ßaise"
                                    />
                                  </div>

                                  <div className="space-y-2">
                                    <Label>Profession</Label>
                                    <Input
                                      value={temoin.profession}
                                      onChange={(e) => {
                                        const newTemoins = [...testamentData.testamentAuthentique.temoins];
                                        newTemoins[idx].profession = e.target.value;
                                        setTestamentData({
                                          ...testamentData,
                                          testamentAuthentique: {...testamentData.testamentAuthentique, temoins: newTemoins}
                                        });
                                      }}
                                    />
                                  </div>

                                  <div className="space-y-2">
                                    <Label>Lien avec le testateur <span className="text-red-500">*</span></Label>
                                    <Input
                                      value={temoin.lienAvecTestateur}
                                      onChange={(e) => {
                                        const newTemoins = [...testamentData.testamentAuthentique.temoins];
                                        newTemoins[idx].lienAvecTestateur = e.target.value;
                                        setTestamentData({
                                          ...testamentData,
                                          testamentAuthentique: {...testamentData.testamentAuthentique, temoins: newTemoins}
                                        });
                                      }}
                                      placeholder="Ex: Aucun lien"
                                    />
                                  </div>

                                  <div className="space-y-2 md:col-span-2">
                                    <Label>Adresse compl√®te <span className="text-red-500">*</span></Label>
                                    <Input
                                      value={temoin.adresse}
                                      onChange={(e) => {
                                        const newTemoins = [...testamentData.testamentAuthentique.temoins];
                                        newTemoins[idx].adresse = e.target.value;
                                        setTestamentData({
                                          ...testamentData,
                                          testamentAuthentique: {...testamentData.testamentAuthentique, temoins: newTemoins}
                                        });
                                      }}
                                    />
                                  </div>
                                </div>

                                {/* D√©clarations l√©gales (CONDITIONS DE VALIDIT√â) */}
                                <div className="mt-3 p-3 bg-red-50 rounded-lg border border-red-200">
                                  <p className="text-sm font-medium mb-2 text-red-700">D√©clarations l√©gales - CONDITIONS DE VALIDIT√â <span className="text-red-500">*</span></p>
                                  <div className="space-y-2">
                                    <div className="flex items-center space-x-2">
                                      <input
                                        type="checkbox"
                                        id={`t${idx}_nonHeritier`}
                                        checked={temoin.nonHeritier}
                                        onChange={(e) => {
                                          const newTemoins = [...testamentData.testamentAuthentique.temoins];
                                          newTemoins[idx].nonHeritier = e.target.checked;
                                          setTestamentData({
                                            ...testamentData,
                                            testamentAuthentique: {...testamentData.testamentAuthentique, temoins: newTemoins}
                                          });
                                        }}
                                        className="w-4 h-4"
                                      />
                                      <Label htmlFor={`t${idx}_nonHeritier`} className="cursor-pointer text-sm">Le t√©moin n'est ni h√©ritier ni l√©gataire</Label>
                                    </div>

                                    <div className="flex items-center space-x-2">
                                      <input
                                        type="checkbox"
                                        id={`t${idx}_nonConjoint`}
                                        checked={temoin.nonConjoint}
                                        onChange={(e) => {
                                          const newTemoins = [...testamentData.testamentAuthentique.temoins];
                                          newTemoins[idx].nonConjoint = e.target.checked;
                                          setTestamentData({
                                            ...testamentData,
                                            testamentAuthentique: {...testamentData.testamentAuthentique, temoins: newTemoins}
                                          });
                                        }}
                                        className="w-4 h-4"
                                      />
                                      <Label htmlFor={`t${idx}_nonConjoint`} className="cursor-pointer text-sm">Le t√©moin n'est ni conjoint, ni parent jusqu'au 4·µâ degr√©</Label>
                                    </div>

                                    <div className="flex items-center space-x-2">
                                      <input
                                        type="checkbox"
                                        id={`t${idx}_capacite`}
                                        checked={temoin.capaciteJuridique}
                                        onChange={(e) => {
                                          const newTemoins = [...testamentData.testamentAuthentique.temoins];
                                          newTemoins[idx].capaciteJuridique = e.target.checked;
                                          setTestamentData({
                                            ...testamentData,
                                            testamentAuthentique: {...testamentData.testamentAuthentique, temoins: newTemoins}
                                          });
                                        }}
                                        className="w-4 h-4"
                                      />
                                      <Label htmlFor={`t${idx}_capacite`} className="cursor-pointer text-sm">Le t√©moin a la capacit√© juridique</Label>
                                    </div>

                                    <div className="flex items-center space-x-2">
                                      <input
                                        type="checkbox"
                                        id={`t${idx}_langue`}
                                        checked={temoin.comprendLangue}
                                        onChange={(e) => {
                                          const newTemoins = [...testamentData.testamentAuthentique.temoins];
                                          newTemoins[idx].comprendLangue = e.target.checked;
                                          setTestamentData({
                                            ...testamentData,
                                            testamentAuthentique: {...testamentData.testamentAuthentique, temoins: newTemoins}
                                          });
                                        }}
                                        className="w-4 h-4"
                                      />
                                      <Label htmlFor={`t${idx}_langue`} className="cursor-pointer text-sm">Le t√©moin comprend la langue utilis√©e</Label>
                                    </div>

                                    <div className="flex items-center space-x-2">
                                      <input
                                        type="checkbox"
                                        id={`t${idx}_libre`}
                                        checked={temoin.agitLibrement}
                                        onChange={(e) => {
                                          const newTemoins = [...testamentData.testamentAuthentique.temoins];
                                          newTemoins[idx].agitLibrement = e.target.checked;
                                          setTestamentData({
                                            ...testamentData,
                                            testamentAuthentique: {...testamentData.testamentAuthentique, temoins: newTemoins}
                                          });
                                        }}
                                        className="w-4 h-4"
                                      />
                                      <Label htmlFor={`t${idx}_libre`} className="cursor-pointer text-sm">Le t√©moin agit librement et sans contrainte</Label>
                                    </div>

                                    <div className="flex items-center space-x-2">
                                      <input
                                        type="checkbox"
                                        id={`t${idx}_signature`}
                                        checked={temoin.signature}
                                        onChange={(e) => {
                                          const newTemoins = [...testamentData.testamentAuthentique.temoins];
                                          newTemoins[idx].signature = e.target.checked;
                                          setTestamentData({
                                            ...testamentData,
                                            testamentAuthentique: {...testamentData.testamentAuthentique, temoins: newTemoins}
                                          });
                                        }}
                                        className="w-4 h-4"
                                      />
                                      <Label htmlFor={`t${idx}_signature`} className="cursor-pointer text-sm">Signature du t√©moin</Label>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            ))}
                          </div>
                        )}

                        {/* Second notaire (conditionnel si modalit√© = 2 notaires) */}
                        {testamentData.testamentAuthentique.modaliteReception === "2notaires" && (
                          <div className="space-y-3 p-3 bg-blue-100 rounded-lg border border-blue-300">
                            <h4 className="font-medium">Second notaire <span className="text-red-500">*</span></h4>
                            <p className="text-sm text-gray-600">Obligatoire pour la modalit√© "2 notaires"</p>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                              <div className="space-y-2">
                                <Label>Nom du 2·µâ notaire <span className="text-red-500">*</span></Label>
                                <Input
                                  value={testamentData.testamentAuthentique.secondNotaireNom}
                                  onChange={(e) => setTestamentData({
                                    ...testamentData,
                                    testamentAuthentique: {...testamentData.testamentAuthentique, secondNotaireNom: e.target.value}
                                  })}
                                  placeholder="M./Mme Nom Pr√©nom"
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Office notarial <span className="text-red-500">*</span></Label>
                                <Input
                                  value={testamentData.testamentAuthentique.secondNotaireOffice}
                                  onChange={(e) => setTestamentData({
                                    ...testamentData,
                                    testamentAuthentique: {...testamentData.testamentAuthentique, secondNotaireOffice: e.target.value}
                                  })}
                                  placeholder="Nom de l'office"
                                />
                              </div>

                              <div className="space-y-2 md:col-span-2">
                                <Label>Adresse de l'office</Label>
                                <Input
                                  value={testamentData.testamentAuthentique.secondNotaireAdresse}
                                  onChange={(e) => setTestamentData({
                                    ...testamentData,
                                    testamentAuthentique: {...testamentData.testamentAuthentique, secondNotaireAdresse: e.target.value}
                                  })}
                                  placeholder="Adresse compl√®te"
                                />
                              </div>
                            </div>
                          </div>
                        )}

                        {/* Formalit√©s l√©gales */}
                        <div className="space-y-3 p-3 bg-red-50 rounded-lg border border-red-300">
                          <h4 className="font-medium">Formalit√©s l√©gales <span className="text-red-500">*</span></h4>
                          <div className="space-y-2">
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="dicte"
                                checked={testamentData.testamentAuthentique.formaliteDicte}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentAuthentique: {...testamentData.testamentAuthentique, formaliteDicte: e.target.checked}
                                })}
                                className="w-4 h-4"
                              />
                              <Label htmlFor="dicte" className="cursor-pointer">Testament dict√© par le testateur au notaire</Label>
                            </div>

                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="relu"
                                checked={testamentData.testamentAuthentique.formaliteRelu}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentAuthentique: {...testamentData.testamentAuthentique, formaliteRelu: e.target.checked}
                                })}
                                className="w-4 h-4"
                              />
                              <Label htmlFor="relu" className="cursor-pointer">Lecture int√©grale par le notaire au testateur</Label>
                            </div>

                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="approbation"
                                checked={testamentData.testamentAuthentique.declarationApprobation}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentAuthentique: {...testamentData.testamentAuthentique, declarationApprobation: e.target.checked}
                                })}
                                className="w-4 h-4"
                              />
                              <Label htmlFor="approbation" className="cursor-pointer">D√©claration d'approbation expresse du testateur</Label>
                            </div>

                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="signe"
                                checked={testamentData.testamentAuthentique.formaliteSigne}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentAuthentique: {...testamentData.testamentAuthentique, formaliteSigne: e.target.checked}
                                })}
                                className="w-4 h-4"
                              />
                              <Label htmlFor="signe" className="cursor-pointer">Signatures : testateur + notaire(s) + t√©moins (le cas √©ch√©ant)</Label>
                            </div>

                            <div className="flex items-center space-x-2 ml-6">
                              <input
                                type="checkbox"
                                id="impossibilite"
                                checked={testamentData.testamentAuthentique.impossibiliteSigner}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentAuthentique: {...testamentData.testamentAuthentique, impossibiliteSigner: e.target.checked}
                                })}
                                className="w-4 h-4"
                              />
                              <Label htmlFor="impossibilite" className="cursor-pointer text-sm">Impossibilit√© de signer (mention requise)</Label>
                            </div>

                            {testamentData.testamentAuthentique.impossibiliteSigner && (
                              <div className="ml-6 space-y-2">
                                <Label>Motif de l'impossibilit√© <span className="text-red-500">*</span></Label>
                                <Input
                                  value={testamentData.testamentAuthentique.motifImpossibilite}
                                  onChange={(e) => setTestamentData({
                                    ...testamentData,
                                    testamentAuthentique: {...testamentData.testamentAuthentique, motifImpossibilite: e.target.value}
                                  })}
                                  placeholder="Ex: Impossibilit√© physique, handicap..."
                                />
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Inscription FCDDV */}
                        <div className="space-y-3 p-3 bg-green-50 rounded-lg border border-green-300">
                          <h4 className="font-medium">Inscription au FCDDV</h4>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="fcddv"
                              checked={testamentData.testamentAuthentique.inscriptionFCDDV}
                              onChange={(e) => setTestamentData({
                                ...testamentData,
                                testamentAuthentique: {...testamentData.testamentAuthentique, inscriptionFCDDV: e.target.checked}
                              })}
                              className="w-4 h-4"
                            />
                            <Label htmlFor="fcddv" className="cursor-pointer">Proc√©der √† l'inscription au FCDDV</Label>
                          </div>

                          {testamentData.testamentAuthentique.inscriptionFCDDV && (
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                              <div className="space-y-2">
                                <Label>Date d'inscription</Label>
                                <Input
                                  type="date"
                                  value={testamentData.testamentAuthentique.dateInscriptionFCDDV}
                                  onChange={(e) => setTestamentData({
                                    ...testamentData,
                                    testamentAuthentique: {...testamentData.testamentAuthentique, dateInscriptionFCDDV: e.target.value}
                                  })}
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Notaire d√©positaire</Label>
                                <Input
                                  value={testamentData.testamentAuthentique.notaireDepositaire}
                                  onChange={(e) => setTestamentData({
                                    ...testamentData,
                                    testamentAuthentique: {...testamentData.testamentAuthentique, notaireDepositaire: e.target.value}
                                  })}
                                  placeholder="Nom du notaire d√©positaire"
                                />
                              </div>
                            </div>
                          )}
                        </div>
                      </div>
                    </div>

                    {/* Mentions l√©gales */}
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">Mentions l√©gales et rappels</h3>
                      <div className="p-4 border-2 rounded-lg space-y-3 bg-red-50/50 border-red-300">
                        
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="rappel_reserve"
                            checked={testamentData.mentionsLegales.rappelReserveHereditaire}
                            onChange={(e) => setTestamentData({
                              ...testamentData,
                              mentionsLegales: {...testamentData.mentionsLegales, rappelReserveHereditaire: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="rappel_reserve" className="cursor-pointer font-medium">
                            <span className="text-red-500">*</span> Rappel de la r√©serve h√©r√©ditaire (art. 912-916 Code civil)
                          </Label>
                        </div>

                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="rappel_quotite"
                            checked={testamentData.mentionsLegales.rappelQuotiteDisponible}
                            onChange={(e) => setTestamentData({
                              ...testamentData,
                              mentionsLegales: {...testamentData.mentionsLegales, rappelQuotiteDisponible: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="rappel_quotite" className="cursor-pointer font-medium">
                            <span className="text-red-500">*</span> Rappel de la quotit√© disponible
                          </Label>
                        </div>

                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="testament_revocable"
                            checked={testamentData.mentionsLegales.testamentRevocable}
                            onChange={(e) => setTestamentData({
                              ...testamentData,
                              mentionsLegales: {...testamentData.mentionsLegales, testamentRevocable: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="testament_revocable" className="cursor-pointer font-medium">
                            <span className="text-red-500">*</span> Testament r√©vocable √† tout moment (art. 895 Code civil)
                          </Label>
                        </div>

                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="indignite"
                            checked={testamentData.mentionsLegales.casIndignite}
                            onChange={(e) => setTestamentData({
                              ...testamentData,
                              mentionsLegales: {...testamentData.mentionsLegales, casIndignite: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="indignite" className="cursor-pointer">
                            Mention des cas d'indignit√© successorale (art. 726-728 Code civil)
                          </Label>
                        </div>

                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="capacite_legataires"
                            checked={testamentData.mentionsLegales.verificationCapaciteLegataires}
                            onChange={(e) => setTestamentData({
                              ...testamentData,
                              mentionsLegales: {...testamentData.mentionsLegales, verificationCapaciteLegataires: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="capacite_legataires" className="cursor-pointer">
                            V√©rification capacit√© des l√©gataires √† recevoir
                          </Label>
                        </div>

                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="droits_reduction"
                            checked={testamentData.mentionsLegales.droitsReduction}
                            onChange={(e) => setTestamentData({
                              ...testamentData,
                              mentionsLegales: {...testamentData.mentionsLegales, droitsReduction: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="droits_reduction" className="cursor-pointer">
                            Mention des droits de r√©duction (art. 920-930 Code civil)
                          </Label>
                        </div>

                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="regime_fiscal"
                            checked={testamentData.mentionsLegales.regimeFiscalSuccessions}
                            onChange={(e) => setTestamentData({
                              ...testamentData,
                              mentionsLegales: {...testamentData.mentionsLegales, regimeFiscalSuccessions: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="regime_fiscal" className="cursor-pointer">
                            Information sur le r√©gime fiscal des successions
                          </Label>
                        </div>
                      </div>
                    </div>

                    {/* Documents obligatoires */}
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">Documents obligatoires √† collecter</h3>
                      <div className="p-4 border-2 rounded-lg space-y-5 bg-indigo-50/50 border-indigo-300">
                        
                        {/* Documents du testateur */}
                        <div className="space-y-3">
                          <h4 className="font-medium text-indigo-900">Documents du testateur</h4>
                          <div className="space-y-2">
                            <Label>Pi√®ce d'identit√© du testateur (CNI, passeport)</Label>
                            <button
                              type="button"
                              onClick={() => handleFileClick("pieceIdentiteTestateur")}
                              className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                              style={{
                                borderColor: testamentData.documentsAuthentique.pieceIdentiteTestateur ? "#22c55e" : "#fb923c",
                                backgroundColor: testamentData.documentsAuthentique.pieceIdentiteTestateur ? "#f0fdf4" : "white"
                              }}
                            >
                              {testamentData.documentsAuthentique.pieceIdentiteTestateur ? (
                                <svg className="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                </svg>
                              ) : (
                                <svg className="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                                </svg>
                              )}
                              <span className={testamentData.documentsAuthentique.pieceIdentiteTestateur ? "text-green-700 font-medium" : "text-orange-700"}>
                                {testamentData.documentsAuthentique.pieceIdentiteTestateur || "Aucune pi√®ce charg√©e - Cliquer pour ajouter"}
                              </span>
                            </button>
                          </div>

                          <div className="space-y-2">
                            <Label>Livret de famille</Label>
                            <button
                              type="button"
                              onClick={() => handleFileClick("livretFamilleTestateur")}
                              className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                              style={{
                                borderColor: testamentData.documentsAuthentique.livretFamilleTestateur ? "#22c55e" : "#fb923c",
                                backgroundColor: testamentData.documentsAuthentique.livretFamilleTestateur ? "#f0fdf4" : "white"
                              }}
                            >
                              {testamentData.documentsAuthentique.livretFamilleTestateur ? (
                                <svg className="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                </svg>
                              ) : (
                                <svg className="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                                </svg>
                              )}
                              <span className={testamentData.documentsAuthentique.livretFamilleTestateur ? "text-green-700 font-medium" : "text-orange-700"}>
                                {testamentData.documentsAuthentique.livretFamilleTestateur || "Aucune pi√®ce charg√©e - Cliquer pour ajouter"}
                              </span>
                            </button>
                          </div>

                          <div className="space-y-2">
                            <Label>Certificat de capacit√© juridique / jugement tutelle-curatelle (si applicable)</Label>
                            <button
                              type="button"
                              onClick={() => handleFileClick("certificatCapaciteTestateur")}
                              className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                              style={{
                                borderColor: testamentData.documentsAuthentique.certificatCapaciteTestateur ? "#22c55e" : "#fb923c",
                                backgroundColor: testamentData.documentsAuthentique.certificatCapaciteTestateur ? "#f0fdf4" : "white"
                              }}
                            >
                              {testamentData.documentsAuthentique.certificatCapaciteTestateur ? (
                                <svg className="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                </svg>
                              ) : (
                                <svg className="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                                </svg>
                              )}
                              <span className={testamentData.documentsAuthentique.certificatCapaciteTestateur ? "text-green-700 font-medium" : "text-orange-700"}>
                                {testamentData.documentsAuthentique.certificatCapaciteTestateur || "Aucune pi√®ce charg√©e - Cliquer pour ajouter"}
                              </span>
                            </button>
                          </div>
                        </div>

                        {/* Documents des t√©moins */}
                        <div className="space-y-3 border-t pt-4">
                          <h4 className="font-medium text-indigo-900">Documents des t√©moins</h4>
                          <div className="space-y-2">
                            <Label>Pi√®ces d'identit√© des t√©moins</Label>
                            <button
                              type="button"
                              onClick={() => handleFileClick("piecesIdentiteTemoins")}
                              className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                              style={{
                                borderColor: testamentData.documentsAuthentique.piecesIdentiteTemoins ? "#22c55e" : "#fb923c",
                                backgroundColor: testamentData.documentsAuthentique.piecesIdentiteTemoins ? "#f0fdf4" : "white"
                              }}
                            >
                              {testamentData.documentsAuthentique.piecesIdentiteTemoins ? (
                                <svg className="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                </svg>
                              ) : (
                                <svg className="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                                </svg>
                              )}
                              <span className={testamentData.documentsAuthentique.piecesIdentiteTemoins ? "text-green-700 font-medium" : "text-orange-700"}>
                                {testamentData.documentsAuthentique.piecesIdentiteTemoins || "Aucune pi√®ce charg√©e - Cliquer pour ajouter"}
                              </span>
                            </button>
                          </div>

                          <div className="space-y-2">
                            <Label>Justificatifs de domicile des t√©moins</Label>
                            <button
                              type="button"
                              onClick={() => handleFileClick("justificatifsDomicileTemoins")}
                              className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                              style={{
                                borderColor: testamentData.documentsAuthentique.justificatifsDomicileTemoins ? "#22c55e" : "#fb923c",
                                backgroundColor: testamentData.documentsAuthentique.justificatifsDomicileTemoins ? "#f0fdf4" : "white"
                              }}
                            >
                              {testamentData.documentsAuthentique.justificatifsDomicileTemoins ? (
                                <svg className="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                </svg>
                              ) : (
                                <svg className="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                                </svg>
                              )}
                              <span className={testamentData.documentsAuthentique.justificatifsDomicileTemoins ? "text-green-700 font-medium" : "text-orange-700"}>
                                {testamentData.documentsAuthentique.justificatifsDomicileTemoins || "Aucune pi√®ce charg√©e - Cliquer pour ajouter"}
                              </span>
                            </button>
                          </div>

                          <div className="space-y-2">
                            <Label>Attestations sur l'honneur capacit√© t√©moins</Label>
                            <button
                              type="button"
                              onClick={() => handleFileClick("attestationsCapaciteTemoins")}
                              className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                              style={{
                                borderColor: testamentData.documentsAuthentique.attestationsCapaciteTemoins ? "#22c55e" : "#fb923c",
                                backgroundColor: testamentData.documentsAuthentique.attestationsCapaciteTemoins ? "#f0fdf4" : "white"
                              }}
                            >
                              {testamentData.documentsAuthentique.attestationsCapaciteTemoins ? (
                                <svg className="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                </svg>
                              ) : (
                                <svg className="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                                </svg>
                              )}
                              <span className={testamentData.documentsAuthentique.attestationsCapaciteTemoins ? "text-green-700 font-medium" : "text-orange-700"}>
                                {testamentData.documentsAuthentique.attestationsCapaciteTemoins || "Aucune pi√®ce charg√©e - Cliquer pour ajouter"}
                              </span>
                            </button>
                          </div>

                          <div className="space-y-2">
                            <Label>Casiers judiciaires des t√©moins (extrait n¬∞3)</Label>
                            <button
                              type="button"
                              onClick={() => handleFileClick("casiersJudiciairesTemoins")}
                              className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                              style={{
                                borderColor: testamentData.documentsAuthentique.casiersJudiciairesTemoins ? "#22c55e" : "#fb923c",
                                backgroundColor: testamentData.documentsAuthentique.casiersJudiciairesTemoins ? "#f0fdf4" : "white"
                              }}
                            >
                              {testamentData.documentsAuthentique.casiersJudiciairesTemoins ? (
                                <svg className="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                </svg>
                              ) : (
                                <svg className="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                                </svg>
                              )}
                              <span className={testamentData.documentsAuthentique.casiersJudiciairesTemoins ? "text-green-700 font-medium" : "text-orange-700"}>
                                {testamentData.documentsAuthentique.casiersJudiciairesTemoins || "Aucune pi√®ce charg√©e - Cliquer pour ajouter"}
                              </span>
                            </button>
                          </div>
                        </div>

                        {/* Documents patrimoniaux */}
                        <div className="space-y-3 border-t pt-4">
                          <h4 className="font-medium text-indigo-900">Documents patrimoniaux</h4>
                          <div className="space-y-2">
                            <Label>Titres de propri√©t√© immobiliers</Label>
                            <button
                              type="button"
                              onClick={() => handleFileClick("titresPropriete")}
                              className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                              style={{
                                borderColor: testamentData.documentsAuthentique.titresPropriete ? "#22c55e" : "#fb923c",
                                backgroundColor: testamentData.documentsAuthentique.titresPropriete ? "#f0fdf4" : "white"
                              }}
                            >
                              {testamentData.documentsAuthentique.titresPropriete ? (
                                <svg className="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                </svg>
                              ) : (
                                <svg className="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                                </svg>
                              )}
                              <span className={testamentData.documentsAuthentique.titresPropriete ? "text-green-700 font-medium" : "text-orange-700"}>
                                {testamentData.documentsAuthentique.titresPropriete || "Aucune pi√®ce charg√©e - Cliquer pour ajouter"}
                              </span>
                            </button>
                          </div>

                          <div className="space-y-2">
                            <Label>Relev√©s bancaires et comptes</Label>
                            <button
                              type="button"
                              onClick={() => handleFileClick("relevesBancaires")}
                              className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                              style={{
                                borderColor: testamentData.documentsAuthentique.relevesBancaires ? "#22c55e" : "#fb923c",
                                backgroundColor: testamentData.documentsAuthentique.relevesBancaires ? "#f0fdf4" : "white"
                              }}
                            >
                              {testamentData.documentsAuthentique.relevesBancaires ? (
                                <svg className="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                </svg>
                              ) : (
                                <svg className="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                                </svg>
                              )}
                              <span className={testamentData.documentsAuthentique.relevesBancaires ? "text-green-700 font-medium" : "text-orange-700"}>
                                {testamentData.documentsAuthentique.relevesBancaires || "Aucune pi√®ce charg√©e - Cliquer pour ajouter"}
                              </span>
                            </button>
                          </div>

                          <div className="space-y-2">
                            <Label>Contrat de mariage / r√©gime matrimonial</Label>
                            <button
                              type="button"
                              onClick={() => handleFileClick("contratMariage")}
                              className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                              style={{
                                borderColor: testamentData.documentsAuthentique.contratMariage ? "#22c55e" : "#fb923c",
                                backgroundColor: testamentData.documentsAuthentique.contratMariage ? "#f0fdf4" : "white"
                              }}
                            >
                              {testamentData.documentsAuthentique.contratMariage ? (
                                <svg className="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                </svg>
                              ) : (
                                <svg className="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                                </svg>
                              )}
                              <span className={testamentData.documentsAuthentique.contratMariage ? "text-green-700 font-medium" : "text-orange-700"}>
                                {testamentData.documentsAuthentique.contratMariage || "Aucune pi√®ce charg√©e - Cliquer pour ajouter"}
                              </span>
                            </button>
                          </div>

                          <div className="space-y-2">
                            <Label>Autres justificatifs patrimoniaux</Label>
                            <button
                              type="button"
                              onClick={() => handleFileClick("autresJustificatifs")}
                              className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                              style={{
                                borderColor: testamentData.documentsAuthentique.autresJustificatifs ? "#22c55e" : "#fb923c",
                                backgroundColor: testamentData.documentsAuthentique.autresJustificatifs ? "#f0fdf4" : "white"
                              }}
                            >
                              {testamentData.documentsAuthentique.autresJustificatifs ? (
                                <svg className="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                </svg>
                              ) : (
                                <svg className="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                                </svg>
                              )}
                              <span className={testamentData.documentsAuthentique.autresJustificatifs ? "text-green-700 font-medium" : "text-orange-700"}>
                                {testamentData.documentsAuthentique.autresJustificatifs || "Aucune pi√®ce charg√©e - Cliquer pour ajouter"}
                              </span>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  )}

                  {/* 9. Testament mystique sp√©cifique */}
                  {testamentData.typeTestament === "mystique" && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">Formalit√©s sp√©cifiques - Testament mystique</h3>
                      
                      <div className="p-4 border-2 rounded-lg space-y-4 bg-purple-50/50 border-purple-300">
                        
                        {/* Testament ant√©rieur (m√™me section que pour authentique) */}
                        <div className="space-y-3 p-3 bg-yellow-50 rounded-lg border border-yellow-300">
                          <h4 className="font-medium">Testament ant√©rieur existant ?</h4>
                          <p className="text-sm text-gray-600">Bonne pratique notariale (non obligatoire)</p>
                          <div className="flex items-center space-x-4">
                            <label className="flex items-center space-x-2 cursor-pointer">
                              <input
                                type="radio"
                                name="testamentAnterieurMystique"
                                checked={testamentData.testamentAnterieur === true}
                                onChange={() => setTestamentData({...testamentData, testamentAnterieur: true})}
                                className="w-4 h-4"
                              />
                              <span>Oui</span>
                            </label>
                            <label className="flex items-center space-x-2 cursor-pointer">
                              <input
                                type="radio"
                                name="testamentAnterieurMystique"
                                checked={testamentData.testamentAnterieur === false}
                                onChange={() => setTestamentData({...testamentData, testamentAnterieur: false})}
                                className="w-4 h-4"
                              />
                              <span>Non</span>
                            </label>
                          </div>

                          {testamentData.testamentAnterieur && (
                            <div className="ml-6 p-3 bg-white rounded-lg border border-yellow-300 space-y-3">
                              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div className="space-y-2">
                                  <Label>Date du pr√©c√©dent testament</Label>
                                  <Input
                                    type="date"
                                    value={testamentData.testamentAnterieurDate}
                                    onChange={(e) => setTestamentData({...testamentData, testamentAnterieurDate: e.target.value})}
                                  />
                                </div>
                                <div className="space-y-2">
                                  <Label>Type du pr√©c√©dent testament</Label>
                                  <Select
                                    value={testamentData.testamentAnterieurType || undefined}
                                    onValueChange={(value) => setTestamentData({...testamentData, testamentAnterieurType: value})}
                                  >
                                    <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                    <SelectContent>
                                      <SelectItem value="authentique">Testament authentique</SelectItem>
                                      <SelectItem value="mystique">Testament mystique</SelectItem>
                                      <SelectItem value="olographe">Testament olographe</SelectItem>
                                    </SelectContent>
                                  </Select>
                                </div>
                                <div className="space-y-2 md:col-span-2">
                                  <Label>Notaire d√©positaire (si connu)</Label>
                                  <Input
                                    value={testamentData.testamentAnterieurNotaire}
                                    onChange={(e) => setTestamentData({...testamentData, testamentAnterieurNotaire: e.target.value})}
                                    placeholder="Nom et adresse du notaire"
                                  />
                                </div>
                              </div>
                            </div>
                          )}
                        </div>

                        {/* R√©daction */}
                        <div className="space-y-3 p-3 bg-white rounded-lg border border-purple-200">
                          <h4 className="font-medium">Mode de r√©daction du testament <span className="text-red-500">*</span></h4>
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="space-y-2">
                              <Label>R√©dig√© par <span className="text-red-500">*</span></Label>
                              <Select
                                value={testamentData.testamentMystique.redactionPar || undefined}
                                onValueChange={(value) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, redactionPar: value}
                                })}
                              >
                                <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="testateur">Le testateur lui-m√™me</SelectItem>
                                  <SelectItem value="tiers">Un tiers</SelectItem>
                                </SelectContent>
                              </Select>
                            </div>

                            {testamentData.testamentMystique.redactionPar === "tiers" && (
                              <div className="space-y-2">
                                <Label>Nom du r√©dacteur <span className="text-red-500">*</span></Label>
                                <Input
                                  value={testamentData.testamentMystique.nomRedacteur}
                                  onChange={(e) => setTestamentData({
                                    ...testamentData,
                                    testamentMystique: {...testamentData.testamentMystique, nomRedacteur: e.target.value}
                                  })}
                                  placeholder="Nom et pr√©nom du r√©dacteur"
                                />
                              </div>
                            )}

                            <div className="space-y-2">
                              <Label>Type d'√©criture <span className="text-red-500">*</span></Label>
                              <Select
                                value={testamentData.testamentMystique.typeEcriture || undefined}
                                onValueChange={(value) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, typeEcriture: value}
                                })}
                              >
                                <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="manuscrit">Manuscrit (√† la main)</SelectItem>
                                  <SelectItem value="dactylographie">Dactylographi√©</SelectItem>
                                </SelectContent>
                              </Select>
                            </div>

                            <div className="space-y-2">
                              <Label>Langue du testament <span className="text-red-500">*</span></Label>
                              <Select
                                value={testamentData.testamentMystique.langueTestament || undefined}
                                onValueChange={(value) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, langueTestament: value}
                                })}
                              >
                                <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="francais">Fran√ßais</SelectItem>
                                  <SelectItem value="autre">Autre langue</SelectItem>
                                </SelectContent>
                              </Select>
                            </div>

                            <div className="space-y-2">
                              <Label>Nombre de pages</Label>
                              <Input
                                type="number"
                                value={testamentData.testamentMystique.nombrePages}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, nombrePages: e.target.value}
                                })}
                                placeholder="Nombre de pages"
                              />
                            </div>
                          </div>
                        </div>

                        {/* Pr√©sentation sous pli ferm√© */}
                        <div className="space-y-3 p-3 bg-yellow-50 rounded-lg border border-yellow-300">
                          <h4 className="font-medium">Pr√©sentation sous pli ferm√© et scell√© <span className="text-red-500">*</span></h4>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="cachete"
                              checked={testamentData.testamentMystique.cachete}
                              onChange={(e) => setTestamentData({
                                ...testamentData,
                                testamentMystique: {...testamentData.testamentMystique, cachete: e.target.checked}
                              })}
                              className="w-4 h-4"
                            />
                            <Label htmlFor="cachete" className="cursor-pointer">Pli ferm√©, cachet√© et scell√©</Label>
                          </div>

                          <div className="space-y-2">
                            <Label>Description du scell√© <span className="text-red-500">*</span></Label>
                            <Input
                              value={testamentData.testamentMystique.descriptionScelle}
                              onChange={(e) => setTestamentData({
                                ...testamentData,
                                testamentMystique: {...testamentData.testamentMystique, descriptionScelle: e.target.value}
                              })}
                              placeholder="Ex: Enveloppe cachet√©e avec cire rouge..."
                            />
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="space-y-2">
                              <Label>Lieu de pr√©sentation <span className="text-red-500">*</span></Label>
                              <Input
                                value={testamentData.testamentMystique.lieuPresentation}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, lieuPresentation: e.target.value}
                                })}
                                placeholder="Ex: Office notarial..."
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>Date de pr√©sentation</Label>
                              <Input
                                type="date"
                                value={testamentData.testamentMystique.datePresentation}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, datePresentation: e.target.value}
                                })}
                              />
                            </div>
                          </div>
                        </div>

                        {/* Notaire */}
                        <div className="space-y-3 p-3 bg-white rounded-lg border border-purple-200">
                          <h4 className="font-medium">Notaire r√©cepteur <span className="text-red-500">*</span></h4>
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="space-y-2">
                              <Label>Nom du notaire <span className="text-red-500">*</span></Label>
                              <Input
                                value={testamentData.testamentMystique.notaireNom}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, notaireNom: e.target.value}
                                })}
                                placeholder="M./Mme Nom Pr√©nom"
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>Office notarial <span className="text-red-500">*</span></Label>
                              <Input
                                value={testamentData.testamentMystique.notaireOffice}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, notaireOffice: e.target.value}
                                })}
                                placeholder="Nom de l'office"
                              />
                            </div>

                            <div className="space-y-2 md:col-span-2">
                              <Label>Adresse de l'office</Label>
                              <Input
                                value={testamentData.testamentMystique.notaireAdresse}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, notaireAdresse: e.target.value}
                                })}
                              />
                            </div>
                          </div>
                        </div>

                        {/* T√©moins (2 obligatoires) */}
                        <div className="space-y-3 p-3 bg-white rounded-lg border border-purple-200">
                          <div className="flex justify-between items-center">
                            <h4 className="font-medium">T√©moins (2 t√©moins obligatoires) <span className="text-red-500">*</span></h4>
                            <Button
                              type="button"
                              size="sm"
                              className="bg-orange-600 hover:bg-orange-700 text-white"
                              onClick={() => setTestamentData({
                                ...testamentData,
                                testamentMystique: {
                                  ...testamentData.testamentMystique,
                                  temoins: [...testamentData.testamentMystique.temoins, {
                                    nom: "", prenom: "", dateNaissance: "", lieuNaissance: "", nationalite: "",
                                    profession: "", adresse: "", lienAvecTestateur: "",
                                    nonHeritier: false, nonLegataire: false, nonConjoint: false,
                                    nonParentJusque4eDegre: false, capaciteJuridique: false,
                                    comprendLangue: false, agitLibrement: false, signature: false
                                  }]
                                }
                              })}
                            >
                              + Ajouter un t√©moin
                            </Button>
                          </div>

                          {testamentData.testamentMystique.temoins.map((temoin, idx) => (
                            <div key={idx} className="p-4 bg-purple-50 rounded-lg space-y-3 border-2 border-purple-300">
                              <div className="flex justify-between">
                                <h5 className="text-sm font-medium">T√©moin {idx + 1}</h5>
                                <Button
                                  type="button"
                                  variant="ghost"
                                  size="sm"
                                  onClick={() => {
                                    const newTemoins = testamentData.testamentMystique.temoins.filter((_, i) => i !== idx);
                                    setTestamentData({
                                      ...testamentData,
                                      testamentMystique: {...testamentData.testamentMystique, temoins: newTemoins}
                                    });
                                  }}
                                >
                                  üóëÔ∏è
                                </Button>
                              </div>

                              <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <div className="space-y-2">
                                  <Label>Nom <span className="text-red-500">*</span></Label>
                                  <Input
                                    value={temoin.nom}
                                    onChange={(e) => {
                                      const newTemoins = [...testamentData.testamentMystique.temoins];
                                      newTemoins[idx].nom = e.target.value;
                                      setTestamentData({
                                        ...testamentData,
                                        testamentMystique: {...testamentData.testamentMystique, temoins: newTemoins}
                                      });
                                    }}
                                  />
                                </div>

                                <div className="space-y-2">
                                  <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                                  <Input
                                    value={temoin.prenom}
                                    onChange={(e) => {
                                      const newTemoins = [...testamentData.testamentMystique.temoins];
                                      newTemoins[idx].prenom = e.target.value;
                                      setTestamentData({
                                        ...testamentData,
                                        testamentMystique: {...testamentData.testamentMystique, temoins: newTemoins}
                                      });
                                    }}
                                  />
                                </div>

                                <div className="space-y-2">
                                  <Label>Date de naissance <span className="text-red-500">*</span></Label>
                                  <Input
                                    type="date"
                                    value={temoin.dateNaissance}
                                    onChange={(e) => {
                                      const newTemoins = [...testamentData.testamentMystique.temoins];
                                      newTemoins[idx].dateNaissance = e.target.value;
                                      setTestamentData({
                                        ...testamentData,
                                        testamentMystique: {...testamentData.testamentMystique, temoins: newTemoins}
                                      });
                                    }}
                                  />
                                </div>

                                <div className="space-y-2">
                                  <Label>Lieu de naissance</Label>
                                  <Input
                                    value={temoin.lieuNaissance}
                                    onChange={(e) => {
                                      const newTemoins = [...testamentData.testamentMystique.temoins];
                                      newTemoins[idx].lieuNaissance = e.target.value;
                                      setTestamentData({
                                        ...testamentData,
                                        testamentMystique: {...testamentData.testamentMystique, temoins: newTemoins}
                                      });
                                    }}
                                  />
                                </div>

                                <div className="space-y-2">
                                  <Label>Nationalit√© <span className="text-red-500">*</span></Label>
                                  <Input
                                    value={temoin.nationalite}
                                    onChange={(e) => {
                                      const newTemoins = [...testamentData.testamentMystique.temoins];
                                      newTemoins[idx].nationalite = e.target.value;
                                      setTestamentData({
                                        ...testamentData,
                                        testamentMystique: {...testamentData.testamentMystique, temoins: newTemoins}
                                      });
                                    }}
                                    placeholder="Ex: Fran√ßaise"
                                  />
                                </div>

                                <div className="space-y-2">
                                  <Label>Profession</Label>
                                  <Input
                                    value={temoin.profession}
                                    onChange={(e) => {
                                      const newTemoins = [...testamentData.testamentMystique.temoins];
                                      newTemoins[idx].profession = e.target.value;
                                      setTestamentData({
                                        ...testamentData,
                                        testamentMystique: {...testamentData.testamentMystique, temoins: newTemoins}
                                      });
                                    }}
                                  />
                                </div>

                                <div className="space-y-2">
                                  <Label>Lien avec le testateur <span className="text-red-500">*</span></Label>
                                  <Input
                                    value={temoin.lienAvecTestateur}
                                    onChange={(e) => {
                                      const newTemoins = [...testamentData.testamentMystique.temoins];
                                      newTemoins[idx].lienAvecTestateur = e.target.value;
                                      setTestamentData({
                                        ...testamentData,
                                        testamentMystique: {...testamentData.testamentMystique, temoins: newTemoins}
                                      });
                                    }}
                                    placeholder="Ex: Aucun lien"
                                  />
                                </div>

                                <div className="space-y-2 md:col-span-2">
                                  <Label>Adresse compl√®te <span className="text-red-500">*</span></Label>
                                  <Input
                                    value={temoin.adresse}
                                    onChange={(e) => {
                                      const newTemoins = [...testamentData.testamentMystique.temoins];
                                      newTemoins[idx].adresse = e.target.value;
                                      setTestamentData({
                                        ...testamentData,
                                        testamentMystique: {...testamentData.testamentMystique, temoins: newTemoins}
                                      });
                                    }}
                                  />
                                </div>
                              </div>

                              {/* D√©clarations l√©gales */}
                              <div className="mt-3 p-3 bg-red-50 rounded-lg border border-red-200">
                                <p className="text-sm font-medium mb-2 text-red-700">D√©clarations l√©gales - CONDITIONS DE VALIDIT√â <span className="text-red-500">*</span></p>
                                <div className="space-y-2">
                                  <div className="flex items-center space-x-2">
                                    <input
                                      type="checkbox"
                                      id={`tm${idx}_nonHeritier`}
                                      checked={temoin.nonHeritier}
                                      onChange={(e) => {
                                        const newTemoins = [...testamentData.testamentMystique.temoins];
                                        newTemoins[idx].nonHeritier = e.target.checked;
                                        setTestamentData({
                                          ...testamentData,
                                          testamentMystique: {...testamentData.testamentMystique, temoins: newTemoins}
                                        });
                                      }}
                                      className="w-4 h-4"
                                    />
                                    <Label htmlFor={`tm${idx}_nonHeritier`} className="cursor-pointer text-sm">Le t√©moin n'est ni h√©ritier ni l√©gataire</Label>
                                  </div>

                                  <div className="flex items-center space-x-2">
                                    <input
                                      type="checkbox"
                                      id={`tm${idx}_nonConjoint`}
                                      checked={temoin.nonConjoint}
                                      onChange={(e) => {
                                        const newTemoins = [...testamentData.testamentMystique.temoins];
                                        newTemoins[idx].nonConjoint = e.target.checked;
                                        setTestamentData({
                                          ...testamentData,
                                          testamentMystique: {...testamentData.testamentMystique, temoins: newTemoins}
                                        });
                                      }}
                                      className="w-4 h-4"
                                    />
                                    <Label htmlFor={`tm${idx}_nonConjoint`} className="cursor-pointer text-sm">Le t√©moin n'est ni conjoint, ni parent jusqu'au 4·µâ degr√©</Label>
                                  </div>

                                  <div className="flex items-center space-x-2">
                                    <input
                                      type="checkbox"
                                      id={`tm${idx}_capacite`}
                                      checked={temoin.capaciteJuridique}
                                      onChange={(e) => {
                                        const newTemoins = [...testamentData.testamentMystique.temoins];
                                        newTemoins[idx].capaciteJuridique = e.target.checked;
                                        setTestamentData({
                                          ...testamentData,
                                          testamentMystique: {...testamentData.testamentMystique, temoins: newTemoins}
                                        });
                                      }}
                                      className="w-4 h-4"
                                    />
                                    <Label htmlFor={`tm${idx}_capacite`} className="cursor-pointer text-sm">Le t√©moin a la capacit√© juridique</Label>
                                  </div>

                                  <div className="flex items-center space-x-2">
                                    <input
                                      type="checkbox"
                                      id={`tm${idx}_langue`}
                                      checked={temoin.comprendLangue}
                                      onChange={(e) => {
                                        const newTemoins = [...testamentData.testamentMystique.temoins];
                                        newTemoins[idx].comprendLangue = e.target.checked;
                                        setTestamentData({
                                          ...testamentData,
                                          testamentMystique: {...testamentData.testamentMystique, temoins: newTemoins}
                                        });
                                      }}
                                      className="w-4 h-4"
                                    />
                                    <Label htmlFor={`tm${idx}_langue`} className="cursor-pointer text-sm">Le t√©moin comprend la langue utilis√©e</Label>
                                  </div>

                                  <div className="flex items-center space-x-2">
                                    <input
                                      type="checkbox"
                                      id={`tm${idx}_libre`}
                                      checked={temoin.agitLibrement}
                                      onChange={(e) => {
                                        const newTemoins = [...testamentData.testamentMystique.temoins];
                                        newTemoins[idx].agitLibrement = e.target.checked;
                                        setTestamentData({
                                          ...testamentData,
                                          testamentMystique: {...testamentData.testamentMystique, temoins: newTemoins}
                                        });
                                      }}
                                      className="w-4 h-4"
                                    />
                                    <Label htmlFor={`tm${idx}_libre`} className="cursor-pointer text-sm">Le t√©moin agit librement et sans contrainte</Label>
                                  </div>

                                  <div className="flex items-center space-x-2">
                                    <input
                                      type="checkbox"
                                      id={`tm${idx}_signature`}
                                      checked={temoin.signature}
                                      onChange={(e) => {
                                        const newTemoins = [...testamentData.testamentMystique.temoins];
                                        newTemoins[idx].signature = e.target.checked;
                                        setTestamentData({
                                          ...testamentData,
                                          testamentMystique: {...testamentData.testamentMystique, temoins: newTemoins}
                                        });
                                      }}
                                      className="w-4 h-4"
                                    />
                                    <Label htmlFor={`tm${idx}_signature`} className="cursor-pointer text-sm">Signature du t√©moin</Label>
                                  </div>
                                </div>
                              </div>
                            </div>
                          ))}
                        </div>

                        {/* D√©clarations obligatoires art. 976 C. civ. */}
                        <div className="space-y-3 p-3 bg-red-50 rounded-lg border-2 border-red-400">
                          <h4 className="font-medium text-red-700">üî¥ D√©clarations obligatoires (art. 976 C. civ.) <span className="text-red-500">*</span></h4>
                          <p className="text-sm text-red-600 mb-3">Sans ces d√©clarations ‚Üí Risque de nullit√© du testament</p>
                          
                          <div className="space-y-3">
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="testateurSaitLireEcrire"
                                checked={testamentData.testamentMystique.testateurSaitLireEcrire}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, testateurSaitLireEcrire: e.target.checked}
                                })}
                                className="w-4 h-4"
                              />
                              <Label htmlFor="testateurSaitLireEcrire" className="cursor-pointer font-medium text-red-700">
                                <span className="text-red-500">*</span> Le testateur d√©clare savoir lire et √©crire (OBLIGATOIRE)
                              </Label>
                            </div>

                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="testateurReconnaitTestament"
                                checked={testamentData.testamentMystique.testateurReconnaitTestament}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, testateurReconnaitTestament: e.target.checked}
                                })}
                                className="w-4 h-4"
                              />
                              <Label htmlFor="testateurReconnaitTestament" className="cursor-pointer font-medium text-red-700">
                                <span className="text-red-500">*</span> Le testateur reconna√Æt que le testament contenu dans le pli est bien le sien
                              </Label>
                            </div>

                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="pliNonOuvert"
                                checked={testamentData.testamentMystique.pliNonOuvert}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, pliNonOuvert: e.target.checked}
                                })}
                                className="w-4 h-4"
                              />
                              <Label htmlFor="pliNonOuvert" className="cursor-pointer font-medium text-red-700">
                                <span className="text-red-500">*</span> Le pli n'a pas √©t√© ouvert par le notaire (le notaire ne conna√Æt pas le contenu)
                              </Label>
                            </div>
                          </div>
                        </div>

                        {/* Conditions l√©gales t√©moins (s√©curisation) */}
                        <div className="space-y-3 p-3 bg-yellow-50 rounded-lg border border-yellow-400">
                          <h4 className="font-medium text-yellow-800">üü° Conditions l√©gales des t√©moins (ultra-s√©curisant)</h4>
                          <p className="text-sm text-yellow-700 mb-3">Recommand√© pour s√©curisation maximale</p>
                          
                          <div className="space-y-2">
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="temoinsMajeurs"
                                checked={testamentData.testamentMystique.temoinsMajeurs}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, temoinsMajeurs: e.target.checked}
                                })}
                                className="w-4 h-4"
                              />
                              <Label htmlFor="temoinsMajeurs" className="cursor-pointer">‚òê T√©moins majeurs</Label>
                            </div>

                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="temoinsNonHeritiersLegataires"
                                checked={testamentData.testamentMystique.temoinsNonHeritiersLegataires}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, temoinsNonHeritiersLegataires: e.target.checked}
                                })}
                                className="w-4 h-4"
                              />
                              <Label htmlFor="temoinsNonHeritiersLegataires" className="cursor-pointer">‚òê T√©moins non h√©ritiers, non l√©gataires</Label>
                            </div>

                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="temoinsSaventLireEcrire"
                                checked={testamentData.testamentMystique.temoinsSaventLireEcrire}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, temoinsSaventLireEcrire: e.target.checked}
                                })}
                                className="w-4 h-4"
                              />
                              <Label htmlFor="temoinsSaventLireEcrire" className="cursor-pointer">‚òê T√©moins sachant lire et √©crire</Label>
                            </div>
                          </div>
                        </div>

                        {/* Acte de suscription */}
                        <div className="space-y-3 p-3 bg-blue-50 rounded-lg border border-blue-300">
                          <h4 className="font-medium">Acte de suscription <span className="text-red-500">*</span></h4>
                          <div className="flex items-center space-x-2 mb-3">
                            <input
                              type="checkbox"
                              id="declarationContenu"
                              checked={testamentData.testamentMystique.declarationContenuTestament}
                              onChange={(e) => setTestamentData({
                                ...testamentData,
                                testamentMystique: {...testamentData.testamentMystique, declarationContenuTestament: e.target.checked}
                              })}
                              className="w-4 h-4"
                            />
                            <Label htmlFor="declarationContenu" className="cursor-pointer">D√©claration que le pli contient le testament</Label>
                          </div>

                          <div className="space-y-2">
                            <Label>Texte de la suscription</Label>
                            <textarea
                              className="w-full min-h-[80px] p-2 border rounded-md text-sm"
                              value={testamentData.testamentMystique.suscription}
                              onChange={(e) => setTestamentData({
                                ...testamentData,
                                testamentMystique: {...testamentData.testamentMystique, suscription: e.target.value}
                              })}
                              placeholder="Texte de l'acte de suscription..."
                            />
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="space-y-2">
                              <Label>Lieu de suscription</Label>
                              <Input
                                value={testamentData.testamentMystique.lieuSuscription}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, lieuSuscription: e.target.value}
                                })}
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>Date de suscription</Label>
                              <Input
                                type="date"
                                value={testamentData.testamentMystique.dateSuscription}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, dateSuscription: e.target.value}
                                })}
                              />
                            </div>
                          </div>
                        </div>

                        {/* Inscription FCDDV */}
                        <div className="space-y-3 p-3 bg-green-50 rounded-lg border border-green-300">
                          <h4 className="font-medium">Inscription au FCDDV</h4>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="fcddv_mystique"
                              checked={testamentData.testamentMystique.inscriptionFCDDV}
                              onChange={(e) => setTestamentData({
                                ...testamentData,
                                testamentMystique: {...testamentData.testamentMystique, inscriptionFCDDV: e.target.checked}
                              })}
                              className="w-4 h-4"
                            />
                            <Label htmlFor="fcddv_mystique" className="cursor-pointer">Proc√©der √† l'inscription au FCDDV</Label>
                          </div>

                          {testamentData.testamentMystique.inscriptionFCDDV && (
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                              <div className="space-y-2">
                                <Label>Date d'inscription</Label>
                                <Input
                                  type="date"
                                  value={testamentData.testamentMystique.dateInscriptionFCDDV}
                                  onChange={(e) => setTestamentData({
                                    ...testamentData,
                                    testamentMystique: {...testamentData.testamentMystique, dateInscriptionFCDDV: e.target.value}
                                  })}
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Notaire d√©positaire</Label>
                                <Input
                                  value={testamentData.testamentMystique.notaireDepositaire}
                                  onChange={(e) => setTestamentData({
                                    ...testamentData,
                                    testamentMystique: {...testamentData.testamentMystique, notaireDepositaire: e.target.value}
                                  })}
                                  placeholder="Nom du notaire d√©positaire"
                                />
                              </div>
                            </div>
                          )}
                        </div>

                        {/* Pr√©sence simultan√©e et Signatures */}
                        <div className="space-y-3 p-3 bg-orange-50 rounded-lg border border-orange-300">
                          <h4 className="font-medium">Pr√©sence simultan√©e et Signatures <span className="text-red-500">*</span></h4>
                          
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="presenceSimultanee"
                              checked={testamentData.testamentMystique.presenceSimultanee}
                              onChange={(e) => setTestamentData({
                                ...testamentData,
                                testamentMystique: {...testamentData.testamentMystique, presenceSimultanee: e.target.checked}
                              })}
                              className="w-4 h-4"
                            />
                            <Label htmlFor="presenceSimultanee" className="cursor-pointer text-red-700 font-medium">Pr√©sence simultan√©e du testateur, du notaire et des t√©moins lors de la suscription</Label>
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3 mt-3">
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="signatureTestateur"
                                checked={testamentData.testamentMystique.signatureTestateur}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, signatureTestateur: e.target.checked}
                                })}
                                className="w-4 h-4"
                              />
                              <Label htmlFor="signatureTestateur" className="cursor-pointer">Signature du testateur</Label>
                            </div>

                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="signatureNotaire"
                                checked={testamentData.testamentMystique.signatureNotaire}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, signatureNotaire: e.target.checked}
                                })}
                                className="w-4 h-4"
                              />
                              <Label htmlFor="signatureNotaire" className="cursor-pointer">Signature du notaire</Label>
                            </div>
                          </div>

                          <div className="space-y-2">
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id="impossibiliteSignerTestateur"
                                checked={testamentData.testamentMystique.impossibiliteSignerTestateur}
                                onChange={(e) => setTestamentData({
                                  ...testamentData,
                                  testamentMystique: {...testamentData.testamentMystique, impossibiliteSignerTestateur: e.target.checked}
                                })}
                                className="w-4 h-4"
                              />
                              <Label htmlFor="impossibiliteSignerTestateur" className="cursor-pointer">Impossibilit√© de signer pour le testateur</Label>
                            </div>

                            {testamentData.testamentMystique.impossibiliteSignerTestateur && (
                              <div className="ml-6">
                                <Label>Motif de l'impossibilit√© <span className="text-red-500">*</span></Label>
                                <Input
                                  value={testamentData.testamentMystique.motifImpossibiliteSignature}
                                  onChange={(e) => setTestamentData({
                                    ...testamentData,
                                    testamentMystique: {...testamentData.testamentMystique, motifImpossibiliteSignature: e.target.value}
                                  })}
                                  placeholder="Ex: Handicap physique, maladie..."
                                />
                              </div>
                            )}
                          </div>
                        </div>
                      </div>
                    </div>
                  )}

                  {/* 10. Mentions l√©gales obligatoires */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Mentions l√©gales et rappels</h3>
                    
                    <div className="p-4 border rounded-lg space-y-3 bg-gray-50/50">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="mention_reserve"
                          checked={testamentData.mentionsLegales.rappelReserveHereditaire}
                          onChange={(e) => setTestamentData({
                            ...testamentData,
                            mentionsLegales: {...testamentData.mentionsLegales, rappelReserveHereditaire: e.target.checked}
                          })}
                        />
                        <label htmlFor="mention_reserve" className="text-sm cursor-pointer">
                          <span className="text-red-500 font-bold">*</span> Rappel de la r√©serve h√©r√©ditaire (art. 912-916 Code civil)
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="mention_quotite"
                          checked={testamentData.mentionsLegales.rappelQuotiteDisponible}
                          onChange={(e) => setTestamentData({
                            ...testamentData,
                            mentionsLegales: {...testamentData.mentionsLegales, rappelQuotiteDisponible: e.target.checked}
                          })}
                        />
                        <label htmlFor="mention_quotite" className="text-sm cursor-pointer">
                          <span className="text-red-500 font-bold">*</span> Rappel de la quotit√© disponible
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="mention_revocabilite"
                          checked={testamentData.mentionsLegales.revocabilite}
                          onChange={(e) => setTestamentData({
                            ...testamentData,
                            mentionsLegales: {...testamentData.mentionsLegales, revocabilite: e.target.checked}
                          })}
                        />
                        <label htmlFor="mention_revocabilite" className="text-sm cursor-pointer">
                          <span className="text-red-500 font-bold">*</span> Testament r√©vocable √† tout moment (art. 895 Code civil)
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="mention_indignite"
                          checked={testamentData.mentionsLegales.indigniteSuccessorale}
                          onChange={(e) => setTestamentData({
                            ...testamentData,
                            mentionsLegales: {...testamentData.mentionsLegales, indigniteSuccessorale: e.target.checked}
                          })}
                        />
                        <label htmlFor="mention_indignite" className="text-sm cursor-pointer">
                          Mention des cas d'indignit√© successorale (art. 726-728 Code civil)
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="mention_capacite"
                          checked={testamentData.mentionsLegales.capaciteLegataires}
                          onChange={(e) => setTestamentData({
                            ...testamentData,
                            mentionsLegales: {...testamentData.mentionsLegales, capaciteLegataires: e.target.checked}
                          })}
                        />
                        <label htmlFor="mention_capacite" className="text-sm cursor-pointer">
                          V√©rification capacit√© des l√©gataires √† recevoir
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="mention_reduction"
                          checked={testamentData.mentionsLegales.droitsReduction}
                          onChange={(e) => setTestamentData({
                            ...testamentData,
                            mentionsLegales: {...testamentData.mentionsLegales, droitsReduction: e.target.checked}
                          })}
                        />
                        <label htmlFor="mention_reduction" className="text-sm cursor-pointer">
                          Mention des droits de r√©duction (art. 920-930 Code civil)
                        </label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="mention_fiscal"
                          checked={testamentData.mentionsLegales.regimeFiscal}
                          onChange={(e) => setTestamentData({
                            ...testamentData,
                            mentionsLegales: {...testamentData.mentionsLegales, regimeFiscal: e.target.checked}
                          })}
                        />
                        <label htmlFor="mention_fiscal" className="text-sm cursor-pointer">
                          Information sur le r√©gime fiscal des successions
                        </label>
                      </div>
                    </div>
                  </div>

                  {/* 11. Documents √† collecter */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Documents obligatoires √† collecter</h3>
                    
                    {/* Testateur */}
                    <div className="space-y-3 p-4 border rounded-lg bg-blue-50/30">
                      <h4 className="font-medium">Documents du testateur</h4>
                      
                      <MultiFileUpload
                        label="Pi√®ce d'identit√© du testateur (CNI, passeport)"
                        files={testamentIdentiteTestateur}
                        onFilesChange={setTestamentIdentiteTestateur}
                      />

                      <MultiFileUpload
                        label="Livret de famille"
                        files={testamentLivretFamille}
                        onFilesChange={setTestamentLivretFamille}
                      />

                      <MultiFileUpload
                        label="Certificat de capacit√© juridique / jugement tutelle-curatelle (si applicable)"
                        files={testamentCapaciteJuridique}
                        onFilesChange={setTestamentCapaciteJuridique}
                      />
                    </div>

                    {/* T√©moins */}
                    <div className="space-y-3 p-4 border rounded-lg bg-purple-50/30">
                      <h4 className="font-medium">Documents des t√©moins</h4>
                      
                      <MultiFileUpload
                        label="Pi√®ces d'identit√© des t√©moins"
                        files={testamentIdentiteTemoins}
                        onFilesChange={setTestamentIdentiteTemoins}
                      />

                      <MultiFileUpload
                        label="Justificatifs de domicile des t√©moins"
                        files={testamentDomicileTemoins}
                        onFilesChange={setTestamentDomicileTemoins}
                      />

                      <MultiFileUpload
                        label="Attestations sur l'honneur capacit√© t√©moins"
                        files={testamentAttestationsTemoins}
                        onFilesChange={setTestamentAttestationsTemoins}
                      />

                      <MultiFileUpload
                        label="Casiers judiciaires des t√©moins (extrait n¬∞3)"
                        files={testamentCasiersTemoins}
                        onFilesChange={setTestamentCasiersTemoins}
                      />
                    </div>

                    {/* Patrimoine */}
                    <div className="space-y-3 p-4 border rounded-lg bg-orange-50/30">
                      <h4 className="font-medium">Documents patrimoniaux</h4>
                      
                      <MultiFileUpload
                        label="Titres de propri√©t√© immobiliers"
                        files={testamentTitresPropriete}
                        onFilesChange={setTestamentTitresPropriete}
                      />

                      <MultiFileUpload
                        label="Relev√©s bancaires et comptes"
                        files={testamentRelevesBancaires}
                        onFilesChange={setTestamentRelevesBancaires}
                      />

                      <MultiFileUpload
                        label="Contrat de mariage / r√©gime matrimonial"
                        files={testamentContratMariage}
                        onFilesChange={setTestamentContratMariage}
                      />

                      <MultiFileUpload
                        label="Autres justificatifs patrimoniaux"
                        files={testamentAutresJustificatifs}
                        onFilesChange={setTestamentAutresJustificatifs}
                      />
                    </div>
                  </div>

                </div>
              </>
            )}

            {/* Formulaire Changement de R√©gime Matrimonial */}
            {pendingContractType === "Changement de r√©gime matrimonial" && (
              <>
                <div className="space-y-6 max-h-[calc(100vh-250px)] overflow-y-auto pr-2">
                  
                  {/* Section 1: Informations g√©n√©rales */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Informations g√©n√©rales sur l'op√©ration</h3>
                    
                    <div className="space-y-2">
                      <Label>Type de modification souhait√©e <span className="text-red-500">*</span></Label>
                      <Select
                        value={changementRegimeData.typeModification || undefined}
                        onValueChange={(value) => setChangementRegimeData({...changementRegimeData, typeModification: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner le type..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="separation_biens">Passage √† la s√©paration de biens</SelectItem>
                          <SelectItem value="communaute_reduite">Passage √† la communaut√© r√©duite aux acqu√™ts</SelectItem>
                          <SelectItem value="communaute_universelle">Passage √† la communaut√© universelle</SelectItem>
                          <SelectItem value="participation_acquets">Passage √† la participation aux acqu√™ts</SelectItem>
                          <SelectItem value="modification_actuel">Modification / am√©nagement du r√©gime actuel</SelectItem>
                          <SelectItem value="ajout_clauses">Clauses ajout√©es au r√©gime actuel</SelectItem>
                          <SelectItem value="adoption_contrat">Adoption d'un contrat de mariage pour la premi√®re fois</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="space-y-2">
                      <Label>R√©gime matrimonial actuel <span className="text-red-500">*</span></Label>
                      <Select
                        value={changementRegimeData.regimeActuel || undefined}
                        onValueChange={(value) => setChangementRegimeData({...changementRegimeData, regimeActuel: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner le r√©gime actuel..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="communaute_legale">Communaut√© l√©gale</SelectItem>
                          <SelectItem value="communaute_universelle">Communaut√© universelle</SelectItem>
                          <SelectItem value="separation_biens">S√©paration de biens</SelectItem>
                          <SelectItem value="participation_acquets">Participation aux acqu√™ts</SelectItem>
                          <SelectItem value="autre">Autre</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    {changementRegimeData.regimeActuel === "autre" && (
                      <div className="space-y-2">
                        <Label>Pr√©ciser le r√©gime actuel</Label>
                        <Input
                          value={changementRegimeData.regimeActuelAutre}
                          onChange={(e) => setChangementRegimeData({...changementRegimeData, regimeActuelAutre: e.target.value})}
                          placeholder="Pr√©cisez..."
                        />
                      </div>
                    )}

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Date du mariage <span className="text-red-500">*</span></Label>
                        <Input
                          type="date"
                          value={changementRegimeData.dateMariage}
                          onChange={(e) => setChangementRegimeData({...changementRegimeData, dateMariage: e.target.value})}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Lieu du mariage <span className="text-red-500">*</span></Label>
                        <Input
                          value={changementRegimeData.lieuMariage}
                          onChange={(e) => setChangementRegimeData({...changementRegimeData, lieuMariage: e.target.value})}
                          placeholder="Ville, pays..."
                        />
                      </div>
                    </div>

                    <div className="space-y-2">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="contratMariageInitial"
                          checked={changementRegimeData.contratMariageInitial}
                          onChange={(e) => setChangementRegimeData({...changementRegimeData, contratMariageInitial: e.target.checked})}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="contratMariageInitial">Existence d'un contrat de mariage initial (joindre copie si oui)</Label>
                      </div>
                    </div>

                    <div className="space-y-2">
                      <Label>Nouveau r√©gime matrimonial souhait√© <span className="text-red-500">*</span></Label>
                      <Select
                        value={changementRegimeData.nouveauRegimeSouhaite || undefined}
                        onValueChange={(value) => setChangementRegimeData({...changementRegimeData, nouveauRegimeSouhaite: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner le nouveau r√©gime..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="communaute_reduite">Communaut√© r√©duite aux acqu√™ts</SelectItem>
                          <SelectItem value="separation_biens">S√©paration de biens</SelectItem>
                          <SelectItem value="communaute_universelle">Communaut√© universelle</SelectItem>
                          <SelectItem value="participation_acquets">Participation aux acqu√™ts</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="space-y-2">
                      <Label>Date d'effet souhait√©e</Label>
                      <Input
                        type="date"
                        value={changementRegimeData.dateEffetSouhaitee}
                        onChange={(e) => setChangementRegimeData({...changementRegimeData, dateEffetSouhaitee: e.target.value})}
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Motif principal du changement <span className="text-red-500">*</span></Label>
                      <Select
                        value={changementRegimeData.motifChangement || undefined}
                        onValueChange={(value) => setChangementRegimeData({...changementRegimeData, motifChangement: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner le motif..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="protection_conjoint">Protection du conjoint</SelectItem>
                          <SelectItem value="activite_professionnelle">Activit√© professionnelle</SelectItem>
                          <SelectItem value="anticipation_successorale">Anticipation successorale</SelectItem>
                          <SelectItem value="simplification_patrimoniale">Simplification patrimoniale</SelectItem>
                          <SelectItem value="autre">Autre</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    {changementRegimeData.motifChangement === "autre" && (
                      <div className="space-y-2">
                        <Label>Pr√©ciser le motif</Label>
                        <Input
                          value={changementRegimeData.motifChangementAutre}
                          onChange={(e) => setChangementRegimeData({...changementRegimeData, motifChangementAutre: e.target.value})}
                          placeholder="Pr√©cisez le motif du changement..."
                        />
                      </div>
                    )}
                  </div>

                  {/* Section 1bis: Pr√©sence d'enfants */}
                  <div className="space-y-4 p-4 border rounded-lg bg-yellow-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">Pr√©sence d'enfants</h3>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="enfantsCommuns"
                            checked={changementRegimeData.presenceEnfants.enfantsCommuns}
                            onChange={(e) => setChangementRegimeData({
                              ...changementRegimeData,
                              presenceEnfants: {...changementRegimeData.presenceEnfants, enfantsCommuns: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="enfantsCommuns">Enfants communs</Label>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="enfantsAutreUnion"
                            checked={changementRegimeData.presenceEnfants.enfantsAutreUnion}
                            onChange={(e) => setChangementRegimeData({
                              ...changementRegimeData,
                              presenceEnfants: {...changementRegimeData.presenceEnfants, enfantsAutreUnion: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="enfantsAutreUnion">Enfants d'une autre union</Label>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="enfantsMineurs"
                            checked={changementRegimeData.presenceEnfants.enfantsMineurs}
                            onChange={(e) => setChangementRegimeData({
                              ...changementRegimeData,
                              presenceEnfants: {...changementRegimeData.presenceEnfants, enfantsMineurs: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="enfantsMineurs">Pr√©sence d'enfants mineurs</Label>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="enfantsMajeursInformes"
                            checked={changementRegimeData.presenceEnfants.enfantsMajeursInformes}
                            onChange={(e) => setChangementRegimeData({
                              ...changementRegimeData,
                              presenceEnfants: {...changementRegimeData.presenceEnfants, enfantsMajeursInformes: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="enfantsMajeursInformes">Enfants majeurs inform√©s</Label>
                        </div>
                      </div>
                    </div>

                    {changementRegimeData.presenceEnfants.enfantsCommuns && (
                      <div className="space-y-2">
                        <Label>Nombre d'enfants communs</Label>
                        <Input
                          type="number"
                          min="0"
                          value={changementRegimeData.presenceEnfants.nombreEnfantsCommuns}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            presenceEnfants: {...changementRegimeData.presenceEnfants, nombreEnfantsCommuns: e.target.value}
                          })}
                        />
                      </div>
                    )}

                    {changementRegimeData.presenceEnfants.enfantsAutreUnion && (
                      <div className="space-y-2">
                        <Label>Nombre d'enfants d'une autre union</Label>
                        <Input
                          type="number"
                          min="0"
                          value={changementRegimeData.presenceEnfants.nombreEnfantsAutreUnion}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            presenceEnfants: {...changementRegimeData.presenceEnfants, nombreEnfantsAutreUnion: e.target.value}
                          })}
                        />
                      </div>
                    )}
                  </div>

                  {/* Section 1ter: Opposition possible des tiers */}
                  <div className="space-y-4 p-4 border rounded-lg bg-red-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">Opposition possible des tiers</h3>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="creanciersConnus"
                            checked={changementRegimeData.oppositionTiers.creanciersConnus}
                            onChange={(e) => setChangementRegimeData({
                              ...changementRegimeData,
                              oppositionTiers: {...changementRegimeData.oppositionTiers, creanciersConnus: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="creanciersConnus">Cr√©anciers connus</Label>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="risqueOpposition"
                            checked={changementRegimeData.oppositionTiers.risqueOpposition}
                            onChange={(e) => setChangementRegimeData({
                              ...changementRegimeData,
                              oppositionTiers: {...changementRegimeData.oppositionTiers, risqueOpposition: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="risqueOpposition">Risque d'opposition identifi√©</Label>
                        </div>
                      </div>
                    </div>

                    {changementRegimeData.oppositionTiers.creanciersConnus && (
                      <div className="space-y-2">
                        <Label>D√©tails des cr√©anciers connus</Label>
                        <textarea
                          value={changementRegimeData.oppositionTiers.detailsCreanciers}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            oppositionTiers: {...changementRegimeData.oppositionTiers, detailsCreanciers: e.target.value}
                          })}
                          className="w-full min-h-[80px] p-2 border rounded-md"
                          placeholder="Liste des cr√©anciers et montants dus..."
                        />
                      </div>
                    )}

                    {changementRegimeData.oppositionTiers.risqueOpposition && (
                      <div className="space-y-2">
                        <Label>Nature du risque d'opposition</Label>
                        <textarea
                          value={changementRegimeData.oppositionTiers.natureRisque}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            oppositionTiers: {...changementRegimeData.oppositionTiers, natureRisque: e.target.value}
                          })}
                          className="w-full min-h-[80px] p-2 border rounded-md"
                          placeholder="Pr√©cisez la nature et les raisons du risque..."
                        />
                      </div>
                    )}
                  </div>

                  {/* Section 1quater: Liquidation du r√©gime matrimonial */}
                  <div className="space-y-4 p-4 border rounded-lg bg-orange-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">Liquidation du r√©gime matrimonial pr√©c√©dent</h3>
                    
                    <div className="space-y-2">
                      <Label>Liquidation n√©cessaire ? <span className="text-red-500">*</span></Label>
                      <Select
                        value={changementRegimeData.liquidationRegime.necessaire || undefined}
                        onValueChange={(value) => setChangementRegimeData({
                          ...changementRegimeData,
                          liquidationRegime: {...changementRegimeData.liquidationRegime, necessaire: value}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="oui">Oui - Liquidation n√©cessaire</SelectItem>
                          <SelectItem value="non">Non - Pas de liquidation</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    {changementRegimeData.liquidationRegime.necessaire === "non" && (
                      <div className="space-y-2">
                        <Label>Justification de l'absence de liquidation</Label>
                        <textarea
                          value={changementRegimeData.liquidationRegime.justificationAbsence}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            liquidationRegime: {...changementRegimeData.liquidationRegime, justificationAbsence: e.target.value}
                          })}
                          className="w-full min-h-[80px] p-2 border rounded-md"
                          placeholder="Expliquez pourquoi aucune liquidation n'est n√©cessaire..."
                        />
                      </div>
                    )}

                    {changementRegimeData.liquidationRegime.necessaire === "oui" && (
                      <>
                        <div className="space-y-2">
                          <Label>R√©partition des biens communs</Label>
                          <Select
                            value={changementRegimeData.liquidationRegime.repartitionBiens || undefined}
                            onValueChange={(value) => setChangementRegimeData({
                              ...changementRegimeData,
                              liquidationRegime: {...changementRegimeData.liquidationRegime, repartitionBiens: value}
                            })}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="50-50">50/50 (par moiti√©)</SelectItem>
                              <SelectItem value="autre">Autre r√©partition</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>

                        {changementRegimeData.liquidationRegime.repartitionBiens === "autre" && (
                          <div className="space-y-2">
                            <Label>Pr√©ciser la r√©partition</Label>
                            <Input
                              value={changementRegimeData.liquidationRegime.autreRepartition}
                              onChange={(e) => setChangementRegimeData({
                                ...changementRegimeData,
                                liquidationRegime: {...changementRegimeData.liquidationRegime, autreRepartition: e.target.value}
                              })}
                              placeholder="Ex: 60/40, ou selon accord..."
                            />
                          </div>
                        )}

                        <div className="space-y-2">
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="recompensesCreances"
                              checked={changementRegimeData.liquidationRegime.recompensesCreances}
                              onChange={(e) => setChangementRegimeData({
                                ...changementRegimeData,
                                liquidationRegime: {...changementRegimeData.liquidationRegime, recompensesCreances: e.target.checked}
                              })}
                              className="w-4 h-4"
                            />
                            <Label htmlFor="recompensesCreances">Existence de r√©compenses ou cr√©ances entre √©poux</Label>
                          </div>
                        </div>

                        {changementRegimeData.liquidationRegime.recompensesCreances && (
                          <div className="space-y-2">
                            <Label>D√©tails des r√©compenses / cr√©ances</Label>
                            <textarea
                              value={changementRegimeData.liquidationRegime.detailsRecompenses}
                              onChange={(e) => setChangementRegimeData({
                                ...changementRegimeData,
                                liquidationRegime: {...changementRegimeData.liquidationRegime, detailsRecompenses: e.target.value}
                              })}
                              className="w-full min-h-[100px] p-2 border rounded-md"
                              placeholder="Liste des r√©compenses dues par chaque √©poux, cr√©ances, montants..."
                            />
                          </div>
                        )}
                      </>
                    )}
                  </div>

                  {/* Section 1quinquies: Homologation judiciaire */}
                  <div className="space-y-4 p-4 border rounded-lg bg-purple-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">Homologation judiciaire</h3>
                    
                    <div className="space-y-2">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="homologationRequise"
                          checked={changementRegimeData.homologation.requise}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            homologation: {...changementRegimeData.homologation, requise: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="homologationRequise">Homologation judiciaire requise</Label>
                      </div>
                    </div>

                    {changementRegimeData.homologation.requise && (
                      <>
                        <div className="space-y-2">
                          <Label>Motif de l'homologation <span className="text-red-500">*</span></Label>
                          <Select
                            value={changementRegimeData.homologation.motif || undefined}
                            onValueChange={(value) => setChangementRegimeData({
                              ...changementRegimeData,
                              homologation: {...changementRegimeData.homologation, motif: value}
                            })}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner le motif..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="enfants_mineurs">Pr√©sence d'enfants mineurs</SelectItem>
                              <SelectItem value="opposition_tiers">Opposition d'un tiers</SelectItem>
                              <SelectItem value="protection_epoux">Protection d'un √©poux</SelectItem>
                              <SelectItem value="autre">Autre motif</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>

                        {changementRegimeData.homologation.motif === "autre" && (
                          <div className="space-y-2">
                            <Label>Pr√©ciser le motif</Label>
                            <textarea
                              value={changementRegimeData.homologation.autreMotif}
                              onChange={(e) => setChangementRegimeData({
                                ...changementRegimeData,
                                homologation: {...changementRegimeData.homologation, autreMotif: e.target.value}
                              })}
                              className="w-full min-h-[80px] p-2 border rounded-md"
                              placeholder="Pr√©cisez le motif de l'homologation judiciaire..."
                            />
                          </div>
                        )}

                        <div className="space-y-2">
                          <Label>Tribunal comp√©tent</Label>
                          <Input
                            value={changementRegimeData.homologation.tribunalCompetent}
                            onChange={(e) => setChangementRegimeData({
                              ...changementRegimeData,
                              homologation: {...changementRegimeData.homologation, tribunalCompetent: e.target.value}
                            })}
                            placeholder="Ex: TJ de Paris..."
                          />
                        </div>
                      </>
                    )}
                  </div>

                  {/* Section 1sexies: Clauses sp√©cifiques */}
                  <div className="space-y-4 p-4 border rounded-lg bg-indigo-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">Clauses sp√©cifiques √† pr√©voir</h3>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="clauseAttributionIntegrale"
                            checked={changementRegimeData.clausesSpecifiques.attributionIntegrale}
                            onChange={(e) => setChangementRegimeData({
                              ...changementRegimeData,
                              clausesSpecifiques: {...changementRegimeData.clausesSpecifiques, attributionIntegrale: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="clauseAttributionIntegrale">Clause d'attribution int√©grale</Label>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="clausePreciput"
                            checked={changementRegimeData.clausesSpecifiques.preciput}
                            onChange={(e) => setChangementRegimeData({
                              ...changementRegimeData,
                              clausesSpecifiques: {...changementRegimeData.clausesSpecifiques, preciput: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="clausePreciput">Clause de pr√©ciput</Label>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="exclusionBiens"
                            checked={changementRegimeData.clausesSpecifiques.exclusionBiens}
                            onChange={(e) => setChangementRegimeData({
                              ...changementRegimeData,
                              clausesSpecifiques: {...changementRegimeData.clausesSpecifiques, exclusionBiens: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="exclusionBiens">Exclusion de certains biens</Label>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="amenagements"
                            checked={changementRegimeData.clausesSpecifiques.amenagements}
                            onChange={(e) => setChangementRegimeData({
                              ...changementRegimeData,
                              clausesSpecifiques: {...changementRegimeData.clausesSpecifiques, amenagements: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="amenagements">Am√©nagements particuliers</Label>
                        </div>
                      </div>
                    </div>

                    {changementRegimeData.clausesSpecifiques.attributionIntegrale && (
                      <div className="space-y-2">
                        <Label>D√©tails de la clause d'attribution int√©grale</Label>
                        <textarea
                          value={changementRegimeData.clausesSpecifiques.detailsAttribution}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            clausesSpecifiques: {...changementRegimeData.clausesSpecifiques, detailsAttribution: e.target.value}
                          })}
                          className="w-full min-h-[80px] p-2 border rounded-md"
                          placeholder="Pr√©cisez les modalit√©s de l'attribution int√©grale..."
                        />
                      </div>
                    )}

                    {changementRegimeData.clausesSpecifiques.preciput && (
                      <div className="space-y-2">
                        <Label>D√©tails de la clause de pr√©ciput</Label>
                        <textarea
                          value={changementRegimeData.clausesSpecifiques.detailsPreciput}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            clausesSpecifiques: {...changementRegimeData.clausesSpecifiques, detailsPreciput: e.target.value}
                          })}
                          className="w-full min-h-[80px] p-2 border rounded-md"
                          placeholder="Biens concern√©s par le pr√©ciput..."
                        />
                      </div>
                    )}

                    {changementRegimeData.clausesSpecifiques.exclusionBiens && (
                      <div className="space-y-2">
                        <Label>Biens exclus du nouveau r√©gime</Label>
                        <textarea
                          value={changementRegimeData.clausesSpecifiques.biensExclus}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            clausesSpecifiques: {...changementRegimeData.clausesSpecifiques, biensExclus: e.target.value}
                          })}
                          className="w-full min-h-[80px] p-2 border rounded-md"
                          placeholder="Liste des biens √† exclure et raisons..."
                        />
                      </div>
                    )}

                    {changementRegimeData.clausesSpecifiques.amenagements && (
                      <div className="space-y-2">
                        <Label>Description des am√©nagements particuliers</Label>
                        <textarea
                          value={changementRegimeData.clausesSpecifiques.detailsAmenagements}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            clausesSpecifiques: {...changementRegimeData.clausesSpecifiques, detailsAmenagements: e.target.value}
                          })}
                          className="w-full min-h-[100px] p-2 border rounded-md"
                          placeholder="D√©crivez les am√©nagements particuliers souhait√©s..."
                        />
                      </div>
                    )}
                  </div>

                  {/* Section 2: √âpoux 1 */}
                  <div className="space-y-4 p-4 border rounded-lg bg-blue-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">Identit√© compl√®te de l'√©poux 1</h3>
                    
                    <div className="space-y-2">
                      <Label>S√©lectionner le client (√âpoux 1)</Label>
                      <Select
                        value={changementRegimeData.epoux1.clientId || undefined}
                        onValueChange={(value) => {
                          const client = clients.find(c => c.id === value);
                          if (client) {
                            setChangementRegimeData({
                              ...changementRegimeData,
                              epoux1: {
                                ...changementRegimeData.epoux1,
                                clientId: value,
                                nom: client.nom,
                                prenom: client.prenom,
                                dateNaissance: client.date_naissance || "",
                                lieuNaissance: client.lieu_naissance || "",
                                nationalite: client.nationalite || "",
                                adresse: client.adresse || "",
                                profession: client.profession || "",
                                telephone: client.telephone || "",
                                email: client.email || "",
                                typeIdentite: client.type_identite || "",
                                numeroIdentite: client.numero_identite || "",
                              }
                            });
                          }
                        }}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner un client..." /></SelectTrigger>
                        <SelectContent>
                          {clients.map((client) => (
                            <SelectItem key={client.id} value={client.id}>
                              {client.prenom} {client.nom}
                            </SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Nom <span className="text-red-500">*</span></Label>
                        <Input
                          value={changementRegimeData.epoux1.nom}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux1: {...changementRegimeData.epoux1, nom: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                        <Input
                          value={changementRegimeData.epoux1.prenom}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux1: {...changementRegimeData.epoux1, prenom: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Nom de naissance</Label>
                        <Input
                          value={changementRegimeData.epoux1.nomNaissance}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux1: {...changementRegimeData.epoux1, nomNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Date de naissance <span className="text-red-500">*</span></Label>
                        <Input
                          type="date"
                          value={changementRegimeData.epoux1.dateNaissance}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux1: {...changementRegimeData.epoux1, dateNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Lieu de naissance</Label>
                        <Input
                          value={changementRegimeData.epoux1.lieuNaissance}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux1: {...changementRegimeData.epoux1, lieuNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Nationalit√©</Label>
                        <Input
                          value={changementRegimeData.epoux1.nationalite}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux1: {...changementRegimeData.epoux1, nationalite: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Adresse actuelle</Label>
                        <Input
                          value={changementRegimeData.epoux1.adresse}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux1: {...changementRegimeData.epoux1, adresse: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Profession</Label>
                        <Input
                          value={changementRegimeData.epoux1.profession}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux1: {...changementRegimeData.epoux1, profession: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>T√©l√©phone</Label>
                        <Input
                          value={changementRegimeData.epoux1.telephone}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux1: {...changementRegimeData.epoux1, telephone: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Email</Label>
                        <Input
                          type="email"
                          value={changementRegimeData.epoux1.email}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux1: {...changementRegimeData.epoux1, email: e.target.value}
                          })}
                        />
                      </div>
                    </div>

                    <div className="space-y-2">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="epoux1Tutelle"
                          checked={changementRegimeData.epoux1.sousTutelleCuratelle}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux1: {...changementRegimeData.epoux1, sousTutelleCuratelle: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="epoux1Tutelle">Sous tutelle ou curatelle (joindre jugement si oui)</Label>
                      </div>
                    </div>
                  </div>

                  {/* Section 3: √âpoux 2 */}
                  <div className="space-y-4 p-4 border rounded-lg bg-purple-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">Identit√© compl√®te de l'√©poux 2</h3>
                    
                    <div className="space-y-2">
                      <Label>S√©lectionner le client (√âpoux 2)</Label>
                      <Select
                        value={changementRegimeData.epoux2.clientId || undefined}
                        onValueChange={(value) => {
                          const client = clients.find(c => c.id === value);
                          if (client) {
                            setChangementRegimeData({
                              ...changementRegimeData,
                              epoux2: {
                                ...changementRegimeData.epoux2,
                                clientId: value,
                                nom: client.nom,
                                prenom: client.prenom,
                                dateNaissance: client.date_naissance || "",
                                lieuNaissance: client.lieu_naissance || "",
                                nationalite: client.nationalite || "",
                                adresse: client.adresse || "",
                                profession: client.profession || "",
                                telephone: client.telephone || "",
                                email: client.email || "",
                                typeIdentite: client.type_identite || "",
                                numeroIdentite: client.numero_identite || "",
                              }
                            });
                          }
                        }}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner un client..." /></SelectTrigger>
                        <SelectContent>
                          {clients.map((client) => (
                            <SelectItem key={client.id} value={client.id}>
                              {client.prenom} {client.nom}
                            </SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Nom <span className="text-red-500">*</span></Label>
                        <Input
                          value={changementRegimeData.epoux2.nom}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux2: {...changementRegimeData.epoux2, nom: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                        <Input
                          value={changementRegimeData.epoux2.prenom}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux2: {...changementRegimeData.epoux2, prenom: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Nom de naissance</Label>
                        <Input
                          value={changementRegimeData.epoux2.nomNaissance}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux2: {...changementRegimeData.epoux2, nomNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Date de naissance <span className="text-red-500">*</span></Label>
                        <Input
                          type="date"
                          value={changementRegimeData.epoux2.dateNaissance}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux2: {...changementRegimeData.epoux2, dateNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Lieu de naissance</Label>
                        <Input
                          value={changementRegimeData.epoux2.lieuNaissance}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux2: {...changementRegimeData.epoux2, lieuNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Nationalit√©</Label>
                        <Input
                          value={changementRegimeData.epoux2.nationalite}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux2: {...changementRegimeData.epoux2, nationalite: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Adresse actuelle</Label>
                        <Input
                          value={changementRegimeData.epoux2.adresse}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux2: {...changementRegimeData.epoux2, adresse: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Profession</Label>
                        <Input
                          value={changementRegimeData.epoux2.profession}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux2: {...changementRegimeData.epoux2, profession: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>T√©l√©phone</Label>
                        <Input
                          value={changementRegimeData.epoux2.telephone}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux2: {...changementRegimeData.epoux2, telephone: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Email</Label>
                        <Input
                          type="email"
                          value={changementRegimeData.epoux2.email}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux2: {...changementRegimeData.epoux2, email: e.target.value}
                          })}
                        />
                      </div>
                    </div>

                    <div className="space-y-2">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="epoux2Tutelle"
                          checked={changementRegimeData.epoux2.sousTutelleCuratelle}
                          onChange={(e) => setChangementRegimeData({
                            ...changementRegimeData,
                            epoux2: {...changementRegimeData.epoux2, sousTutelleCuratelle: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="epoux2Tutelle">Sous tutelle ou curatelle (joindre jugement si oui)</Label>
                      </div>
                    </div>
                  </div>

                  {/* Section 4: Documents √† collecter */}
                  <div className="space-y-4 p-4 border rounded-lg bg-green-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">Pi√®ces justificatives √† collecter</h3>
                    
                    <div className="space-y-4">
                      <MultiFileUpload
                        label="Pi√®ce d'identit√© √©poux 1 (CNI, passeport)"
                        files={changementRegimeEpouxIdentite1}
                        onFilesChange={setChangementRegimeEpouxIdentite1}
                      />

                      <MultiFileUpload
                        label="Pi√®ce d'identit√© √©poux 2 (CNI, passeport)"
                        files={changementRegimeEpouxIdentite2}
                        onFilesChange={setChangementRegimeEpouxIdentite2}
                      />

                      <MultiFileUpload
                        label="Livret de famille"
                        files={changementRegimeLivretFamille}
                        onFilesChange={setChangementRegimeLivretFamille}
                      />

                      <MultiFileUpload
                        label="Acte de mariage"
                        files={changementRegimeActeMariage}
                        onFilesChange={setChangementRegimeActeMariage}
                      />

                      {changementRegimeData.contratMariageInitial && (
                        <MultiFileUpload
                          label="Contrat de mariage initial"
                          files={changementRegimeContratMariageInitial}
                          onFilesChange={setChangementRegimeContratMariageInitial}
                        />
                      )}

                      <MultiFileUpload
                        label="Titres de propri√©t√© (biens immobiliers)"
                        files={changementRegimeTitresPropriete}
                        onFilesChange={setChangementRegimeTitresPropriete}
                      />

                      <MultiFileUpload
                        label="Relev√©s de comptes bancaires"
                        files={changementRegimeRelevesComptes}
                        onFilesChange={setChangementRegimeRelevesComptes}
                      />

                      <MultiFileUpload
                        label="Statuts de soci√©t√©s / Pactes d'associ√©s"
                        files={changementRegimeStatutsSocietes}
                        onFilesChange={setChangementRegimeStatutsSocietes}
                      />

                      <MultiFileUpload
                        label="Actes de pr√™ts en cours"
                        files={changementRegimeActesPrets}
                        onFilesChange={setChangementRegimeActesPrets}
                      />

                      <MultiFileUpload
                        label="Valeurs estim√©es des biens"
                        files={changementRegimeEstimationsBiens}
                        onFilesChange={setChangementRegimeEstimationsBiens}
                      />

                      {(changementRegimeData.epoux1.sousTutelleCuratelle || changementRegimeData.epoux2.sousTutelleCuratelle) && (
                        <MultiFileUpload
                          label="Jugement de tutelle/curatelle"
                          files={changementRegimeJugementTutelle}
                          onFilesChange={setChangementRegimeJugementTutelle}
                        />
                      )}

                      <div className="p-3 bg-blue-50 border border-blue-200 rounded-lg mt-4">
                        <p className="text-sm text-blue-800">
                          üí° <strong>Astuce :</strong> Vous pouvez s√©lectionner plusieurs fichiers √† la fois pour chaque cat√©gorie. Les fichiers appara√Ætront sous le bouton et pourront √™tre supprim√©s individuellement.
                        </p>
                      </div>
                    </div>
                  </div>

                </div>
              </>
            )}

            {/* Formulaire D√©claration de Succession */}
            {pendingContractType === "D√©claration de succession" && (
              <>
                <div className="space-y-6 max-h-[calc(100vh-250px)] overflow-y-auto pr-2">
                  
                  {/* Section 1: Informations g√©n√©rales sur la succession */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">Informations g√©n√©rales sur la succession</h3>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Date du d√©c√®s <span className="text-red-500">*</span></Label>
                        <Input
                          type="date"
                          value={successionData.dateDeces}
                          onChange={(e) => setSuccessionData({...successionData, dateDeces: e.target.value})}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Lieu du d√©c√®s <span className="text-red-500">*</span></Label>
                        <Input
                          value={successionData.lieuDeces}
                          onChange={(e) => setSuccessionData({...successionData, lieuDeces: e.target.value})}
                          placeholder="Ville, pays..."
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Commune du dernier domicile <span className="text-red-500">*</span></Label>
                        <Input
                          value={successionData.communeDernierDomicile}
                          onChange={(e) => setSuccessionData({...successionData, communeDernierDomicile: e.target.value})}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Num√©ro d'acte de d√©c√®s</Label>
                        <Input
                          value={successionData.numeroActeDeces}
                          onChange={(e) => setSuccessionData({...successionData, numeroActeDeces: e.target.value})}
                        />
                      </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="decesEtranger"
                            checked={successionData.decesEtranger}
                            onChange={(e) => setSuccessionData({...successionData, decesEtranger: e.target.checked})}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="decesEtranger">D√©c√®s √† l'√©tranger (d√©lai 12 mois)</Label>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="declarationDans6Mois"
                            checked={successionData.declarationDans6Mois}
                            onChange={(e) => setSuccessionData({...successionData, declarationDans6Mois: e.target.checked})}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="declarationDans6Mois">D√©claration dans les 6 mois</Label>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Section 2: Identit√© compl√®te du d√©funt */}
                  <div className="space-y-4 p-4 border rounded-lg bg-gray-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">Identit√© compl√®te du d√©funt</h3>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Nom <span className="text-red-500">*</span></Label>
                        <Input
                          value={successionData.defunt.nom}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            defunt: {...successionData.defunt, nom: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                        <Input
                          value={successionData.defunt.prenom}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            defunt: {...successionData.defunt, prenom: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Nom de naissance</Label>
                        <Input
                          value={successionData.defunt.nomNaissance}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            defunt: {...successionData.defunt, nomNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Date de naissance <span className="text-red-500">*</span></Label>
                        <Input
                          type="date"
                          value={successionData.defunt.dateNaissance}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            defunt: {...successionData.defunt, dateNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Lieu de naissance</Label>
                        <Input
                          value={successionData.defunt.lieuNaissance}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            defunt: {...successionData.defunt, lieuNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Nationalit√©</Label>
                        <Input
                          value={successionData.defunt.nationalite}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            defunt: {...successionData.defunt, nationalite: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Profession</Label>
                        <Input
                          value={successionData.defunt.profession}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            defunt: {...successionData.defunt, profession: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Adresse compl√®te</Label>
                        <Input
                          value={successionData.defunt.adresse}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            defunt: {...successionData.defunt, adresse: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Situation matrimoniale <span className="text-red-500">*</span></Label>
                        <Select
                          value={successionData.defunt.situationMatrimoniale || undefined}
                          onValueChange={(value) => setSuccessionData({
                            ...successionData,
                            defunt: {...successionData.defunt, situationMatrimoniale: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="celibataire">C√©libataire</SelectItem>
                            <SelectItem value="marie">Mari√©</SelectItem>
                            <SelectItem value="divorce">Divorc√©</SelectItem>
                            <SelectItem value="veuf">Veuf</SelectItem>
                            <SelectItem value="pacse">PACS√©</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {(successionData.defunt.situationMatrimoniale === "marie" || successionData.defunt.situationMatrimoniale === "divorce") && (
                        <div className="space-y-2">
                          <Label>R√©gime matrimonial</Label>
                          <Select
                            value={successionData.defunt.regimeMatrimonial || undefined}
                            onValueChange={(value) => setSuccessionData({
                              ...successionData,
                              defunt: {...successionData.defunt, regimeMatrimonial: value}
                            })}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="communaute_legale">Communaut√© l√©gale</SelectItem>
                              <SelectItem value="separation_biens">S√©paration de biens</SelectItem>
                              <SelectItem value="participation_acquets">Participation aux acqu√™ts</SelectItem>
                              <SelectItem value="communaute_universelle">Communaut√© universelle</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                      )}
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="contratMariageExiste"
                            checked={successionData.defunt.contratMariageExiste}
                            onChange={(e) => setSuccessionData({
                              ...successionData,
                              defunt: {...successionData.defunt, contratMariageExiste: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="contratMariageExiste">Existence d'un contrat de mariage</Label>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="testamentExiste"
                            checked={successionData.defunt.testamentExiste}
                            onChange={(e) => setSuccessionData({
                              ...successionData,
                              defunt: {...successionData.defunt, testamentExiste: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="testamentExiste">Existence d'un testament</Label>
                        </div>
                      </div>

                      {successionData.defunt.testamentExiste && (
                        <div className="space-y-2 md:col-span-2">
                          <Label>Type de testament</Label>
                          <Select
                            value={successionData.defunt.typeTestament || undefined}
                            onValueChange={(value) => setSuccessionData({
                              ...successionData,
                              defunt: {...successionData.defunt, typeTestament: value}
                            })}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="olographe">Olographe</SelectItem>
                              <SelectItem value="authentique">Authentique</SelectItem>
                              <SelectItem value="mystique">Mystique</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                      )}

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="donationsAnterieuresExistent"
                            checked={successionData.defunt.donationsAnterieuresExistent}
                            onChange={(e) => setSuccessionData({
                              ...successionData,
                              defunt: {...successionData.defunt, donationsAnterieuresExistent: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="donationsAnterieuresExistent">Donations ant√©rieures</Label>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="mandatProtectionFuture"
                            checked={successionData.defunt.mandatProtectionFuture}
                            onChange={(e) => setSuccessionData({
                              ...successionData,
                              defunt: {...successionData.defunt, mandatProtectionFuture: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="mandatProtectionFuture">Mandat de protection future</Label>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="pacteSuccessoral"
                            checked={successionData.defunt.pacteSuccessoral}
                            onChange={(e) => setSuccessionData({
                              ...successionData,
                              defunt: {...successionData.defunt, pacteSuccessoral: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="pacteSuccessoral">Pacte successoral</Label>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Section 3: Pi√®ces justificatives essentielles */}
                  <div className="space-y-4 p-4 border rounded-lg bg-blue-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">Pi√®ces justificatives √† fournir</h3>
                    
                    <div className="space-y-4">
                      <MultiFileUpload
                        label="Acte de d√©c√®s"
                        files={successionActeDeces}
                        onFilesChange={setSuccessionActeDeces}
                        required
                      />

                      <MultiFileUpload
                        label="Livret de famille"
                        files={successionLivretFamille}
                        onFilesChange={setSuccessionLivretFamille}
                      />

                      {successionData.defunt.contratMariageExiste && (
                        <MultiFileUpload
                          label="Contrat de mariage"
                          files={successionContratMariage}
                          onFilesChange={setSuccessionContratMariage}
                        />
                      )}

                      {successionData.defunt.testamentExiste && (
                        <MultiFileUpload
                          label="Testament"
                          files={successionTestament}
                          onFilesChange={setSuccessionTestament}
                        />
                      )}

                      <MultiFileUpload
                        label="Titres de propri√©t√© (biens immobiliers)"
                        files={successionTitresPropriete}
                        onFilesChange={setSuccessionTitresPropriete}
                      />

                      <MultiFileUpload
                        label="Avis d'imposition / Relev√© fiscal IFI"
                        files={successionAvisImposition}
                        onFilesChange={setSuccessionAvisImposition}
                      />

                      <MultiFileUpload
                        label="Relev√©s bancaires / Comptes-titres"
                        files={successionRelevesBancaires}
                        onFilesChange={setSuccessionRelevesBancaires}
                      />

                      <MultiFileUpload
                        label="Contrats d'assurance-vie"
                        files={successionAssuranceVie}
                        onFilesChange={setSuccessionAssuranceVie}
                      />

                      <MultiFileUpload
                        label="Statuts de soci√©t√©s / Bilans"
                        files={successionStatutsSocietes}
                        onFilesChange={setSuccessionStatutsSocietes}
                      />

                      <MultiFileUpload
                        label="Justificatifs des dettes"
                        files={successionJustifsDettes}
                        onFilesChange={setSuccessionJustifsDettes}
                      />

                      <MultiFileUpload
                        label="Facture pompes fun√®bres"
                        files={successionFactureFuneraires}
                        onFilesChange={setSuccessionFactureFuneraires}
                      />
                    </div>

                    <div className="p-3 bg-orange-50 border border-orange-200 rounded-lg mt-4">
                      <p className="text-sm text-orange-800">
                        üí° <strong>Astuce :</strong> Vous pouvez s√©lectionner plusieurs fichiers √† la fois pour chaque cat√©gorie. Les fichiers appara√Ætront sous le bouton et pourront √™tre supprim√©s individuellement.
                      </p>
                    </div>
                  </div>

                  {/* Section 4: Informations sur les h√©ritiers */}
                  <div className="space-y-4 p-4 border rounded-lg bg-green-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">Informations sur les h√©ritiers</h3>
                    
                    <div className="space-y-4">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="conjointSurvivant"
                          checked={successionData.heritiers.conjointSurvivant}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            heritiers: {...successionData.heritiers, conjointSurvivant: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="conjointSurvivant">Conjoint survivant</Label>
                      </div>

                      {successionData.heritiers.conjointSurvivant && (
                        <div className="ml-6 p-4 border rounded bg-white space-y-3">
                          <h4 className="font-medium text-sm">Identit√© du conjoint survivant</h4>
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <Input
                              placeholder="Nom"
                              value={successionData.heritiers.conjointIdentite.nom}
                              onChange={(e) => setSuccessionData({
                                ...successionData,
                                heritiers: {
                                  ...successionData.heritiers,
                                  conjointIdentite: {...successionData.heritiers.conjointIdentite, nom: e.target.value}
                                }
                              })}
                            />
                            <Input
                              placeholder="Pr√©nom"
                              value={successionData.heritiers.conjointIdentite.prenom}
                              onChange={(e) => setSuccessionData({
                                ...successionData,
                                heritiers: {
                                  ...successionData.heritiers,
                                  conjointIdentite: {...successionData.heritiers.conjointIdentite, prenom: e.target.value}
                                }
                              })}
                            />
                            <Input
                              type="date"
                              placeholder="Date de naissance"
                              value={successionData.heritiers.conjointIdentite.dateNaissance}
                              onChange={(e) => setSuccessionData({
                                ...successionData,
                                heritiers: {
                                  ...successionData.heritiers,
                                  conjointIdentite: {...successionData.heritiers.conjointIdentite, dateNaissance: e.target.value}
                                }
                              })}
                            />
                            <Input
                              placeholder="T√©l√©phone"
                              value={successionData.heritiers.conjointIdentite.telephone}
                              onChange={(e) => setSuccessionData({
                                ...successionData,
                                heritiers: {
                                  ...successionData.heritiers,
                                  conjointIdentite: {...successionData.heritiers.conjointIdentite, telephone: e.target.value}
                                }
                              })}
                            />
                            <Input
                              placeholder="Email"
                              value={successionData.heritiers.conjointIdentite.email}
                              onChange={(e) => setSuccessionData({
                                ...successionData,
                                heritiers: {
                                  ...successionData.heritiers,
                                  conjointIdentite: {...successionData.heritiers.conjointIdentite, email: e.target.value}
                                }
                              })}
                            />
                            <Input
                              placeholder="Adresse compl√®te"
                              className="md:col-span-2"
                              value={successionData.heritiers.conjointIdentite.adresse}
                              onChange={(e) => setSuccessionData({
                                ...successionData,
                                heritiers: {
                                  ...successionData.heritiers,
                                  conjointIdentite: {...successionData.heritiers.conjointIdentite, adresse: e.target.value}
                                }
                              })}
                            />
                          </div>
                        </div>
                      )}

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="enfantsExistent"
                          checked={successionData.heritiers.enfantsExistent}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            heritiers: {...successionData.heritiers, enfantsExistent: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="enfantsExistent">Enfants</Label>
                      </div>

                      {successionData.heritiers.enfantsExistent && (
                        <div className="ml-6 space-y-3">
                          <Input
                            placeholder="Nombre d'enfants"
                            type="number"
                            value={successionData.heritiers.nombreEnfants}
                            onChange={(e) => setSuccessionData({
                              ...successionData,
                              heritiers: {...successionData.heritiers, nombreEnfants: e.target.value}
                            })}
                            className="w-32"
                          />
                          <p className="text-sm text-gray-600">Les identit√©s compl√®tes des enfants seront renseign√©es ult√©rieurement si n√©cessaire</p>
                        </div>
                      )}

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="autresHeritiersExistent"
                          checked={successionData.heritiers.autresHeritiersExistent}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            heritiers: {...successionData.heritiers, autresHeritiersExistent: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="autresHeritiersExistent">Autres h√©ritiers (parents, fr√®res/s≈ìurs, neveux/ni√®ces)</Label>
                      </div>

                      {successionData.heritiers.autresHeritiersExistent && (
                        <div className="ml-6">
                          <p className="text-sm text-gray-600">Les identit√©s et degr√©s de parent√© seront pr√©cis√©s ult√©rieurement</p>
                        </div>
                      )}

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="heritierMineurOuProtege"
                          checked={successionData.heritiers.heritierMineurOuProtege}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            heritiers: {...successionData.heritiers, heritierMineurOuProtege: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="heritierMineurOuProtege">H√©ritier(s) mineur(s) ou majeur prot√©g√©</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="renonciation"
                          checked={successionData.heritiers.renonciation}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            heritiers: {...successionData.heritiers, renonciation: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="renonciation">Existence d'un renon√ßant</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="acceptationConcurrenceActifNet"
                          checked={successionData.heritiers.acceptationConcurrenceActifNet}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            heritiers: {...successionData.heritiers, acceptationConcurrenceActifNet: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="acceptationConcurrenceActifNet">Acceptation √† concurrence de l'actif net</Label>
                      </div>
                    </div>
                  </div>

                  {/* Section 5: R√©gime matrimonial (liquidation) */}
                  <div className="space-y-4 p-4 border rounded-lg bg-purple-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">R√©gime matrimonial (liquidation)</h3>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>R√©gime matrimonial exact</Label>
                        <Select
                          value={successionData.regimeMatrimonialLiquidation.regimeExact}
                          onValueChange={(value) => setSuccessionData({
                            ...successionData,
                            regimeMatrimonialLiquidation: {...successionData.regimeMatrimonialLiquidation, regimeExact: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="communaute_legale">Communaut√© l√©gale</SelectItem>
                            <SelectItem value="separation_biens">S√©paration de biens</SelectItem>
                            <SelectItem value="communaute_universelle">Communaut√© universelle</SelectItem>
                            <SelectItem value="participation_acquets">Participation aux acqu√™ts</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="space-y-2">
                        <Label>Date de mariage</Label>
                        <Input
                          type="date"
                          value={successionData.regimeMatrimonialLiquidation.dateMariage}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            regimeMatrimonialLiquidation: {...successionData.regimeMatrimonialLiquidation, dateMariage: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Date d'effet du r√©gime / contrat</Label>
                        <Input
                          type="date"
                          value={successionData.regimeMatrimonialLiquidation.dateEffetRegime}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            regimeMatrimonialLiquidation: {...successionData.regimeMatrimonialLiquidation, dateEffetRegime: e.target.value}
                          })}
                        />
                      </div>
                    </div>

                    <div className="space-y-3">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="clausesParticulieres"
                          checked={successionData.regimeMatrimonialLiquidation.clausesParticulieres}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            regimeMatrimonialLiquidation: {...successionData.regimeMatrimonialLiquidation, clausesParticulieres: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="clausesParticulieres">Clauses particuli√®res</Label>
                      </div>

                      {successionData.regimeMatrimonialLiquidation.clausesParticulieres && (
                        <div className="ml-6 space-y-3">
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="preciput"
                              checked={successionData.regimeMatrimonialLiquidation.preciput}
                              onChange={(e) => setSuccessionData({
                                ...successionData,
                                regimeMatrimonialLiquidation: {...successionData.regimeMatrimonialLiquidation, preciput: e.target.checked}
                              })}
                              className="w-4 h-4"
                            />
                            <Label htmlFor="preciput">Pr√©ciput</Label>
                          </div>

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="attributionIntegrale"
                              checked={successionData.regimeMatrimonialLiquidation.attributionIntegrale}
                              onChange={(e) => setSuccessionData({
                                ...successionData,
                                regimeMatrimonialLiquidation: {...successionData.regimeMatrimonialLiquidation, attributionIntegrale: e.target.checked}
                              })}
                              className="w-4 h-4"
                            />
                            <Label htmlFor="attributionIntegrale">Attribution int√©grale</Label>
                          </div>

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="avantagesMatrimoniaux"
                              checked={successionData.regimeMatrimonialLiquidation.avantagesMatrimoniaux}
                              onChange={(e) => setSuccessionData({
                                ...successionData,
                                regimeMatrimonialLiquidation: {...successionData.regimeMatrimonialLiquidation, avantagesMatrimoniaux: e.target.checked}
                              })}
                              className="w-4 h-4"
                            />
                            <Label htmlFor="avantagesMatrimoniaux">Avantages matrimoniaux</Label>
                          </div>

                          <Input
                            placeholder="D√©tails des clauses particuli√®res"
                            value={successionData.regimeMatrimonialLiquidation.detailsClausesParticulieres}
                            onChange={(e) => setSuccessionData({
                              ...successionData,
                              regimeMatrimonialLiquidation: {...successionData.regimeMatrimonialLiquidation, detailsClausesParticulieres: e.target.value}
                            })}
                          />
                        </div>
                      )}

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="precedenteLiquidation"
                          checked={successionData.regimeMatrimonialLiquidation.precedenteLiquidation}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            regimeMatrimonialLiquidation: {...successionData.regimeMatrimonialLiquidation, precedenteLiquidation: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="precedenteLiquidation">Existence d'une pr√©c√©dente liquidation</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="changementRegime"
                          checked={successionData.regimeMatrimonialLiquidation.changementRegime}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            regimeMatrimonialLiquidation: {...successionData.regimeMatrimonialLiquidation, changementRegime: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="changementRegime">Changement de r√©gime ant√©rieur</Label>
                      </div>
                    </div>
                  </div>

                  {/* Section 6: Fiscalit√© / R√©sidence / D√©lais */}
                  <div className="space-y-4 p-4 border rounded-lg bg-yellow-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">Fiscalit√© / R√©sidence / D√©lais</h3>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>R√©sidence fiscale du d√©funt</Label>
                        <Select
                          value={successionData.fiscaliteResidence.residenceFiscale}
                          onValueChange={(value) => setSuccessionData({
                            ...successionData,
                            fiscaliteResidence: {...successionData.fiscaliteResidence, residenceFiscale: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="France">France</SelectItem>
                            <SelectItem value="Autre">Autre pays</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {successionData.fiscaliteResidence.residenceFiscale === "Autre" && (
                        <div className="space-y-2">
                          <Label>Pays de r√©sidence</Label>
                          <Input
                            value={successionData.fiscaliteResidence.autrePays}
                            onChange={(e) => setSuccessionData({
                              ...successionData,
                              fiscaliteResidence: {...successionData.fiscaliteResidence, autrePays: e.target.value}
                            })}
                          />
                        </div>
                      )}

                      {successionData.decesEtranger && (
                        <div className="space-y-2 md:col-span-2">
                          <Label>Pays du d√©c√®s (si √† l'√©tranger)</Label>
                          <Input
                            value={successionData.fiscaliteResidence.decesEtrangerPays}
                            onChange={(e) => setSuccessionData({
                              ...successionData,
                              fiscaliteResidence: {...successionData.fiscaliteResidence, decesEtrangerPays: e.target.value}
                            })}
                          />
                        </div>
                      )}

                      <div className="space-y-2 md:col-span-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="existenceIFI"
                            checked={successionData.fiscaliteResidence.existenceIFI}
                            onChange={(e) => setSuccessionData({
                              ...successionData,
                              fiscaliteResidence: {...successionData.fiscaliteResidence, existenceIFI: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="existenceIFI">Existence d'un IFI (Imp√¥t sur la Fortune Immobili√®re)</Label>
                        </div>

                        {successionData.fiscaliteResidence.existenceIFI && (
                          <Input
                            placeholder="D√©tails IFI"
                            value={successionData.fiscaliteResidence.detailsIFI}
                            onChange={(e) => setSuccessionData({
                              ...successionData,
                              fiscaliteResidence: {...successionData.fiscaliteResidence, detailsIFI: e.target.value}
                            })}
                            className="ml-6"
                          />
                        )}
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Coordonn√©es du Service des Imp√¥ts (SIP) - Facultatif</Label>
                        <Input
                          value={successionData.fiscaliteResidence.sipCoordonnees}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            fiscaliteResidence: {...successionData.fiscaliteResidence, sipCoordonnees: e.target.value}
                          })}
                          placeholder="Adresse, t√©l√©phone..."
                        />
                      </div>
                    </div>
                  </div>

                  {/* Section 7: Mandats / Repr√©sentation */}
                  <div className="space-y-4 p-4 border rounded-lg bg-indigo-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">Mandats / Repr√©sentation</h3>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>H√©ritier r√©f√©rent (personne qui mandate le notaire)</Label>
                        <Input
                          value={successionData.mandatsRepresentation.heritierReferentNom}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            mandatsRepresentation: {...successionData.mandatsRepresentation, heritierReferentNom: e.target.value}
                          })}
                          placeholder="Nom et pr√©nom"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>R√¥le</Label>
                        <Input
                          value={successionData.mandatsRepresentation.heritierReferentRole}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            mandatsRepresentation: {...successionData.mandatsRepresentation, heritierReferentRole: e.target.value}
                          })}
                          placeholder="Conjoint, enfant..."
                        />
                      </div>
                    </div>

                    <div className="space-y-3">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="procurationsExistent"
                          checked={successionData.mandatsRepresentation.procurationsExistent}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            mandatsRepresentation: {...successionData.mandatsRepresentation, procurationsExistent: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="procurationsExistent">Procurations existantes</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="executeurTestamentaire"
                          checked={successionData.mandatsRepresentation.executeurTestamentaire}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            mandatsRepresentation: {...successionData.mandatsRepresentation, executeurTestamentaire: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="executeurTestamentaire">Ex√©cuteur testamentaire</Label>
                      </div>

                      {successionData.mandatsRepresentation.executeurTestamentaire && (
                        <Input
                          placeholder="Identit√© de l'ex√©cuteur testamentaire"
                          value={successionData.mandatsRepresentation.executeurIdentite}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            mandatsRepresentation: {...successionData.mandatsRepresentation, executeurIdentite: e.target.value}
                          })}
                          className="ml-6"
                        />
                      )}
                    </div>
                  </div>

                  {/* Section 8: Points juridiques sensibles */}
                  <div className="space-y-4 p-4 border rounded-lg bg-red-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">Points juridiques sensibles</h3>
                    
                    <div className="space-y-3">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="successionInternationale"
                          checked={successionData.pointsJuridiquesSensibles.successionInternationale}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            pointsJuridiquesSensibles: {...successionData.pointsJuridiquesSensibles, successionInternationale: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="successionInternationale">Succession internationale (biens/h√©ritiers √† l'√©tranger)</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="indivisionConflictuelle"
                          checked={successionData.pointsJuridiquesSensibles.indivisionConflictuelle}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            pointsJuridiquesSensibles: {...successionData.pointsJuridiquesSensibles, indivisionConflictuelle: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="indivisionConflictuelle">Indivision conflictuelle / contentieux pr√©visible</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="heritierIntrouvable"
                          checked={successionData.pointsJuridiquesSensibles.heritierIntrouvable}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            pointsJuridiquesSensibles: {...successionData.pointsJuridiquesSensibles, heritierIntrouvable: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="heritierIntrouvable">Pr√©sence d'un h√©ritier introuvable</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="acceptationBeneficeInventaire"
                          checked={successionData.pointsJuridiquesSensibles.acceptationBeneficeInventaire}
                          onChange={(e) => setSuccessionData({
                            ...successionData,
                            pointsJuridiquesSensibles: {...successionData.pointsJuridiquesSensibles, acceptationBeneficeInventaire: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="acceptationBeneficeInventaire">Acceptation sous b√©n√©fice d'inventaire envisag√©e</Label>
                      </div>
                    </div>
                  </div>

                  <div className="p-3 bg-blue-50 border border-blue-200 rounded-lg">
                    <p className="text-sm text-blue-800">
                      ‚ÑπÔ∏è <strong>Note :</strong> Les sections d√©taill√©es sur les donations ant√©rieures, le patrimoine immobilier complet, les comptes bancaires, les assurances-vie, les entreprises, les v√©hicules, et le passif d√©taill√© seront compl√©t√©es par le notaire lors de l'instruction du dossier avec l'ensemble des pi√®ces justificatives.
                    </p>
                  </div>

                </div>
              </>
            )}

            {pendingContractType === "Acte de notori√©t√©" && (
              <>
                <div className="space-y-6 max-h-[calc(100vh-250px)] overflow-y-auto pr-2">
                  
                  {/* Section 1: Type d'acte */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">1. Type d'acte de notori√©t√©</h3>
                    <div className="space-y-3">
                      <div className="flex items-center space-x-3">
                        <input
                          type="radio"
                          id="typeSuccession"
                          name="typeActe"
                          value="succession"
                          checked={acteNotorieteData.typeActe === "succession"}
                          onChange={(e) => setActeNotorieteData({...acteNotorieteData, typeActe: e.target.value})}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="typeSuccession">Acte de notori√©t√© pour succession (√©tablir la d√©volution successorale)</Label>
                      </div>
                      <div className="flex items-center space-x-3">
                        <input
                          type="radio"
                          id="typeFiliation"
                          name="typeActe"
                          value="filiation"
                          checked={acteNotorieteData.typeActe === "filiation"}
                          onChange={(e) => setActeNotorieteData({...acteNotorieteData, typeActe: e.target.value})}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="typeFiliation">Acte de notori√©t√© pour √©tablir une filiation</Label>
                      </div>
                      <div className="flex items-center space-x-3">
                        <input
                          type="radio"
                          id="typeReconstitution"
                          name="typeActe"
                          value="reconstitution"
                          checked={acteNotorieteData.typeActe === "reconstitution"}
                          onChange={(e) => setActeNotorieteData({...acteNotorieteData, typeActe: e.target.value})}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="typeReconstitution">Acte de notori√©t√© pour reconstitution d'acte d'√©tat civil</Label>
                      </div>
                      <div className="flex items-center space-x-3">
                        <input
                          type="radio"
                          id="typeQualite"
                          name="typeActe"
                          value="qualiteHereditaire"
                          checked={acteNotorieteData.typeActe === "qualiteHereditaire"}
                          onChange={(e) => setActeNotorieteData({...acteNotorieteData, typeActe: e.target.value})}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="typeQualite">Acte de notori√©t√© pour constater la qualit√© d'h√©ritier</Label>
                      </div>
                    </div>
                  </div>

                  {/* Section 2: Informations sur le d√©funt */}
                  {(acteNotorieteData.typeActe === "succession" || acteNotorieteData.typeActe === "qualiteHereditaire") && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">2. Informations sur le d√©funt</h3>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                          <Label htmlFor="defuntNom">Nom</Label>
                          <Input
                            id="defuntNom"
                            value={acteNotorieteData.defunt.nom}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              defunt: {...acteNotorieteData.defunt, nom: e.target.value}
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="defuntPrenom">Pr√©nom(s)</Label>
                          <Input
                            id="defuntPrenom"
                            value={acteNotorieteData.defunt.prenom}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              defunt: {...acteNotorieteData.defunt, prenom: e.target.value}
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="defuntDateNaissance">Date de naissance</Label>
                          <Input
                            id="defuntDateNaissance"
                            type="date"
                            value={acteNotorieteData.defunt.dateNaissance}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              defunt: {...acteNotorieteData.defunt, dateNaissance: e.target.value}
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="defuntLieuNaissance">Lieu de naissance</Label>
                          <Input
                            id="defuntLieuNaissance"
                            value={acteNotorieteData.defunt.lieuNaissance}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              defunt: {...acteNotorieteData.defunt, lieuNaissance: e.target.value}
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="defuntDateDeces">Date de d√©c√®s</Label>
                          <Input
                            id="defuntDateDeces"
                            type="date"
                            value={acteNotorieteData.defunt.dateDeces}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              defunt: {...acteNotorieteData.defunt, dateDeces: e.target.value}
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="defuntLieuDeces">Lieu de d√©c√®s</Label>
                          <Input
                            id="defuntLieuDeces"
                            value={acteNotorieteData.defunt.lieuDeces}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              defunt: {...acteNotorieteData.defunt, lieuDeces: e.target.value}
                            })}
                          />
                        </div>
                        <div className="md:col-span-2">
                          <Label htmlFor="defuntDernierDomicile">Dernier domicile</Label>
                          <Input
                            id="defuntDernierDomicile"
                            value={acteNotorieteData.defunt.dernierDomicile}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              defunt: {...acteNotorieteData.defunt, dernierDomicile: e.target.value}
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="defuntNationalite">Nationalit√©</Label>
                          <Input
                            id="defuntNationalite"
                            value={acteNotorieteData.defunt.nationalite}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              defunt: {...acteNotorieteData.defunt, nationalite: e.target.value}
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="defuntProfession">Profession</Label>
                          <Input
                            id="defuntProfession"
                            value={acteNotorieteData.defunt.profession}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              defunt: {...acteNotorieteData.defunt, profession: e.target.value}
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="defuntSituationMatrimoniale">Situation matrimoniale</Label>
                          <select
                            id="defuntSituationMatrimoniale"
                            value={acteNotorieteData.defunt.situationMatrimoniale}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              defunt: {...acteNotorieteData.defunt, situationMatrimoniale: e.target.value}
                            })}
                            className="w-full px-3 py-2 border rounded-md"
                          >
                            <option value="">-- S√©lectionner --</option>
                            <option value="celibataire">C√©libataire</option>
                            <option value="marie">Mari√©(e)</option>
                            <option value="pacse">Pacs√©(e)</option>
                            <option value="divorce">Divorc√©(e)</option>
                            <option value="veuf">Veuf/Veuve</option>
                          </select>
                        </div>
                        {(acteNotorieteData.defunt.situationMatrimoniale === "marie" || acteNotorieteData.defunt.situationMatrimoniale === "veuf") && (
                          <>
                            <div>
                              <Label htmlFor="defuntDateMariage">Date de mariage</Label>
                              <Input
                                id="defuntDateMariage"
                                type="date"
                                value={acteNotorieteData.defunt.dateMariage}
                                onChange={(e) => setActeNotorieteData({
                                  ...acteNotorieteData,
                                  defunt: {...acteNotorieteData.defunt, dateMariage: e.target.value}
                                })}
                              />
                            </div>
                            <div>
                              <Label htmlFor="defuntRegimeMatrimonial">R√©gime matrimonial</Label>
                              <Input
                                id="defuntRegimeMatrimonial"
                                value={acteNotorieteData.defunt.regimeMatrimonial}
                                onChange={(e) => setActeNotorieteData({
                                  ...acteNotorieteData,
                                  defunt: {...acteNotorieteData.defunt, regimeMatrimonial: e.target.value}
                                })}
                              />
                            </div>
                          </>
                        )}
                      </div>
                      
                      <div className="space-y-3 mt-4">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="defuntTestamentExiste"
                            checked={acteNotorieteData.defunt.testamentExiste}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              defunt: {...acteNotorieteData.defunt, testamentExiste: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="defuntTestamentExiste">Testament existant</Label>
                        </div>

                        {acteNotorieteData.defunt.testamentExiste && (
                          <div>
                            <Label htmlFor="defuntTestamentDetails">D√©tails du testament</Label>
                            <Textarea
                              id="defuntTestamentDetails"
                              value={acteNotorieteData.defunt.testamentDetails}
                              onChange={(e) => setActeNotorieteData({
                                ...acteNotorieteData,
                                defunt: {...acteNotorieteData.defunt, testamentDetails: e.target.value}
                              })}
                              rows={3}
                            />
                          </div>
                        )}

                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="defuntDonationsAnterieures"
                            checked={acteNotorieteData.defunt.donationsAnterieures}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              defunt: {...acteNotorieteData.defunt, donationsAnterieures: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="defuntDonationsAnterieures">Donations ant√©rieures</Label>
                        </div>

                        {acteNotorieteData.defunt.donationsAnterieures && (
                          <div>
                            <Label htmlFor="defuntDonationsDetails">D√©tails des donations</Label>
                            <Textarea
                              id="defuntDonationsDetails"
                              value={acteNotorieteData.defunt.donationsDetails}
                              onChange={(e) => setActeNotorieteData({
                                ...acteNotorieteData,
                                defunt: {...acteNotorieteData.defunt, donationsDetails: e.target.value}
                              })}
                              rows={3}
                            />
                          </div>
                        )}
                      </div>
                    </div>
                  )}

                  {/* Section 3: H√©ritiers */}
                  {(acteNotorieteData.typeActe === "succession" || acteNotorieteData.typeActe === "qualiteHereditaire") && (
                    <div className="space-y-4">
                      <div className="flex justify-between items-center">
                        <h3 className="font-semibold text-lg border-b pb-2 flex-1">3. H√©ritiers</h3>
                        <Button
                          type="button"
                          variant="outline"
                          size="sm"
                          onClick={() => {
                            const newId = Date.now();
                            setActeNotorieteData({
                              ...acteNotorieteData,
                              heritiers: [...acteNotorieteData.heritiers, {
                                id: newId,
                                clientId: "",
                                nom: "", prenom: "", dateNaissance: "", lieuNaissance: "",
                                adresse: "", nationalite: "", profession: "",
                                lienParente: "", degre: "", branche: "",
                                representantDe: "", representeQui: "",
                                majeurOuMineur: "majeur", regime: "",
                                optionSuccessorale: "acceptePurSimple"
                              }]
                            });
                            setActeNotorieteHeritierFiles({
                              ...acteNotorieteHeritierFiles,
                              [newId]: []
                            });
                          }}
                          className="ml-2"
                        >
                          + Ajouter un h√©ritier
                        </Button>
                      </div>

                      {acteNotorieteData.heritiers.map((heritier, index) => (
                        <div key={heritier.id} className="p-4 border rounded-lg space-y-4 bg-gray-50">
                          <div className="flex justify-between items-center">
                            <h4 className="font-medium">H√©ritier {index + 1}</h4>
                            <Button
                              type="button"
                              variant="destructive"
                              size="sm"
                              onClick={() => {
                                const newHeritiers = acteNotorieteData.heritiers.filter(h => h.id !== heritier.id);
                                setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                                const newFiles = {...acteNotorieteHeritierFiles};
                                delete newFiles[heritier.id];
                                setActeNotorieteHeritierFiles(newFiles);
                              }}
                            >
                              Supprimer
                            </Button>
                          </div>

                          {/* S√©lection client ou saisie manuelle */}
                          <div className="mb-4">
                            <Label htmlFor={`heritier_client_${heritier.id}`}>Choisir un client existant (optionnel)</Label>
                            <select
                              id={`heritier_client_${heritier.id}`}
                              value={heritier.clientId || ""}
                              onChange={(e) => {
                                const clientId = e.target.value;
                                const newHeritiers = [...acteNotorieteData.heritiers];
                                
                                if (clientId) {
                                  const selectedClient = clients.find(c => c.id === clientId);
                                  if (selectedClient) {
                                    newHeritiers[index] = {
                                      ...heritier,
                                      clientId: clientId,
                                      nom: selectedClient.nom || "",
                                      prenom: selectedClient.prenom || "",
                                      dateNaissance: selectedClient.date_naissance || "",
                                      lieuNaissance: selectedClient.lieu_naissance || "",
                                      adresse: selectedClient.adresse || "",
                                      nationalite: selectedClient.nationalite || "",
                                      profession: selectedClient.profession || "",
                                    };
                                  }
                                } else {
                                  newHeritiers[index] = {...heritier, clientId: ""};
                                }
                                
                                setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                              }}
                              className="w-full px-3 py-2 border rounded-md"
                            >
                              <option value="">-- Saisie manuelle --</option>
                              {clients.map((client) => (
                                <option key={client.id} value={client.id}>
                                  {client.prenom} {client.nom}
                                </option>
                              ))}
                            </select>
                          </div>

                          {/* Informations civiles */}
                          <div>
                            <h5 className="font-medium text-sm mb-2">Informations civiles</h5>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                              <div>
                                <Label htmlFor={`heritier_nom_${heritier.id}`}>Nom</Label>
                                <Input
                                  id={`heritier_nom_${heritier.id}`}
                                  value={heritier.nom}
                                  onChange={(e) => {
                                    const newHeritiers = [...acteNotorieteData.heritiers];
                                    newHeritiers[index] = {...heritier, nom: e.target.value};
                                    setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                                  }}
                                />
                              </div>
                              <div>
                                <Label htmlFor={`heritier_prenom_${heritier.id}`}>Pr√©nom(s)</Label>
                                <Input
                                  id={`heritier_prenom_${heritier.id}`}
                                  value={heritier.prenom}
                                  onChange={(e) => {
                                    const newHeritiers = [...acteNotorieteData.heritiers];
                                    newHeritiers[index] = {...heritier, prenom: e.target.value};
                                    setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                                  }}
                                />
                              </div>
                              <div>
                                <Label htmlFor={`heritier_dateNaissance_${heritier.id}`}>Date de naissance</Label>
                                <Input
                                  id={`heritier_dateNaissance_${heritier.id}`}
                                  type="date"
                                  value={heritier.dateNaissance}
                                  onChange={(e) => {
                                    const newHeritiers = [...acteNotorieteData.heritiers];
                                    newHeritiers[index] = {...heritier, dateNaissance: e.target.value};
                                    setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                                  }}
                                />
                              </div>
                              <div>
                                <Label htmlFor={`heritier_lieuNaissance_${heritier.id}`}>Lieu de naissance</Label>
                                <Input
                                  id={`heritier_lieuNaissance_${heritier.id}`}
                                  value={heritier.lieuNaissance}
                                  onChange={(e) => {
                                    const newHeritiers = [...acteNotorieteData.heritiers];
                                    newHeritiers[index] = {...heritier, lieuNaissance: e.target.value};
                                    setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                                  }}
                                />
                              </div>
                              <div className="md:col-span-2">
                                <Label htmlFor={`heritier_adresse_${heritier.id}`}>Adresse</Label>
                                <Input
                                  id={`heritier_adresse_${heritier.id}`}
                                  value={heritier.adresse}
                                  onChange={(e) => {
                                    const newHeritiers = [...acteNotorieteData.heritiers];
                                    newHeritiers[index] = {...heritier, adresse: e.target.value};
                                    setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                                  }}
                                />
                              </div>
                              <div>
                                <Label htmlFor={`heritier_nationalite_${heritier.id}`}>Nationalit√©</Label>
                                <Input
                                  id={`heritier_nationalite_${heritier.id}`}
                                  value={heritier.nationalite}
                                  onChange={(e) => {
                                    const newHeritiers = [...acteNotorieteData.heritiers];
                                    newHeritiers[index] = {...heritier, nationalite: e.target.value};
                                    setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                                  }}
                                />
                              </div>
                              <div>
                                <Label htmlFor={`heritier_profession_${heritier.id}`}>Profession</Label>
                                <Input
                                  id={`heritier_profession_${heritier.id}`}
                                  value={heritier.profession}
                                  onChange={(e) => {
                                    const newHeritiers = [...acteNotorieteData.heritiers];
                                    newHeritiers[index] = {...heritier, profession: e.target.value};
                                    setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                                  }}
                                />
                              </div>
                            </div>
                          </div>

                          {/* Lien de parent√© */}
                          <div>
                            <h5 className="font-medium text-sm mb-2">Lien de parent√©</h5>
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
                              <div>
                                <Label htmlFor={`heritier_lienParente_${heritier.id}`}>Lien</Label>
                                <Input
                                  id={`heritier_lienParente_${heritier.id}`}
                                  value={heritier.lienParente}
                                  onChange={(e) => {
                                    const newHeritiers = [...acteNotorieteData.heritiers];
                                    newHeritiers[index] = {...heritier, lienParente: e.target.value};
                                    setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                                  }}
                                  placeholder="Ex: Fils, Fille, Conjoint..."
                                />
                              </div>
                              <div>
                                <Label htmlFor={`heritier_degre_${heritier.id}`}>Degr√©</Label>
                                <Input
                                  id={`heritier_degre_${heritier.id}`}
                                  value={heritier.degre}
                                  onChange={(e) => {
                                    const newHeritiers = [...acteNotorieteData.heritiers];
                                    newHeritiers[index] = {...heritier, degre: e.target.value};
                                    setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                                  }}
                                  placeholder="1er, 2e..."
                                />
                              </div>
                              <div>
                                <Label htmlFor={`heritier_branche_${heritier.id}`}>Branche</Label>
                                <Input
                                  id={`heritier_branche_${heritier.id}`}
                                  value={heritier.branche}
                                  onChange={(e) => {
                                    const newHeritiers = [...acteNotorieteData.heritiers];
                                    newHeritiers[index] = {...heritier, branche: e.target.value};
                                    setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                                  }}
                                  placeholder="Paternelle, Maternelle..."
                                />
                              </div>
                            </div>
                          </div>

                          {/* Repr√©sentation */}
                          <div>
                            <h5 className="font-medium text-sm mb-2">Repr√©sentation (si applicable)</h5>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                              <div>
                                <Label htmlFor={`heritier_representantDe_${heritier.id}`}>Repr√©sentant de</Label>
                                <Input
                                  id={`heritier_representantDe_${heritier.id}`}
                                  value={heritier.representantDe}
                                  onChange={(e) => {
                                    const newHeritiers = [...acteNotorieteData.heritiers];
                                    newHeritiers[index] = {...heritier, representantDe: e.target.value};
                                    setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                                  }}
                                  placeholder="Nom du repr√©sent√©"
                                />
                              </div>
                              <div>
                                <Label htmlFor={`heritier_representeQui_${heritier.id}`}>Repr√©sente qui</Label>
                                <Input
                                  id={`heritier_representeQui_${heritier.id}`}
                                  value={heritier.representeQui}
                                  onChange={(e) => {
                                    const newHeritiers = [...acteNotorieteData.heritiers];
                                    newHeritiers[index] = {...heritier, representeQui: e.target.value};
                                    setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                                  }}
                                  placeholder="Lien avec le repr√©sent√©"
                                />
                              </div>
                            </div>
                          </div>

                          {/* Capacit√© */}
                          <div>
                            <h5 className="font-medium text-sm mb-2">Capacit√©</h5>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                              <div>
                                <Label htmlFor={`heritier_majeurOuMineur_${heritier.id}`}>Statut</Label>
                                <select
                                  id={`heritier_majeurOuMineur_${heritier.id}`}
                                  value={heritier.majeurOuMineur}
                                  onChange={(e) => {
                                    const newHeritiers = [...acteNotorieteData.heritiers];
                                    newHeritiers[index] = {...heritier, majeurOuMineur: e.target.value};
                                    setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                                  }}
                                  className="w-full px-3 py-2 border rounded-md"
                                >
                                  <option value="majeur">Majeur</option>
                                  <option value="mineur">Mineur</option>
                                  <option value="protege">Majeur prot√©g√©</option>
                                </select>
                              </div>
                              {heritier.majeurOuMineur !== "majeur" && (
                                <div>
                                  <Label htmlFor={`heritier_regime_${heritier.id}`}>R√©gime de protection</Label>
                                  <Input
                                    id={`heritier_regime_${heritier.id}`}
                                    value={heritier.regime}
                                    onChange={(e) => {
                                      const newHeritiers = [...acteNotorieteData.heritiers];
                                      newHeritiers[index] = {...heritier, regime: e.target.value};
                                      setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                                    }}
                                    placeholder="Tutelle, curatelle..."
                                  />
                                </div>
                              )}
                            </div>
                          </div>

                          {/* Option successorale */}
                          <div>
                            <h5 className="font-medium text-sm mb-2">Option successorale</h5>
                            <select
                              id={`heritier_option_${heritier.id}`}
                              value={heritier.optionSuccessorale}
                              onChange={(e) => {
                                const newHeritiers = [...acteNotorieteData.heritiers];
                                newHeritiers[index] = {...heritier, optionSuccessorale: e.target.value};
                                setActeNotorieteData({...acteNotorieteData, heritiers: newHeritiers});
                              }}
                              className="w-full px-3 py-2 border rounded-md"
                            >
                              <option value="acceptePurSimple">Accepte pur et simple</option>
                              <option value="accepteBeneficeInventaire">Accepte √† concurrence de l'actif net (b√©n√©fice d'inventaire)</option>
                              <option value="renonce">Renonce</option>
                            </select>
                          </div>

                          {/* Documents de l'h√©ritier */}
                          <div>
                            <h5 className="font-medium text-sm mb-2">Documents justificatifs de l'h√©ritier</h5>
                            <MultiFileUpload
                              label="Pi√®ces d'identit√©, actes de naissance, justificatifs de domicile"
                              files={acteNotorieteHeritierFiles[heritier.id] || []}
                              onFilesChange={(newFiles) => {
                                setActeNotorieteHeritierFiles({
                                  ...acteNotorieteHeritierFiles,
                                  [heritier.id]: newFiles
                                });
                              }}
                            />
                          </div>
                        </div>
                      ))}

                      {acteNotorieteData.heritiers.length === 0 && (
                        <p className="text-sm text-gray-500 italic">Aucun h√©ritier ajout√©. Cliquez sur "Ajouter un h√©ritier" pour commencer.</p>
                      )}
                    </div>
                  )}

                  {/* Section 4: Conjoint survivant */}
                  {(acteNotorieteData.typeActe === "succession" || acteNotorieteData.typeActe === "qualiteHereditaire") && 
                   (acteNotorieteData.defunt.situationMatrimoniale === "marie" || acteNotorieteData.defunt.situationMatrimoniale === "veuf") && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">4. Conjoint survivant</h3>
                      <div className="space-y-3">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="conjointDonationsRecues"
                            checked={acteNotorieteData.conjointSurvivant.donationsRecues}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              conjointSurvivant: {...acteNotorieteData.conjointSurvivant, donationsRecues: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="conjointDonationsRecues">Donations re√ßues du d√©funt</Label>
                        </div>

                        {acteNotorieteData.conjointSurvivant.donationsRecues && (
                          <div>
                            <Label htmlFor="conjointDonationsDetails">D√©tails des donations</Label>
                            <Textarea
                              id="conjointDonationsDetails"
                              value={acteNotorieteData.conjointSurvivant.donationsDetails}
                              onChange={(e) => setActeNotorieteData({
                                ...acteNotorieteData,
                                conjointSurvivant: {...acteNotorieteData.conjointSurvivant, donationsDetails: e.target.value}
                              })}
                              rows={2}
                            />
                          </div>
                        )}

                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="conjointElectionDroits"
                            checked={acteNotorieteData.conjointSurvivant.electionDroits}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              conjointSurvivant: {...acteNotorieteData.conjointSurvivant, electionDroits: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="conjointElectionDroits">√âlection de droits (usufruit / pleine propri√©t√©)</Label>
                        </div>

                        {acteNotorieteData.conjointSurvivant.electionDroits && (
                          <div>
                            <Label htmlFor="conjointElectionDetails">Choix du conjoint</Label>
                            <Textarea
                              id="conjointElectionDetails"
                              value={acteNotorieteData.conjointSurvivant.electionDetails}
                              onChange={(e) => setActeNotorieteData({
                                ...acteNotorieteData,
                                conjointSurvivant: {...acteNotorieteData.conjointSurvivant, electionDetails: e.target.value}
                              })}
                              rows={2}
                            />
                          </div>
                        )}

                        <div>
                          <Label htmlFor="conjointDroitsSuccession">Droits dans la succession</Label>
                          <Textarea
                            id="conjointDroitsSuccession"
                            value={acteNotorieteData.conjointSurvivant.droitsSuccession}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              conjointSurvivant: {...acteNotorieteData.conjointSurvivant, droitsSuccession: e.target.value}
                            })}
                            rows={2}
                            placeholder="D√©crire les droits du conjoint..."
                          />
                        </div>

                        <div>
                          <Label htmlFor="conjointContratMariage">Contrat de mariage (si applicable)</Label>
                          <Input
                            id="conjointContratMariage"
                            value={acteNotorieteData.conjointSurvivant.contratMariage}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              conjointSurvivant: {...acteNotorieteData.conjointSurvivant, contratMariage: e.target.value}
                            })}
                            placeholder="D√©tails du contrat..."
                          />
                        </div>

                        <div>
                          <Label htmlFor="conjointClausesParticulieres">Clauses particuli√®res</Label>
                          <Textarea
                            id="conjointClausesParticulieres"
                            value={acteNotorieteData.conjointSurvivant.clausesParticulieres}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              conjointSurvivant: {...acteNotorieteData.conjointSurvivant, clausesParticulieres: e.target.value}
                            })}
                            rows={2}
                            placeholder="Clauses sp√©cifiques..."
                          />
                        </div>
                      </div>
                    </div>
                  )}

                  {/* Section 5: T√©moins */}
                  <div className="space-y-4">
                    <div className="flex justify-between items-center">
                      <h3 className="font-semibold text-lg border-b pb-2 flex-1">5. T√©moins (minimum 2)</h3>
                      <Button
                        type="button"
                        size="sm"
                        onClick={() => {
                          const newId = Date.now();
                          setActeNotorieteData({
                            ...acteNotorieteData,
                            temoins: [...acteNotorieteData.temoins, {
                              id: newId,
                              nom: "", prenom: "", dateNaissance: "", lieuNaissance: "",
                              adresse: "", nationalite: "", profession: "",
                              lienDefunt: ""
                            }]
                          });
                          setActeNotorieteTemoinFiles({
                            ...acteNotorieteTemoinFiles,
                            [newId]: []
                          });
                        }}
                        className={`ml-2 ${role === 'notaire' ? 'bg-orange-600 hover:bg-orange-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'}`}
                      >
                        + Ajouter un t√©moin
                      </Button>
                    </div>

                    {acteNotorieteData.temoins.map((temoin, index) => (
                      <div key={temoin.id} className="p-4 border rounded-lg space-y-4 bg-blue-50">
                        <div className="flex justify-between items-center">
                          <h4 className="font-medium">T√©moin {index + 1}</h4>
                          <Button
                            type="button"
                            variant="destructive"
                            size="sm"
                            onClick={() => {
                              const newTemoins = acteNotorieteData.temoins.filter(t => t.id !== temoin.id);
                              setActeNotorieteData({...acteNotorieteData, temoins: newTemoins});
                              const newFiles = {...acteNotorieteTemoinFiles};
                              delete newFiles[temoin.id];
                              setActeNotorieteTemoinFiles(newFiles);
                            }}
                            disabled={acteNotorieteData.temoins.length <= 2}
                          >
                            Supprimer
                          </Button>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                          <div>
                            <Label htmlFor={`temoin_nom_${temoin.id}`}>Nom</Label>
                            <Input
                              id={`temoin_nom_${temoin.id}`}
                              value={temoin.nom}
                              onChange={(e) => {
                                const newTemoins = [...acteNotorieteData.temoins];
                                newTemoins[index] = {...temoin, nom: e.target.value};
                                setActeNotorieteData({...acteNotorieteData, temoins: newTemoins});
                              }}
                            />
                          </div>
                          <div>
                            <Label htmlFor={`temoin_prenom_${temoin.id}`}>Pr√©nom(s)</Label>
                            <Input
                              id={`temoin_prenom_${temoin.id}`}
                              value={temoin.prenom}
                              onChange={(e) => {
                                const newTemoins = [...acteNotorieteData.temoins];
                                newTemoins[index] = {...temoin, prenom: e.target.value};
                                setActeNotorieteData({...acteNotorieteData, temoins: newTemoins});
                              }}
                            />
                          </div>
                          <div>
                            <Label htmlFor={`temoin_dateNaissance_${temoin.id}`}>Date de naissance</Label>
                            <Input
                              id={`temoin_dateNaissance_${temoin.id}`}
                              type="date"
                              value={temoin.dateNaissance}
                              onChange={(e) => {
                                const newTemoins = [...acteNotorieteData.temoins];
                                newTemoins[index] = {...temoin, dateNaissance: e.target.value};
                                setActeNotorieteData({...acteNotorieteData, temoins: newTemoins});
                              }}
                            />
                          </div>
                          <div>
                            <Label htmlFor={`temoin_lieuNaissance_${temoin.id}`}>Lieu de naissance</Label>
                            <Input
                              id={`temoin_lieuNaissance_${temoin.id}`}
                              value={temoin.lieuNaissance}
                              onChange={(e) => {
                                const newTemoins = [...acteNotorieteData.temoins];
                                newTemoins[index] = {...temoin, lieuNaissance: e.target.value};
                                setActeNotorieteData({...acteNotorieteData, temoins: newTemoins});
                              }}
                            />
                          </div>
                          <div className="md:col-span-2">
                            <Label htmlFor={`temoin_adresse_${temoin.id}`}>Adresse</Label>
                            <Input
                              id={`temoin_adresse_${temoin.id}`}
                              value={temoin.adresse}
                              onChange={(e) => {
                                const newTemoins = [...acteNotorieteData.temoins];
                                newTemoins[index] = {...temoin, adresse: e.target.value};
                                setActeNotorieteData({...acteNotorieteData, temoins: newTemoins});
                              }}
                            />
                          </div>
                          <div>
                            <Label htmlFor={`temoin_nationalite_${temoin.id}`}>Nationalit√©</Label>
                            <Input
                              id={`temoin_nationalite_${temoin.id}`}
                              value={temoin.nationalite}
                              onChange={(e) => {
                                const newTemoins = [...acteNotorieteData.temoins];
                                newTemoins[index] = {...temoin, nationalite: e.target.value};
                                setActeNotorieteData({...acteNotorieteData, temoins: newTemoins});
                              }}
                            />
                          </div>
                          <div>
                            <Label htmlFor={`temoin_profession_${temoin.id}`}>Profession</Label>
                            <Input
                              id={`temoin_profession_${temoin.id}`}
                              value={temoin.profession}
                              onChange={(e) => {
                                const newTemoins = [...acteNotorieteData.temoins];
                                newTemoins[index] = {...temoin, profession: e.target.value};
                                setActeNotorieteData({...acteNotorieteData, temoins: newTemoins});
                              }}
                            />
                          </div>
                          <div className="md:col-span-2">
                            <Label htmlFor={`temoin_lienDefunt_${temoin.id}`}>Lien avec le d√©funt</Label>
                            <Input
                              id={`temoin_lienDefunt_${temoin.id}`}
                              value={temoin.lienDefunt}
                              onChange={(e) => {
                                const newTemoins = [...acteNotorieteData.temoins];
                                newTemoins[index] = {...temoin, lienDefunt: e.target.value};
                                setActeNotorieteData({...acteNotorieteData, temoins: newTemoins});
                              }}
                              placeholder="Ex: Ami proche, voisin, coll√®gue..."
                            />
                          </div>
                        </div>

                        <div>
                          <Label>Documents du t√©moin</Label>
                          <MultiFileUpload
                            label="Pi√®ce d'identit√©, justificatif de domicile"
                            files={acteNotorieteTemoinFiles[temoin.id] || []}
                            onFilesChange={(newFiles) => {
                              setActeNotorieteTemoinFiles({
                                ...acteNotorieteTemoinFiles,
                                [temoin.id]: newFiles
                              });
                            }}
                          />
                        </div>
                      </div>
                    ))}

                    {acteNotorieteData.temoins.length < 2 && (
                      <p className="text-sm text-orange-600 font-medium">‚ö†Ô∏è Au moins 2 t√©moins sont requis pour √©tablir l'acte de notori√©t√©.</p>
                    )}
                  </div>

                  {/* Section 6: Preuves de la filiation */}
                  {acteNotorieteData.typeActe === "filiation" && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">6. Preuves de la filiation</h3>
                      <div className="space-y-3">
                        <MultiFileUpload
                          label="Photos de famille"
                          files={acteNotorietePreuvePhotos}
                          onFilesChange={setActeNotorietePreuvePhotos}
                        />

                        <MultiFileUpload
                          label="Certificats m√©dicaux"
                          files={acteNotorietePreuveCertificats}
                          onFilesChange={setActeNotorietePreuveCertificats}
                        />

                        <MultiFileUpload
                          label="Documents scolaires"
                          files={acteNotorietePreuveDocumentsScolaires}
                          onFilesChange={setActeNotorietePreuveDocumentsScolaires}
                        />

                        <MultiFileUpload
                          label="Correspondances"
                          files={acteNotorietePreuveCorrespondances}
                          onFilesChange={setActeNotorietePreuveCorrespondances}
                        />

                        <MultiFileUpload
                          label="Autres preuves"
                          files={acteNotorietePreuveAutres}
                          onFilesChange={setActeNotorietePreuveAutres}
                        />
                      </div>
                    </div>
                  )}

                  {/* Section 7: Contenu de l'acte */}
                  {(acteNotorieteData.typeActe === "succession" || acteNotorieteData.typeActe === "qualiteHereditaire") && (
                    <div className="space-y-4">
                      <h3 className="font-semibold text-lg border-b pb-2">7. Contenu de l'acte</h3>
                      <div className="space-y-3">
                        <div>
                          <Label htmlFor="contenuDeclarations">D√©clarations des t√©moins</Label>
                          <Textarea
                            id="contenuDeclarations"
                            value={acteNotorieteData.contenuActe.declarationsTemoins}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              contenuActe: {...acteNotorieteData.contenuActe, declarationsTemoins: e.target.value}
                            })}
                            rows={3}
                            placeholder="R√©sum√© des d√©clarations faites par les t√©moins..."
                          />
                        </div>

                        <div>
                          <Label htmlFor="contenuOrdre">Ordre successoral</Label>
                          <Textarea
                            id="contenuOrdre"
                            value={acteNotorieteData.contenuActe.ordreSuccessoral}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              contenuActe: {...acteNotorieteData.contenuActe, ordreSuccessoral: e.target.value}
                            })}
                            rows={3}
                            placeholder="Ordre des h√©ritiers selon la loi..."
                          />
                        </div>

                        <div>
                          <Label htmlFor="contenuParts">Parts h√©r√©ditaires</Label>
                          <Textarea
                            id="contenuParts"
                            value={acteNotorieteData.contenuActe.partsHereditaires}
                            onChange={(e) => setActeNotorieteData({
                              ...acteNotorieteData,
                              contenuActe: {...acteNotorieteData.contenuActe, partsHereditaires: e.target.value}
                            })}
                            rows={3}
                            placeholder="R√©partition des parts entre les h√©ritiers..."
                          />
                        </div>
                      </div>
                    </div>
                  )}

                  {/* Section 8: Formalit√©s */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">8. Formalit√©s</h3>
                    <div className="space-y-3">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="formaliteFCDDV"
                          checked={acteNotorieteData.formalites.fichierCentralDesDispositionsDernieresVolontes}
                          onChange={(e) => setActeNotorieteData({
                            ...acteNotorieteData,
                            formalites: {...acteNotorieteData.formalites, fichierCentralDesDispositionsDernieresVolontes: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="formaliteFCDDV">Consultation du Fichier Central des Dispositions de Derni√®res Volont√©s (FCDDV)</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="formaliteReception"
                          checked={acteNotorieteData.formalites.receptionActeNotaire}
                          onChange={(e) => setActeNotorieteData({
                            ...acteNotorieteData,
                            formalites: {...acteNotorieteData.formalites, receptionActeNotaire: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="formaliteReception">R√©ception de l'acte par le notaire</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="formaliteAuthentification"
                          checked={acteNotorieteData.formalites.authentificationSignatures}
                          onChange={(e) => setActeNotorieteData({
                            ...acteNotorieteData,
                            formalites: {...acteNotorieteData.formalites, authentificationSignatures: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="formaliteAuthentification">Authentification des signatures</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="formaliteTransmission"
                          checked={acteNotorieteData.formalites.transmissionCopiesHeritiers}
                          onChange={(e) => setActeNotorieteData({
                            ...acteNotorieteData,
                            formalites: {...acteNotorieteData.formalites, transmissionCopiesHeritiers: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="formaliteTransmission">Transmission de copies aux h√©ritiers</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="formaliteInscription"
                          checked={acteNotorieteData.formalites.inscriptionRegistres}
                          onChange={(e) => setActeNotorieteData({
                            ...acteNotorieteData,
                            formalites: {...acteNotorieteData.formalites, inscriptionRegistres: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="formaliteInscription">Inscription dans les registres</Label>
                      </div>
                    </div>
                  </div>

                  {/* Section 9: Pi√®ces justificatives */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">9. Pi√®ces justificatives</h3>
                    
                    <div className="space-y-3">
                      <h4 className="font-medium text-sm">Documents relatifs au d√©funt</h4>
                      
                      <MultiFileUpload
                        label="Acte de d√©c√®s"
                        files={acteNotorieteDefuntActeDeces}
                        onFilesChange={setActeNotorieteDefuntActeDeces}
                      />

                      <MultiFileUpload
                        label="Acte de naissance du d√©funt"
                        files={acteNotorieteDefuntActeNaissance}
                        onFilesChange={setActeNotorieteDefuntActeNaissance}
                      />

                      <MultiFileUpload
                        label="Livret de famille du d√©funt"
                        files={acteNotorieteDefuntLivretFamille}
                        onFilesChange={setActeNotorieteDefuntLivretFamille}
                      />

                      <MultiFileUpload
                        label="Acte de mariage du d√©funt"
                        files={acteNotorieteDefuntActeMariage}
                        onFilesChange={setActeNotorieteDefuntActeMariage}
                      />

                      <MultiFileUpload
                        label="Contrat de mariage"
                        files={acteNotorieteDefuntContratMariage}
                        onFilesChange={setActeNotorieteDefuntContratMariage}
                      />

                      <MultiFileUpload
                        label="Jugement de divorce"
                        files={acteNotorieteDefuntJugementDivorce}
                        onFilesChange={setActeNotorieteDefuntJugementDivorce}
                      />

                      <MultiFileUpload
                        label="Testament(s)"
                        files={acteNotorieteDefuntTestament}
                        onFilesChange={setActeNotorieteDefuntTestament}
                      />

                      <MultiFileUpload
                        label="Donations ant√©rieures"
                        files={acteNotorieteDefuntDonations}
                        onFilesChange={setActeNotorieteDefuntDonations}
                      />

                      <MultiFileUpload
                        label="Justificatif de domicile du d√©funt"
                        files={acteNotorieteDefuntJustifDomicile}
                        onFilesChange={setActeNotorieteDefuntJustifDomicile}
                      />

                      <MultiFileUpload
                        label="Pi√®ce d'identit√© du d√©funt"
                        files={acteNotorieteDefuntPieceIdentite}
                        onFilesChange={setActeNotorieteDefuntPieceIdentite}
                      />
                    </div>

                    <div className="space-y-3 mt-6">
                      <h4 className="font-medium text-sm">Documents relatifs aux h√©ritiers (collectifs)</h4>
                      
                      <MultiFileUpload
                        label="Actes de naissance des h√©ritiers"
                        files={acteNotorieteHeritiersActesNaissance}
                        onFilesChange={setActeNotorieteHeritiersActesNaissance}
                      />

                      <MultiFileUpload
                        label="Pi√®ces d'identit√© des h√©ritiers"
                        files={acteNotorieteHeritiersPiecesIdentite}
                        onFilesChange={setActeNotorieteHeritiersPiecesIdentite}
                      />

                      <MultiFileUpload
                        label="Justificatifs de domicile des h√©ritiers"
                        files={acteNotorieteHeritiersJustifsDomicile}
                        onFilesChange={setActeNotorieteHeritiersJustifsDomicile}
                      />

                      <MultiFileUpload
                        label="Livrets de famille des h√©ritiers"
                        files={acteNotorieteHeritiersLivretsFamille}
                        onFilesChange={setActeNotorieteHeritiersLivretsFamille}
                      />

                      <MultiFileUpload
                        label="Actes de notori√©t√© ant√©rieurs"
                        files={acteNotorieteHeritiersActesNotoriete}
                        onFilesChange={setActeNotorieteHeritiersActesNotoriete}
                      />

                      <MultiFileUpload
                        label="Certificats d'h√©r√©dit√©"
                        files={acteNotorieteHeritiersCertificatsHeredite}
                        onFilesChange={setActeNotorieteHeritiersCertificatsHeredite}
                      />

                      <MultiFileUpload
                        label="Documents de tutelle/curatelle (si applicable)"
                        files={acteNotorieteHeritiersTutelleCuratelle}
                        onFilesChange={setActeNotorieteHeritiersTutelleCuratelle}
                      />
                    </div>

                    <div className="space-y-3 mt-6">
                      <h4 className="font-medium text-sm">Documents relatifs aux t√©moins (collectifs)</h4>
                      
                      <MultiFileUpload
                        label="Pi√®ces d'identit√© des t√©moins"
                        files={acteNotorieteTemoinsPiecesIdentite}
                        onFilesChange={setActeNotorieteTemoinsPiecesIdentite}
                      />

                      <MultiFileUpload
                        label="Justificatifs de domicile des t√©moins"
                        files={acteNotorieteTemoinsJustifsDomicile}
                        onFilesChange={setActeNotorieteTemoinsJustifsDomicile}
                      />
                    </div>

                    <div className="space-y-3 mt-6">
                      <h4 className="font-medium text-sm">Autres documents</h4>
                      
                      <MultiFileUpload
                        label="Attestations diverses"
                        files={acteNotorieteAutresAttestations}
                        onFilesChange={setActeNotorieteAutresAttestations}
                      />

                      <MultiFileUpload
                        label="Certificats m√©dicaux"
                        files={acteNotorieteAutresCertificatsMedicaux}
                        onFilesChange={setActeNotorieteAutresCertificatsMedicaux}
                      />

                      <MultiFileUpload
                        label="Correspondances"
                        files={acteNotorieteAutresCorrespondances}
                        onFilesChange={setActeNotorieteAutresCorrespondances}
                      />

                      <MultiFileUpload
                        label="Autres documents"
                        files={acteNotorieteAutresDocuments}
                        onFilesChange={setActeNotorieteAutresDocuments}
                      />
                    </div>
                  </div>

                  <div className="p-3 bg-blue-50 border border-blue-200 rounded-lg">
                    <p className="text-sm text-blue-800">
                      ‚ÑπÔ∏è <strong>Note :</strong> L'acte de notori√©t√© est un document officiel √©tabli par un notaire qui certifie la qualit√© d'h√©ritier ou √©tablit une filiation. Il est requis pour d√©bloquer les comptes bancaires, transf√©rer les biens immobiliers, et effectuer toutes les d√©marches successorales. Assurez-vous de fournir tous les documents n√©cessaires pour faciliter le traitement par le notaire.
                    </p>
                  </div>

                </div>
              </>
            )}

            {pendingContractType === "Partage successoral" && (
              <>
                <div className="space-y-6 max-h-[calc(100vh-250px)] overflow-y-auto pr-2">
                  
                  {/* Section 1: Informations sur la succession */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">1. Informations sur la succession</h3>
                    
                    {/* A. Identit√© du d√©funt */}
                    <div className="space-y-4">
                      <h4 className="font-medium text-md">A. Identit√© du d√©funt</h4>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                          <Label htmlFor="partageDefuntNom">Nom</Label>
                          <Input
                            id="partageDefuntNom"
                            value={partageSuccessoralData.succession.defunt.nom}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                defunt: {...partageSuccessoralData.succession.defunt, nom: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="partageDefuntPrenom">Pr√©nom</Label>
                          <Input
                            id="partageDefuntPrenom"
                            value={partageSuccessoralData.succession.defunt.prenom}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                defunt: {...partageSuccessoralData.succession.defunt, prenom: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="partageDefuntNomNaissance">Nom de naissance</Label>
                          <Input
                            id="partageDefuntNomNaissance"
                            value={partageSuccessoralData.succession.defunt.nomNaissance}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                defunt: {...partageSuccessoralData.succession.defunt, nomNaissance: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="partageDefuntDateNaissance">Date de naissance</Label>
                          <Input
                            id="partageDefuntDateNaissance"
                            type="date"
                            value={partageSuccessoralData.succession.defunt.dateNaissance}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                defunt: {...partageSuccessoralData.succession.defunt, dateNaissance: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="partageDefuntLieuNaissance">Lieu de naissance</Label>
                          <Input
                            id="partageDefuntLieuNaissance"
                            value={partageSuccessoralData.succession.defunt.lieuNaissance}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                defunt: {...partageSuccessoralData.succession.defunt, lieuNaissance: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="partageDefuntDateDeces">Date du d√©c√®s</Label>
                          <Input
                            id="partageDefuntDateDeces"
                            type="date"
                            value={partageSuccessoralData.succession.defunt.dateDeces}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                defunt: {...partageSuccessoralData.succession.defunt, dateDeces: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="partageDefuntLieuDeces">Lieu du d√©c√®s</Label>
                          <Input
                            id="partageDefuntLieuDeces"
                            value={partageSuccessoralData.succession.defunt.lieuDeces}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                defunt: {...partageSuccessoralData.succession.defunt, lieuDeces: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="partageDefuntNationalite">Nationalit√©</Label>
                          <Input
                            id="partageDefuntNationalite"
                            value={partageSuccessoralData.succession.defunt.nationalite}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                defunt: {...partageSuccessoralData.succession.defunt, nationalite: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="partageDefuntProfession">Profession</Label>
                          <Input
                            id="partageDefuntProfession"
                            value={partageSuccessoralData.succession.defunt.profession}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                defunt: {...partageSuccessoralData.succession.defunt, profession: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div className="md:col-span-2">
                          <Label htmlFor="partageDefuntAdresse">Adresse au jour du d√©c√®s</Label>
                          <Input
                            id="partageDefuntAdresse"
                            value={partageSuccessoralData.succession.defunt.adresseAuDeces}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                defunt: {...partageSuccessoralData.succession.defunt, adresseAuDeces: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="partageDefuntSituationMatrimoniale">Situation matrimoniale</Label>
                          <Input
                            id="partageDefuntSituationMatrimoniale"
                            value={partageSuccessoralData.succession.defunt.situationMatrimoniale}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                defunt: {...partageSuccessoralData.succession.defunt, situationMatrimoniale: e.target.value}
                              }
                            })}
                            placeholder="C√©libataire, Mari√©(e), Pacs√©(e), Divorc√©(e), Veuf/Veuve"
                          />
                        </div>
                        <div>
                          <Label htmlFor="partageDefuntRegime">R√©gime matrimonial</Label>
                          <Input
                            id="partageDefuntRegime"
                            value={partageSuccessoralData.succession.defunt.regimeMatrimonial}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                defunt: {...partageSuccessoralData.succession.defunt, regimeMatrimonial: e.target.value}
                              }
                            })}
                            placeholder="Communaut√©, s√©paration de biens..."
                          />
                        </div>
                      </div>
                      
                      <div className="space-y-3 mt-4">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="partageDefuntTestaments"
                            checked={partageSuccessoralData.succession.defunt.testamentsExistants}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                defunt: {...partageSuccessoralData.succession.defunt, testamentsExistants: e.target.checked}
                              }
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="partageDefuntTestaments">Testaments existants</Label>
                        </div>

                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="partageDefuntDonationsEntreEpoux"
                            checked={partageSuccessoralData.succession.defunt.donationsEntreEpoux}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                defunt: {...partageSuccessoralData.succession.defunt, donationsEntreEpoux: e.target.checked}
                              }
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="partageDefuntDonationsEntreEpoux">Donations entre √©poux</Label>
                        </div>

                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="partageDefuntDonationsAnterieures"
                            checked={partageSuccessoralData.succession.defunt.donationsAnterieures}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                defunt: {...partageSuccessoralData.succession.defunt, donationsAnterieures: e.target.checked}
                              }
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="partageDefuntDonationsAnterieures">Donations ant√©rieures aux h√©ritiers</Label>
                        </div>
                      </div>
                    </div>

                    {/* B. Notaire */}
                    <div className="space-y-4 mt-6">
                      <h4 className="font-medium text-md">B. Notaire charg√© de la succession</h4>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                          <Label htmlFor="partageNotaireNom">Nom</Label>
                          <Input
                            id="partageNotaireNom"
                            value={partageSuccessoralData.succession.notaire.nom}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                notaire: {...partageSuccessoralData.succession.notaire, nom: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="partageNotaireEtude">√âtude</Label>
                          <Input
                            id="partageNotaireEtude"
                            value={partageSuccessoralData.succession.notaire.etude}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                notaire: {...partageSuccessoralData.succession.notaire, etude: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div className="md:col-span-2">
                          <Label htmlFor="partageNotaireAdresse">Adresse</Label>
                          <Input
                            id="partageNotaireAdresse"
                            value={partageSuccessoralData.succession.notaire.adresse}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                notaire: {...partageSuccessoralData.succession.notaire, adresse: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="partageNotaireTelephone">T√©l√©phone</Label>
                          <Input
                            id="partageNotaireTelephone"
                            value={partageSuccessoralData.succession.notaire.telephone}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                notaire: {...partageSuccessoralData.succession.notaire, telephone: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="partageNotaireEmail">Email</Label>
                          <Input
                            id="partageNotaireEmail"
                            type="email"
                            value={partageSuccessoralData.succession.notaire.email}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              succession: {
                                ...partageSuccessoralData.succession,
                                notaire: {...partageSuccessoralData.succession.notaire, email: e.target.value}
                              }
                            })}
                          />
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Section 2: H√©ritiers / L√©gataires */}
                  <div className="space-y-4">
                    <div className="flex justify-between items-center">
                      <h3 className="font-semibold text-lg border-b pb-2 flex-1">2. H√©ritiers / L√©gataires</h3>
                      <Button
                        type="button"
                        size="sm"
                        onClick={() => {
                          const newId = Date.now();
                          setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            heritiers: [...partageSuccessoralData.heritiers, {
                              id: newId,
                              clientId: "",
                              nom: "", prenom: "", nomNaissance: "", adresse: "",
                              dateNaissance: "", lieuNaissance: "", nationalite: "", profession: "",
                              telephone: "", email: "", lienDefunt: "",
                              heritierReservataire: false, legataireUniversel: false,
                              legataireATitreUniversel: false, legataireParticulier: false,
                              heritierParRepresentation: false, representeQui: "",
                              acceptationRenonciation: "", majeurMineur: "majeur",
                              sousTutelleCuratelle: false, typeProtection: "", tuteurNom: "",
                              quotePart: ""
                            }]
                          });
                          setPartageHeritierFiles({
                            ...partageHeritierFiles,
                            [newId]: []
                          });
                        }}
                        className={`ml-2 ${role === 'notaire' ? 'bg-orange-600 hover:bg-orange-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'}`}
                      >
                        + Ajouter un h√©ritier
                      </Button>
                    </div>

                    {partageSuccessoralData.heritiers.map((heritier, index) => (
                      <div key={heritier.id} className="p-4 border rounded-lg space-y-4 bg-gray-50">
                        <div className="flex justify-between items-center">
                          <h4 className="font-medium">H√©ritier {index + 1}</h4>
                          <Button
                            type="button"
                            variant="destructive"
                            size="sm"
                            onClick={() => {
                              const newHeritiers = partageSuccessoralData.heritiers.filter(h => h.id !== heritier.id);
                              setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                              const newFiles = {...partageHeritierFiles};
                              delete newFiles[heritier.id];
                              setPartageHeritierFiles(newFiles);
                            }}
                          >
                            Supprimer
                          </Button>
                        </div>

                        {/* S√©lection client ou saisie manuelle */}
                        <div className="mb-4">
                          <Label htmlFor={`heritier_client_${heritier.id}`}>Choisir un client existant (optionnel)</Label>
                          <select
                            id={`heritier_client_${heritier.id}`}
                            value={heritier.clientId || ""}
                            onChange={(e) => {
                              const clientId = e.target.value;
                              const newHeritiers = [...partageSuccessoralData.heritiers];
                              
                              if (clientId) {
                                const selectedClient = clients.find(c => c.id === clientId);
                                if (selectedClient) {
                                  newHeritiers[index] = {
                                    ...heritier,
                                    clientId: clientId,
                                    nom: selectedClient.nom || "",
                                    prenom: selectedClient.prenom || "",
                                    nomNaissance: selectedClient.nom_naissance || "",
                                    dateNaissance: selectedClient.date_naissance || "",
                                    lieuNaissance: selectedClient.lieu_naissance || "",
                                    nationalite: selectedClient.nationalite || "",
                                    profession: selectedClient.profession || "",
                                    adresse: selectedClient.adresse || "",
                                    telephone: selectedClient.telephone || "",
                                    email: selectedClient.email || "",
                                  };
                                }
                              } else {
                                newHeritiers[index] = {...heritier, clientId: ""};
                              }
                              
                              setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                            }}
                            className="w-full px-3 py-2 border rounded-md"
                          >
                            <option value="">-- Saisie manuelle --</option>
                            {clients.map((client) => (
                              <option key={client.id} value={client.id}>
                                {client.prenom} {client.nom}
                              </option>
                            ))}
                          </select>
                        </div>

                        {/* Informations d'√©tat civil */}
                        <div>
                          <h5 className="font-medium text-sm mb-2">A. Informations d'√©tat civil</h5>
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div>
                              <Label htmlFor={`heritier_nom_${heritier.id}`}>Nom</Label>
                              <Input
                                id={`heritier_nom_${heritier.id}`}
                                value={heritier.nom}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, nom: e.target.value};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`heritier_prenom_${heritier.id}`}>Pr√©nom</Label>
                              <Input
                                id={`heritier_prenom_${heritier.id}`}
                                value={heritier.prenom}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, prenom: e.target.value};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`heritier_nomNaissance_${heritier.id}`}>Nom de naissance</Label>
                              <Input
                                id={`heritier_nomNaissance_${heritier.id}`}
                                value={heritier.nomNaissance}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, nomNaissance: e.target.value};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`heritier_dateNaissance_${heritier.id}`}>Date de naissance</Label>
                              <Input
                                id={`heritier_dateNaissance_${heritier.id}`}
                                type="date"
                                value={heritier.dateNaissance}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, dateNaissance: e.target.value};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`heritier_lieuNaissance_${heritier.id}`}>Lieu de naissance</Label>
                              <Input
                                id={`heritier_lieuNaissance_${heritier.id}`}
                                value={heritier.lieuNaissance}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, lieuNaissance: e.target.value};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`heritier_nationalite_${heritier.id}`}>Nationalit√©</Label>
                              <Input
                                id={`heritier_nationalite_${heritier.id}`}
                                value={heritier.nationalite}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, nationalite: e.target.value};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`heritier_profession_${heritier.id}`}>Profession</Label>
                              <Input
                                id={`heritier_profession_${heritier.id}`}
                                value={heritier.profession}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, profession: e.target.value};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`heritier_telephone_${heritier.id}`}>T√©l√©phone</Label>
                              <Input
                                id={`heritier_telephone_${heritier.id}`}
                                value={heritier.telephone}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, telephone: e.target.value};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`heritier_email_${heritier.id}`}>Email</Label>
                              <Input
                                id={`heritier_email_${heritier.id}`}
                                type="email"
                                value={heritier.email}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, email: e.target.value};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                              />
                            </div>
                            <div className="md:col-span-2">
                              <Label htmlFor={`heritier_adresse_${heritier.id}`}>Adresse</Label>
                              <Input
                                id={`heritier_adresse_${heritier.id}`}
                                value={heritier.adresse}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, adresse: e.target.value};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`heritier_lienDefunt_${heritier.id}`}>Lien avec le d√©funt</Label>
                              <Input
                                id={`heritier_lienDefunt_${heritier.id}`}
                                value={heritier.lienDefunt}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, lienDefunt: e.target.value};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                                placeholder="Ex: Fils, Fille, Conjoint..."
                              />
                            </div>
                          </div>
                        </div>

                        {/* Situation juridique */}
                        <div>
                          <h5 className="font-medium text-sm mb-2">B. Situation juridique</h5>
                          <div className="space-y-3">
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id={`heritier_reservataire_${heritier.id}`}
                                checked={heritier.heritierReservataire}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, heritierReservataire: e.target.checked};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                                className="w-4 h-4"
                              />
                              <Label htmlFor={`heritier_reservataire_${heritier.id}`}>H√©ritier r√©servataire</Label>
                            </div>

                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id={`heritier_legataireUniversel_${heritier.id}`}
                                checked={heritier.legataireUniversel}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, legataireUniversel: e.target.checked};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                                className="w-4 h-4"
                              />
                              <Label htmlFor={`heritier_legataireUniversel_${heritier.id}`}>L√©gataire universel</Label>
                            </div>

                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id={`heritier_legataireATitreUniversel_${heritier.id}`}
                                checked={heritier.legataireATitreUniversel}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, legataireATitreUniversel: e.target.checked};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                                className="w-4 h-4"
                              />
                              <Label htmlFor={`heritier_legataireATitreUniversel_${heritier.id}`}>L√©gataire √† titre universel</Label>
                            </div>

                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id={`heritier_legataireParticulier_${heritier.id}`}
                                checked={heritier.legataireParticulier}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, legataireParticulier: e.target.checked};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                                className="w-4 h-4"
                              />
                              <Label htmlFor={`heritier_legataireParticulier_${heritier.id}`}>L√©gataire particulier</Label>
                            </div>

                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id={`heritier_representation_${heritier.id}`}
                                checked={heritier.heritierParRepresentation}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, heritierParRepresentation: e.target.checked};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                                className="w-4 h-4"
                              />
                              <Label htmlFor={`heritier_representation_${heritier.id}`}>H√©ritier par repr√©sentation</Label>
                            </div>

                            {heritier.heritierParRepresentation && (
                              <div>
                                <Label htmlFor={`heritier_representeQui_${heritier.id}`}>Repr√©sente qui</Label>
                                <Input
                                  id={`heritier_representeQui_${heritier.id}`}
                                  value={heritier.representeQui}
                                  onChange={(e) => {
                                    const newHeritiers = [...partageSuccessoralData.heritiers];
                                    newHeritiers[index] = {...heritier, representeQui: e.target.value};
                                    setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                  }}
                                  placeholder="Nom du repr√©sent√©"
                                />
                              </div>
                            )}

                            <div>
                              <Label htmlFor={`heritier_acceptation_${heritier.id}`}>Acceptation / Renonciation</Label>
                              <select
                                id={`heritier_acceptation_${heritier.id}`}
                                value={heritier.acceptationRenonciation}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, acceptationRenonciation: e.target.value};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                                className="w-full px-3 py-2 border rounded-md"
                              >
                                <option value="">-- S√©lectionner --</option>
                                <option value="accepte">Accepte</option>
                                <option value="renonce">Renonce</option>
                                <option value="benefice_inventaire">√Ä concurrence de l'actif net (b√©n√©fice d'inventaire)</option>
                              </select>
                            </div>

                            <div>
                              <Label htmlFor={`heritier_majeurMineur_${heritier.id}`}>Majeur / Mineur</Label>
                              <select
                                id={`heritier_majeurMineur_${heritier.id}`}
                                value={heritier.majeurMineur}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, majeurMineur: e.target.value};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                                className="w-full px-3 py-2 border rounded-md"
                              >
                                <option value="majeur">Majeur</option>
                                <option value="mineur">Mineur</option>
                              </select>
                            </div>

                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id={`heritier_tutelleCuratelle_${heritier.id}`}
                                checked={heritier.sousTutelleCuratelle}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, sousTutelleCuratelle: e.target.checked};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                                className="w-4 h-4"
                              />
                              <Label htmlFor={`heritier_tutelleCuratelle_${heritier.id}`}>Sous tutelle / curatelle</Label>
                            </div>

                            {heritier.sousTutelleCuratelle && (
                              <>
                                <div>
                                  <Label htmlFor={`heritier_typeProtection_${heritier.id}`}>Type de protection</Label>
                                  <Input
                                    id={`heritier_typeProtection_${heritier.id}`}
                                    value={heritier.typeProtection}
                                    onChange={(e) => {
                                      const newHeritiers = [...partageSuccessoralData.heritiers];
                                      newHeritiers[index] = {...heritier, typeProtection: e.target.value};
                                      setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                    }}
                                    placeholder="Tutelle, curatelle..."
                                  />
                                </div>
                                <div>
                                  <Label htmlFor={`heritier_tuteur_${heritier.id}`}>Nom du tuteur/curateur</Label>
                                  <Input
                                    id={`heritier_tuteur_${heritier.id}`}
                                    value={heritier.tuteurNom}
                                    onChange={(e) => {
                                      const newHeritiers = [...partageSuccessoralData.heritiers];
                                      newHeritiers[index] = {...heritier, tuteurNom: e.target.value};
                                      setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                    }}
                                  />
                                </div>
                              </>
                            )}

                            <div>
                              <Label htmlFor={`heritier_quotePart_${heritier.id}`}>Quote-part</Label>
                              <Input
                                id={`heritier_quotePart_${heritier.id}`}
                                value={heritier.quotePart}
                                onChange={(e) => {
                                  const newHeritiers = [...partageSuccessoralData.heritiers];
                                  newHeritiers[index] = {...heritier, quotePart: e.target.value};
                                  setPartageSuccessoralData({...partageSuccessoralData, heritiers: newHeritiers});
                                }}
                                placeholder="Ex: 1/2, 1/3, 1/4..."
                              />
                            </div>
                          </div>
                        </div>

                        {/* Documents h√©ritier */}
                        <div>
                          <h5 className="font-medium text-sm mb-2">Documents de l'h√©ritier</h5>
                          <MultiFileUpload
                            label="Acte de naissance, pi√®ce d'identit√©, justificatifs..."
                            files={partageHeritierFiles[heritier.id] || []}
                            onFilesChange={(newFiles) => {
                              setPartageHeritierFiles({
                                ...partageHeritierFiles,
                                [heritier.id]: newFiles
                              });
                            }}
                          />
                        </div>
                      </div>
                    ))}

                    {partageSuccessoralData.heritiers.length === 0 && (
                      <p className="text-sm text-gray-500 italic">Aucun h√©ritier ajout√©. Cliquez sur "Ajouter un h√©ritier" pour commencer.</p>
                    )}
                  </div>

                  {/* Section 3: Inventaire complet de l'actif successoral */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">3. Inventaire complet de l'actif successoral</h3>
                    
                    {/* A. Biens immobiliers */}
                    <div className="space-y-4">
                      <div className="flex justify-between items-center">
                        <h4 className="font-medium text-md flex-1">A. Biens immobiliers</h4>
                        <Button
                          type="button"
                          size="sm"
                          onClick={() => {
                            const newId = Date.now();
                            setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              actif: {
                                ...partageSuccessoralData.actif,
                                biensImmobiliers: [...partageSuccessoralData.actif.biensImmobiliers, {
                                  id: newId,
                                  adresse: "", description: "", designationCadastrale: "",
                                  valeurVenale: "", origineBien: "", quotePartDefunt: "",
                                  etatLocatif: "", loyer: "", hypotheques: "",
                                  copropriete: false, lots: "", chargesCopro: ""
                                }]
                              }
                            });
                            setPartageBienImmobilierFiles({
                              ...partageBienImmobilierFiles,
                              [newId]: []
                            });
                          }}
                          className={`ml-2 ${role === 'notaire' ? 'bg-orange-600 hover:bg-orange-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'}`}
                        >
                          + Ajouter un bien
                        </Button>
                      </div>

                      {partageSuccessoralData.actif.biensImmobiliers.map((bien, index) => (
                        <div key={bien.id} className="p-4 border rounded-lg space-y-3 bg-blue-50">
                          <div className="flex justify-between items-center">
                            <h5 className="font-medium">Bien immobilier {index + 1}</h5>
                            <Button
                              type="button"
                              variant="destructive"
                              size="sm"
                              onClick={() => {
                                const newBiens = partageSuccessoralData.actif.biensImmobiliers.filter(b => b.id !== bien.id);
                                setPartageSuccessoralData({
                                  ...partageSuccessoralData,
                                  actif: {...partageSuccessoralData.actif, biensImmobiliers: newBiens}
                                });
                                const newFiles = {...partageBienImmobilierFiles};
                                delete newFiles[bien.id];
                                setPartageBienImmobilierFiles(newFiles);
                              }}
                            >
                              Supprimer
                            </Button>
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div className="md:col-span-2">
                              <Label htmlFor={`bien_adresse_${bien.id}`}>Adresse</Label>
                              <Input
                                id={`bien_adresse_${bien.id}`}
                                value={bien.adresse}
                                onChange={(e) => {
                                  const newBiens = [...partageSuccessoralData.actif.biensImmobiliers];
                                  newBiens[index] = {...bien, adresse: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, biensImmobiliers: newBiens}
                                  });
                                }}
                              />
                            </div>
                            <div className="md:col-span-2">
                              <Label htmlFor={`bien_description_${bien.id}`}>Description compl√®te</Label>
                              <Textarea
                                id={`bien_description_${bien.id}`}
                                value={bien.description}
                                onChange={(e) => {
                                  const newBiens = [...partageSuccessoralData.actif.biensImmobiliers];
                                  newBiens[index] = {...bien, description: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, biensImmobiliers: newBiens}
                                  });
                                }}
                                rows={2}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`bien_cadastre_${bien.id}`}>D√©signation cadastrale</Label>
                              <Input
                                id={`bien_cadastre_${bien.id}`}
                                value={bien.designationCadastrale}
                                onChange={(e) => {
                                  const newBiens = [...partageSuccessoralData.actif.biensImmobiliers];
                                  newBiens[index] = {...bien, designationCadastrale: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, biensImmobiliers: newBiens}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`bien_valeur_${bien.id}`}>Valeur v√©nale (‚Ç¨)</Label>
                              <Input
                                id={`bien_valeur_${bien.id}`}
                                type="number"
                                value={bien.valeurVenale}
                                onChange={(e) => {
                                  const newBiens = [...partageSuccessoralData.actif.biensImmobiliers];
                                  newBiens[index] = {...bien, valeurVenale: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, biensImmobiliers: newBiens}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`bien_origine_${bien.id}`}>Origine du bien</Label>
                              <select
                                id={`bien_origine_${bien.id}`}
                                value={bien.origineBien}
                                onChange={(e) => {
                                  const newBiens = [...partageSuccessoralData.actif.biensImmobiliers];
                                  newBiens[index] = {...bien, origineBien: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, biensImmobiliers: newBiens}
                                  });
                                }}
                                className="w-full px-3 py-2 border rounded-md"
                              >
                                <option value="">-- S√©lectionner --</option>
                                <option value="propre">Propre du d√©funt</option>
                                <option value="commun">Commun</option>
                                <option value="indivis">Indivis</option>
                              </select>
                            </div>
                            <div>
                              <Label htmlFor={`bien_quotePart_${bien.id}`}>Quote-part du d√©funt</Label>
                              <Input
                                id={`bien_quotePart_${bien.id}`}
                                value={bien.quotePartDefunt}
                                onChange={(e) => {
                                  const newBiens = [...partageSuccessoralData.actif.biensImmobiliers];
                                  newBiens[index] = {...bien, quotePartDefunt: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, biensImmobiliers: newBiens}
                                  });
                                }}
                                placeholder="Ex: 100%, 50%, 1/3..."
                              />
                            </div>
                            <div>
                              <Label htmlFor={`bien_etatLocatif_${bien.id}`}>√âtat locatif</Label>
                              <Input
                                id={`bien_etatLocatif_${bien.id}`}
                                value={bien.etatLocatif}
                                onChange={(e) => {
                                  const newBiens = [...partageSuccessoralData.actif.biensImmobiliers];
                                  newBiens[index] = {...bien, etatLocatif: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, biensImmobiliers: newBiens}
                                  });
                                }}
                                placeholder="Lou√©, vacant..."
                              />
                            </div>
                            <div>
                              <Label htmlFor={`bien_loyer_${bien.id}`}>Loyer (‚Ç¨/mois)</Label>
                              <Input
                                id={`bien_loyer_${bien.id}`}
                                type="number"
                                value={bien.loyer}
                                onChange={(e) => {
                                  const newBiens = [...partageSuccessoralData.actif.biensImmobiliers];
                                  newBiens[index] = {...bien, loyer: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, biensImmobiliers: newBiens}
                                  });
                                }}
                              />
                            </div>
                            <div className="md:col-span-2">
                              <Label htmlFor={`bien_hypotheques_${bien.id}`}>Hypoth√®ques</Label>
                              <Textarea
                                id={`bien_hypotheques_${bien.id}`}
                                value={bien.hypotheques}
                                onChange={(e) => {
                                  const newBiens = [...partageSuccessoralData.actif.biensImmobiliers];
                                  newBiens[index] = {...bien, hypotheques: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, biensImmobiliers: newBiens}
                                  });
                                }}
                                rows={2}
                              />
                            </div>
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id={`bien_copropriete_${bien.id}`}
                                checked={bien.copropriete}
                                onChange={(e) => {
                                  const newBiens = [...partageSuccessoralData.actif.biensImmobiliers];
                                  newBiens[index] = {...bien, copropriete: e.target.checked};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, biensImmobiliers: newBiens}
                                  });
                                }}
                                className="w-4 h-4"
                              />
                              <Label htmlFor={`bien_copropriete_${bien.id}`}>Copropri√©t√©</Label>
                            </div>

                            {bien.copropriete && (
                              <>
                                <div>
                                  <Label htmlFor={`bien_lots_${bien.id}`}>Lots</Label>
                                  <Input
                                    id={`bien_lots_${bien.id}`}
                                    value={bien.lots}
                                    onChange={(e) => {
                                      const newBiens = [...partageSuccessoralData.actif.biensImmobiliers];
                                      newBiens[index] = {...bien, lots: e.target.value};
                                      setPartageSuccessoralData({
                                        ...partageSuccessoralData,
                                        actif: {...partageSuccessoralData.actif, biensImmobiliers: newBiens}
                                      });
                                    }}
                                  />
                                </div>
                                <div>
                                  <Label htmlFor={`bien_charges_${bien.id}`}>Charges (‚Ç¨/an)</Label>
                                  <Input
                                    id={`bien_charges_${bien.id}`}
                                    type="number"
                                    value={bien.chargesCopro}
                                    onChange={(e) => {
                                      const newBiens = [...partageSuccessoralData.actif.biensImmobiliers];
                                      newBiens[index] = {...bien, chargesCopro: e.target.value};
                                      setPartageSuccessoralData({
                                        ...partageSuccessoralData,
                                        actif: {...partageSuccessoralData.actif, biensImmobiliers: newBiens}
                                      });
                                    }}
                                  />
                                </div>
                              </>
                            )}
                          </div>

                          <div>
                            <Label>Documents du bien (titres, diagnostics...)</Label>
                            <MultiFileUpload
                              label="Titre de propri√©t√©, diagnostics, expertises..."
                              files={partageBienImmobilierFiles[bien.id] || []}
                              onFilesChange={(newFiles) => {
                                setPartageBienImmobilierFiles({
                                  ...partageBienImmobilierFiles,
                                  [bien.id]: newFiles
                                });
                              }}
                            />
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* B. Biens meubles corporels */}
                    <div className="space-y-4 mt-6">
                      <h4 className="font-medium text-md">B. Biens meubles corporels</h4>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="mobilierForfait"
                            checked={partageSuccessoralData.actif.biensMeubles.mobilierForfait5Pct}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              actif: {
                                ...partageSuccessoralData.actif,
                                biensMeubles: {...partageSuccessoralData.actif.biensMeubles, mobilierForfait5Pct: e.target.checked}
                              }
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="mobilierForfait">Mobilier (forfait 5%)</Label>
                        </div>

                        {!partageSuccessoralData.actif.biensMeubles.mobilierForfait5Pct && (
                          <div>
                            <Label htmlFor="mobilierValeur">Valeur r√©elle du mobilier (‚Ç¨)</Label>
                            <Input
                              id="mobilierValeur"
                              type="number"
                              value={partageSuccessoralData.actif.biensMeubles.mobilierValeurReelle}
                              onChange={(e) => setPartageSuccessoralData({
                                ...partageSuccessoralData,
                                actif: {
                                  ...partageSuccessoralData.actif,
                                  biensMeubles: {...partageSuccessoralData.actif.biensMeubles, mobilierValeurReelle: e.target.value}
                                }
                              })}
                            />
                          </div>
                        )}

                        <div className="md:col-span-2">
                          <Label htmlFor="vehicules">V√©hicules</Label>
                          <Textarea
                            id="vehicules"
                            value={partageSuccessoralData.actif.biensMeubles.vehicules}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              actif: {
                                ...partageSuccessoralData.actif,
                                biensMeubles: {...partageSuccessoralData.actif.biensMeubles, vehicules: e.target.value}
                              }
                            })}
                            rows={2}
                            placeholder="Marque, mod√®le, immatriculation, valeur..."
                          />
                        </div>

                        <div>
                          <Label htmlFor="bijoux">Bijoux</Label>
                          <Textarea
                            id="bijoux"
                            value={partageSuccessoralData.actif.biensMeubles.bijoux}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              actif: {
                                ...partageSuccessoralData.actif,
                                biensMeubles: {...partageSuccessoralData.actif.biensMeubles, bijoux: e.target.value}
                              }
                            })}
                            rows={2}
                          />
                        </div>

                        <div>
                          <Label htmlFor="oeuvresArt">≈íuvres d'art</Label>
                          <Textarea
                            id="oeuvresArt"
                            value={partageSuccessoralData.actif.biensMeubles.oeuvresArt}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              actif: {
                                ...partageSuccessoralData.actif,
                                biensMeubles: {...partageSuccessoralData.actif.biensMeubles, oeuvresArt: e.target.value}
                              }
                            })}
                            rows={2}
                          />
                        </div>

                        <div>
                          <Label htmlFor="collections">Collections</Label>
                          <Textarea
                            id="collections"
                            value={partageSuccessoralData.actif.biensMeubles.collections}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              actif: {
                                ...partageSuccessoralData.actif,
                                biensMeubles: {...partageSuccessoralData.actif.biensMeubles, collections: e.target.value}
                              }
                            })}
                            rows={2}
                          />
                        </div>

                        <div>
                          <Label htmlFor="materielPro">Mat√©riel professionnel</Label>
                          <Textarea
                            id="materielPro"
                            value={partageSuccessoralData.actif.biensMeubles.materielProfessionnel}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              actif: {
                                ...partageSuccessoralData.actif,
                                biensMeubles: {...partageSuccessoralData.actif.biensMeubles, materielProfessionnel: e.target.value}
                              }
                            })}
                            rows={2}
                          />
                        </div>
                      </div>
                    </div>

                    {/* C. Comptes bancaires et placements */}
                    <div className="space-y-4 mt-6">
                      <div className="flex justify-between items-center">
                        <h4 className="font-medium text-md flex-1">C. Comptes bancaires et placements</h4>
                        <Button
                          type="button"
                          size="sm"
                          onClick={() => {
                            setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              actif: {
                                ...partageSuccessoralData.actif,
                                comptesBancaires: [...partageSuccessoralData.actif.comptesBancaires, {
                                  id: Date.now(),
                                  banque: "", typeCompte: "", numeroCompte: "",
                                  soldeAuDeces: "", interetsCourus: ""
                                }]
                              }
                            });
                          }}
                          className={`ml-2 ${role === 'notaire' ? 'bg-orange-600 hover:bg-orange-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'}`}
                        >
                          + Ajouter un compte
                        </Button>
                      </div>

                      {partageSuccessoralData.actif.comptesBancaires.map((compte, index) => (
                        <div key={compte.id} className="p-4 border rounded-lg space-y-3 bg-green-50">
                          <div className="flex justify-between items-center">
                            <h5 className="font-medium">Compte {index + 1}</h5>
                            <Button
                              type="button"
                              variant="destructive"
                              size="sm"
                              onClick={() => {
                                const newComptes = partageSuccessoralData.actif.comptesBancaires.filter(c => c.id !== compte.id);
                                setPartageSuccessoralData({
                                  ...partageSuccessoralData,
                                  actif: {...partageSuccessoralData.actif, comptesBancaires: newComptes}
                                });
                              }}
                            >
                              Supprimer
                            </Button>
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div>
                              <Label htmlFor={`compte_banque_${compte.id}`}>Banque</Label>
                              <Input
                                id={`compte_banque_${compte.id}`}
                                value={compte.banque}
                                onChange={(e) => {
                                  const newComptes = [...partageSuccessoralData.actif.comptesBancaires];
                                  newComptes[index] = {...compte, banque: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, comptesBancaires: newComptes}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`compte_type_${compte.id}`}>Type de compte</Label>
                              <Input
                                id={`compte_type_${compte.id}`}
                                value={compte.typeCompte}
                                onChange={(e) => {
                                  const newComptes = [...partageSuccessoralData.actif.comptesBancaires];
                                  newComptes[index] = {...compte, typeCompte: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, comptesBancaires: newComptes}
                                  });
                                }}
                                placeholder="Courant, Livret A, PEL, LDD..."
                              />
                            </div>
                            <div>
                              <Label htmlFor={`compte_numero_${compte.id}`}>N¬∞ de compte</Label>
                              <Input
                                id={`compte_numero_${compte.id}`}
                                value={compte.numeroCompte}
                                onChange={(e) => {
                                  const newComptes = [...partageSuccessoralData.actif.comptesBancaires];
                                  newComptes[index] = {...compte, numeroCompte: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, comptesBancaires: newComptes}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`compte_solde_${compte.id}`}>Solde au d√©c√®s (‚Ç¨)</Label>
                              <Input
                                id={`compte_solde_${compte.id}`}
                                type="number"
                                value={compte.soldeAuDeces}
                                onChange={(e) => {
                                  const newComptes = [...partageSuccessoralData.actif.comptesBancaires];
                                  newComptes[index] = {...compte, soldeAuDeces: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, comptesBancaires: newComptes}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`compte_interets_${compte.id}`}>Int√©r√™ts courus (‚Ç¨)</Label>
                              <Input
                                id={`compte_interets_${compte.id}`}
                                type="number"
                                value={compte.interetsCourus}
                                onChange={(e) => {
                                  const newComptes = [...partageSuccessoralData.actif.comptesBancaires];
                                  newComptes[index] = {...compte, interetsCourus: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, comptesBancaires: newComptes}
                                  });
                                }}
                              />
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* D. Assurance-vie */}
                    <div className="space-y-4 mt-6">
                      <div className="flex justify-between items-center">
                        <h4 className="font-medium text-md flex-1">D. Assurance-vie / Contrats de capitalisation</h4>
                        <Button
                          type="button"
                          size="sm"
                          onClick={() => {
                            setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              actif: {
                                ...partageSuccessoralData.actif,
                                assurancesVie: [...partageSuccessoralData.actif.assurancesVie, {
                                  id: Date.now(),
                                  compagnie: "", numeroContrat: "", beneficiaires: "",
                                  capitalVerse: "", primesAvant70Ans: "", primesApres70Ans: ""
                                }]
                              }
                            });
                          }}
                          className={`ml-2 ${role === 'notaire' ? 'bg-orange-600 hover:bg-orange-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'}`}
                        >
                          + Ajouter un contrat
                        </Button>
                      </div>

                      <p className="text-sm text-gray-600 italic">
                        ‚ÑπÔ∏è Les assurances-vie ne rentrent pas dans le partage, mais doivent √™tre mentionn√©es
                      </p>

                      {partageSuccessoralData.actif.assurancesVie.map((assurance, index) => (
                        <div key={assurance.id} className="p-4 border rounded-lg space-y-3 bg-yellow-50">
                          <div className="flex justify-between items-center">
                            <h5 className="font-medium">Contrat {index + 1}</h5>
                            <Button
                              type="button"
                              variant="destructive"
                              size="sm"
                              onClick={() => {
                                const newAssurances = partageSuccessoralData.actif.assurancesVie.filter(a => a.id !== assurance.id);
                                setPartageSuccessoralData({
                                  ...partageSuccessoralData,
                                  actif: {...partageSuccessoralData.actif, assurancesVie: newAssurances}
                                });
                              }}
                            >
                              Supprimer
                            </Button>
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div>
                              <Label htmlFor={`assurance_compagnie_${assurance.id}`}>Compagnie</Label>
                              <Input
                                id={`assurance_compagnie_${assurance.id}`}
                                value={assurance.compagnie}
                                onChange={(e) => {
                                  const newAssurances = [...partageSuccessoralData.actif.assurancesVie];
                                  newAssurances[index] = {...assurance, compagnie: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, assurancesVie: newAssurances}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`assurance_numero_${assurance.id}`}>N¬∞ de contrat</Label>
                              <Input
                                id={`assurance_numero_${assurance.id}`}
                                value={assurance.numeroContrat}
                                onChange={(e) => {
                                  const newAssurances = [...partageSuccessoralData.actif.assurancesVie];
                                  newAssurances[index] = {...assurance, numeroContrat: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, assurancesVie: newAssurances}
                                  });
                                }}
                              />
                            </div>
                            <div className="md:col-span-2">
                              <Label htmlFor={`assurance_beneficiaires_${assurance.id}`}>B√©n√©ficiaires</Label>
                              <Input
                                id={`assurance_beneficiaires_${assurance.id}`}
                                value={assurance.beneficiaires}
                                onChange={(e) => {
                                  const newAssurances = [...partageSuccessoralData.actif.assurancesVie];
                                  newAssurances[index] = {...assurance, beneficiaires: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, assurancesVie: newAssurances}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`assurance_capital_${assurance.id}`}>Capital vers√© (‚Ç¨)</Label>
                              <Input
                                id={`assurance_capital_${assurance.id}`}
                                type="number"
                                value={assurance.capitalVerse}
                                onChange={(e) => {
                                  const newAssurances = [...partageSuccessoralData.actif.assurancesVie];
                                  newAssurances[index] = {...assurance, capitalVerse: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, assurancesVie: newAssurances}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`assurance_primesAvant70_${assurance.id}`}>Primes avant 70 ans (‚Ç¨)</Label>
                              <Input
                                id={`assurance_primesAvant70_${assurance.id}`}
                                type="number"
                                value={assurance.primesAvant70Ans}
                                onChange={(e) => {
                                  const newAssurances = [...partageSuccessoralData.actif.assurancesVie];
                                  newAssurances[index] = {...assurance, primesAvant70Ans: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, assurancesVie: newAssurances}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`assurance_primesApres70_${assurance.id}`}>Primes apr√®s 70 ans (‚Ç¨)</Label>
                              <Input
                                id={`assurance_primesApres70_${assurance.id}`}
                                type="number"
                                value={assurance.primesApres70Ans}
                                onChange={(e) => {
                                  const newAssurances = [...partageSuccessoralData.actif.assurancesVie];
                                  newAssurances[index] = {...assurance, primesApres70Ans: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, assurancesVie: newAssurances}
                                  });
                                }}
                              />
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* E. Parts sociales / Entreprises */}
                    <div className="space-y-4 mt-6">
                      <div className="flex justify-between items-center">
                        <h4 className="font-medium text-md flex-1">E. Parts sociales / Entreprises</h4>
                        <Button
                          type="button"
                          size="sm"
                          onClick={() => {
                            setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              actif: {
                                ...partageSuccessoralData.actif,
                                partsSociales: [...partageSuccessoralData.actif.partsSociales, {
                                  id: Date.now(),
                                  nature: "", nomEntite: "", nombreParts: "",
                                  valeurEstimee: "", droitsAttaches: "", pacteDutreil: false
                                }]
                              }
                            });
                          }}
                          className={`ml-2 ${role === 'notaire' ? 'bg-orange-600 hover:bg-orange-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'}`}
                        >
                          + Ajouter une entit√©
                        </Button>
                      </div>

                      {partageSuccessoralData.actif.partsSociales.map((parts, index) => (
                        <div key={parts.id} className="p-4 border rounded-lg space-y-3 bg-purple-50">
                          <div className="flex justify-between items-center">
                            <h5 className="font-medium">Entit√© {index + 1}</h5>
                            <Button
                              type="button"
                              variant="destructive"
                              size="sm"
                              onClick={() => {
                                const newParts = partageSuccessoralData.actif.partsSociales.filter(p => p.id !== parts.id);
                                setPartageSuccessoralData({
                                  ...partageSuccessoralData,
                                  actif: {...partageSuccessoralData.actif, partsSociales: newParts}
                                });
                              }}
                            >
                              Supprimer
                            </Button>
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div>
                              <Label htmlFor={`parts_nature_${parts.id}`}>Nature</Label>
                              <select
                                id={`parts_nature_${parts.id}`}
                                value={parts.nature}
                                onChange={(e) => {
                                  const newParts = [...partageSuccessoralData.actif.partsSociales];
                                  newParts[index] = {...parts, nature: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, partsSociales: newParts}
                                  });
                                }}
                                className="w-full px-3 py-2 border rounded-md"
                              >
                                <option value="">-- S√©lectionner --</option>
                                <option value="SARL">SARL</option>
                                <option value="SAS">SAS</option>
                                <option value="SCI">SCI</option>
                                <option value="EI">Entreprise Individuelle</option>
                                <option value="exploitation_agricole">Exploitation agricole</option>
                              </select>
                            </div>
                            <div>
                              <Label htmlFor={`parts_nom_${parts.id}`}>Nom de l'entit√©</Label>
                              <Input
                                id={`parts_nom_${parts.id}`}
                                value={parts.nomEntite}
                                onChange={(e) => {
                                  const newParts = [...partageSuccessoralData.actif.partsSociales];
                                  newParts[index] = {...parts, nomEntite: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, partsSociales: newParts}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`parts_nombre_${parts.id}`}>Nombre de parts</Label>
                              <Input
                                id={`parts_nombre_${parts.id}`}
                                type="number"
                                value={parts.nombreParts}
                                onChange={(e) => {
                                  const newParts = [...partageSuccessoralData.actif.partsSociales];
                                  newParts[index] = {...parts, nombreParts: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, partsSociales: newParts}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`parts_valeur_${parts.id}`}>Valeur estim√©e (‚Ç¨)</Label>
                              <Input
                                id={`parts_valeur_${parts.id}`}
                                type="number"
                                value={parts.valeurEstimee}
                                onChange={(e) => {
                                  const newParts = [...partageSuccessoralData.actif.partsSociales];
                                  newParts[index] = {...parts, valeurEstimee: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, partsSociales: newParts}
                                  });
                                }}
                              />
                            </div>
                            <div className="md:col-span-2">
                              <Label htmlFor={`parts_droits_${parts.id}`}>Droits attach√©s</Label>
                              <Textarea
                                id={`parts_droits_${parts.id}`}
                                value={parts.droitsAttaches}
                                onChange={(e) => {
                                  const newParts = [...partageSuccessoralData.actif.partsSociales];
                                  newParts[index] = {...parts, droitsAttaches: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, partsSociales: newParts}
                                  });
                                }}
                                rows={2}
                              />
                            </div>
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id={`parts_dutreil_${parts.id}`}
                                checked={parts.pacteDutreil}
                                onChange={(e) => {
                                  const newParts = [...partageSuccessoralData.actif.partsSociales];
                                  newParts[index] = {...parts, pacteDutreil: e.target.checked};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, partsSociales: newParts}
                                  });
                                }}
                                className="w-4 h-4"
                              />
                              <Label htmlFor={`parts_dutreil_${parts.id}`}>Pacte Dutreil</Label>
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* F. Biens √† l'√©tranger */}
                    <div className="space-y-4 mt-6">
                      <div className="flex justify-between items-center">
                        <h4 className="font-medium text-md flex-1">F. Biens √† l'√©tranger</h4>
                        <Button
                          type="button"
                          size="sm"
                          onClick={() => {
                            setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              actif: {
                                ...partageSuccessoralData.actif,
                                biensEtranger: [...partageSuccessoralData.actif.biensEtranger, {
                                  id: Date.now(),
                                  pays: "", adresse: "", valeur: "", regimeFiscal: ""
                                }]
                              }
                            });
                          }}
                          className={`ml-2 ${role === 'notaire' ? 'bg-orange-600 hover:bg-orange-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'}`}
                        >
                          + Ajouter un bien
                        </Button>
                      </div>

                      {partageSuccessoralData.actif.biensEtranger.map((bien, index) => (
                        <div key={bien.id} className="p-4 border rounded-lg space-y-3 bg-red-50">
                          <div className="flex justify-between items-center">
                            <h5 className="font-medium">Bien √† l'√©tranger {index + 1}</h5>
                            <Button
                              type="button"
                              variant="destructive"
                              size="sm"
                              onClick={() => {
                                const newBiens = partageSuccessoralData.actif.biensEtranger.filter(b => b.id !== bien.id);
                                setPartageSuccessoralData({
                                  ...partageSuccessoralData,
                                  actif: {...partageSuccessoralData.actif, biensEtranger: newBiens}
                                });
                              }}
                            >
                              Supprimer
                            </Button>
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div>
                              <Label htmlFor={`bienEtranger_pays_${bien.id}`}>Pays</Label>
                              <Input
                                id={`bienEtranger_pays_${bien.id}`}
                                value={bien.pays}
                                onChange={(e) => {
                                  const newBiens = [...partageSuccessoralData.actif.biensEtranger];
                                  newBiens[index] = {...bien, pays: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, biensEtranger: newBiens}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`bienEtranger_valeur_${bien.id}`}>Valeur (‚Ç¨)</Label>
                              <Input
                                id={`bienEtranger_valeur_${bien.id}`}
                                type="number"
                                value={bien.valeur}
                                onChange={(e) => {
                                  const newBiens = [...partageSuccessoralData.actif.biensEtranger];
                                  newBiens[index] = {...bien, valeur: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, biensEtranger: newBiens}
                                  });
                                }}
                              />
                            </div>
                            <div className="md:col-span-2">
                              <Label htmlFor={`bienEtranger_adresse_${bien.id}`}>Adresse</Label>
                              <Input
                                id={`bienEtranger_adresse_${bien.id}`}
                                value={bien.adresse}
                                onChange={(e) => {
                                  const newBiens = [...partageSuccessoralData.actif.biensEtranger];
                                  newBiens[index] = {...bien, adresse: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, biensEtranger: newBiens}
                                  });
                                }}
                              />
                            </div>
                            <div className="md:col-span-2">
                              <Label htmlFor={`bienEtranger_regime_${bien.id}`}>R√©gime fiscal / Convention</Label>
                              <Textarea
                                id={`bienEtranger_regime_${bien.id}`}
                                value={bien.regimeFiscal}
                                onChange={(e) => {
                                  const newBiens = [...partageSuccessoralData.actif.biensEtranger];
                                  newBiens[index] = {...bien, regimeFiscal: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, biensEtranger: newBiens}
                                  });
                                }}
                                rows={2}
                              />
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* G. Usufruit / Nue-propri√©t√© */}
                    <div className="space-y-4 mt-6">
                      <div className="flex justify-between items-center">
                        <h4 className="font-medium text-md flex-1">G. Usufruit / Nue-propri√©t√©</h4>
                        <Button
                          type="button"
                          size="sm"
                          onClick={() => {
                            setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              actif: {
                                ...partageSuccessoralData.actif,
                                usufruitNuePropriete: [...partageSuccessoralData.actif.usufruitNuePropriete, {
                                  id: Date.now(),
                                  bienConcerne: "", valeurUsufruit: "",
                                  valeurNuePropriete: "", baremeFiscal: ""
                                }]
                              }
                            });
                          }}
                          className={`ml-2 ${role === 'notaire' ? 'bg-orange-600 hover:bg-orange-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'}`}
                        >
                          + Ajouter un d√©membrement
                        </Button>
                      </div>

                      {partageSuccessoralData.actif.usufruitNuePropriete.map((demembrement, index) => (
                        <div key={demembrement.id} className="p-4 border rounded-lg space-y-3 bg-indigo-50">
                          <div className="flex justify-between items-center">
                            <h5 className="font-medium">D√©membrement {index + 1}</h5>
                            <Button
                              type="button"
                              variant="destructive"
                              size="sm"
                              onClick={() => {
                                const newDemembrement = partageSuccessoralData.actif.usufruitNuePropriete.filter(d => d.id !== demembrement.id);
                                setPartageSuccessoralData({
                                  ...partageSuccessoralData,
                                  actif: {...partageSuccessoralData.actif, usufruitNuePropriete: newDemembrement}
                                });
                              }}
                            >
                              Supprimer
                            </Button>
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div className="md:col-span-2">
                              <Label htmlFor={`demembrement_bien_${demembrement.id}`}>Bien concern√©</Label>
                              <Input
                                id={`demembrement_bien_${demembrement.id}`}
                                value={demembrement.bienConcerne}
                                onChange={(e) => {
                                  const newDemembrement = [...partageSuccessoralData.actif.usufruitNuePropriete];
                                  newDemembrement[index] = {...demembrement, bienConcerne: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, usufruitNuePropriete: newDemembrement}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`demembrement_usufruit_${demembrement.id}`}>Valeur usufruit (‚Ç¨)</Label>
                              <Input
                                id={`demembrement_usufruit_${demembrement.id}`}
                                type="number"
                                value={demembrement.valeurUsufruit}
                                onChange={(e) => {
                                  const newDemembrement = [...partageSuccessoralData.actif.usufruitNuePropriete];
                                  newDemembrement[index] = {...demembrement, valeurUsufruit: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, usufruitNuePropriete: newDemembrement}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`demembrement_nuePropriete_${demembrement.id}`}>Valeur nue-propri√©t√© (‚Ç¨)</Label>
                              <Input
                                id={`demembrement_nuePropriete_${demembrement.id}`}
                                type="number"
                                value={demembrement.valeurNuePropriete}
                                onChange={(e) => {
                                  const newDemembrement = [...partageSuccessoralData.actif.usufruitNuePropriete];
                                  newDemembrement[index] = {...demembrement, valeurNuePropriete: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, usufruitNuePropriete: newDemembrement}
                                  });
                                }}
                              />
                            </div>
                            <div className="md:col-span-2">
                              <Label htmlFor={`demembrement_bareme_${demembrement.id}`}>Bar√®me fiscal selon √¢ge</Label>
                              <Input
                                id={`demembrement_bareme_${demembrement.id}`}
                                value={demembrement.baremeFiscal}
                                onChange={(e) => {
                                  const newDemembrement = [...partageSuccessoralData.actif.usufruitNuePropriete];
                                  newDemembrement[index] = {...demembrement, baremeFiscal: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    actif: {...partageSuccessoralData.actif, usufruitNuePropriete: newDemembrement}
                                  });
                                }}
                                placeholder="Ex: 40% / 60% (selon √¢ge)"
                              />
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>

                  </div>

                  {/* SECTION 4 : PASSIF SUCCESSORAL */}
                  <div className="mt-8 p-6 border rounded-lg bg-orange-50">
                    <h3 className="text-lg font-semibold mb-4">4. Passif successoral</h3>

                    {/* Dettes */}
                    <div className="space-y-4">
                      <div className="flex justify-between items-center">
                        <h4 className="font-medium text-md flex-1">Dettes du d√©funt</h4>
                        <Button
                          type="button"
                          size="sm"
                          onClick={() => {
                            setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              passif: {
                                ...partageSuccessoralData.passif,
                                dettes: [...partageSuccessoralData.passif.dettes, {
                                  id: Date.now(),
                                  nature: "", creancier: "", montant: "", dateExigibilite: ""
                                }]
                              }
                            });
                          }}
                          className={`ml-2 ${role === 'notaire' ? 'bg-orange-600 hover:bg-orange-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'}`}
                        >
                          + Ajouter une dette
                        </Button>
                      </div>

                      {partageSuccessoralData.passif.dettes.map((dette, index) => (
                        <div key={dette.id} className="p-4 border rounded-lg space-y-3 bg-white">
                          <div className="flex justify-between items-center">
                            <h5 className="font-medium">Dette {index + 1}</h5>
                            <Button
                              type="button"
                              variant="destructive"
                              size="sm"
                              onClick={() => {
                                const newDettes = partageSuccessoralData.passif.dettes.filter(d => d.id !== dette.id);
                                setPartageSuccessoralData({
                                  ...partageSuccessoralData,
                                  passif: {...partageSuccessoralData.passif, dettes: newDettes}
                                });
                              }}
                            >
                              Supprimer
                            </Button>
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div>
                              <Label htmlFor={`dette_nature_${dette.id}`}>Nature de la dette</Label>
                              <Input
                                id={`dette_nature_${dette.id}`}
                                value={dette.nature}
                                onChange={(e) => {
                                  const newDettes = [...partageSuccessoralData.passif.dettes];
                                  newDettes[index] = {...dette, nature: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    passif: {...partageSuccessoralData.passif, dettes: newDettes}
                                  });
                                }}
                                placeholder="Ex: Pr√™t immobilier, cr√©dit √† la consommation"
                              />
                            </div>
                            <div>
                              <Label htmlFor={`dette_creancier_${dette.id}`}>Cr√©ancier</Label>
                              <Input
                                id={`dette_creancier_${dette.id}`}
                                value={dette.creancier}
                                onChange={(e) => {
                                  const newDettes = [...partageSuccessoralData.passif.dettes];
                                  newDettes[index] = {...dette, creancier: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    passif: {...partageSuccessoralData.passif, dettes: newDettes}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`dette_montant_${dette.id}`}>Montant (‚Ç¨)</Label>
                              <Input
                                id={`dette_montant_${dette.id}`}
                                type="number"
                                value={dette.montant}
                                onChange={(e) => {
                                  const newDettes = [...partageSuccessoralData.passif.dettes];
                                  newDettes[index] = {...dette, montant: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    passif: {...partageSuccessoralData.passif, dettes: newDettes}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`dette_date_${dette.id}`}>Date d'exigibilit√©</Label>
                              <Input
                                id={`dette_date_${dette.id}`}
                                type="date"
                                value={dette.dateExigibilite}
                                onChange={(e) => {
                                  const newDettes = [...partageSuccessoralData.passif.dettes];
                                  newDettes[index] = {...dette, dateExigibilite: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    passif: {...partageSuccessoralData.passif, dettes: newDettes}
                                  });
                                }}
                              />
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* Frais fun√©raires */}
                    <div className="mt-4">
                      <Label htmlFor="fraisFuneraires">Frais fun√©raires (‚Ç¨)</Label>
                      <Input
                        id="fraisFuneraires"
                        type="number"
                        value={partageSuccessoralData.passif.fraisFuneraires}
                        onChange={(e) => setPartageSuccessoralData({
                          ...partageSuccessoralData,
                          passif: {...partageSuccessoralData.passif, fraisFuneraires: e.target.value}
                        })}
                      />
                    </div>

                    {/* Frais derni√®re maladie */}
                    <div className="mt-4">
                      <Label htmlFor="fraisDerniereMaladie">Frais de derni√®re maladie (‚Ç¨)</Label>
                      <Input
                        id="fraisDerniereMaladie"
                        type="number"
                        value={partageSuccessoralData.passif.fraisDerniereMaladie}
                        onChange={(e) => setPartageSuccessoralData({
                          ...partageSuccessoralData,
                          passif: {...partageSuccessoralData.passif, fraisDerniereMaladie: e.target.value}
                        })}
                      />
                    </div>

                    {/* Imp√¥ts */}
                    <div className="mt-4 space-y-3">
                      <h4 className="font-medium text-md">Imp√¥ts et taxes</h4>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <div>
                          <Label htmlFor="impotsRevenus">Imp√¥ts sur les revenus (‚Ç¨)</Label>
                          <Input
                            id="impotsRevenus"
                            type="number"
                            value={partageSuccessoralData.passif.impots.revenus}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              passif: {
                                ...partageSuccessoralData.passif,
                                impots: {...partageSuccessoralData.passif.impots, revenus: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="impotsFonciers">Imp√¥ts fonciers (‚Ç¨)</Label>
                          <Input
                            id="impotsFonciers"
                            type="number"
                            value={partageSuccessoralData.passif.impots.fonciers}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              passif: {
                                ...partageSuccessoralData.passif,
                                impots: {...partageSuccessoralData.passif.impots, fonciers: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="taxeHabitation">Taxe d'habitation (‚Ç¨)</Label>
                          <Input
                            id="taxeHabitation"
                            type="number"
                            value={partageSuccessoralData.passif.impots.habitation}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              passif: {
                                ...partageSuccessoralData.passif,
                                impots: {...partageSuccessoralData.passif.impots, habitation: e.target.value}
                              }
                            })}
                          />
                        </div>
                        <div>
                          <Label htmlFor="autresImpots">Autres imp√¥ts (‚Ç¨)</Label>
                          <Input
                            id="autresImpots"
                            type="number"
                            value={partageSuccessoralData.passif.impots.autres}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              passif: {
                                ...partageSuccessoralData.passif,
                                impots: {...partageSuccessoralData.passif.impots, autres: e.target.value}
                              }
                            })}
                          />
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* SECTION 5 : TYPE DE PARTAGE ET CR√âATION DES LOTS */}
                  <div className="mt-8 p-6 border rounded-lg bg-teal-50">
                    <h3 className="text-lg font-semibold mb-4">5. Type de partage et cr√©ation des lots</h3>

                    {/* Type de partage */}
                    <div className="mb-6">
                      <Label className="text-md font-medium mb-2 block">Type de partage</Label>
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="partage_amiable"
                            name="typePartage"
                            value="amiable"
                            checked={partageSuccessoralData.partage.typePartage === "amiable"}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              partage: {...partageSuccessoralData.partage, typePartage: e.target.value}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="partage_amiable">Amiable</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="partage_judiciaire"
                            name="typePartage"
                            value="judiciaire"
                            checked={partageSuccessoralData.partage.typePartage === "judiciaire"}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              partage: {...partageSuccessoralData.partage, typePartage: e.target.value}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="partage_judiciaire">Judiciaire</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="partage_attribution_integrale"
                            name="typePartage"
                            value="attribution_integrale"
                            checked={partageSuccessoralData.partage.typePartage === "attribution_integrale"}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              partage: {...partageSuccessoralData.partage, typePartage: e.target.value}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="partage_attribution_integrale">Attribution int√©grale √† un h√©ritier</Label>
                        </div>
                      </div>
                    </div>

                    {/* Lots */}
                    <div className="space-y-4">
                      <div className="flex justify-between items-center">
                        <h4 className="font-medium text-md flex-1">Composition des lots</h4>
                        <Button
                          type="button"
                          size="sm"
                          onClick={() => {
                            setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              partage: {
                                ...partageSuccessoralData.partage,
                                lots: [...partageSuccessoralData.partage.lots, {
                                  id: Date.now(),
                                  numero: partageSuccessoralData.partage.lots.length + 1,
                                  heritierAttributaire: "",
                                  biensInclus: "",
                                  valeurTotale: ""
                                }]
                              }
                            });
                          }}
                          className={`ml-2 ${role === 'notaire' ? 'bg-orange-600 hover:bg-orange-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'}`}
                        >
                          + Ajouter un lot
                        </Button>
                      </div>

                      {partageSuccessoralData.partage.lots.map((lot, index) => (
                        <div key={lot.id} className="p-4 border rounded-lg space-y-3 bg-white">
                          <div className="flex justify-between items-center">
                            <h5 className="font-medium">Lot {lot.numero}</h5>
                            <Button
                              type="button"
                              variant="destructive"
                              size="sm"
                              onClick={() => {
                                const newLots = partageSuccessoralData.partage.lots.filter(l => l.id !== lot.id);
                                setPartageSuccessoralData({
                                  ...partageSuccessoralData,
                                  partage: {...partageSuccessoralData.partage, lots: newLots}
                                });
                              }}
                            >
                              Supprimer
                            </Button>
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div>
                              <Label htmlFor={`lot_heritier_${lot.id}`}>H√©ritier attributaire</Label>
                              <Input
                                id={`lot_heritier_${lot.id}`}
                                value={lot.heritierAttributaire}
                                onChange={(e) => {
                                  const newLots = [...partageSuccessoralData.partage.lots];
                                  newLots[index] = {...lot, heritierAttributaire: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    partage: {...partageSuccessoralData.partage, lots: newLots}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`lot_valeur_${lot.id}`}>Valeur totale (‚Ç¨)</Label>
                              <Input
                                id={`lot_valeur_${lot.id}`}
                                type="number"
                                value={lot.valeurTotale}
                                onChange={(e) => {
                                  const newLots = [...partageSuccessoralData.partage.lots];
                                  newLots[index] = {...lot, valeurTotale: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    partage: {...partageSuccessoralData.partage, lots: newLots}
                                  });
                                }}
                              />
                            </div>
                            <div className="md:col-span-2">
                              <Label htmlFor={`lot_biens_${lot.id}`}>Biens inclus</Label>
                              <Textarea
                                id={`lot_biens_${lot.id}`}
                                value={lot.biensInclus}
                                onChange={(e) => {
                                  const newLots = [...partageSuccessoralData.partage.lots];
                                  newLots[index] = {...lot, biensInclus: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    partage: {...partageSuccessoralData.partage, lots: newLots}
                                  });
                                }}
                                rows={3}
                                placeholder="D√©taillez les biens composant ce lot"
                              />
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* Attributions pr√©f√©rentielles */}
                    <div className="mt-6 space-y-4">
                      <div className="flex justify-between items-center">
                        <h4 className="font-medium text-md flex-1">Attributions pr√©f√©rentielles</h4>
                        <Button
                          type="button"
                          size="sm"
                          onClick={() => {
                            setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              partage: {
                                ...partageSuccessoralData.partage,
                                attributionsPreferentielles: [...partageSuccessoralData.partage.attributionsPreferentielles, {
                                  id: Date.now(),
                                  heritier: "",
                                  bien: "",
                                  justification: ""
                                }]
                              }
                            });
                          }}
                          className={`ml-2 ${role === 'notaire' ? 'bg-orange-600 hover:bg-orange-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'}`}
                        >
                          + Ajouter une attribution
                        </Button>
                      </div>

                      {partageSuccessoralData.partage.attributionsPreferentielles.map((attribution, index) => (
                        <div key={attribution.id} className="p-4 border rounded-lg space-y-3 bg-white">
                          <div className="flex justify-between items-center">
                            <h5 className="font-medium">Attribution {index + 1}</h5>
                            <Button
                              type="button"
                              variant="destructive"
                              size="sm"
                              onClick={() => {
                                const newAttrib = partageSuccessoralData.partage.attributionsPreferentielles.filter(a => a.id !== attribution.id);
                                setPartageSuccessoralData({
                                  ...partageSuccessoralData,
                                  partage: {...partageSuccessoralData.partage, attributionsPreferentielles: newAttrib}
                                });
                              }}
                            >
                              Supprimer
                            </Button>
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div>
                              <Label htmlFor={`attrib_heritier_${attribution.id}`}>H√©ritier</Label>
                              <Input
                                id={`attrib_heritier_${attribution.id}`}
                                value={attribution.heritier}
                                onChange={(e) => {
                                  const newAttrib = [...partageSuccessoralData.partage.attributionsPreferentielles];
                                  newAttrib[index] = {...attribution, heritier: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    partage: {...partageSuccessoralData.partage, attributionsPreferentielles: newAttrib}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`attrib_bien_${attribution.id}`}>Bien concern√©</Label>
                              <Input
                                id={`attrib_bien_${attribution.id}`}
                                value={attribution.bien}
                                onChange={(e) => {
                                  const newAttrib = [...partageSuccessoralData.partage.attributionsPreferentielles];
                                  newAttrib[index] = {...attribution, bien: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    partage: {...partageSuccessoralData.partage, attributionsPreferentielles: newAttrib}
                                  });
                                }}
                              />
                            </div>
                            <div className="md:col-span-2">
                              <Label htmlFor={`attrib_justif_${attribution.id}`}>Justification</Label>
                              <Textarea
                                id={`attrib_justif_${attribution.id}`}
                                value={attribution.justification}
                                onChange={(e) => {
                                  const newAttrib = [...partageSuccessoralData.partage.attributionsPreferentielles];
                                  newAttrib[index] = {...attribution, justification: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    partage: {...partageSuccessoralData.partage, attributionsPreferentielles: newAttrib}
                                  });
                                }}
                                rows={2}
                                placeholder="Ex: Logement familial, exploitation agricole"
                              />
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* Donations √† rapporter */}
                    <div className="mt-6 space-y-4">
                      <div className="flex justify-between items-center">
                        <h4 className="font-medium text-md flex-1">Donations ant√©rieures √† rapporter</h4>
                        <Button
                          type="button"
                          size="sm"
                          onClick={() => {
                            setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              partage: {
                                ...partageSuccessoralData.partage,
                                donationsARapporter: [...partageSuccessoralData.partage.donationsARapporter, {
                                  id: Date.now(),
                                  donataire: "",
                                  dateDonation: "",
                                  nature: "",
                                  valeur: ""
                                }]
                              }
                            });
                          }}
                          className={`ml-2 ${role === 'notaire' ? 'bg-orange-600 hover:bg-orange-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'}`}
                        >
                          + Ajouter une donation
                        </Button>
                      </div>

                      {partageSuccessoralData.partage.donationsARapporter.map((donation, index) => (
                        <div key={donation.id} className="p-4 border rounded-lg space-y-3 bg-white">
                          <div className="flex justify-between items-center">
                            <h5 className="font-medium">Donation {index + 1}</h5>
                            <Button
                              type="button"
                              variant="destructive"
                              size="sm"
                              onClick={() => {
                                const newDonations = partageSuccessoralData.partage.donationsARapporter.filter(d => d.id !== donation.id);
                                setPartageSuccessoralData({
                                  ...partageSuccessoralData,
                                  partage: {...partageSuccessoralData.partage, donationsARapporter: newDonations}
                                });
                              }}
                            >
                              Supprimer
                            </Button>
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div>
                              <Label htmlFor={`donation_donataire_${donation.id}`}>Donataire</Label>
                              <Input
                                id={`donation_donataire_${donation.id}`}
                                value={donation.donataire}
                                onChange={(e) => {
                                  const newDonations = [...partageSuccessoralData.partage.donationsARapporter];
                                  newDonations[index] = {...donation, donataire: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    partage: {...partageSuccessoralData.partage, donationsARapporter: newDonations}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`donation_date_${donation.id}`}>Date de la donation</Label>
                              <Input
                                id={`donation_date_${donation.id}`}
                                type="date"
                                value={donation.dateDonation}
                                onChange={(e) => {
                                  const newDonations = [...partageSuccessoralData.partage.donationsARapporter];
                                  newDonations[index] = {...donation, dateDonation: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    partage: {...partageSuccessoralData.partage, donationsARapporter: newDonations}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`donation_nature_${donation.id}`}>Nature du bien</Label>
                              <Input
                                id={`donation_nature_${donation.id}`}
                                value={donation.nature}
                                onChange={(e) => {
                                  const newDonations = [...partageSuccessoralData.partage.donationsARapporter];
                                  newDonations[index] = {...donation, nature: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    partage: {...partageSuccessoralData.partage, donationsARapporter: newDonations}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`donation_valeur_${donation.id}`}>Valeur √† rapporter (‚Ç¨)</Label>
                              <Input
                                id={`donation_valeur_${donation.id}`}
                                type="number"
                                value={donation.valeur}
                                onChange={(e) => {
                                  const newDonations = [...partageSuccessoralData.partage.donationsARapporter];
                                  newDonations[index] = {...donation, valeur: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    partage: {...partageSuccessoralData.partage, donationsARapporter: newDonations}
                                  });
                                }}
                              />
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* Soultes */}
                    <div className="mt-6 space-y-4">
                      <div className="flex justify-between items-center">
                        <h4 className="font-medium text-md flex-1">Soultes et compensations</h4>
                        <Button
                          type="button"
                          size="sm"
                          onClick={() => {
                            setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              partage: {
                                ...partageSuccessoralData.partage,
                                soultes: [...partageSuccessoralData.partage.soultes, {
                                  id: Date.now(),
                                  debiteur: "",
                                  creancier: "",
                                  montant: "",
                                  modalitesPaiement: ""
                                }]
                              }
                            });
                          }}
                          className={`ml-2 ${role === 'notaire' ? 'bg-orange-600 hover:bg-orange-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'}`}
                        >
                          + Ajouter une soulte
                        </Button>
                      </div>

                      {partageSuccessoralData.partage.soultes.map((soulte, index) => (
                        <div key={soulte.id} className="p-4 border rounded-lg space-y-3 bg-white">
                          <div className="flex justify-between items-center">
                            <h5 className="font-medium">Soulte {index + 1}</h5>
                            <Button
                              type="button"
                              variant="destructive"
                              size="sm"
                              onClick={() => {
                                const newSoultes = partageSuccessoralData.partage.soultes.filter(s => s.id !== soulte.id);
                                setPartageSuccessoralData({
                                  ...partageSuccessoralData,
                                  partage: {...partageSuccessoralData.partage, soultes: newSoultes}
                                });
                              }}
                            >
                              Supprimer
                            </Button>
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div>
                              <Label htmlFor={`soulte_debiteur_${soulte.id}`}>D√©biteur</Label>
                              <Input
                                id={`soulte_debiteur_${soulte.id}`}
                                value={soulte.debiteur}
                                onChange={(e) => {
                                  const newSoultes = [...partageSuccessoralData.partage.soultes];
                                  newSoultes[index] = {...soulte, debiteur: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    partage: {...partageSuccessoralData.partage, soultes: newSoultes}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`soulte_creancier_${soulte.id}`}>Cr√©ancier</Label>
                              <Input
                                id={`soulte_creancier_${soulte.id}`}
                                value={soulte.creancier}
                                onChange={(e) => {
                                  const newSoultes = [...partageSuccessoralData.partage.soultes];
                                  newSoultes[index] = {...soulte, creancier: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    partage: {...partageSuccessoralData.partage, soultes: newSoultes}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`soulte_montant_${soulte.id}`}>Montant (‚Ç¨)</Label>
                              <Input
                                id={`soulte_montant_${soulte.id}`}
                                type="number"
                                value={soulte.montant}
                                onChange={(e) => {
                                  const newSoultes = [...partageSuccessoralData.partage.soultes];
                                  newSoultes[index] = {...soulte, montant: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    partage: {...partageSuccessoralData.partage, soultes: newSoultes}
                                  });
                                }}
                              />
                            </div>
                            <div>
                              <Label htmlFor={`soulte_modalites_${soulte.id}`}>Modalit√©s de paiement</Label>
                              <Input
                                id={`soulte_modalites_${soulte.id}`}
                                value={soulte.modalitesPaiement}
                                onChange={(e) => {
                                  const newSoultes = [...partageSuccessoralData.partage.soultes];
                                  newSoultes[index] = {...soulte, modalitesPaiement: e.target.value};
                                  setPartageSuccessoralData({
                                    ...partageSuccessoralData,
                                    partage: {...partageSuccessoralData.partage, soultes: newSoultes}
                                  });
                                }}
                                placeholder="Ex: Comptant, √©ch√©ancier"
                              />
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>

                  {/* SECTION 6 : D√âCLARATIONS ET CLAUSES */}
                  <div className="mt-8 p-6 border rounded-lg bg-pink-50">
                    <h3 className="text-lg font-semibold mb-4">6. D√©clarations et clauses particuli√®res</h3>

                    <div className="space-y-3">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="declarationNonOmission"
                          checked={partageSuccessoralData.declarations.nonOmissionBiens}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, nonOmissionBiens: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="declarationNonOmission">D√©claration de non-omission de biens</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="accordUnanimeTousParts"
                          checked={partageSuccessoralData.declarations.accordUnanimeTousParts}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, accordUnanimeTousParts: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="accordUnanimeTousParts">Accord unanime de toutes les parties</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="renoncationRecours"
                          checked={partageSuccessoralData.declarations.renoncationRecours}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, renoncationRecours: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="renoncationRecours">Renonciation √† tout recours</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="garantieEviction"
                          checked={partageSuccessoralData.declarations.garantieEviction}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, garantieEviction: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="garantieEviction">Garantie d'√©viction</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="maintenIndivision"
                          checked={partageSuccessoralData.declarations.maintenIndivision}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, maintenIndivision: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="maintenIndivision">Maintien en indivision de certains biens</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="egaliteEnValeur"
                          checked={partageSuccessoralData.declarations.egaliteEnValeur}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, egaliteEnValeur: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="egaliteEnValeur">√âgalit√© en valeur des lots</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="reserveHereditaire"
                          checked={partageSuccessoralData.declarations.reserveHereditaire}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, reserveHereditaire: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="reserveHereditaire">Respect de la r√©serve h√©r√©ditaire</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="quotiteDisponible"
                          checked={partageSuccessoralData.declarations.quotiteDisponible}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, quotiteDisponible: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="quotiteDisponible">Respect de la quotit√© disponible</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="prixValeurs"
                          checked={partageSuccessoralData.declarations.prixValeurs}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, prixValeurs: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="prixValeurs">Les prix et valeurs sont sinc√®res</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="evaluationAmiable"
                          checked={partageSuccessoralData.declarations.evaluationAmiable}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, evaluationAmiable: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="evaluationAmiable">√âvaluation amiable des biens</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="expertiseJudiciaire"
                          checked={partageSuccessoralData.declarations.expertiseJudiciaire}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, expertiseJudiciaire: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="expertiseJudiciaire">Expertise judiciaire r√©alis√©e</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="tirageSortLots"
                          checked={partageSuccessoralData.declarations.tirageSortLots}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, tirageSortLots: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="tirageSortLots">Tirage au sort des lots</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="choixAmiableLots"
                          checked={partageSuccessoralData.declarations.choixAmiableLots}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, choixAmiableLots: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="choixAmiableLots">Choix amiable des lots</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="paiementSoulteComptant"
                          checked={partageSuccessoralData.declarations.paiementSoulteComptant}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, paiementSoulteComptant: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="paiementSoulteComptant">Paiement des soultes comptant</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="echelonnementSoultes"
                          checked={partageSuccessoralData.declarations.echelonnementSoultes}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, echelonnementSoultes: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="echelonnementSoultes">√âchelonnement du paiement des soultes</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="clauseIndivisionResiduelle"
                          checked={partageSuccessoralData.declarations.clauseIndivisionResiduelle}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            declarations: {...partageSuccessoralData.declarations, clauseIndivisionResiduelle: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="clauseIndivisionResiduelle">Clause d'indivision r√©siduelle</Label>
                      </div>

                      {partageSuccessoralData.declarations.clauseIndivisionResiduelle && (
                        <div className="ml-6 mt-2">
                          <Label htmlFor="biensIndivisionResiduelle">Biens concern√©s par l'indivision r√©siduelle</Label>
                          <Textarea
                            id="biensIndivisionResiduelle"
                            value={partageSuccessoralData.declarations.biensIndivisionResiduelle}
                            onChange={(e) => setPartageSuccessoralData({
                              ...partageSuccessoralData,
                              declarations: {...partageSuccessoralData.declarations, biensIndivisionResiduelle: e.target.value}
                            })}
                            rows={3}
                            placeholder="D√©taillez les biens qui resteront en indivision"
                          />
                        </div>
                      )}
                    </div>
                  </div>

                  {/* SECTION 7 : FORMALIT√âS */}
                  <div className="mt-8 p-6 border rounded-lg bg-cyan-50">
                    <h3 className="text-lg font-semibold mb-4">7. Formalit√©s et obligations</h3>

                    <div className="space-y-3">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="declarationSuccession"
                          checked={partageSuccessoralData.formalites.declarationSuccession}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            formalites: {...partageSuccessoralData.formalites, declarationSuccession: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="declarationSuccession">D√©claration de succession d√©pos√©e</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="paiementDroitsSuccession"
                          checked={partageSuccessoralData.formalites.paiementDroitsSuccession}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            formalites: {...partageSuccessoralData.formalites, paiementDroitsSuccession: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="paiementDroitsSuccession">Droits de succession acquitt√©s</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="publicationConservation"
                          checked={partageSuccessoralData.formalites.publicationConservation}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            formalites: {...partageSuccessoralData.formalites, publicationConservation: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="publicationConservation">Publication √† la conservation des hypoth√®ques</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="mentionActesDeces"
                          checked={partageSuccessoralData.formalites.mentionActesDeces}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            formalites: {...partageSuccessoralData.formalites, mentionActesDeces: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="mentionActesDeces">Mention sur les actes de d√©c√®s</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="notificationCoheritiers"
                          checked={partageSuccessoralData.formalites.notificationCoheritiers}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            formalites: {...partageSuccessoralData.formalites, notificationCoheritiers: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="notificationCoheritiers">Notification aux coh√©ritiers</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="attestationPropriete"
                          checked={partageSuccessoralData.formalites.attestationPropriete}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            formalites: {...partageSuccessoralData.formalites, attestationPropriete: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="attestationPropriete">Attestation de propri√©t√© √©tablie</Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="certificatInscriptionPrivileges"
                          checked={partageSuccessoralData.formalites.certificatInscriptionPrivileges}
                          onChange={(e) => setPartageSuccessoralData({
                            ...partageSuccessoralData,
                            formalites: {...partageSuccessoralData.formalites, certificatInscriptionPrivileges: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="certificatInscriptionPrivileges">Certificat d'inscription de privil√®ges et hypoth√®ques</Label>
                      </div>
                    </div>
                  </div>

                  {/* SECTION 8 : PI√àCES JUSTIFICATIVES */}
                  <div className="mt-8 p-6 border rounded-lg bg-amber-50">
                    <h3 className="text-lg font-semibold mb-4">8. Pi√®ces justificatives</h3>

                    <div className="space-y-6">
                      {/* Documents d√©funt */}
                      <div>
                        <Label className="text-md font-medium mb-2 block">Documents relatifs au d√©funt</Label>
                        <div className="space-y-2">
                          <div>
                            <Label>Acte de d√©c√®s</Label>
                            <MultiFileUpload
                              files={partageDefuntActeDeces}
                              onChange={setPartageDefuntActeDeces}
                              label=""
                            />
                          </div>
                          <div>
                            <Label>Livret de famille</Label>
                            <MultiFileUpload
                              files={partageDefuntLivretFamille}
                              onChange={setPartageDefuntLivretFamille}
                              label=""
                            />
                          </div>
                          <div>
                            <Label>Contrat de mariage / PACS</Label>
                            <MultiFileUpload
                              files={partageDefuntContratMariage}
                              onChange={setPartageDefuntContratMariage}
                              label=""
                            />
                          </div>
                          <div>
                            <Label>Testaments</Label>
                            <MultiFileUpload
                              files={partageDefuntTestaments}
                              onChange={setPartageDefuntTestaments}
                              label=""
                            />
                          </div>
                          <div>
                            <Label>Donations entre √©poux</Label>
                            <MultiFileUpload
                              files={partageDefuntDonationsEntreEpoux}
                              onChange={setPartageDefuntDonationsEntreEpoux}
                              label=""
                            />
                          </div>
                          <div>
                            <Label>Donations ant√©rieures</Label>
                            <MultiFileUpload
                              files={partageDefuntDonationsAnterieures}
                              onChange={setPartageDefuntDonationsAnterieures}
                              label=""
                            />
                          </div>
                        </div>
                      </div>

                      {/* Documents biens */}
                      <div>
                        <Label className="text-md font-medium mb-2 block">Documents relatifs aux biens</Label>
                        <div className="space-y-2">
                          <div>
                            <Label>Titres de propri√©t√©</Label>
                            <MultiFileUpload
                              files={partageDefuntTitresPropriete}
                              onChange={setPartageDefuntTitresPropriete}
                              label=""
                            />
                          </div>
                          <div>
                            <Label>Relev√©s bancaires</Label>
                            <MultiFileUpload
                              files={partageDefuntRelevesBancaires}
                              onChange={setPartageDefuntRelevesBancaires}
                              label=""
                            />
                          </div>
                          <div>
                            <Label>Bilans entreprises / parts sociales</Label>
                            <MultiFileUpload
                              files={partageDefuntBilansEntreprises}
                              onChange={setPartageDefuntBilansEntreprises}
                              label=""
                            />
                          </div>
                          <div>
                            <Label>Inventaire mobilier</Label>
                            <MultiFileUpload
                              files={partageDefuntInventaireMobilier}
                              onChange={setPartageDefuntInventaireMobilier}
                              label=""
                            />
                          </div>
                        </div>
                      </div>

                      {/* Autres documents */}
                      <div>
                        <Label className="text-md font-medium mb-2 block">Autres documents</Label>
                        <div className="space-y-2">
                          <div>
                            <Label>Diagnostics immobiliers</Label>
                            <MultiFileUpload
                              files={partageAutresDiagnostics}
                              onChange={setPartageAutresDiagnostics}
                              label=""
                            />
                          </div>
                          <div>
                            <Label>√âvaluations / expertises</Label>
                            <MultiFileUpload
                              files={partageAutresEvaluations}
                              onChange={setPartageAutresEvaluations}
                              label=""
                            />
                          </div>
                          <div>
                            <Label>Statuts de soci√©t√©s</Label>
                            <MultiFileUpload
                              files={partageAutresStatutsSocietes}
                              onChange={setPartageAutresStatutsSocietes}
                              label=""
                            />
                          </div>
                          <div>
                            <Label>Autres documents</Label>
                            <MultiFileUpload
                              files={partageAutresDocuments}
                              onChange={setPartageAutresDocuments}
                              label=""
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                </div>
              </>
            )}

            {/* Formulaire sp√©cifique pour Procuration authentique */}
            {pendingContractType === "Procuration authentique" && (
              <>
                <div className="space-y-6">
                  {/* 1Ô∏è‚É£ Type de procuration */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">1Ô∏è‚É£ Type de procuration (OBLIGATOIRE)</h3>
                    <div className="space-y-2">
                      <Label>S√©lectionnez le type de procuration *</Label>
                      <Select 
                        value={procurationData.typeProcuration} 
                        onValueChange={(value) => setProcurationData({...procurationData, typeProcuration: value})}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="generale">‚òê Procuration g√©n√©rale</SelectItem>
                          <SelectItem value="speciale">‚òê Procuration sp√©ciale</SelectItem>
                          <SelectItem value="immobiliere">‚òê Procuration immobili√®re</SelectItem>
                          <SelectItem value="bancaire">‚òê Procuration bancaire</SelectItem>
                          <SelectItem value="fiscale">‚òê Procuration fiscale</SelectItem>
                          <SelectItem value="ssp">‚òê Procuration pour signature d'acte sous seing priv√©</SelectItem>
                          <SelectItem value="internationale">‚òê Procuration internationale</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    
                    {["speciale", "immobiliere", "bancaire", "fiscale"].includes(procurationData.typeProcuration) && (
                      <div className="space-y-2 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                        <Label>Acte(s) pr√©cis√©ment vis√©(s) (OBLIGATOIRE) *</Label>
                        <Textarea 
                          value={procurationData.actesVises} 
                          onChange={(e) => setProcurationData({...procurationData, actesVises: e.target.value})} 
                          rows={3}
                          placeholder="D√©crivez pr√©cis√©ment le ou les actes pour lesquels cette procuration est donn√©e..."
                          className="border-yellow-300"
                        />
                      </div>
                    )}
                  </div>

                  {/* 2Ô∏è‚É£ Identit√© du mandant */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">2Ô∏è‚É£ Identit√© compl√®te du MANDANT (OBLIGATOIRE)</h3>
                    
                    <div className="space-y-2">
                      <Label>S√©lectionner un client existant (optionnel)</Label>
                      <Select
                        value={procurationData.mandant.clientId}
                        onValueChange={(value) => {
                          const selectedClient = clients.find(c => c.id === value) as any;
                          if (selectedClient) {
                            // Extraire la situation familiale
                            let situationFamiliale = "";
                            if (typeof selectedClient.situation_familiale === 'object' && selectedClient.situation_familiale !== null) {
                              situationFamiliale = selectedClient.situation_familiale.situation_familiale || "";
                            } else if (typeof selectedClient.situation_familiale === 'string') {
                              situationFamiliale = selectedClient.situation_familiale;
                            }

                            setProcurationData({
                              ...procurationData,
                              mandant: { 
                                ...procurationData.mandant, 
                                clientId: value, 
                                isClient: true,
                                nom: selectedClient.nom || "",
                                prenom: selectedClient.prenom || "",
                                dateNaissance: selectedClient.date_naissance || "",
                                lieuNaissance: selectedClient.lieu_naissance || "",
                                nationalite: selectedClient.nationalite || "",
                                profession: selectedClient.profession || "",
                                adresseComplete: selectedClient.adresse || "",
                                telephone: selectedClient.telephone || "",
                                email: selectedClient.email || "",
                                situationMatrimoniale: situationFamiliale || selectedClient.situation_matrimoniale || "",
                                typeIdentite: selectedClient.type_identite || "",
                                numeroIdentite: selectedClient.numero_identite || "",
                                dateEmissionIdentite: selectedClient.date_expiration_identite || "",
                              }
                            });

                            // Charger le document d'identit√©
                            if (selectedClient.id_doc_path) {
                              supabase.storage
                                .from('documents')
                                .createSignedUrl(selectedClient.id_doc_path, 3600)
                                .then(({ data, error }) => {
                                  if (!error && data?.signedUrl) {
                                    setProcurationMandantIdentiteUrl(data.signedUrl);
                                  }
                                });
                            } else {
                              // Chercher dans client_documents
                              supabase
                                .from('client_documents')
                                .select('file_path')
                                .eq('client_id', selectedClient.id)
                                .eq('document_type', 'piece_identite')
                                .order('uploaded_at', { ascending: false })
                                .limit(1)
                                .then(({ data: docs }) => {
                                  if (docs && docs.length > 0) {
                                    supabase.storage
                                      .from('documents')
                                      .createSignedUrl(docs[0].file_path, 3600)
                                      .then(({ data, error }) => {
                                        if (!error && data?.signedUrl) {
                                          setProcurationMandantIdentiteUrl(data.signedUrl);
                                        }
                                      });
                                  }
                                });
                            }
                          }
                        }}
                      >
                        <SelectTrigger>
                          <SelectValue placeholder="Choisir un client..." />
                        </SelectTrigger>
                        <SelectContent>
                          {clients.map((client) => (
                            <SelectItem key={client.id} value={client.id}>
                              {client.nom} {client.prenom}
                            </SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Nom *</Label>
                        <Input value={procurationData.mandant.nom} onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, nom: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Pr√©nom *</Label>
                        <Input value={procurationData.mandant.prenom} onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, prenom: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Nom de naissance</Label>
                        <Input value={procurationData.mandant.nomNaissance} onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, nomNaissance: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Date de naissance *</Label>
                        <Input type="date" value={procurationData.mandant.dateNaissance} onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, dateNaissance: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Lieu de naissance</Label>
                        <Input value={procurationData.mandant.lieuNaissance} onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, lieuNaissance: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Nationalit√©</Label>
                        <Input value={procurationData.mandant.nationalite} onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, nationalite: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Profession</Label>
                        <Input value={procurationData.mandant.profession} onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, profession: e.target.value}})} />
                      </div>
                    </div>

                    <div className="space-y-2">
                      <Label>Adresse compl√®te *</Label>
                      <Textarea value={procurationData.mandant.adresseComplete} onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, adresseComplete: e.target.value}})} rows={2} />
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>T√©l√©phone</Label>
                        <Input value={procurationData.mandant.telephone} onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, telephone: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Email</Label>
                        <Input type="email" value={procurationData.mandant.email} onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, email: e.target.value}})} />
                      </div>
                    </div>

                    <div className="space-y-2">
                      <Label>Situation matrimoniale</Label>
                      <Input 
                        value={procurationData.mandant.situationMatrimoniale} 
                        onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, situationMatrimoniale: e.target.value}})}
                        placeholder="Renseign√©e automatiquement si client s√©lectionn√©"
                      />
                    </div>

                    {(procurationData.mandant.situationMatrimoniale === "marie" || procurationData.mandant.situationMatrimoniale === "pacse") && (
                      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div className="space-y-2">
                          <Label>R√©gime matrimonial</Label>
                          <Input value={procurationData.mandant.regimeMatrimonial} onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, regimeMatrimonial: e.target.value}})} placeholder="Ex: Communaut√© l√©gale" />
                        </div>
                        <div className="space-y-2">
                          <Label>Nom du conjoint</Label>
                          <Input value={procurationData.mandant.conjointNom} onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, conjointNom: e.target.value}})} />
                        </div>
                        <div className="space-y-2">
                          <Label>Pr√©nom du conjoint</Label>
                          <Input value={procurationData.mandant.conjointPrenom} onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, conjointPrenom: e.target.value}})} />
                        </div>
                      </div>
                    )}

                    <div className="space-y-2">
                      <Label>Capacit√© juridique</Label>
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="majeur_capable"
                            value="majeur_capable"
                            checked={procurationData.mandant.capaciteJuridique === "majeur_capable"}
                            onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, capaciteJuridique: e.target.value}})}
                          />
                          <Label htmlFor="majeur_capable" className="cursor-pointer font-normal">‚òê Majeur capable</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="sous_protection"
                            value="sous_protection"
                            checked={procurationData.mandant.capaciteJuridique === "sous_protection"}
                            onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, capaciteJuridique: e.target.value}})}
                          />
                          <Label htmlFor="sous_protection" className="cursor-pointer font-normal">‚òê Sous mesure de protection</Label>
                        </div>
                      </div>
                    </div>

                    {procurationData.mandant.capaciteJuridique === "sous_protection" && (
                      <div className="space-y-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                        <div className="space-y-2">
                          <Label>Type de mesure *</Label>
                          <Select value={procurationData.mandant.typeMesureProtection} onValueChange={(value) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, typeMesureProtection: value}})}>
                            <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="tutelle">Tutelle</SelectItem>
                              <SelectItem value="curatelle">Curatelle</SelectItem>
                              <SelectItem value="sauvegarde">Sauvegarde de justice</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="autorisation"
                            checked={procurationData.mandant.autorisationJointe}
                            onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, autorisationJointe: e.target.checked}})}
                            className="rounded"
                          />
                          <Label htmlFor="autorisation" className="cursor-pointer font-normal">Autorisation jointe (PDF)</Label>
                        </div>
                        <div className="text-sm text-yellow-700">
                          ‚ö†Ô∏è Joindre le jugement de protection et l'autorisation du juge/curateur
                        </div>
                      </div>
                    )}

                    <div className="space-y-2">
                      <Label className="font-semibold">Pi√®ce d'identit√© du mandant (OBLIGATOIRE)</Label>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Type de pi√®ce *</Label>
                        <Select value={procurationData.mandant.typeIdentite} onValueChange={(value) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, typeIdentite: value}})}>
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="CNI">Carte Nationale d'Identit√© (CNI)</SelectItem>
                            <SelectItem value="Passeport">Passeport</SelectItem>
                            <SelectItem value="Titre de s√©jour">Titre de s√©jour</SelectItem>
                            <SelectItem value="Permis de conduire">Permis de conduire</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <Label>Num√©ro *</Label>
                        <Input value={procurationData.mandant.numeroIdentite} onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, numeroIdentite: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Date d'√©mission</Label>
                        <Input type="date" value={procurationData.mandant.dateEmissionIdentite} onChange={(e) => setProcurationData({...procurationData, mandant: {...procurationData.mandant, dateEmissionIdentite: e.target.value}})} />
                      </div>
                    </div>

                    {/* Pi√®ce d'identit√© du mandant */}
                    {procurationData.mandant.clientId ? (
                      <div className="space-y-2">
                        <Label>üìé Pi√®ce d'identit√© du mandant</Label>
                        {procurationMandantIdentiteUrl ? (
                          <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg">
                            <svg className="w-4 h-4 text-green-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <span className="text-sm flex-1 text-green-700">Pi√®ce d'identit√© charg√©e depuis le profil client</span>
                            <Button
                              type="button"
                              variant="ghost"
                              size="sm"
                              className="bg-green-600 hover:bg-green-700 text-white"
                              onClick={() => window.open(procurationMandantIdentiteUrl, '_blank')}
                            >
                              <Eye className="w-4 h-4" />
                            </Button>
                          </div>
                        ) : (
                          <div className="flex items-center gap-2 p-2 bg-orange-50 border border-orange-200 rounded-lg">
                            <svg className="w-4 h-4 text-orange-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                            </svg>
                            <span className="text-sm flex-1 text-orange-700">Aucune pi√®ce d'identit√© dans le profil client</span>
                          </div>
                        )}
                      </div>
                    ) : (
                      <div className="space-y-2">
                        <Label>üìé Pi√®ce d'identit√© du mandant</Label>
                        <button
                          type="button"
                          onClick={() => {
                            const input = document.createElement('input');
                            input.type = 'file';
                            input.accept = '.pdf,.jpg,.jpeg,.png';
                            input.onchange = (e: any) => {
                              console.log('Upload fichier mandant:', e.target.files?.[0]);
                              // TODO: G√©rer l'upload et stocker le nom du fichier
                            };
                            input.click();
                          }}
                          className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                        >
                          <svg className="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                          </svg>
                          <span className="text-orange-700">Aucune pi√®ce charg√©e - Cliquer pour ajouter</span>
                        </button>
                      </div>
                    )}
                  </div>

                  {/* 3Ô∏è‚É£ Identit√© du mandataire */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">3Ô∏è‚É£ Identit√© compl√®te du MANDATAIRE (OBLIGATOIRE)</h3>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Nom *</Label>
                        <Input value={procurationData.mandataire.nom} onChange={(e) => setProcurationData({...procurationData, mandataire: {...procurationData.mandataire, nom: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Pr√©nom *</Label>
                        <Input value={procurationData.mandataire.prenom} onChange={(e) => setProcurationData({...procurationData, mandataire: {...procurationData.mandataire, prenom: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Nom de naissance</Label>
                        <Input value={procurationData.mandataire.nomNaissance} onChange={(e) => setProcurationData({...procurationData, mandataire: {...procurationData.mandataire, nomNaissance: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Date de naissance</Label>
                        <Input type="date" value={procurationData.mandataire.dateNaissance} onChange={(e) => setProcurationData({...procurationData, mandataire: {...procurationData.mandataire, dateNaissance: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Lieu de naissance</Label>
                        <Input value={procurationData.mandataire.lieuNaissance} onChange={(e) => setProcurationData({...procurationData, mandataire: {...procurationData.mandataire, lieuNaissance: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Nationalit√©</Label>
                        <Input value={procurationData.mandataire.nationalite} onChange={(e) => setProcurationData({...procurationData, mandataire: {...procurationData.mandataire, nationalite: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Profession</Label>
                        <Input value={procurationData.mandataire.profession} onChange={(e) => setProcurationData({...procurationData, mandataire: {...procurationData.mandataire, profession: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>T√©l√©phone</Label>
                        <Input value={procurationData.mandataire.telephone} onChange={(e) => setProcurationData({...procurationData, mandataire: {...procurationData.mandataire, telephone: e.target.value}})} />
                      </div>
                    </div>

                    <div className="space-y-2">
                      <Label>Adresse compl√®te *</Label>
                      <Textarea value={procurationData.mandataire.adresseComplete} onChange={(e) => setProcurationData({...procurationData, mandataire: {...procurationData.mandataire, adresseComplete: e.target.value}})} rows={2} />
                    </div>

                    <div className="space-y-2">
                      <Label>Email (optionnel mais recommand√©)</Label>
                      <Input type="email" value={procurationData.mandataire.email} onChange={(e) => setProcurationData({...procurationData, mandataire: {...procurationData.mandataire, email: e.target.value}})} />
                    </div>

                    <div className="space-y-2">
                      <Label>Lien avec le mandant</Label>
                      <Select value={procurationData.mandataire.lienMandant} onValueChange={(value) => setProcurationData({...procurationData, mandataire: {...procurationData.mandataire, lienMandant: value}})}>
                        <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="conjoint">Conjoint</SelectItem>
                          <SelectItem value="parent">Parent</SelectItem>
                          <SelectItem value="enfant">Enfant</SelectItem>
                          <SelectItem value="ami">Ami</SelectItem>
                          <SelectItem value="avocat">Avocat</SelectItem>
                          <SelectItem value="notaire">Notaire</SelectItem>
                          <SelectItem value="tiers_professionnel">Tiers professionnel</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="space-y-2">
                      <Label className="font-semibold">Pi√®ce d'identit√© du mandataire (OBLIGATOIRE)</Label>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Type de pi√®ce *</Label>
                        <Select value={procurationData.mandataire.typeIdentite} onValueChange={(value) => setProcurationData({...procurationData, mandataire: {...procurationData.mandataire, typeIdentite: value}})}>
                          <SelectTrigger><SelectValue placeholder="S√©lectionner..." /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="CNI">Carte Nationale d'Identit√© (CNI)</SelectItem>
                            <SelectItem value="Passeport">Passeport</SelectItem>
                            <SelectItem value="Titre de s√©jour">Titre de s√©jour</SelectItem>
                            <SelectItem value="Permis de conduire">Permis de conduire</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <Label>Num√©ro *</Label>
                        <Input value={procurationData.mandataire.numeroIdentite} onChange={(e) => setProcurationData({...procurationData, mandataire: {...procurationData.mandataire, numeroIdentite: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Date d'√©mission</Label>
                        <Input type="date" value={procurationData.mandataire.dateEmissionIdentite} onChange={(e) => setProcurationData({...procurationData, mandataire: {...procurationData.mandataire, dateEmissionIdentite: e.target.value}})} />
                      </div>
                    </div>

                    {/* Pi√®ce d'identit√© du mandataire */}
                    <div className="space-y-2">
                      <Label>üìé Copie de la pi√®ce</Label>
                      {procurationMandataireIdentiteFile ? (
                        <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg">
                          <svg className="w-4 h-4 text-green-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                          </svg>
                          <span className="text-sm flex-1 text-green-700">Pi√®ce d'identit√© charg√©e : {procurationMandataireIdentiteFile.name}</span>
                          <Button
                            type="button"
                            variant="ghost"
                            size="sm"
                            className="bg-green-600 hover:bg-green-700 text-white"
                            onClick={() => {
                              const url = URL.createObjectURL(procurationMandataireIdentiteFile);
                              window.open(url, '_blank');
                            }}
                          >
                            <Eye className="w-4 h-4" />
                          </Button>
                          <Button
                            type="button"
                            variant="ghost"
                            size="sm"
                            className="bg-red-600 hover:bg-red-700 text-white"
                            onClick={() => setProcurationMandataireIdentiteFile(null)}
                          >
                            <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                            </svg>
                          </Button>
                        </div>
                      ) : (
                        <button
                          type="button"
                          onClick={() => {
                            const input = document.createElement('input');
                            input.type = 'file';
                            input.accept = '.pdf,.jpg,.jpeg,.png';
                            input.onchange = (e: any) => {
                              const file = e.target.files?.[0];
                              if (file) {
                                setProcurationMandataireIdentiteFile(file);
                              }
                            };
                            input.click();
                          }}
                          className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                        >
                          <svg className="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                          </svg>
                          <span className="text-orange-700">Aucune pi√®ce charg√©e - Cliquer pour ajouter</span>
                        </button>
                      )}
                    </div>
                  </div>

                  {/* 4Ô∏è‚É£ Objet pr√©cis de la procuration */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">4Ô∏è‚É£ OBJET PR√âCIS DE LA PROCURATION (OBLIGATOIRE)</h3>
                    <div className="space-y-2">
                      <Label>Description pr√©cise et d√©taill√©e de l'objet *</Label>
                      <Textarea 
                        value={procurationData.objet.descriptionPrecise} 
                        onChange={(e) => setProcurationData({...procurationData, objet: {...procurationData.objet, descriptionPrecise: e.target.value}})} 
                        rows={4}
                        placeholder="D√©crivez pr√©cis√©ment l'objet de la procuration..."
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Liste exhaustive des actes autoris√©s *</Label>
                      <Textarea 
                        value={procurationData.objet.listeActesAutorises} 
                        onChange={(e) => setProcurationData({...procurationData, objet: {...procurationData.objet, listeActesAutorises: e.target.value}})} 
                        rows={3}
                        placeholder="Listez tous les actes pour lesquels la procuration est donn√©e..."
                      />
                    </div>
                    
                    <div className="space-y-2 p-4 bg-gray-50 border rounded-lg">
                      <Label className="font-semibold">Facult√©s du mandataire</Label>
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="faculte_signer"
                          checked={procurationData.objet.faculteSignerActes}
                          onChange={(e) => setProcurationData({...procurationData, objet: {...procurationData.objet, faculteSignerActes: e.target.checked}})}
                          className="rounded"
                        />
                        <Label htmlFor="faculte_signer" className="cursor-pointer font-normal">Facult√© de signer tous actes n√©cessaires √† l'ex√©cution</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="faculte_recevoir"
                          checked={procurationData.objet.faculteRecevoirSommes}
                          onChange={(e) => setProcurationData({...procurationData, objet: {...procurationData.objet, faculteRecevoirSommes: e.target.checked}})}
                          className="rounded"
                        />
                        <Label htmlFor="faculte_recevoir" className="cursor-pointer font-normal">Facult√© de recevoir sommes / donner quittance</Label>
                      </div>
                    </div>

                    {/* Cas particulier : Procuration immobili√®re */}
                    {procurationData.typeProcuration === "immobiliere" && (
                      <div className="space-y-4 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                        <Label className="font-semibold text-blue-900">‚û°Ô∏è Procuration immobili√®re - Pr√©cisions</Label>
                        <div className="space-y-2">
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="immo_vente"
                              checked={procurationData.objet.immobilierVente}
                              onChange={(e) => setProcurationData({...procurationData, objet: {...procurationData.objet, immobilierVente: e.target.checked}})}
                              className="rounded"
                            />
                            <Label htmlFor="immo_vente" className="cursor-pointer font-normal">Vente</Label>
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="immo_achat"
                              checked={procurationData.objet.immobilierAchat}
                              onChange={(e) => setProcurationData({...procurationData, objet: {...procurationData.objet, immobilierAchat: e.target.checked}})}
                              className="rounded"
                            />
                            <Label htmlFor="immo_achat" className="cursor-pointer font-normal">Achat</Label>
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="immo_hypotheque"
                              checked={procurationData.objet.immobilierHypotheque}
                              onChange={(e) => setProcurationData({...procurationData, objet: {...procurationData.objet, immobilierHypotheque: e.target.checked}})}
                              className="rounded"
                            />
                            <Label htmlFor="immo_hypotheque" className="cursor-pointer font-normal">Hypoth√®que</Label>
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="immo_mainlevee"
                              checked={procurationData.objet.immobilierMainlevee}
                              onChange={(e) => setProcurationData({...procurationData, objet: {...procurationData.objet, immobilierMainlevee: e.target.checked}})}
                              className="rounded"
                            />
                            <Label htmlFor="immo_mainlevee" className="cursor-pointer font-normal">Mainlev√©e</Label>
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="immo_avant_contrats"
                              checked={procurationData.objet.immobilierSignatureAvantContrats}
                              onChange={(e) => setProcurationData({...procurationData, objet: {...procurationData.objet, immobilierSignatureAvantContrats: e.target.checked}})}
                              className="rounded"
                            />
                            <Label htmlFor="immo_avant_contrats" className="cursor-pointer font-normal">Signature de tous avant-contrats et actes d√©finitifs</Label>
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="immo_conditions"
                              checked={procurationData.objet.immobilierAcceptationConditions}
                              onChange={(e) => setProcurationData({...procurationData, objet: {...procurationData.objet, immobilierAcceptationConditions: e.target.checked}})}
                              className="rounded"
                            />
                            <Label htmlFor="immo_conditions" className="cursor-pointer font-normal">Acceptation / renonciation aux conditions suspensives</Label>
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="immo_percevoir"
                              checked={procurationData.objet.immobilierPercevoirPrix}
                              onChange={(e) => setProcurationData({...procurationData, objet: {...procurationData.objet, immobilierPercevoirPrix: e.target.checked}})}
                              className="rounded"
                            />
                            <Label htmlFor="immo_percevoir" className="cursor-pointer font-normal">Facult√© de percevoir le prix</Label>
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="faculte_substituer"
                              checked={procurationData.objet.faculteSubstituer}
                              onChange={(e) => setProcurationData({...procurationData, objet: {...procurationData.objet, faculteSubstituer: e.target.checked}})}
                              className="rounded"
                            />
                            <Label htmlFor="faculte_substituer" className="cursor-pointer font-normal">Facult√© de substituer</Label>
                          </div>
                        </div>
                      </div>
                    )}
                  </div>

                  {/* 5Ô∏è‚É£ √âTENDUE DES POUVOIRS ET LIMITES */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">5Ô∏è‚É£ √âTENDUE DES POUVOIRS ET LIMITES (OBLIGATOIRE)</h3>
                    <div className="space-y-2">
                      <Label>√âtendue des pouvoirs *</Label>
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="etendue_large"
                            value="tres_large"
                            checked={procurationData.etendue.typeEtendue === "tres_large"}
                            onChange={(e) => setProcurationData({...procurationData, etendue: {...procurationData.etendue, typeEtendue: e.target.value}})}
                          />
                          <Label htmlFor="etendue_large" className="cursor-pointer font-normal">‚òê Tr√®s large</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="etendue_limitee"
                            value="limitee"
                            checked={procurationData.etendue.typeEtendue === "limitee"}
                            onChange={(e) => setProcurationData({...procurationData, etendue: {...procurationData.etendue, typeEtendue: e.target.value}})}
                          />
                          <Label htmlFor="etendue_limitee" className="cursor-pointer font-normal">‚òê Limit√©e (pr√©ciser)</Label>
                        </div>
                      </div>
                    </div>

                    {procurationData.etendue.typeEtendue === "limitee" && (
                      <div className="space-y-2 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                        <Label>Pr√©cisions sur les limites *</Label>
                        <Textarea 
                          value={procurationData.etendue.precisionsLimitees} 
                          onChange={(e) => setProcurationData({...procurationData, etendue: {...procurationData.etendue, precisionsLimitees: e.target.value}})} 
                          rows={2}
                          placeholder="Pr√©cisez les limites de la procuration..."
                        />
                      </div>
                    )}

                    <div className="space-y-2">
                      <Label>Actes express√©ment exclus (champ texte)</Label>
                      <Textarea 
                        value={procurationData.etendue.actesExclus} 
                        onChange={(e) => setProcurationData({...procurationData, etendue: {...procurationData.etendue, actesExclus: e.target.value}})} 
                        rows={2}
                        placeholder="Listez les actes explicitement exclus de la procuration..."
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Subd√©l√©gation</Label>
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="subdel_autorisee"
                            value="autorisee"
                            checked={procurationData.etendue.subdelegation === "autorisee"}
                            onChange={(e) => setProcurationData({...procurationData, etendue: {...procurationData.etendue, subdelegation: e.target.value}})}
                          />
                          <Label htmlFor="subdel_autorisee" className="cursor-pointer font-normal">‚òê Autoris√©e</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="subdel_interdite"
                            value="interdite"
                            checked={procurationData.etendue.subdelegation === "interdite"}
                            onChange={(e) => setProcurationData({...procurationData, etendue: {...procurationData.etendue, subdelegation: e.target.value}})}
                          />
                          <Label htmlFor="subdel_interdite" className="cursor-pointer font-normal">‚òê Interdite</Label>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* 6Ô∏è‚É£ DUR√âE - R√âVOCATION */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">6Ô∏è‚É£ DUR√âE - R√âVOCATION (OBLIGATOIRE)</h3>
                    <div className="space-y-2">
                      <Label>Dur√©e *</Label>
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="duree_indeterminee"
                            value="indeterminee"
                            checked={procurationData.duree.type === "indeterminee"}
                            onChange={(e) => setProcurationData({...procurationData, duree: {...procurationData.duree, type: e.target.value}})}
                          />
                          <Label htmlFor="duree_indeterminee" className="cursor-pointer font-normal">‚òê Dur√©e ind√©termin√©e</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="duree_determinee"
                            value="determinee"
                            checked={procurationData.duree.type === "determinee"}
                            onChange={(e) => setProcurationData({...procurationData, duree: {...procurationData.duree, type: e.target.value}})}
                          />
                          <Label htmlFor="duree_determinee" className="cursor-pointer font-normal">‚òê Dur√©e d√©termin√©e (date de fin)</Label>
                        </div>
                      </div>
                    </div>
                    
                    {procurationData.duree.type === "determinee" && (
                      <div className="space-y-2">
                        <Label>Date de fin *</Label>
                        <Input type="date" value={procurationData.duree.dateFin} onChange={(e) => setProcurationData({...procurationData, duree: {...procurationData.duree, dateFin: e.target.value}})} />
                      </div>
                    )}

                    <div className="space-y-2">
                      <Label>R√©vocable √† tout moment</Label>
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="revocable_oui"
                            checked={procurationData.duree.revocable === true}
                            onChange={() => setProcurationData({...procurationData, duree: {...procurationData.duree, revocable: true}})}
                          />
                          <Label htmlFor="revocable_oui" className="cursor-pointer font-normal">‚òê Oui</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="revocable_non"
                            checked={procurationData.duree.revocable === false}
                            onChange={() => setProcurationData({...procurationData, duree: {...procurationData.duree, revocable: false}})}
                          />
                          <Label htmlFor="revocable_non" className="cursor-pointer font-normal">‚òê Non (rare mais possible)</Label>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* 7Ô∏è‚É£ ACCEPTATION DU MANDATAIRE */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">7Ô∏è‚É£ ACCEPTATION DU MANDATAIRE (OBLIGATOIRE)</h3>
                    <div className="space-y-2">
                      <Label>Type d'acceptation *</Label>
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="accept_expresse"
                            value="expresse"
                            checked={procurationData.acceptation.type === "expresse"}
                            onChange={(e) => setProcurationData({...procurationData, acceptation: {...procurationData.acceptation, type: e.target.value}})}
                          />
                          <Label htmlFor="accept_expresse" className="cursor-pointer font-normal">‚òê Acceptation expresse</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="accept_tacite"
                            value="tacite"
                            checked={procurationData.acceptation.type === "tacite"}
                            onChange={(e) => setProcurationData({...procurationData, acceptation: {...procurationData.acceptation, type: e.target.value}})}
                          />
                          <Label htmlFor="accept_tacite" className="cursor-pointer font-normal">‚òê Acceptation tacite</Label>
                        </div>
                      </div>
                    </div>

                    <div className="space-y-2">
                      <Label>Acceptation r√©alis√©e le jour de l'acte</Label>
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="accept_jour_oui"
                            checked={procurationData.acceptation.acceptationJourActe === true}
                            onChange={() => setProcurationData({...procurationData, acceptation: {...procurationData.acceptation, acceptationJourActe: true}})}
                          />
                          <Label htmlFor="accept_jour_oui" className="cursor-pointer font-normal">‚òê Oui</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="accept_jour_non"
                            checked={procurationData.acceptation.acceptationJourActe === false}
                            onChange={() => setProcurationData({...procurationData, acceptation: {...procurationData.acceptation, acceptationJourActe: false}})}
                          />
                          <Label htmlFor="accept_jour_non" className="cursor-pointer font-normal">‚òê Non (acceptation ult√©rieure)</Label>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* 8Ô∏è‚É£ D√âCLARATIONS ESSENTIELLES DU MANDANT */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">8Ô∏è‚É£ D√âCLARATIONS ESSENTIELLES DU MANDANT (OBLIGATOIRE)</h3>
                    <div className="p-4 bg-gray-50 border rounded-lg space-y-2">
                      <Label className="font-semibold">Cases √† cocher :</Label>
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="decl_libre"
                          checked={procurationData.declarations.agitLibrement}
                          onChange={(e) => setProcurationData({...procurationData, declarations: {...procurationData.declarations, agitLibrement: e.target.checked}})}
                          className="rounded"
                        />
                        <Label htmlFor="decl_libre" className="cursor-pointer font-normal">‚òê D√©clare agir librement, sans contrainte</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="decl_capacite"
                          checked={procurationData.declarations.pleineCapacite}
                          onChange={(e) => setProcurationData({...procurationData, declarations: {...procurationData.declarations, pleineCapacite: e.target.checked}})}
                          className="rounded"
                        />
                        <Label htmlFor="decl_capacite" className="cursor-pointer font-normal">‚òê D√©clare avoir pleine capacit√© juridique</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="decl_comprend"
                          checked={procurationData.declarations.comprendPortee}
                          onChange={(e) => setProcurationData({...procurationData, declarations: {...procurationData.declarations, comprendPortee: e.target.checked}})}
                          className="rounded"
                        />
                        <Label htmlFor="decl_comprend" className="cursor-pointer font-normal">‚òê D√©clare comprendre la port√©e de la procuration</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="decl_consent"
                          checked={procurationData.declarations.consentLibre}
                          onChange={(e) => setProcurationData({...procurationData, declarations: {...procurationData.declarations, consentLibre: e.target.checked}})}
                          className="rounded"
                        />
                        <Label htmlFor="decl_consent" className="cursor-pointer font-normal">‚òê D√©clare consentir librement et de mani√®re √©clair√©e</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="decl_irrevocable"
                          checked={procurationData.declarations.pouvoirIrrevocable}
                          onChange={(e) => setProcurationData({...procurationData, declarations: {...procurationData.declarations, pouvoirIrrevocable: e.target.checked}})}
                          className="rounded"
                        />
                        <Label htmlFor="decl_irrevocable" className="cursor-pointer font-normal">‚òê D√©clare donner pouvoir irr√©vocable pendant la dur√©e pr√©vue (si applicable)</Label>
                      </div>
                    </div>
                  </div>

                  {/* 9Ô∏è‚É£ LANGUE - COMPR√âHENSION */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">9Ô∏è‚É£ LANGUE - COMPR√âHENSION (OBLIGATOIRE)</h3>
                    <div className="space-y-2">
                      <Label>Langue comprise par le mandant *</Label>
                      <Input 
                        value={procurationData.langue.langueComprise} 
                        onChange={(e) => setProcurationData({...procurationData, langue: {...procurationData.langue, langueComprise: e.target.value}})} 
                        placeholder="Ex: Fran√ßais, Anglais, Espagnol..."
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Recours √† un interpr√®te</Label>
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="interprete_non"
                            checked={procurationData.langue.interpreteNecessaire === false}
                            onChange={() => setProcurationData({...procurationData, langue: {...procurationData.langue, interpreteNecessaire: false}})}
                          />
                          <Label htmlFor="interprete_non" className="cursor-pointer font-normal">‚òê Non</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="interprete_oui"
                            checked={procurationData.langue.interpreteNecessaire === true}
                            onChange={() => setProcurationData({...procurationData, langue: {...procurationData.langue, interpreteNecessaire: true}})}
                          />
                          <Label htmlFor="interprete_oui" className="cursor-pointer font-normal">‚òê Oui (identit√© de l'interpr√®te)</Label>
                        </div>
                      </div>
                    </div>

                    {procurationData.langue.interpreteNecessaire && (
                      <div className="space-y-2 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                        <Label>Identit√© de l'interpr√®te *</Label>
                        <Textarea 
                          value={procurationData.langue.interpreteIdentite} 
                          onChange={(e) => setProcurationData({...procurationData, langue: {...procurationData.langue, interpreteIdentite: e.target.value}})} 
                          rows={2}
                          placeholder="Nom, pr√©nom, qualifications de l'interpr√®te..."
                        />
                      </div>
                    )}
                  </div>

                  {/* üîü COMPARUTION - SIGNATURE */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">üîü COMPARUTION - SIGNATURE (OBLIGATOIRE)</h3>
                    <div className="space-y-2">
                      <Label>Comparution du mandant *</Label>
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="comp_presence"
                            value="presence"
                            checked={procurationData.comparution.typeComparution === "presence"}
                            onChange={(e) => setProcurationData({...procurationData, comparution: {...procurationData.comparution, typeComparution: e.target.value}})}
                          />
                          <Label htmlFor="comp_presence" className="cursor-pointer font-normal">‚òê En pr√©sence du notaire</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="comp_distance"
                            value="distance"
                            checked={procurationData.comparution.typeComparution === "distance"}
                            onChange={(e) => setProcurationData({...procurationData, comparution: {...procurationData.comparution, typeComparution: e.target.value}})}
                          />
                          <Label htmlFor="comp_distance" className="cursor-pointer font-normal">‚òê √Ä distance (visioconf√©rence s√©curis√©e)</Label>
                        </div>
                      </div>
                    </div>

                    <div className="space-y-2">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="lecture"
                          checked={procurationData.comparution.lectureFaite}
                          onChange={(e) => setProcurationData({...procurationData, comparution: {...procurationData.comparution, lectureFaite: e.target.checked}})}
                          className="rounded"
                        />
                        <Label htmlFor="lecture" className="cursor-pointer font-normal">Lecture de l'acte faite par le notaire</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="consentement"
                          checked={procurationData.comparution.consentementRecueilli}
                          onChange={(e) => setProcurationData({...procurationData, comparution: {...procurationData.comparution, consentementRecueilli: e.target.checked}})}
                          className="rounded"
                        />
                        <Label htmlFor="consentement" className="cursor-pointer font-normal">Consentement recueilli</Label>
                      </div>
                    </div>

                    <div className="space-y-2">
                      <Label>Signature *</Label>
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="sign_presentiel"
                            value="presentiel"
                            checked={procurationData.comparution.typeSignature === "presentiel"}
                            onChange={(e) => setProcurationData({...procurationData, comparution: {...procurationData.comparution, typeSignature: e.target.value}})}
                          />
                          <Label htmlFor="sign_presentiel" className="cursor-pointer font-normal">‚òê En pr√©sentiel</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input
                            type="radio"
                            id="sign_distance"
                            value="distance"
                            checked={procurationData.comparution.typeSignature === "distance"}
                            onChange={(e) => setProcurationData({...procurationData, comparution: {...procurationData.comparution, typeSignature: e.target.value}})}
                          />
                          <Label htmlFor="sign_distance" className="cursor-pointer font-normal">‚òê √Ä distance via syst√®me s√©curis√© de l'office</Label>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* 1Ô∏è‚É£1Ô∏è‚É£ MENTIONS NOTARIALES */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">1Ô∏è‚É£1Ô∏è‚É£ MENTIONS NOTARIALES (OBLIGATOIRE)</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Nom du notaire instrumentaire *</Label>
                        <Input value={procurationData.mentionsNotariales.nomNotaire} onChange={(e) => setProcurationData({...procurationData, mentionsNotariales: {...procurationData.mentionsNotariales, nomNotaire: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Ville de l'office *</Label>
                        <Input value={procurationData.mentionsNotariales.villeOffice} onChange={(e) => setProcurationData({...procurationData, mentionsNotariales: {...procurationData.mentionsNotariales, villeOffice: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Date de r√©ception de l'acte *</Label>
                        <Input type="date" value={procurationData.mentionsNotariales.dateReception} onChange={(e) => setProcurationData({...procurationData, mentionsNotariales: {...procurationData.mentionsNotariales, dateReception: e.target.value}})} />
                      </div>
                      <div className="space-y-2">
                        <Label>Lieu de r√©ception *</Label>
                        <Input value={procurationData.mentionsNotariales.lieuReception} onChange={(e) => setProcurationData({...procurationData, mentionsNotariales: {...procurationData.mentionsNotariales, lieuReception: e.target.value}})} placeholder="Ex: √âtude notariale, domicile..." />
                      </div>
                    </div>

                    <div className="flex items-center space-x-2">
                      <input
                        type="checkbox"
                        id="acte_minute"
                        checked={procurationData.mentionsNotariales.acteRecuMinute}
                        onChange={(e) => setProcurationData({...procurationData, mentionsNotariales: {...procurationData.mentionsNotariales, acteRecuMinute: e.target.checked}})}
                        className="rounded"
                      />
                      <Label htmlFor="acte_minute" className="cursor-pointer font-normal">Acte re√ßu en minute</Label>
                    </div>
                  </div>

                  {/* 1Ô∏è‚É£2Ô∏è‚É£ CONSERVATION - COPIES */}
                  <div className="space-y-4">
                    <h3 className="font-semibold text-lg border-b pb-2">1Ô∏è‚É£2Ô∏è‚É£ CONSERVATION - COPIES (OBLIGATOIRE)</h3>
                    <div className="space-y-2">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="minute"
                          checked={procurationData.conservation.minuteConservee}
                          onChange={(e) => setProcurationData({...procurationData, conservation: {...procurationData.conservation, minuteConservee: e.target.checked}})}
                          className="rounded"
                        />
                        <Label htmlFor="minute" className="cursor-pointer font-normal">Minute conserv√©e par le notaire</Label>
                      </div>
                      
                      <Label className="font-semibold mt-4 block">D√©livrance :</Label>
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="copies_simples"
                          checked={procurationData.conservation.copiesSimples}
                          onChange={(e) => setProcurationData({...procurationData, conservation: {...procurationData.conservation, copiesSimples: e.target.checked}})}
                          className="rounded"
                        />
                        <Label htmlFor="copies_simples" className="cursor-pointer font-normal">‚òê Copies simples</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="copies_certifiees"
                          checked={procurationData.conservation.copiesCertifiees}
                          onChange={(e) => setProcurationData({...procurationData, conservation: {...procurationData.conservation, copiesCertifiees: e.target.checked}})}
                          className="rounded"
                        />
                        <Label htmlFor="copies_certifiees" className="cursor-pointer font-normal">‚òê Copies certifi√©es conformes</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="copies_executoires"
                          checked={procurationData.conservation.copiesExecutoires}
                          onChange={(e) => setProcurationData({...procurationData, conservation: {...procurationData.conservation, copiesExecutoires: e.target.checked}})}
                          className="rounded"
                        />
                        <Label htmlFor="copies_executoires" className="cursor-pointer font-normal">‚òê Copies ex√©cutoires</Label>
                      </div>
                    </div>
                  </div>

                  {/* Note informative */}
                  <div className="p-4 bg-green-50 border border-green-200 rounded-lg">
                    <p className="text-sm text-green-700">
                      <strong>‚úÖ Checklist compl√®te :</strong> Tous les champs obligatoires pour une procuration authentique sont pr√©sents dans ce formulaire conforme aux exigences notariales.
                    </p>
                  </div>
                </div>
              </>
            )}

            {/* Formulaire sp√©cifique pour Mandat de protection future */}
            {pendingContractType === "Mandat de protection future" && (
              <>
                <div className="space-y-6">
                  {/* SECTION 1: TYPE DE MANDAT */}
                  <div className="space-y-4 p-4 border rounded-lg bg-orange-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">1Ô∏è‚É£ Type de mandat</h3>
                    
                    <div className="space-y-2">
                      <Label className="text-sm font-medium">S√©lectionnez le(s) type(s) de mandat <span className="text-red-500">*</span></Label>
                      <div className="space-y-2">
                        {[
                          { value: "mandat_soi_meme", label: "Mandat pour soi-m√™me" },
                          { value: "mandat_autrui", label: "Mandat pour autrui (ex. enfant handicap√©)" },
                          { value: "sous_seing_prive", label: "Sous seing priv√©" },
                          { value: "acte_authentique", label: "Acte authentique (notari√©)" },
                          { value: "mandat_mixte", label: "Mandat mixte (partie sous seing priv√© / partie notari√©e)" },
                        ].map(option => (
                          <div key={option.value} className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id={`type-${option.value}`}
                              checked={mandatProtectionData.typeMandat.includes(option.value)}
                              onChange={(e) => {
                                const newTypes = e.target.checked
                                  ? [...mandatProtectionData.typeMandat, option.value]
                                  : mandatProtectionData.typeMandat.filter(t => t !== option.value);
                                setMandatProtectionData({...mandatProtectionData, typeMandat: newTypes});
                              }}
                              className="w-4 h-4"
                            />
                            <Label htmlFor={`type-${option.value}`} className="cursor-pointer">{option.label}</Label>
                          </div>
                        ))}
                      </div>
                      <p className="text-xs text-gray-500 mt-2">
                        Le type de mandat d√©termine les pouvoirs permis.
                      </p>

                      {/* Pr√©cisions pour mandat pour autrui */}
                      {mandatProtectionData.typeMandat.includes("mandat_autrui") && (
                        <div className="space-y-4 mt-4 p-4 bg-orange-50 border border-orange-200 rounded-lg">
                          <p className="text-sm text-orange-800 font-medium">
                            ‚ö†Ô∏è Mandat pour autrui : uniquement possible pour un enfant mineur ou un enfant majeur handicap√©
                          </p>
                          <div className="space-y-2">
                            <Label>Lien juridique avec la personne prot√©g√©e <span className="text-red-500">*</span></Label>
                            <Input 
                              value={mandatProtectionData.mandatAutrui.lienJuridique}
                              onChange={(e) => setMandatProtectionData({
                                ...mandatProtectionData,
                                mandatAutrui: {...mandatProtectionData.mandatAutrui, lienJuridique: e.target.value}
                              })}
                              placeholder="Ex: Parent, Tuteur l√©gal..."
                            />
                          </div>
                          <div className="space-y-2">
                            <Label>Justification l√©gale <span className="text-red-500">*</span></Label>
                            <Textarea 
                              value={mandatProtectionData.mandatAutrui.justificationLegale}
                              onChange={(e) => setMandatProtectionData({
                                ...mandatProtectionData,
                                mandatAutrui: {...mandatProtectionData.mandatAutrui, justificationLegale: e.target.value}
                              })}
                              placeholder="Pr√©cisez: handicap, vuln√©rabilit√©, reconnaissance MDPH, etc."
                              rows={2}
                            />
                          </div>
                        </div>
                      )}
                    </div>
                  </div>

                  {/* SECTION 2: IDENTIT√â DU MANDANT */}
                  <div className="space-y-4 p-4 border rounded-lg bg-blue-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">2Ô∏è‚É£ Identit√© compl√®te du MANDANT (OBLIGATOIRE)</h3>
                    
                    {/* S√©lection client existant */}
                    <div className="space-y-2">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="mandant-is-client-mandat"
                          checked={mandatProtectionData.mandant.isClient}
                          onChange={(e) => {
                            setMandatProtectionData({
                              ...mandatProtectionData,
                              mandant: {...mandatProtectionData.mandant, isClient: e.target.checked, clientId: ""}
                            });
                          }}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="mandant-is-client-mandat" className="cursor-pointer">
                          Le mandant est un client existant
                        </Label>
                      </div>

                      {mandatProtectionData.mandant.isClient && (
                        <Select
                          value={mandatProtectionData.mandant.clientId}
                          onValueChange={(val) => {
                            setMandatProtectionData({
                              ...mandatProtectionData,
                              mandant: {...mandatProtectionData.mandant, clientId: val}
                            });
                            // Auto-fill depuis le client s√©lectionn√©
                            const selectedClient = clients.find(c => c.id === val);
                            if (selectedClient) {
                              setMandatProtectionData(prev => ({
                                ...prev,
                                mandant: {
                                  ...prev.mandant,
                                  clientId: val,
                                  nom: selectedClient.nom || "",
                                  prenom: selectedClient.prenom || "",
                                  nomNaissance: selectedClient.nom_naissance || "",
                                  dateNaissance: selectedClient.date_naissance || "",
                                  lieuNaissance: selectedClient.lieu_naissance || "",
                                  nationalite: selectedClient.nationalite || "",
                                  profession: selectedClient.profession || "",
                                  adresseComplete: selectedClient.adresse || "",
                                  telephone: selectedClient.telephone || "",
                                  email: selectedClient.email || "",
                                  typeIdentite: selectedClient.type_identite || "",
                                  numeroIdentite: selectedClient.numero_identite || "",
                                }
                              }));
                            }
                          }}
                        >
                          <SelectTrigger>
                            <SelectValue placeholder="S√©lectionner un client" />
                          </SelectTrigger>
                          <SelectContent>
                            {clients.map(c => (
                              <SelectItem key={c.id} value={c.id}>
                                {c.prenom} {c.nom}
                              </SelectItem>
                            ))}
                          </SelectContent>
                        </Select>
                      )}

                      {/* Upload pi√®ce d'identit√© mandant */}
                      {mandatProtectionData.mandant.clientId && (
                        <div className="space-y-2">
                          <Label>üìé Copie de la pi√®ce d'identit√©</Label>
                          {mandatProtectionMandantIdentiteUrl ? (
                            <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg">
                              <svg className="w-4 h-4 text-green-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                              </svg>
                              <span className="text-sm flex-1 text-green-700">Pi√®ce d'identit√© du client disponible</span>
                              <Button
                                type="button"
                                variant="ghost"
                                size="sm"
                                className="bg-green-600 hover:bg-green-700 text-white"
                                onClick={() => window.open(mandatProtectionMandantIdentiteUrl, '_blank')}
                              >
                                <Eye className="w-4 h-4" />
                              </Button>
                            </div>
                          ) : (
                            <div className="flex items-center gap-2 p-2 bg-orange-50 border border-orange-300 rounded-lg">
                              <svg className="w-4 h-4 text-orange-600 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                                <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                              </svg>
                              <span className="text-sm flex-1 text-orange-700">Aucune pi√®ce d'identit√© associ√©e √† ce client</span>
                            </div>
                          )}
                        </div>
                      )}

                      {!mandatProtectionData.mandant.isClient && (
                        <div className="space-y-2">
                          <Label>üìé Copie de la pi√®ce d'identit√©</Label>
                          {mandatProtectionMandantIdentiteUrl ? (
                            <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg">
                              <svg className="w-4 h-4 text-green-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                              </svg>
                              <span className="text-sm flex-1 text-green-700">Pi√®ce d'identit√© charg√©e</span>
                              <Button
                                type="button"
                                variant="ghost"
                                size="sm"
                                className="bg-green-600 hover:bg-green-700 text-white"
                                onClick={() => window.open(mandatProtectionMandantIdentiteUrl, '_blank')}
                              >
                                <Eye className="w-4 h-4" />
                              </Button>
                              <Button
                                type="button"
                                variant="ghost"
                                size="sm"
                                className="bg-red-600 hover:bg-red-700 text-white"
                                onClick={() => setMandatProtectionMandantIdentiteUrl(null)}
                              >
                                <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                </svg>
                              </Button>
                            </div>
                          ) : (
                            <button
                              type="button"
                              onClick={() => {
                                const input = document.createElement('input');
                                input.type = 'file';
                                input.accept = '.pdf,.jpg,.jpeg,.png';
                                input.onchange = (e: any) => {
                                  const file = e.target.files?.[0];
                                  if (file) {
                                    const url = URL.createObjectURL(file);
                                    setMandatProtectionMandantIdentiteUrl(url);
                                  }
                                };
                                input.click();
                              }}
                              className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                            >
                              <svg className="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                              </svg>
                              <span className="text-orange-700">Aucune pi√®ce charg√©e - Cliquer pour ajouter</span>
                            </button>
                          )}
                        </div>
                      )}
                    </div>

                    {/* Champs d'identit√© */}
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Nom <span className="text-red-500">*</span></Label>
                        <Input 
                          value={mandatProtectionData.mandant.nom}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandant: {...mandatProtectionData.mandant, nom: e.target.value}
                          })}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                        <Input 
                          value={mandatProtectionData.mandant.prenom}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandant: {...mandatProtectionData.mandant, prenom: e.target.value}
                          })}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Nom de naissance</Label>
                        <Input 
                          value={mandatProtectionData.mandant.nomNaissance}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandant: {...mandatProtectionData.mandant, nomNaissance: e.target.value}
                          })}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Date de naissance <span className="text-red-500">*</span></Label>
                        <Input 
                          type="date"
                          value={mandatProtectionData.mandant.dateNaissance}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandant: {...mandatProtectionData.mandant, dateNaissance: e.target.value}
                          })}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Lieu de naissance</Label>
                        <Input 
                          value={mandatProtectionData.mandant.lieuNaissance}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandant: {...mandatProtectionData.mandant, lieuNaissance: e.target.value}
                          })}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Nationalit√©</Label>
                        <Input 
                          value={mandatProtectionData.mandant.nationalite}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandant: {...mandatProtectionData.mandant, nationalite: e.target.value}
                          })}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Profession</Label>
                        <Input 
                          value={mandatProtectionData.mandant.profession}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandant: {...mandatProtectionData.mandant, profession: e.target.value}
                          })}
                        />
                      </div>
                    </div>

                    <div className="space-y-2">
                      <Label>Adresse compl√®te <span className="text-red-500">*</span></Label>
                      <Textarea 
                        value={mandatProtectionData.mandant.adresseComplete}
                        onChange={(e) => setMandatProtectionData({
                          ...mandatProtectionData,
                          mandant: {...mandatProtectionData.mandant, adresseComplete: e.target.value}
                        })}
                        rows={2}
                      />
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>T√©l√©phone</Label>
                        <Input 
                          value={mandatProtectionData.mandant.telephone}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandant: {...mandatProtectionData.mandant, telephone: e.target.value}
                          })}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Email</Label>
                        <Input 
                          type="email"
                          value={mandatProtectionData.mandant.email}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandant: {...mandatProtectionData.mandant, email: e.target.value}
                          })}
                        />
                      </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Situation familiale</Label>
                        <Input
                          value={mandatProtectionData.mandant.situationMatrimoniale}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandant: {...mandatProtectionData.mandant, situationMatrimoniale: e.target.value}
                          })}
                          placeholder="Renseign√©e automatiquement si client s√©lectionn√©"
                        />
                      </div>
                      {(mandatProtectionData.mandant.situationMatrimoniale === "marie" || mandatProtectionData.mandant.situationMatrimoniale === "pacse") && (
                        <div className="space-y-2">
                          <Label>R√©gime matrimonial</Label>
                          <Input 
                            value={mandatProtectionData.mandant.regimeMatrimonial}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              mandant: {...mandatProtectionData.mandant, regimeMatrimonial: e.target.value}
                            })}
                            placeholder="Ex: Communaut√© r√©duite aux acqu√™ts"
                          />
                        </div>
                      )}
                    </div>

                    {(mandatProtectionData.mandant.situationMatrimoniale === "marie" || mandatProtectionData.mandant.situationMatrimoniale === "pacse") && (
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <Label>Nom du conjoint</Label>
                          <Input 
                            value={mandatProtectionData.mandant.conjointNom}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              mandant: {...mandatProtectionData.mandant, conjointNom: e.target.value}
                            })}
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>Pr√©nom du conjoint</Label>
                          <Input 
                            value={mandatProtectionData.mandant.conjointPrenom}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              mandant: {...mandatProtectionData.mandant, conjointPrenom: e.target.value}
                            })}
                          />
                        </div>
                      </div>
                    )}

                    <div className="space-y-2">
                      <Label>Capacit√© juridique actuelle <span className="text-red-500">*</span></Label>
                      <Select
                        value={mandatProtectionData.mandant.capaciteJuridique}
                        onValueChange={(val) => setMandatProtectionData({
                          ...mandatProtectionData,
                          mandant: {...mandatProtectionData.mandant, capaciteJuridique: val}
                        })}
                      >
                        <SelectTrigger>
                          <SelectValue />
                        </SelectTrigger>
                        <SelectContent>
                          <SelectItem value="majeur_capable">Majeur capable</SelectItem>
                          <SelectItem value="sauvegarde_justice">Sauvegarde de justice (mandat impossible)</SelectItem>
                          <SelectItem value="curatelle">Curatelle (mandat limit√©)</SelectItem>
                          <SelectItem value="tutelle">Tutelle (mandat impossible)</SelectItem>
                        </SelectContent>
                      </Select>
                      {mandatProtectionData.mandant.capaciteJuridique === "sauvegarde_justice" && (
                        <p className="text-xs text-red-600 mt-1">‚ö†Ô∏è Un mandant sous sauvegarde de justice ne peut pas √©tablir de mandat de protection future</p>
                      )}
                      {mandatProtectionData.mandant.capaciteJuridique === "tutelle" && (
                        <p className="text-xs text-red-600 mt-1">‚ö†Ô∏è Un mandant sous tutelle ne peut pas √©tablir de mandat de protection future</p>
                      )}
                      {mandatProtectionData.mandant.capaciteJuridique === "curatelle" && (
                        <p className="text-xs text-orange-600 mt-1">‚ö†Ô∏è Mandat possible mais avec pouvoirs limit√©s</p>
                      )}
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                      <div className="space-y-2">
                        <Label>Type de pi√®ce d'identit√©</Label>
                        <Select
                          value={mandatProtectionData.mandant.typeIdentite}
                          onValueChange={(val) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandant: {...mandatProtectionData.mandant, typeIdentite: val}
                          })}
                        >
                          <SelectTrigger>
                            <SelectValue placeholder="S√©lectionner" />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="CNI">Carte nationale d'identit√©</SelectItem>
                            <SelectItem value="passeport">Passeport</SelectItem>
                            <SelectItem value="titre_sejour">Titre de s√©jour</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <Label>Num√©ro de pi√®ce</Label>
                        <Input 
                          value={mandatProtectionData.mandant.numeroIdentite}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandant: {...mandatProtectionData.mandant, numeroIdentite: e.target.value}
                          })}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Date d'expiration</Label>
                        <Input 
                          type="date"
                          value={mandatProtectionData.mandant.dateExpirationIdentite}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandant: {...mandatProtectionData.mandant, dateExpirationIdentite: e.target.value}
                          })}
                        />
                      </div>
                    </div>
                  </div>

                  {/* SECTION 3: MANDATAIRE PRINCIPAL */}
                  <div className="space-y-4 p-4 border rounded-lg bg-purple-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">3Ô∏è‚É£ Identit√© compl√®te du MANDATAIRE PRINCIPAL (OBLIGATOIRE)</h3>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Nom <span className="text-red-500">*</span></Label>
                        <Input 
                          value={mandatProtectionData.mandatairePrincipal.nom}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, nom: e.target.value}
                          })}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                        <Input 
                          value={mandatProtectionData.mandatairePrincipal.prenom}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, prenom: e.target.value}
                          })}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Date de naissance</Label>
                        <Input 
                          type="date"
                          value={mandatProtectionData.mandatairePrincipal.dateNaissance}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, dateNaissance: e.target.value}
                          })}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Lieu de naissance</Label>
                        <Input 
                          value={mandatProtectionData.mandatairePrincipal.lieuNaissance}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, lieuNaissance: e.target.value}
                          })}
                        />
                      </div>
                    </div>

                    <div className="space-y-2">
                      <Label>Adresse compl√®te <span className="text-red-500">*</span></Label>
                      <Textarea 
                        value={mandatProtectionData.mandatairePrincipal.adresseComplete}
                        onChange={(e) => setMandatProtectionData({
                          ...mandatProtectionData,
                          mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, adresseComplete: e.target.value}
                        })}
                        rows={2}
                      />
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Profession</Label>
                        <Input 
                          value={mandatProtectionData.mandatairePrincipal.profession}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, profession: e.target.value}
                          })}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Lien avec le mandant</Label>
                        <Select
                          value={mandatProtectionData.mandatairePrincipal.lienMandant}
                          onValueChange={(val) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, lienMandant: val}
                          })}
                        >
                          <SelectTrigger>
                            <SelectValue placeholder="S√©lectionner" />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="conjoint">Conjoint</SelectItem>
                            <SelectItem value="enfant">Enfant</SelectItem>
                            <SelectItem value="parent">Parent</SelectItem>
                            <SelectItem value="ami">Ami</SelectItem>
                            <SelectItem value="tiers_professionnel">Tiers professionnel</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <Label>T√©l√©phone</Label>
                        <Input 
                          value={mandatProtectionData.mandatairePrincipal.telephone}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, telephone: e.target.value}
                          })}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Email</Label>
                        <Input 
                          type="email"
                          value={mandatProtectionData.mandatairePrincipal.email}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, email: e.target.value}
                          })}
                        />
                      </div>
                    </div>

                    {/* Pi√®ce d'identit√© du mandataire */}
                    <div className="space-y-2">
                      <Label>üìé Copie de la pi√®ce</Label>
                      {mandatProtectionMandataireIdentiteFile ? (
                        <div className="flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg">
                          <svg className="w-4 h-4 text-green-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                          </svg>
                          <span className="text-sm flex-1 text-green-700">Pi√®ce d'identit√© charg√©e : {mandatProtectionMandataireIdentiteFile.name}</span>
                          <Button
                            type="button"
                            variant="ghost"
                            size="sm"
                            className="bg-green-600 hover:bg-green-700 text-white"
                            onClick={() => {
                              const url = URL.createObjectURL(mandatProtectionMandataireIdentiteFile);
                              window.open(url, '_blank');
                            }}
                          >
                            <Eye className="w-4 h-4" />
                          </Button>
                          <Button
                            type="button"
                            variant="ghost"
                            size="sm"
                            className="bg-red-600 hover:bg-red-700 text-white"
                            onClick={() => setMandatProtectionMandataireIdentiteFile(null)}
                          >
                            <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                            </svg>
                          </Button>
                        </div>
                      ) : (
                        <button
                          type="button"
                          onClick={() => {
                            const input = document.createElement('input');
                            input.type = 'file';
                            input.accept = '.pdf,.jpg,.jpeg,.png';
                            input.onchange = (e: any) => {
                              const file = e.target.files?.[0];
                              if (file) {
                                setMandatProtectionMandataireIdentiteFile(file);
                              }
                            };
                            input.click();
                          }}
                          className="w-full p-3 border-2 border-dashed border-orange-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-orange-50 hover:border-orange-400 transition-colors"
                        >
                          <svg className="w-5 h-5 text-orange-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                          </svg>
                          <span className="text-orange-700">Aucune pi√®ce charg√©e - Cliquer pour ajouter</span>
                        </button>
                      )}
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                      <div className="space-y-2">
                        <Label>Type de pi√®ce d'identit√©</Label>
                        <Select
                          value={mandatProtectionData.mandatairePrincipal.typeIdentite}
                          onValueChange={(val) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, typeIdentite: val}
                          })}
                        >
                          <SelectTrigger>
                            <SelectValue placeholder="S√©lectionner" />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="CNI">Carte nationale d'identit√©</SelectItem>
                            <SelectItem value="passeport">Passeport</SelectItem>
                            <SelectItem value="titre_sejour">Titre de s√©jour</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div className="space-y-2">
                        <Label>Num√©ro de pi√®ce</Label>
                        <Input 
                          value={mandatProtectionData.mandatairePrincipal.numeroIdentite}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, numeroIdentite: e.target.value}
                          })}
                        />
                      </div>
                      <div className="space-y-2">
                        <Label>Date d'expiration</Label>
                        <Input 
                          type="date"
                          value={mandatProtectionData.mandatairePrincipal.dateExpirationIdentite}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, dateExpirationIdentite: e.target.value}
                          })}
                        />
                      </div>
                    </div>

                    <div className="space-y-3">
                      <p className="text-sm font-medium text-gray-700">D√©clarations du mandataire :</p>
                      
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="absenceIncapaciteLegale"
                          checked={mandatProtectionData.mandatairePrincipal.absenceIncapaciteLegale}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, absenceIncapaciteLegale: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="absenceIncapaciteLegale" className="cursor-pointer">
                          N'est pas frapp√© d'une incapacit√© l√©gale
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="absenceDecheanceAutorite"
                          checked={mandatProtectionData.mandatairePrincipal.absenceDecheanceAutorite}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, absenceDecheanceAutorite: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="absenceDecheanceAutorite" className="cursor-pointer">
                          N'est pas d√©chu de l'autorit√© parentale
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="absenceInterdictionGestion"
                          checked={mandatProtectionData.mandatairePrincipal.absenceInterdictionGestion}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, absenceInterdictionGestion: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="absenceInterdictionGestion" className="cursor-pointer">
                          N'est pas interdit de gestion
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="absenceMesureProtection"
                          checked={mandatProtectionData.mandatairePrincipal.absenceMesureProtection}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, absenceMesureProtection: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="absenceMesureProtection" className="cursor-pointer">
                          N'est pas plac√© sous mesure de protection
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="acceptationEcrite"
                          checked={mandatProtectionData.mandatairePrincipal.acceptationEcrite}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            mandatairePrincipal: {...mandatProtectionData.mandatairePrincipal, acceptationEcrite: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="acceptationEcrite" className="cursor-pointer font-medium">
                          Acceptation √©crite du mandat <span className="text-red-500">*</span>
                        </Label>
                      </div>

                      <p className="text-xs text-red-600 mt-2">
                        ‚ö†Ô∏è Un juge peut invalider le mandat si le mandataire ne remplit pas ces conditions
                      </p>
                    </div>
                  </div>

                  {/* SECTION 4: MANDATAIRE SUBSTITUT */}
                  <div className="space-y-4 p-4 border rounded-lg bg-yellow-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">4Ô∏è‚É£ Mandataire substitut (optionnel)</h3>
                    
                    <div className="flex items-center space-x-2">
                      <input
                        type="checkbox"
                        id="mandataireSubstitutExiste"
                        checked={mandatProtectionData.mandataireSubstitut.existe}
                        onChange={(e) => setMandatProtectionData({
                          ...mandatProtectionData,
                          mandataireSubstitut: {...mandatProtectionData.mandataireSubstitut, existe: e.target.checked}
                        })}
                        className="w-4 h-4"
                      />
                      <Label htmlFor="mandataireSubstitutExiste" className="cursor-pointer">
                        Pr√©voir un mandataire substitut (rempla√ßant si le principal ne peut pas agir)
                      </Label>
                    </div>

                    {mandatProtectionData.mandataireSubstitut.existe && (
                      <div className="space-y-4 pl-6 border-l-2 border-yellow-300">
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          <div className="space-y-2">
                            <Label>Nom</Label>
                            <Input 
                              value={mandatProtectionData.mandataireSubstitut.nom}
                              onChange={(e) => setMandatProtectionData({
                                ...mandatProtectionData,
                                mandataireSubstitut: {...mandatProtectionData.mandataireSubstitut, nom: e.target.value}
                              })}
                            />
                          </div>
                          <div className="space-y-2">
                            <Label>Pr√©nom</Label>
                            <Input 
                              value={mandatProtectionData.mandataireSubstitut.prenom}
                              onChange={(e) => setMandatProtectionData({
                                ...mandatProtectionData,
                                mandataireSubstitut: {...mandatProtectionData.mandataireSubstitut, prenom: e.target.value}
                              })}
                            />
                          </div>
                          <div className="space-y-2">
                            <Label>Date de naissance</Label>
                            <Input 
                              type="date"
                              value={mandatProtectionData.mandataireSubstitut.dateNaissance}
                              onChange={(e) => setMandatProtectionData({
                                ...mandatProtectionData,
                                mandataireSubstitut: {...mandatProtectionData.mandataireSubstitut, dateNaissance: e.target.value}
                              })}
                            />
                          </div>
                          <div className="space-y-2">
                            <Label>Lieu de naissance</Label>
                            <Input 
                              value={mandatProtectionData.mandataireSubstitut.lieuNaissance}
                              onChange={(e) => setMandatProtectionData({
                                ...mandatProtectionData,
                                mandataireSubstitut: {...mandatProtectionData.mandataireSubstitut, lieuNaissance: e.target.value}
                              })}
                            />
                          </div>
                        </div>

                        <div className="space-y-2">
                          <Label>Adresse compl√®te</Label>
                          <Textarea 
                            value={mandatProtectionData.mandataireSubstitut.adresseComplete}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              mandataireSubstitut: {...mandatProtectionData.mandataireSubstitut, adresseComplete: e.target.value}
                            })}
                            rows={2}
                          />
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          <div className="space-y-2">
                            <Label>Profession</Label>
                            <Input 
                              value={mandatProtectionData.mandataireSubstitut.profession}
                              onChange={(e) => setMandatProtectionData({
                                ...mandatProtectionData,
                                mandataireSubstitut: {...mandatProtectionData.mandataireSubstitut, profession: e.target.value}
                              })}
                            />
                          </div>
                          <div className="space-y-2">
                            <Label>Lien avec le mandant</Label>
                            <Select
                              value={mandatProtectionData.mandataireSubstitut.lienMandant}
                              onValueChange={(val) => setMandatProtectionData({
                                ...mandatProtectionData,
                                mandataireSubstitut: {...mandatProtectionData.mandataireSubstitut, lienMandant: val}
                              })}
                            >
                              <SelectTrigger>
                                <SelectValue placeholder="S√©lectionner" />
                              </SelectTrigger>
                              <SelectContent>
                                <SelectItem value="conjoint">Conjoint</SelectItem>
                                <SelectItem value="enfant">Enfant</SelectItem>
                                <SelectItem value="parent">Parent</SelectItem>
                                <SelectItem value="ami">Ami</SelectItem>
                                <SelectItem value="tiers_professionnel">Tiers professionnel</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>
                          <div className="space-y-2">
                            <Label>T√©l√©phone</Label>
                            <Input 
                              value={mandatProtectionData.mandataireSubstitut.telephone}
                              onChange={(e) => setMandatProtectionData({
                                ...mandatProtectionData,
                                mandataireSubstitut: {...mandatProtectionData.mandataireSubstitut, telephone: e.target.value}
                              })}
                            />
                          </div>
                          <div className="space-y-2">
                            <Label>Email</Label>
                            <Input 
                              type="email"
                              value={mandatProtectionData.mandataireSubstitut.email}
                              onChange={(e) => setMandatProtectionData({
                                ...mandatProtectionData,
                                mandataireSubstitut: {...mandatProtectionData.mandataireSubstitut, email: e.target.value}
                              })}
                            />
                          </div>
                        </div>

                        <div className="space-y-2">
                          <Label>Conditions d'entr√©e en fonction</Label>
                          <Textarea 
                            value={mandatProtectionData.mandataireSubstitut.conditionsEntree}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              mandataireSubstitut: {...mandatProtectionData.mandataireSubstitut, conditionsEntree: e.target.value}
                            })}
                            placeholder="Ex: En cas de d√©c√®s, incapacit√©, refus du mandataire principal..."
                            rows={2}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>√âtendue des pouvoirs du substitut</Label>
                          <Textarea 
                            value={mandatProtectionData.mandataireSubstitut.etenduePouvoirs}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              mandataireSubstitut: {...mandatProtectionData.mandataireSubstitut, etenduePouvoirs: e.target.value}
                            })}
                            placeholder="Pr√©cisez les pouvoirs identiques ou diff√©rents du mandataire principal..."
                            rows={2}
                          />
                        </div>
                      </div>
                    )}
                  </div>

                  {/* SECTION 5: POUVOIRS SUR LA PERSONNE */}
                  <div className="space-y-4 p-4 border rounded-lg bg-green-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">5Ô∏è‚É£ A. Pouvoirs sur la personne du mandant</h3>
                    
                    <p className="text-sm text-gray-600">
                      S√©lectionnez les actes que le mandataire pourra accomplir pour la protection de la personne :
                    </p>

                    <div className="space-y-3">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="representationActesCourants"
                          checked={mandatProtectionData.pouvoirsPersonne.representationActesCourants}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsPersonne: {...mandatProtectionData.pouvoirsPersonne, representationActesCourants: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="representationActesCourants" className="cursor-pointer">
                          Repr√©senter pour les actes de la vie courante
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="choixEtablissement"
                          checked={mandatProtectionData.pouvoirsPersonne.choixEtablissement}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsPersonne: {...mandatProtectionData.pouvoirsPersonne, choixEtablissement: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="choixEtablissement" className="cursor-pointer">
                          Choisir l'√©tablissement d'h√©bergement
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="demarchesSociales"
                          checked={mandatProtectionData.pouvoirsPersonne.demarchesSociales}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsPersonne: {...mandatProtectionData.pouvoirsPersonne, demarchesSociales: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="demarchesSociales" className="cursor-pointer">
                          Repr√©senter dans les d√©marches sociales
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="organisationSoins"
                          checked={mandatProtectionData.pouvoirsPersonne.organisationSoins}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsPersonne: {...mandatProtectionData.pouvoirsPersonne, organisationSoins: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="organisationSoins" className="cursor-pointer">
                          Organiser et payer les soins
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="gestionMedecins"
                          checked={mandatProtectionData.pouvoirsPersonne.gestionMedecins}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsPersonne: {...mandatProtectionData.pouvoirsPersonne, gestionMedecins: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="gestionMedecins" className="cursor-pointer">
                          G√©rer les relations avec les m√©decins (dans le cadre l√©gal)
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="gestionQuotidien"
                          checked={mandatProtectionData.pouvoirsPersonne.gestionQuotidien}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsPersonne: {...mandatProtectionData.pouvoirsPersonne, gestionQuotidien: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="gestionQuotidien" className="cursor-pointer">
                          G√©rer le quotidien : transports, loisirs, s√©curit√©
                        </Label>
                      </div>
                    </div>

                    <div className="space-y-2">
                      <Label>Pr√©cisions / Autres pouvoirs sur la personne</Label>
                      <Textarea 
                        value={mandatProtectionData.pouvoirsPersonne.precisionsAutres}
                        onChange={(e) => setMandatProtectionData({
                          ...mandatProtectionData,
                          pouvoirsPersonne: {...mandatProtectionData.pouvoirsPersonne, precisionsAutres: e.target.value}
                        })}
                        rows={2}
                        placeholder="Pr√©cisez d'autres pouvoirs..."
                      />
                    </div>

                    <div className="p-3 bg-red-50 border border-red-200 rounded-lg">
                      <p className="text-xs text-red-700">
                        <strong>‚ö†Ô∏è Le mandataire ne peut JAMAIS :</strong> consentir au mariage, au divorce, √† des actes m√©dicaux graves sans autorisation, ou disposer du corps du mandant.
                      </p>
                    </div>
                  </div>

                  {/* SECTION 5B: POUVOIRS SUR LE PATRIMOINE - ADMINISTRATION */}
                  <div className="space-y-4 p-4 border rounded-lg bg-blue-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">5Ô∏è‚É£ B. Pouvoirs sur le patrimoine - Actes d'administration</h3>
                    
                    <p className="text-sm text-gray-600">
                      Ces actes sont g√©n√©ralement autoris√©s dans un mandat :
                    </p>

                    <div className="space-y-3">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="gestionComptes"
                          checked={mandatProtectionData.pouvoirsAdministration.gestionComptes}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsAdministration: {...mandatProtectionData.pouvoirsAdministration, gestionComptes: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="gestionComptes" className="cursor-pointer">
                          G√©rer les comptes bancaires
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="encaissementRevenus"
                          checked={mandatProtectionData.pouvoirsAdministration.encaissementRevenus}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsAdministration: {...mandatProtectionData.pouvoirsAdministration, encaissementRevenus: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="encaissementRevenus" className="cursor-pointer">
                          Encaisser les revenus
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="paiementDepenses"
                          checked={mandatProtectionData.pouvoirsAdministration.paiementDepenses}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsAdministration: {...mandatProtectionData.pouvoirsAdministration, paiementDepenses: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="paiementDepenses" className="cursor-pointer">
                          Payer les d√©penses courantes
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="renouvellementBail"
                          checked={mandatProtectionData.pouvoirsAdministration.renouvellementBail}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsAdministration: {...mandatProtectionData.pouvoirsAdministration, renouvellementBail: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="renouvellementBail" className="cursor-pointer">
                          Renouveler un bail
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="souscriptionAssurances"
                          checked={mandatProtectionData.pouvoirsAdministration.souscriptionAssurances}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsAdministration: {...mandatProtectionData.pouvoirsAdministration, souscriptionAssurances: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="souscriptionAssurances" className="cursor-pointer">
                          Souscrire assurance habitation / sant√©
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="entretienBiens"
                          checked={mandatProtectionData.pouvoirsAdministration.entretienBiens}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsAdministration: {...mandatProtectionData.pouvoirsAdministration, entretienBiens: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="entretienBiens" className="cursor-pointer">
                          Faire l'entretien courant des biens
                        </Label>
                      </div>
                    </div>
                  </div>

                  {/* SECTION 5C: POUVOIRS SUR LE PATRIMOINE - DISPOSITION */}
                  <div className="space-y-4 p-4 border rounded-lg bg-orange-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">5Ô∏è‚É£ C. Pouvoirs sur le patrimoine - Actes de disposition</h3>
                    
                    <div className="p-3 bg-orange-100 border border-orange-300 rounded-lg mb-4">
                      <p className="text-xs text-orange-800">
                        <strong>‚ö†Ô∏è Important :</strong> Ces actes ne sont autoris√©s que dans un mandat notari√©. S√©lectionnez uniquement si le mandat est authentique.
                      </p>
                    </div>

                    <div className="space-y-3">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="venteImmobilier"
                          checked={mandatProtectionData.pouvoirsDisposition.venteImmobilier}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsDisposition: {...mandatProtectionData.pouvoirsDisposition, venteImmobilier: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="venteImmobilier" className="cursor-pointer">
                          Vendre un bien immobilier
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="achatImmobilier"
                          checked={mandatProtectionData.pouvoirsDisposition.achatImmobilier}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsDisposition: {...mandatProtectionData.pouvoirsDisposition, achatImmobilier: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="achatImmobilier" className="cursor-pointer">
                          Acheter un bien
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="donationMobilier"
                          checked={mandatProtectionData.pouvoirsDisposition.donationMobilier}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsDisposition: {...mandatProtectionData.pouvoirsDisposition, donationMobilier: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="donationMobilier" className="cursor-pointer">
                          Donner un bien mobilier
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="gestionTitres"
                          checked={mandatProtectionData.pouvoirsDisposition.gestionTitres}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsDisposition: {...mandatProtectionData.pouvoirsDisposition, gestionTitres: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="gestionTitres" className="cursor-pointer">
                          G√©rer un portefeuille titres
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="resiliationBail"
                          checked={mandatProtectionData.pouvoirsDisposition.resiliationBail}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsDisposition: {...mandatProtectionData.pouvoirsDisposition, resiliationBail: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="resiliationBail" className="cursor-pointer">
                          R√©silier un bail
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="reglementDettes"
                          checked={mandatProtectionData.pouvoirsDisposition.reglementDettes}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsDisposition: {...mandatProtectionData.pouvoirsDisposition, reglementDettes: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="reglementDettes" className="cursor-pointer">
                          R√©gler des dettes importantes
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="acceptationSuccession"
                          checked={mandatProtectionData.pouvoirsDisposition.acceptationSuccession}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsDisposition: {...mandatProtectionData.pouvoirsDisposition, acceptationSuccession: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="acceptationSuccession" className="cursor-pointer">
                          Accepter une succession
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="renonciationSuccession"
                          checked={mandatProtectionData.pouvoirsDisposition.renonciationSuccession}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsDisposition: {...mandatProtectionData.pouvoirsDisposition, renonciationSuccession: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="renonciationSuccession" className="cursor-pointer">
                          Renoncer √† une succession (n√©cessite clause sp√©ciale)
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="donations"
                          checked={mandatProtectionData.pouvoirsDisposition.donations}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsDisposition: {...mandatProtectionData.pouvoirsDisposition, donations: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="donations" className="cursor-pointer">
                          Faire des donations
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="modificationsSuccessorales"
                          checked={mandatProtectionData.pouvoirsDisposition.modificationsSuccessorales}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsDisposition: {...mandatProtectionData.pouvoirsDisposition, modificationsSuccessorales: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="modificationsSuccessorales" className="cursor-pointer">
                          Effectuer des modifications successorales
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="actesGratuits"
                          checked={mandatProtectionData.pouvoirsDisposition.actesGratuits}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsDisposition: {...mandatProtectionData.pouvoirsDisposition, actesGratuits: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="actesGratuits" className="cursor-pointer">
                          Actes √† titre gratuit importants
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="modificationContratMariage"
                          checked={mandatProtectionData.pouvoirsDisposition.modificationContratMariage}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            pouvoirsDisposition: {...mandatProtectionData.pouvoirsDisposition, modificationContratMariage: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="modificationContratMariage" className="cursor-pointer">
                          Modifications de contrat de mariage
                        </Label>
                      </div>
                    </div>
                  </div>

                  {/* SECTION 6: LISTE DES BIENS */}
                  <div className="space-y-4 p-4 border rounded-lg bg-indigo-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">6Ô∏è‚É£ Liste des biens du mandant (patrimoine)</h3>
                    
                    <p className="text-sm text-gray-600">
                      Indispensable pour d√©terminer l'√©tendue du mandat :
                    </p>

                    <div className="space-y-4">
                      <div className="space-y-2">
                        <Label>Biens immobiliers</Label>
                        <Textarea 
                          value={mandatProtectionData.biensPatrimoine.biensImmobiliers}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            biensPatrimoine: {...mandatProtectionData.biensPatrimoine, biensImmobiliers: e.target.value}
                          })}
                          placeholder="Adresses, titres, valeurs estim√©es..."
                          rows={3}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Comptes bancaires</Label>
                        <Textarea 
                          value={mandatProtectionData.biensPatrimoine.comptesBancaires}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            biensPatrimoine: {...mandatProtectionData.biensPatrimoine, comptesBancaires: e.target.value}
                          })}
                          placeholder="Banques, num√©ros de comptes, montants approximatifs..."
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Contrats d'assurance-vie</Label>
                        <Textarea 
                          value={mandatProtectionData.biensPatrimoine.assurancesVie}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            biensPatrimoine: {...mandatProtectionData.biensPatrimoine, assurancesVie: e.target.value}
                          })}
                          placeholder="Compagnies, num√©ros de contrats, capitaux..."
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Livrets, PEL, PEA</Label>
                        <Textarea 
                          value={mandatProtectionData.biensPatrimoine.livretsEpargne}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            biensPatrimoine: {...mandatProtectionData.biensPatrimoine, livretsEpargne: e.target.value}
                          })}
                          placeholder="Types d'√©pargne et montants..."
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Biens mobiliers</Label>
                        <Textarea 
                          value={mandatProtectionData.biensPatrimoine.biensMobiliers}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            biensPatrimoine: {...mandatProtectionData.biensPatrimoine, biensMobiliers: e.target.value}
                          })}
                          placeholder="Voitures, ≈ìuvres d'art, bijoux, meubles de valeur..."
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Parts sociales / Valeurs mobili√®res</Label>
                        <Textarea 
                          value={mandatProtectionData.biensPatrimoine.partsSociales}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            biensPatrimoine: {...mandatProtectionData.biensPatrimoine, partsSociales: e.target.value}
                          })}
                          placeholder="Actions, obligations, SCPI, parts de soci√©t√©..."
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Revenus r√©guliers</Label>
                        <Textarea 
                          value={mandatProtectionData.biensPatrimoine.revenusReguliers}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            biensPatrimoine: {...mandatProtectionData.biensPatrimoine, revenusReguliers: e.target.value}
                          })}
                          placeholder="Salaires, pensions, retraites, loyers per√ßus..."
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Dettes existantes</Label>
                        <Textarea 
                          value={mandatProtectionData.biensPatrimoine.dettesExistantes}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            biensPatrimoine: {...mandatProtectionData.biensPatrimoine, dettesExistantes: e.target.value}
                          })}
                          placeholder="Cr√©dits, emprunts, dettes fiscales..."
                          rows={2}
                        />
                      </div>
                    </div>
                  </div>

                  {/* SECTION 7: LIMITES DU MANDAT */}
                  <div className="space-y-4 p-4 border rounded-lg bg-red-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">7Ô∏è‚É£ Limites du mandat (si n√©cessaire)</h3>
                    
                    <div className="space-y-4">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="interdictionVenteCertainsBiens"
                          checked={mandatProtectionData.limites.interdictionVenteCertainsBiens}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            limites: {...mandatProtectionData.limites, interdictionVenteCertainsBiens: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="interdictionVenteCertainsBiens" className="cursor-pointer">
                          Interdiction de vendre certains biens
                        </Label>
                      </div>

                      {mandatProtectionData.limites.interdictionVenteCertainsBiens && (
                        <div className="space-y-2 pl-6">
                          <Label>Biens concern√©s</Label>
                          <Textarea 
                            value={mandatProtectionData.limites.biensConcernes}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              limites: {...mandatProtectionData.limites, biensConcernes: e.target.value}
                            })}
                            placeholder="Pr√©cisez les biens qui ne peuvent pas √™tre vendus..."
                            rows={2}
                          />
                        </div>
                      )}

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="interdictionDeplacement"
                          checked={mandatProtectionData.limites.interdictionDeplacement}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            limites: {...mandatProtectionData.limites, interdictionDeplacement: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="interdictionDeplacement" className="cursor-pointer">
                          Interdiction de d√©placer le mandant sans accord familial
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="interdictionModificationContrats"
                          checked={mandatProtectionData.limites.interdictionModificationContrats}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            limites: {...mandatProtectionData.limites, interdictionModificationContrats: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="interdictionModificationContrats" className="cursor-pointer">
                          Interdiction de modifier certains contrats
                        </Label>
                      </div>

                      <div className="space-y-2">
                        <Label>Montant maximum pour les actes</Label>
                        <Input 
                          type="number"
                          value={mandatProtectionData.limites.montantMaximum}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            limites: {...mandatProtectionData.limites, montantMaximum: e.target.value}
                          })}
                          placeholder="Ex: 10000"
                        />
                        <p className="text-xs text-gray-500">Montant au-del√† duquel le mandataire ne peut pas agir seul</p>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="obligationComptesReguliers"
                          checked={mandatProtectionData.limites.obligationComptesReguliers}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            limites: {...mandatProtectionData.limites, obligationComptesReguliers: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="obligationComptesReguliers" className="cursor-pointer">
                          Obligation de rendre des comptes r√©guliers
                        </Label>
                      </div>

                      {mandatProtectionData.limites.obligationComptesReguliers && (
                        <div className="space-y-2 pl-6">
                          <Label>P√©riodicit√©</Label>
                          <Select
                            value={mandatProtectionData.limites.periodiciteComptes}
                            onValueChange={(val) => setMandatProtectionData({
                              ...mandatProtectionData,
                              limites: {...mandatProtectionData.limites, periodiciteComptes: val}
                            })}
                          >
                            <SelectTrigger>
                              <SelectValue placeholder="S√©lectionner" />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="mensuel">Mensuel</SelectItem>
                              <SelectItem value="trimestriel">Trimestriel</SelectItem>
                              <SelectItem value="semestriel">Semestriel</SelectItem>
                              <SelectItem value="annuel">Annuel</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                      )}
                    </div>
                  </div>

                  {/* SECTION 8: CONTR√îLE DU MANDATAIRE */}
                  <div className="space-y-4 p-4 border rounded-lg bg-purple-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">8Ô∏è‚É£ Contr√¥le du mandataire</h3>
                    
                    <div className="space-y-4">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="obligationCompteGestion"
                          checked={mandatProtectionData.controle.obligationCompteGestion}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            controle: {...mandatProtectionData.controle, obligationCompteGestion: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="obligationCompteGestion" className="cursor-pointer">
                          Obligation de tenir un compte de gestion
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="controlePersonne"
                          checked={mandatProtectionData.controle.controlePersonne}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            controle: {...mandatProtectionData.controle, controlePersonne: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="controlePersonne" className="cursor-pointer">
                          Contr√¥le par une personne d√©sign√©e
                        </Label>
                      </div>

                      {mandatProtectionData.controle.controlePersonne && (
                        <div className="space-y-4 pl-6 border-l-2 border-purple-300">
                          <div className="space-y-2">
                            <Label>Identit√© compl√®te du contr√¥leur</Label>
                            <Textarea 
                              value={mandatProtectionData.controle.controleIdentite}
                              onChange={(e) => setMandatProtectionData({
                                ...mandatProtectionData,
                                controle: {...mandatProtectionData.controle, controleIdentite: e.target.value}
                              })}
                              placeholder="Nom, pr√©nom, adresse, lien avec le mandant..."
                              rows={2}
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>√âtendue du contr√¥le / Pouvoirs du contr√¥leur</Label>
                            <Textarea 
                              value={mandatProtectionData.controle.controlePouvoirs}
                              onChange={(e) => setMandatProtectionData({
                                ...mandatProtectionData,
                                controle: {...mandatProtectionData.controle, controlePouvoirs: e.target.value}
                              })}
                              placeholder="D√©finissez ce que le contr√¥leur peut v√©rifier, demander, etc..."
                              rows={2}
                            />
                          </div>
                        </div>
                      )}

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="controleNotaire"
                          checked={mandatProtectionData.controle.controleNotaire}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            controle: {...mandatProtectionData.controle, controleNotaire: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="controleNotaire" className="cursor-pointer">
                          Contr√¥le par un notaire
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="controleExpertComptable"
                          checked={mandatProtectionData.controle.controleExpertComptable}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            controle: {...mandatProtectionData.controle, controleExpertComptable: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="controleExpertComptable" className="cursor-pointer">
                          Contr√¥le par un expert-comptable
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="compteRenduAnnuel"
                          checked={mandatProtectionData.controle.compteRenduAnnuel}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            controle: {...mandatProtectionData.controle, compteRenduAnnuel: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="compteRenduAnnuel" className="cursor-pointer">
                          Compte rendu annuel obligatoire
                        </Label>
                      </div>

                      <div className="space-y-2">
                        <Label>P√©riodicit√© du contr√¥le</Label>
                        <Select
                          value={mandatProtectionData.controle.periodicite}
                          onValueChange={(val) => setMandatProtectionData({
                            ...mandatProtectionData,
                            controle: {...mandatProtectionData.controle, periodicite: val}
                          })}
                        >
                          <SelectTrigger>
                            <SelectValue placeholder="S√©lectionner" />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="mensuel">Mensuel</SelectItem>
                            <SelectItem value="trimestriel">Trimestriel</SelectItem>
                            <SelectItem value="semestriel">Semestriel</SelectItem>
                            <SelectItem value="annuel">Annuel</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                    </div>
                  </div>

                  {/* SECTION 9: CONDITIONS DE MISE EN ≈íUVRE */}
                  <div className="space-y-4 p-4 border rounded-lg bg-yellow-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">9Ô∏è‚É£ Conditions de mise en ≈ìuvre du mandat</h3>
                    
                    <p className="text-sm text-gray-600 mb-4">
                      Le mandat ne prend effet qu'en cas d'incapacit√© du mandant.
                    </p>

                    <div className="space-y-4">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="certificatMedical"
                          checked={mandatProtectionData.miseEnOeuvre.certificatMedical}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            miseEnOeuvre: {...mandatProtectionData.miseEnOeuvre, certificatMedical: e.target.checked}
                          })}
                          className="w-4 h-4"
                          disabled
                        />
                        <Label htmlFor="certificatMedical" className="cursor-not-allowed opacity-70">
                          Certificat m√©dical circonstanci√© (OBLIGATOIRE)
                        </Label>
                      </div>

                      <div className="space-y-2">
                        <Label>M√©decin inscrit sur la liste du procureur</Label>
                        <Input 
                          value={mandatProtectionData.miseEnOeuvre.medecinListe}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            miseEnOeuvre: {...mandatProtectionData.miseEnOeuvre, medecinListe: e.target.value}
                          })}
                          placeholder="Nom du m√©decin"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Date de constat de l'incapacit√©</Label>
                        <Input 
                          type="date"
                          value={mandatProtectionData.miseEnOeuvre.dateConstat}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            miseEnOeuvre: {...mandatProtectionData.miseEnOeuvre, dateConstat: e.target.value}
                          })}
                        />
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="depotGreffe"
                          checked={mandatProtectionData.miseEnOeuvre.depotGreffe}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            miseEnOeuvre: {...mandatProtectionData.miseEnOeuvre, depotGreffe: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="depotGreffe" className="cursor-pointer">
                          Pr√©sentation du mandat au greffe du tribunal judiciaire comp√©tent lors de la mise en ≈ìuvre
                        </Label>
                      </div>

                      <div className="p-3 bg-orange-100 border border-orange-300 rounded-lg">
                        <p className="text-xs text-orange-800">
                          <strong>‚ö†Ô∏è Important :</strong> Le mandat n'est pas d√©pos√© au greffe lors de sa signature, mais pr√©sent√© lors de sa mise en ≈ìuvre effective.
                        </p>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="notificationMandataire"
                          checked={mandatProtectionData.miseEnOeuvre.notificationMandataire}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            miseEnOeuvre: {...mandatProtectionData.miseEnOeuvre, notificationMandataire: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="notificationMandataire" className="cursor-pointer">
                          Notification au mandataire
                        </Label>
                      </div>
                    </div>
                  </div>

                  {/* SECTION 10: FIN DU MANDAT */}
                  <div className="space-y-4 p-4 border rounded-lg bg-red-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">üîü Fin du mandat</h3>
                    
                    <p className="text-sm text-gray-600 mb-4">
                      S√©lectionnez les √©v√©nements qui mettent fin au mandat :
                    </p>

                    <div className="space-y-3">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="finRetourFacultes"
                          checked={mandatProtectionData.finMandat.finRetourFacultes}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            finMandat: {...mandatProtectionData.finMandat, finRetourFacultes: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="finRetourFacultes" className="cursor-pointer">
                          Fin au retour des facult√©s du mandant
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="revocationMandant"
                          checked={mandatProtectionData.finMandat.revocationMandant}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            finMandat: {...mandatProtectionData.finMandat, revocationMandant: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="revocationMandant" className="cursor-pointer">
                          R√©vocation par le mandant tant qu'il est capable
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="destitutionJuge"
                          checked={mandatProtectionData.finMandat.destitutionJuge}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            finMandat: {...mandatProtectionData.finMandat, destitutionJuge: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="destitutionJuge" className="cursor-pointer">
                          Destitution du mandataire par le juge
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="decesMandant"
                          checked={mandatProtectionData.finMandat.decesMandant}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            finMandat: {...mandatProtectionData.finMandat, decesMandant: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="decesMandant" className="cursor-pointer">
                          D√©c√®s du mandant
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="remplacementSubstitut"
                          checked={mandatProtectionData.finMandat.remplacementSubstitut}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            finMandat: {...mandatProtectionData.finMandat, remplacementSubstitut: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="remplacementSubstitut" className="cursor-pointer">
                          Remplacement par le mandataire substitut
                        </Label>
                      </div>
                    </div>
                  </div>

                  {/* SECTION 11: D√âCLARATIONS OBLIGATOIRES */}
                  <div className="space-y-4 p-4 border rounded-lg bg-orange-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">1Ô∏è‚É£1Ô∏è‚É£ D√©clarations obligatoires du mandant</h3>
                    
                    <p className="text-sm text-red-600 mb-4">
                      <strong>‚ö†Ô∏è Ces d√©clarations sont OBLIGATOIRES pour la validit√© du mandat :</strong>
                    </p>

                    <div className="space-y-3">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="volonteLibre"
                          checked={mandatProtectionData.declarations.volonteLibre}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            declarations: {...mandatProtectionData.declarations, volonteLibre: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="volonteLibre" className="cursor-pointer font-medium">
                          D√©claration de volont√© libre et √©clair√©e <span className="text-red-500">*</span>
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="consentementSansPression"
                          checked={mandatProtectionData.declarations.consentementSansPression}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            declarations: {...mandatProtectionData.declarations, consentementSansPression: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="consentementSansPression" className="cursor-pointer font-medium">
                          Consentement sans pression <span className="text-red-500">*</span>
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="explicationComprise"
                          checked={mandatProtectionData.declarations.explicationComprise}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            declarations: {...mandatProtectionData.declarations, explicationComprise: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="explicationComprise" className="cursor-pointer font-medium">
                          Explication comprise des cons√©quences juridiques <span className="text-red-500">*</span>
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="acceptationActesDisposition"
                          checked={mandatProtectionData.declarations.acceptationActesDisposition}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            declarations: {...mandatProtectionData.declarations, acceptationActesDisposition: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="acceptationActesDisposition" className="cursor-pointer font-medium">
                          Acceptation ou refus de certains actes de disposition <span className="text-red-500">*</span>
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="acceptationMandataire"
                          checked={mandatProtectionData.declarations.acceptationMandataire}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            declarations: {...mandatProtectionData.declarations, acceptationMandataire: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="acceptationMandataire" className="cursor-pointer font-medium">
                          Acceptation du mandataire d√©sign√© <span className="text-red-500">*</span>
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="droitRevocation"
                          checked={mandatProtectionData.declarations.droitRevocation}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            declarations: {...mandatProtectionData.declarations, droitRevocation: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="droitRevocation" className="cursor-pointer font-medium">
                          Mention que le mandant peut r√©voquer tant qu'il est lucide <span className="text-red-500">*</span>
                        </Label>
                      </div>
                    </div>
                  </div>

                  {/* SECTION 12: FORME DU MANDAT */}
                  <div className="space-y-4 p-4 border rounded-lg bg-blue-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">1Ô∏è‚É£2Ô∏è‚É£ Forme du mandat</h3>
                    
                    <div className="space-y-4">
                      <div className="space-y-2">
                        <Label>Type d'acte <span className="text-red-500">*</span></Label>
                        <Select
                          value={mandatProtectionData.forme.typeActe}
                          onValueChange={(val) => setMandatProtectionData({
                            ...mandatProtectionData,
                            forme: {...mandatProtectionData.forme, typeActe: val}
                          })}
                        >
                          <SelectTrigger>
                            <SelectValue placeholder="S√©lectionner" />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="notarie">Mandat notari√© (authentique)</SelectItem>
                            <SelectItem value="sous_seing_prive">Mandat sous seing priv√©</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {mandatProtectionData.forme.typeActe === "notarie" && (
                        <div className="p-3 bg-blue-100 border border-blue-300 rounded-lg">
                          <p className="text-xs text-blue-800">
                            <strong>‚úÖ Mandat notari√© :</strong> Permet les actes de disposition lourds (vente d'immeubles, etc.). Doit √™tre sign√© devant notaire.
                          </p>
                        </div>
                      )}

                      {mandatProtectionData.forme.typeActe === "sous_seing_prive" && (
                        <div className="p-3 bg-orange-100 border border-orange-300 rounded-lg">
                          <p className="text-xs text-orange-800">
                            <strong>‚ö†Ô∏è Mandat sous seing priv√© :</strong> Pouvoirs plus limit√©s. Ne permet pas les actes de disposition importants.
                          </p>
                        </div>
                      )}

                      {mandatProtectionData.forme.typeActe === "notarie" && (
                        <>
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="space-y-2">
                              <Label>Nom du notaire</Label>
                              <Input 
                                value={mandatProtectionData.forme.nomNotaire}
                                onChange={(e) => setMandatProtectionData({
                                  ...mandatProtectionData,
                                  forme: {...mandatProtectionData.forme, nomNotaire: e.target.value}
                                })}
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Ville de l'office notarial</Label>
                              <Input 
                                value={mandatProtectionData.forme.villeOffice}
                                onChange={(e) => setMandatProtectionData({
                                  ...mandatProtectionData,
                                  forme: {...mandatProtectionData.forme, villeOffice: e.target.value}
                                })}
                              />
                            </div>
                          </div>
                        </>
                      )}

                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <Label>Date de signature <span className="text-red-500">*</span></Label>
                          <Input 
                            type="date"
                            value={mandatProtectionData.forme.dateSignature}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              forme: {...mandatProtectionData.forme, dateSignature: e.target.value}
                            })}
                          />
                          <p className="text-xs text-gray-500">
                            Date de signature de l'acte
                          </p>
                        </div>
                        <div className="space-y-2">
                          <Label>Date de prise d'effet</Label>
                          <Input 
                            type="date"
                            value={mandatProtectionData.forme.datePriseEffet}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              forme: {...mandatProtectionData.forme, datePriseEffet: e.target.value}
                            })}
                          />
                          <p className="text-xs text-gray-500">
                            Date effective de mise en ≈ìuvre (si diff√©rente)
                          </p>
                        </div>
                      </div>

                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <Label>Lieu de signature</Label>
                          <Input 
                            value={mandatProtectionData.forme.lieuSignature}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              forme: {...mandatProtectionData.forme, lieuSignature: e.target.value}
                            })}
                          />
                        </div>
                      </div>

                      <div className="p-3 bg-blue-100 border border-blue-300 rounded-lg">
                        <p className="text-xs text-blue-800">
                          <strong>‚ÑπÔ∏è Information :</strong> La date de signature est la date de r√©daction du mandat. La date de prise d'effet est la date √† laquelle le mandat entre en vigueur (g√©n√©ralement constat√©e par le m√©decin ou le juge).
                        </p>
                      </div>
                    </div>
                  </div>

                  {/* SECTION 13: JURIDICTION ET CONSERVATION */}
                  <div className="space-y-4 p-4 border rounded-lg bg-purple-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">1Ô∏è‚É£3Ô∏è‚É£ Juridiction et conservation</h3>
                    
                    <div className="space-y-4">
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <Label>Tribunal judiciaire comp√©tent <span className="text-red-500">*</span></Label>
                          <Input 
                            value={mandatProtectionData.juridictionConservation.tribunalCompetent}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              juridictionConservation: {...mandatProtectionData.juridictionConservation, tribunalCompetent: e.target.value}
                            })}
                            placeholder="Ex: Tribunal judiciaire de Paris"
                          />
                          <p className="text-xs text-gray-500">
                            G√©n√©ralement le tribunal du domicile du mandant
                          </p>
                        </div>
                        <div className="space-y-2">
                          <Label>Ville de la juridiction <span className="text-red-500">*</span></Label>
                          <Input 
                            value={mandatProtectionData.juridictionConservation.villeJuridiction}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              juridictionConservation: {...mandatProtectionData.juridictionConservation, villeJuridiction: e.target.value}
                            })}
                            placeholder="Ex: Paris"
                          />
                        </div>
                      </div>

                      <div className="space-y-2">
                        <Label>Lieu de conservation du mandat <span className="text-red-500">*</span></Label>
                        <Select
                          value={mandatProtectionData.juridictionConservation.lieuConservation}
                          onValueChange={(val) => setMandatProtectionData({
                            ...mandatProtectionData,
                            juridictionConservation: {...mandatProtectionData.juridictionConservation, lieuConservation: val}
                          })}
                        >
                          <SelectTrigger>
                            <SelectValue placeholder="S√©lectionner" />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="notaire">Chez le notaire</SelectItem>
                            <SelectItem value="mandant">Chez le mandant</SelectItem>
                            <SelectItem value="tiers">Chez un tiers de confiance</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {mandatProtectionData.juridictionConservation.lieuConservation === "tiers" && (
                        <div className="space-y-2">
                          <Label>Pr√©cisions sur le lieu de conservation</Label>
                          <textarea 
                            value={mandatProtectionData.juridictionConservation.precisionsConservation}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              juridictionConservation: {...mandatProtectionData.juridictionConservation, precisionsConservation: e.target.value}
                            })}
                            placeholder="Identit√© et adresse du tiers conservant le mandat"
                            className="w-full min-h-[60px] p-2 border rounded-md"
                          />
                        </div>
                      )}
                    </div>
                  </div>

                  {/* SECTION 14: FRAIS ET R√âMUN√âRATION */}
                  <div className="space-y-4 p-4 border rounded-lg bg-amber-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">1Ô∏è‚É£4Ô∏è‚É£ Frais et r√©mun√©ration</h3>
                    
                    <div className="space-y-4">
                      <div className="space-y-2">
                        <Label>R√©mun√©ration du mandataire <span className="text-red-500">*</span></Label>
                        <div className="space-y-2">
                          <div className="flex items-center space-x-2">
                            <input
                              type="radio"
                              id="remunerationGratuit"
                              checked={mandatProtectionData.remuneration.typeRemuneration === "gratuit"}
                              onChange={() => setMandatProtectionData({
                                ...mandatProtectionData,
                                remuneration: {...mandatProtectionData.remuneration, typeRemuneration: "gratuit"}
                              })}
                              className="w-4 h-4"
                            />
                            <Label htmlFor="remunerationGratuit" className="cursor-pointer">
                              Mandat gratuit
                            </Label>
                          </div>
                          <div className="flex items-center space-x-2">
                            <input
                              type="radio"
                              id="remunerationRemunere"
                              checked={mandatProtectionData.remuneration.typeRemuneration === "remunere"}
                              onChange={() => setMandatProtectionData({
                                ...mandatProtectionData,
                                remuneration: {...mandatProtectionData.remuneration, typeRemuneration: "remunere"}
                              })}
                              className="w-4 h-4"
                            />
                            <Label htmlFor="remunerationRemunere" className="cursor-pointer">
                              Mandat r√©mun√©r√©
                            </Label>
                          </div>
                        </div>
                      </div>

                      {mandatProtectionData.remuneration.typeRemuneration === "remunere" && (
                        <div className="space-y-2">
                          <Label>Modalit√©s de r√©mun√©ration <span className="text-red-500">*</span></Label>
                          <textarea 
                            value={mandatProtectionData.remuneration.modalitesRemuneration}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              remuneration: {...mandatProtectionData.remuneration, modalitesRemuneration: e.target.value}
                            })}
                            placeholder="Montant, p√©riodicit√©, conditions de versement..."
                            className="w-full min-h-[80px] p-2 border rounded-md"
                          />
                        </div>
                      )}

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="remboursementFrais"
                          checked={mandatProtectionData.remuneration.remboursementFrais}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            remuneration: {...mandatProtectionData.remuneration, remboursementFrais: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="remboursementFrais" className="cursor-pointer">
                          Remboursement des frais expos√©s par le mandataire
                        </Label>
                      </div>

                      {mandatProtectionData.remuneration.remboursementFrais && (
                        <div className="space-y-2">
                          <Label>Pr√©cisions sur le remboursement des frais</Label>
                          <textarea 
                            value={mandatProtectionData.remuneration.precisionsRemboursement}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              remuneration: {...mandatProtectionData.remuneration, precisionsRemboursement: e.target.value}
                            })}
                            placeholder="Nature des frais remboursables, justificatifs requis, plafond √©ventuel..."
                            className="w-full min-h-[60px] p-2 border rounded-md"
                          />
                        </div>
                      )}
                    </div>
                  </div>

                  {/* SECTION 15: CLAUSES SP√âCIALES */}
                  <div className="space-y-4 p-4 border rounded-lg bg-indigo-50/30">
                    <h3 className="font-semibold text-lg border-b pb-2">1Ô∏è‚É£5Ô∏è‚É£ Clauses sp√©ciales</h3>
                    
                    <div className="space-y-4">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="prioriteFamiliale"
                          checked={mandatProtectionData.clausesSpeciales.prioriteFamiliale}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            clausesSpeciales: {...mandatProtectionData.clausesSpeciales, prioriteFamiliale: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="prioriteFamiliale" className="cursor-pointer">
                          Priorit√© au maintien dans l'environnement familial
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="obligationInformationFamille"
                          checked={mandatProtectionData.clausesSpeciales.obligationInformationFamille}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            clausesSpeciales: {...mandatProtectionData.clausesSpeciales, obligationInformationFamille: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="obligationInformationFamille" className="cursor-pointer">
                          Obligation d'information r√©guli√®re de la famille
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="ordreSubstitution"
                          checked={mandatProtectionData.clausesSpeciales.ordreSubstitution}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            clausesSpeciales: {...mandatProtectionData.clausesSpeciales, ordreSubstitution: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="ordreSubstitution" className="cursor-pointer">
                          Ordre de substitution des mandataires en cas d'emp√™chement
                        </Label>
                      </div>

                      <div className="p-4 bg-red-50 border border-red-300 rounded-lg space-y-3">
                        <p className="text-sm font-semibold text-red-800">‚öñÔ∏è Clauses l√©gales fondamentales</p>
                        
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="obligationInteretExclusif"
                            checked={mandatProtectionData.clausesSpeciales.obligationInteretExclusif}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              clausesSpeciales: {...mandatProtectionData.clausesSpeciales, obligationInteretExclusif: e.target.checked}
                            })}
                            className="w-4 h-4"
                            disabled
                          />
                          <Label htmlFor="obligationInteretExclusif" className="cursor-not-allowed opacity-70 font-medium">
                            Obligation d'agir dans l'int√©r√™t exclusif du mandant <span className="text-red-500">*</span>
                          </Label>
                        </div>

                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="responsabiliteCivile"
                            checked={mandatProtectionData.clausesSpeciales.responsabiliteCivile}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              clausesSpeciales: {...mandatProtectionData.clausesSpeciales, responsabiliteCivile: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="responsabiliteCivile" className="cursor-pointer">
                            Responsabilit√© civile en cas de faute ou n√©gligence
                          </Label>
                        </div>

                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="assuranceRC"
                            checked={mandatProtectionData.clausesSpeciales.responsabiliteCivile}
                            onChange={(e) => setMandatProtectionData({
                              ...mandatProtectionData,
                              clausesSpeciales: {...mandatProtectionData.clausesSpeciales, responsabiliteCivile: e.target.checked}
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="assuranceRC" className="cursor-pointer">
                            Souscription d'une assurance responsabilit√© civile professionnelle
                          </Label>
                        </div>

                        <p className="text-xs text-red-600 mt-2">
                          ‚ö†Ô∏è Ces clauses prot√®gent juridiquement le mandant et sont souvent exig√©es par le greffe
                        </p>
                      </div>

                      <div className="space-y-3 p-4 bg-orange-50 border border-orange-300 rounded-lg">
                        <p className="text-sm font-semibold text-orange-800">üéÅ Donations et actes √† titre gratuit</p>
                        
                        <div className="space-y-2">
                          <Label>Autorisation des donations <span className="text-red-500">*</span></Label>
                          <Select
                            value={mandatProtectionData.clausesSpeciales.donationsAutorisees}
                            onValueChange={(val) => setMandatProtectionData({
                              ...mandatProtectionData,
                              clausesSpeciales: {...mandatProtectionData.clausesSpeciales, donationsAutorisees: val}
                            })}
                          >
                            <SelectTrigger>
                              <SelectValue placeholder="S√©lectionner" />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="interdites">‚ùå Donations strictement interdites</SelectItem>
                              <SelectItem value="presentsUsage">‚úÖ Pr√©sents d'usage autoris√©s uniquement</SelectItem>
                              <SelectItem value="limitees">‚ö†Ô∏è Donations limit√©es (avec conditions)</SelectItem>
                              <SelectItem value="autorisees">‚úÖ Donations autoris√©es</SelectItem>
                            </SelectContent>
                          </Select>
                          <p className="text-xs text-gray-500">
                            Clause expresse exig√©e par la loi (source fr√©quente de contentieux)
                          </p>
                        </div>

                        {(mandatProtectionData.clausesSpeciales.donationsAutorisees === "presentsUsage" || 
                          mandatProtectionData.clausesSpeciales.donationsAutorisees === "limitees" || 
                          mandatProtectionData.clausesSpeciales.donationsAutorisees === "autorisees") && (
                          <div className="space-y-2">
                            <Label>B√©n√©ficiaires autoris√©s</Label>
                            <textarea 
                              value={mandatProtectionData.clausesSpeciales.beneficiairesAutorises}
                              onChange={(e) => setMandatProtectionData({
                                ...mandatProtectionData,
                                clausesSpeciales: {...mandatProtectionData.clausesSpeciales, beneficiairesAutorises: e.target.value}
                              })}
                              placeholder="Ex: Descendants directs, petits-enfants, ≈ìuvres caritatives sp√©cifiques..."
                              className="w-full min-h-[60px] p-2 border rounded-md"
                            />
                          </div>
                        )}

                        {mandatProtectionData.clausesSpeciales.donationsAutorisees === "limitees" && (
                          <div className="p-2 bg-orange-100 border border-orange-400 rounded">
                            <p className="text-xs text-orange-800">
                              üí° Pr√©cisez les montants maximaux, fr√©quence, occasions autoris√©es (anniversaires, f√™tes...)
                            </p>
                          </div>
                        )}
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="comptesRendusPeriodicite"
                          checked={mandatProtectionData.clausesSpeciales.comptesRendusPeriodicite}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            clausesSpeciales: {...mandatProtectionData.clausesSpeciales, comptesRendusPeriodicite: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="comptesRendusPeriodicite" className="cursor-pointer">
                          P√©riodicit√© des comptes rendus de gestion
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="accordsAutoriteProtection"
                          checked={mandatProtectionData.clausesSpeciales.accordsAutoriteProtection}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            clausesSpeciales: {...mandatProtectionData.clausesSpeciales, accordsAutoriteProtection: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="accordsAutoriteProtection" className="cursor-pointer">
                          N√©cessit√© d'accords pr√©alables pour certains actes (juge, famille)
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="interdictionsSpecifiques"
                          checked={mandatProtectionData.clausesSpeciales.interdictionsSpecifiques}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            clausesSpeciales: {...mandatProtectionData.clausesSpeciales, interdictionsSpecifiques: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="interdictionsSpecifiques" className="cursor-pointer">
                          Interdictions sp√©cifiques (ex: vente de la r√©sidence principale)
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="revocabilite"
                          checked={mandatProtectionData.clausesSpeciales.revocabilite}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            clausesSpeciales: {...mandatProtectionData.clausesSpeciales, revocabilite: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="revocabilite" className="cursor-pointer">
                          Modalit√©s de r√©vocation du mandat
                        </Label>
                      </div>

                      <div className="space-y-2">
                        <Label>Autres clauses particuli√®res</Label>
                        <textarea 
                          value={mandatProtectionData.clausesSpeciales.autresClausesParticulieres}
                          onChange={(e) => setMandatProtectionData({
                            ...mandatProtectionData,
                            clausesSpeciales: {...mandatProtectionData.clausesSpeciales, autresClausesParticulieres: e.target.value}
                          })}
                          placeholder="Toute autre clause jug√©e utile par le mandant..."
                          className="w-full min-h-[100px] p-2 border rounded-md"
                        />
                      </div>

                      <div className="p-3 bg-blue-100 border border-blue-300 rounded-lg">
                        <p className="text-xs text-blue-800">
                          <strong>üí° Conseil :</strong> Les clauses sp√©ciales permettent d'adapter le mandat aux souhaits du mandant. Elles doivent respecter l'ordre public et les bonnes m≈ìurs.
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </>
            )}

            {/* Formulaire Attestation de propri√©t√© immobili√®re */}
            {pendingContractType === "Attestation de propri√©t√© immobili√®re" && (
              <div className="space-y-6">
                {/* Section 1 : Informations sur le d√©funt */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Informations sur le d√©funt</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Nom <span className="text-red-500">*</span></Label>
                        <Input 
                          value={attestationData.defunt.nom}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, nom: e.target.value}
                          })}
                          placeholder="Nom de famille"
                          required
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                        <Input 
                          value={attestationData.defunt.prenom}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, prenom: e.target.value}
                          })}
                          placeholder="Pr√©nom"
                          required
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Nom de naissance (si diff√©rent)</Label>
                        <Input 
                          value={attestationData.defunt.nomNaissance}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, nomNaissance: e.target.value}
                          })}
                          placeholder="Nom de jeune fille"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Sexe</Label>
                        <Select 
                          value={attestationData.defunt.sexe}
                          onValueChange={(value) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, sexe: value}
                          })}
                        >
                          <SelectTrigger>
                            <SelectValue placeholder="S√©lectionner" />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="masculin">Masculin</SelectItem>
                            <SelectItem value="feminin">F√©minin</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="space-y-2">
                        <Label>Date de naissance</Label>
                        <Input 
                          type="date"
                          value={attestationData.defunt.dateNaissance}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, dateNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Lieu de naissance</Label>
                        <Input 
                          value={attestationData.defunt.lieuNaissance}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, lieuNaissance: e.target.value}
                          })}
                          placeholder="Ville, d√©partement, pays"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Nationalit√©</Label>
                        <Input 
                          value={attestationData.defunt.nationalite}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, nationalite: e.target.value}
                          })}
                          placeholder="Fran√ßaise"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Profession</Label>
                        <Input 
                          value={attestationData.defunt.profession}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, profession: e.target.value}
                          })}
                          placeholder="Profession exerc√©e"
                        />
                      </div>
                    </div>

                    <div className="space-y-2">
                      <Label>Derni√®re adresse compl√®te du d√©funt</Label>
                      <textarea 
                        value={attestationData.defunt.adresseDecesComplete}
                        onChange={(e) => setAttestationData({
                          ...attestationData,
                          defunt: {...attestationData.defunt, adresseDecesComplete: e.target.value}
                        })}
                        placeholder="Num√©ro, rue, code postal, ville"
                        className="w-full min-h-[60px] p-2 border rounded-md"
                      />
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Date de d√©c√®s <span className="text-red-500">*</span></Label>
                        <Input 
                          type="date"
                          value={attestationData.defunt.dateDeces}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, dateDeces: e.target.value}
                          })}
                          required
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Lieu de d√©c√®s</Label>
                        <Input 
                          value={attestationData.defunt.lieuDeces}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, lieuDeces: e.target.value}
                          })}
                          placeholder="Ville du d√©c√®s"
                        />
                      </div>
                    </div>

                    <div className="space-y-4 p-4 bg-red-50 rounded-lg border border-red-200">
                      <h4 className="font-medium text-red-700">üèõÔ∏è Dernier domicile fiscal <span className="text-red-500">*</span></h4>
                      
                      <div className="space-y-2">
                        <Label>Commune du dernier domicile fiscal <span className="text-red-500">*</span></Label>
                        <Input 
                          value={attestationData.defunt.domicileFiscalCommune || ""}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, domicileFiscalCommune: e.target.value}
                          })}
                          placeholder="Commune"
                          required
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Pays <span className="text-red-500">*</span></Label>
                        <Input 
                          value={attestationData.defunt.domicileFiscalPays || ""}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, domicileFiscalPays: e.target.value}
                          })}
                          placeholder="France"
                          required
                        />
                      </div>

                      <div className="p-3 bg-red-100 border border-red-300 rounded">
                        <p className="text-xs text-red-800">
                          ‚ö†Ô∏è <strong>Obligatoire</strong> pour d√©terminer la loi successorale, la comp√©tence fiscale et la d√©claration de succession
                        </p>
                      </div>
                    </div>

                    <div className="space-y-4 p-4 bg-white rounded-lg border">
                      <h4 className="font-medium text-gray-700">üíç Situation matrimoniale</h4>
                      
                      <div className="space-y-2">
                        <Label>Situation matrimoniale du d√©funt</Label>
                        <Select 
                          value={attestationData.defunt.situationMatrimoniale}
                          onValueChange={(value) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, situationMatrimoniale: value}
                          })}
                        >
                          <SelectTrigger>
                            <SelectValue placeholder="S√©lectionner" />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="celibataire">C√©libataire</SelectItem>
                            <SelectItem value="marie">Mari√©(e)</SelectItem>
                            <SelectItem value="pacse">Pacs√©(e)</SelectItem>
                            <SelectItem value="divorce">Divorc√©(e)</SelectItem>
                            <SelectItem value="veuf">Veuf/Veuve</SelectItem>
                            <SelectItem value="concubinage">Concubinage</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {(attestationData.defunt.situationMatrimoniale === "marie" || 
                        attestationData.defunt.situationMatrimoniale === "divorce" ||
                        attestationData.defunt.situationMatrimoniale === "veuf") && (
                        <div className="space-y-4">
                          <div className="space-y-2">
                            <Label>R√©gime matrimonial applicable <span className="text-red-500">*</span></Label>
                            <Select 
                              value={attestationData.defunt.regimeMatrimonial}
                              onValueChange={(value) => setAttestationData({
                                ...attestationData,
                                defunt: {...attestationData.defunt, regimeMatrimonial: value}
                              })}
                            >
                              <SelectTrigger>
                                <SelectValue placeholder="S√©lectionner" />
                              </SelectTrigger>
                              <SelectContent>
                                <SelectItem value="communaute_legale">Communaut√© l√©gale (r√©duite aux acqu√™ts)</SelectItem>
                                <SelectItem value="separation_biens">S√©paration de biens</SelectItem>
                                <SelectItem value="communaute_universelle">Communaut√© universelle</SelectItem>
                                <SelectItem value="participation_acquets">Participation aux acqu√™ts</SelectItem>
                                <SelectItem value="autre">Autre (pr√©ciser)</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          {attestationData.defunt.regimeMatrimonial === "autre" && (
                            <div className="space-y-2">
                              <Label>Pr√©ciser le r√©gime</Label>
                              <Input 
                                value={attestationData.defunt.regimeMatrimonialAutre || ""}
                                onChange={(e) => setAttestationData({
                                  ...attestationData,
                                  defunt: {...attestationData.defunt, regimeMatrimonialAutre: e.target.value}
                                })}
                                placeholder="D√©tails du r√©gime matrimonial"
                              />
                            </div>
                          )}

                          {attestationData.defunt.existenceContratMariage && (
                            <>
                              <div className="space-y-2">
                                <Label>Date du contrat de mariage</Label>
                                <Input 
                                  type="date"
                                  value={attestationData.defunt.dateContratMariage || ""}
                                  onChange={(e) => setAttestationData({
                                    ...attestationData,
                                    defunt: {...attestationData.defunt, dateContratMariage: e.target.value}
                                  })}
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Notaire r√©dacteur du contrat</Label>
                                <Input 
                                  value={attestationData.defunt.notaireContratMariage || ""}
                                  onChange={(e) => setAttestationData({
                                    ...attestationData,
                                    defunt: {...attestationData.defunt, notaireContratMariage: e.target.value}
                                  })}
                                  placeholder="Nom et office du notaire"
                                />
                              </div>
                            </>
                          )}

                          <div className="p-3 bg-orange-100 border border-orange-300 rounded">
                            <p className="text-xs text-orange-800">
                              ‚ö†Ô∏è <strong>Essentiel</strong> pour d√©terminer les droits du conjoint survivant
                            </p>
                          </div>
                        </div>
                      )}
                    </div>

                    <div className="space-y-4 p-4 bg-amber-50 rounded-lg border border-amber-200">
                      <h4 className="font-medium text-amber-800">üìÑ Documents et dispositions du d√©funt</h4>
                      
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="existenceContratMariage"
                          checked={attestationData.defunt.existenceContratMariage}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, existenceContratMariage: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="existenceContratMariage" className="cursor-pointer">
                          Existence d'un contrat de mariage
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="existencePacs"
                          checked={attestationData.defunt.existencePacs}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, existencePacs: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="existencePacs" className="cursor-pointer">
                          Existence d'un PACS
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="existenceTestament"
                          checked={attestationData.defunt.existenceTestament}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, existenceTestament: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="existenceTestament" className="cursor-pointer">
                          Existence d'un testament
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="existenceDonationsEntreEpoux"
                          checked={attestationData.defunt.existenceDonationsEntreEpoux}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, existenceDonationsEntreEpoux: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="existenceDonationsEntreEpoux" className="cursor-pointer">
                          Donations entre √©poux
                        </Label>
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="existenceDonationsAnterieures"
                          checked={attestationData.defunt.existenceDonationsAnterieures}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            defunt: {...attestationData.defunt, existenceDonationsAnterieures: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="existenceDonationsAnterieures" className="cursor-pointer">
                          Donations ant√©rieures au d√©c√®s
                        </Label>
                      </div>
                    </div>
                  </div>

                  {/* Section 2 : H√©ritiers */}
                  <div>
                    <h3 className="font-semibold text-lg border-b pb-2 mb-4">H√©ritiers et succession</h3>
                    <div className="space-y-6">
                      {attestationData.heritiers.map((heritier, index) => (
                        <div key={heritier.id} className="p-4 bg-white rounded-lg border border-green-300 space-y-4">
                          <div className="flex justify-between items-center">
                            <h4 className="font-medium text-green-700">H√©ritier #{index + 1}</h4>
                            {attestationData.heritiers.length > 1 && (
                              <Button
                                type="button"
                                variant="destructive"
                                size="sm"
                                onClick={() => {
                                  setAttestationData({
                                    ...attestationData,
                                    heritiers: attestationData.heritiers.filter(h => h.id !== heritier.id)
                                  });
                                }}
                              >
                                Supprimer
                              </Button>
                            )}
                          </div>

                          <div className="space-y-2">
                            <Label>üë§ S√©lectionner un client existant (optionnel)</Label>
                            <Select 
                              value={heritier.clientId || "none"}
                              onValueChange={(value) => {
                                const updated = [...attestationData.heritiers];
                                if (value === "none") {
                                  // R√©initialiser aux valeurs vides pour saisie manuelle
                                  updated[index] = {...heritier, clientId: ""};
                                } else {
                                  // Remplir avec les donn√©es du client
                                  const selectedClient = clients.find(c => c.id === value);
                                  if (selectedClient) {
                                    // Calculer le statut d'√¢ge si date de naissance disponible
                                    let statutAge = "";
                                    if (selectedClient.date_naissance) {
                                      const birthDate = new Date(selectedClient.date_naissance);
                                      const today = new Date();
                                      let age = today.getFullYear() - birthDate.getFullYear();
                                      const monthDiff = today.getMonth() - birthDate.getMonth();
                                      if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                                        age--;
                                      }
                                      statutAge = age >= 18 ? "majeur" : "mineur";
                                    }
                                    updated[index] = {
                                      ...heritier,
                                      clientId: value,
                                      nom: selectedClient.nom,
                                      prenom: selectedClient.prenom,
                                      dateNaissance: selectedClient.date_naissance || "",
                                      lieuNaissance: selectedClient.lieu_naissance || "",
                                      adresseComplete: selectedClient.adresse || "",
                                      email: selectedClient.email || "",
                                      telephone: selectedClient.telephone || "",
                                      nationalite: selectedClient.nationalite || "",
                                      profession: selectedClient.profession || "",
                                      statutAge,
                                    };
                                  }
                                }
                                setAttestationData({...attestationData, heritiers: updated});
                              }}
                            >
                              <SelectTrigger>
                                <SelectValue placeholder="Aucun client s√©lectionn√© (saisie manuelle)" />
                              </SelectTrigger>
                              <SelectContent>
                                <SelectItem value="none">‚ùå Aucun (saisie manuelle)</SelectItem>
                                {clients.map((client) => (
                                  <SelectItem key={client.id} value={client.id}>
                                    üë§ {client.prenom} {client.nom}
                                  </SelectItem>
                                ))}
                              </SelectContent>
                            </Select>
                            {heritier.clientId && heritier.clientId !== "" && (
                              <p className="text-xs text-green-600 flex items-center gap-1">
                                ‚úÖ Client s√©lectionn√© - Les champs sont pr√©-remplis
                              </p>
                            )}
                          </div>

                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="space-y-2">
                              <Label>Nom <span className="text-red-500">*</span></Label>
                              <Input 
                                value={heritier.nom}
                                onChange={(e) => {
                                  const updated = [...attestationData.heritiers];
                                  updated[index] = {...heritier, nom: e.target.value};
                                  setAttestationData({...attestationData, heritiers: updated});
                                }}
                                placeholder="Nom"
                                required
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                              <Input 
                                value={heritier.prenom}
                                onChange={(e) => {
                                  const updated = [...attestationData.heritiers];
                                  updated[index] = {...heritier, prenom: e.target.value};
                                  setAttestationData({...attestationData, heritiers: updated});
                                }}
                                placeholder="Pr√©nom"
                                required
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>Date de naissance</Label>
                              <Input 
                                type="date"
                                value={heritier.dateNaissance}
                                onChange={(e) => {
                                  const updated = [...attestationData.heritiers];
                                  // Calculer l'√¢ge automatiquement
                                  const birthDate = new Date(e.target.value);
                                  const today = new Date();
                                  let age = today.getFullYear() - birthDate.getFullYear();
                                  const monthDiff = today.getMonth() - birthDate.getMonth();
                                  if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                                    age--;
                                  }
                                  const statutAge = age >= 18 ? "majeur" : "mineur";
                                  updated[index] = {...heritier, dateNaissance: e.target.value, statutAge};
                                  setAttestationData({...attestationData, heritiers: updated});
                                }}
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>Lieu de naissance</Label>
                              <Input 
                                value={heritier.lieuNaissance}
                                onChange={(e) => {
                                  const updated = [...attestationData.heritiers];
                                  updated[index] = {...heritier, lieuNaissance: e.target.value};
                                  setAttestationData({...attestationData, heritiers: updated});
                                }}
                                placeholder="Ville, pays"
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>Lien de parent√© avec le d√©funt</Label>
                              <Select 
                                value={heritier.lienParente}
                                onValueChange={(value) => {
                                  const updated = [...attestationData.heritiers];
                                  updated[index] = {...heritier, lienParente: value};
                                  setAttestationData({...attestationData, heritiers: updated});
                                }}
                              >
                                <SelectTrigger>
                                  <SelectValue placeholder="S√©lectionner" />
                                </SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="conjoint">Conjoint survivant</SelectItem>
                                  <SelectItem value="enfant">Enfant</SelectItem>
                                  <SelectItem value="petit-enfant">Petit-enfant</SelectItem>
                                  <SelectItem value="parent">Parent (p√®re/m√®re)</SelectItem>
                                  <SelectItem value="frere_soeur">Fr√®re/S≈ìur</SelectItem>
                                  <SelectItem value="neveu_niece">Neveu/Ni√®ce</SelectItem>
                                  <SelectItem value="autre">Autre</SelectItem>
                                </SelectContent>
                              </Select>
                            </div>

                            <div className="space-y-2">
                              <Label>Type d'acceptation de la succession</Label>
                              <Select 
                                value={heritier.typeAcceptation}
                                onValueChange={(value) => {
                                  const updated = [...attestationData.heritiers];
                                  updated[index] = {...heritier, typeAcceptation: value};
                                  setAttestationData({...attestationData, heritiers: updated});
                                }}
                              >
                                <SelectTrigger>
                                  <SelectValue placeholder="S√©lectionner" />
                                </SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="pure_simple">Acceptation pure et simple</SelectItem>
                                  <SelectItem value="concurrence_actif">√Ä concurrence de l'actif net</SelectItem>
                                  <SelectItem value="renonciation">Renonciation</SelectItem>
                                </SelectContent>
                              </Select>
                            </div>

                            <div className="space-y-2">
                              <Label>Statut (√¢ge) - Calcul√© automatiquement</Label>
                              <div className="p-3 bg-gray-100 rounded-md border">
                                {heritier.dateNaissance ? (
                                  <div className="flex items-center gap-2">
                                    <span className={`px-3 py-1 rounded-full text-sm font-semibold ${
                                      heritier.statutAge === "majeur" 
                                        ? "bg-green-100 text-green-800" 
                                        : "bg-orange-100 text-orange-800"
                                    }`}>
                                      {heritier.statutAge === "majeur" ? "‚úÖ Majeur" : "‚ö†Ô∏è Mineur"}
                                    </span>
                                    <span className="text-sm text-gray-600">
                                      (n√©(e) le {new Date(heritier.dateNaissance).toLocaleDateString('fr-FR')})
                                    </span>
                                  </div>
                                ) : (
                                  <span className="text-sm text-gray-500 italic">
                                    Saisissez la date de naissance pour calculer le statut
                                  </span>
                                )}
                              </div>
                            </div>

                            <div className="space-y-2">
                              <Label>Nationalit√©</Label>
                              <Input 
                                value={heritier.nationalite}
                                onChange={(e) => {
                                  const updated = [...attestationData.heritiers];
                                  updated[index] = {...heritier, nationalite: e.target.value};
                                  setAttestationData({...attestationData, heritiers: updated});
                                }}
                                placeholder="Fran√ßaise"
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>Profession</Label>
                              <Input 
                                value={heritier.profession}
                                onChange={(e) => {
                                  const updated = [...attestationData.heritiers];
                                  updated[index] = {...heritier, profession: e.target.value};
                                  setAttestationData({...attestationData, heritiers: updated});
                                }}
                                placeholder="Profession"
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>Email</Label>
                              <Input 
                                type="email"
                                value={heritier.email}
                                onChange={(e) => {
                                  const updated = [...attestationData.heritiers];
                                  updated[index] = {...heritier, email: e.target.value};
                                  setAttestationData({...attestationData, heritiers: updated});
                                }}
                                placeholder="email@exemple.fr"
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>T√©l√©phone</Label>
                              <Input 
                                value={heritier.telephone}
                                onChange={(e) => {
                                  const updated = [...attestationData.heritiers];
                                  updated[index] = {...heritier, telephone: e.target.value};
                                  setAttestationData({...attestationData, heritiers: updated});
                                }}
                                placeholder="06 12 34 56 78"
                              />
                            </div>

                            <div className="space-y-2">
                              <Label>Protection juridique √©ventuelle</Label>
                              <Select 
                                value={heritier.protectionJuridique}
                                onValueChange={(value) => {
                                  const updated = [...attestationData.heritiers];
                                  updated[index] = {...heritier, protectionJuridique: value};
                                  setAttestationData({...attestationData, heritiers: updated});
                                }}
                              >
                                <SelectTrigger>
                                  <SelectValue placeholder="Aucune" />
                                </SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="aucune">Aucune</SelectItem>
                                  <SelectItem value="tutelle">Sous tutelle</SelectItem>
                                  <SelectItem value="curatelle">Sous curatelle</SelectItem>
                                  <SelectItem value="sauvegarde_justice">Sauvegarde de justice</SelectItem>
                                </SelectContent>
                              </Select>
                            </div>
                          </div>

                          <div className="space-y-2">
                            <Label>Adresse compl√®te</Label>
                            <textarea 
                              value={heritier.adresseComplete}
                              onChange={(e) => {
                                const updated = [...attestationData.heritiers];
                                updated[index] = {...heritier, adresseComplete: e.target.value};
                                setAttestationData({...attestationData, heritiers: updated});
                              }}
                              placeholder="Num√©ro, rue, code postal, ville"
                              className="w-full min-h-[60px] p-2 border rounded-md"
                            />
                          </div>
                        </div>
                      ))}

                      <Button
                        type="button"
                        variant="outline"
                        className="w-full border-green-300 text-green-700 hover:bg-green-50"
                        onClick={() => {
                          const newId = Math.max(...attestationData.heritiers.map(h => h.id)) + 1;
                          setAttestationData({
                            ...attestationData,
                            heritiers: [...attestationData.heritiers, {
                              id: newId, nom: "", prenom: "", dateNaissance: "", lieuNaissance: "", 
                              lienParente: "", adresseComplete: "", email: "", telephone: "", 
                              nationalite: "", profession: "", typeAcceptation: "", statutAge: "", 
                              protectionJuridique: "",
                            }]
                          });
                        }}
                      >
                        + Ajouter un h√©ritier
                      </Button>
                    </div>

                    {/* Conjoint survivant */}
                    <div className="mt-6 p-4 bg-purple-50 rounded-lg border border-purple-200 space-y-4">
                      <h4 className="font-medium text-purple-800">üíë Conjoint survivant (si applicable)</h4>
                      
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="conjointExiste"
                          checked={attestationData.conjointSurvivant.existe}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            conjointSurvivant: {...attestationData.conjointSurvivant, existe: e.target.checked}
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="conjointExiste" className="cursor-pointer">
                          Le d√©funt laisse un conjoint survivant
                        </Label>
                      </div>

                      {attestationData.conjointSurvivant.existe && (
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          <div className="space-y-2">
                            <Label>Nom du conjoint</Label>
                            <Input 
                              value={attestationData.conjointSurvivant.nom}
                              onChange={(e) => setAttestationData({
                                ...attestationData,
                                conjointSurvivant: {...attestationData.conjointSurvivant, nom: e.target.value}
                              })}
                              placeholder="Nom"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Pr√©nom du conjoint</Label>
                            <Input 
                              value={attestationData.conjointSurvivant.prenom}
                              onChange={(e) => setAttestationData({
                                ...attestationData,
                                conjointSurvivant: {...attestationData.conjointSurvivant, prenom: e.target.value}
                              })}
                              placeholder="Pr√©nom"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>R√©gime matrimonial</Label>
                            <Input 
                              value={attestationData.conjointSurvivant.regimeMatrimonial}
                              onChange={(e) => setAttestationData({
                                ...attestationData,
                                conjointSurvivant: {...attestationData.conjointSurvivant, regimeMatrimonial: e.target.value}
                              })}
                              placeholder="Ex: Communaut√© r√©duite aux acqu√™ts"
                            />
                          </div>

                          <div className="space-y-2">
                            <Label>Droits du conjoint</Label>
                            <Input 
                              value={attestationData.conjointSurvivant.droitsConjoint}
                              onChange={(e) => setAttestationData({
                                ...attestationData,
                                conjointSurvivant: {...attestationData.conjointSurvivant, droitsConjoint: e.target.value}
                              })}
                              placeholder="Ex: Usufruit, 1/4 en pleine propri√©t√©"
                            />
                          </div>
                        </div>
                      )}
                    </div>
                  </div>

                  {/* Section 3 : Biens immobiliers */}
                  <div>
                    <h3 className="font-semibold text-lg border-b pb-2 mb-4">Biens immobiliers concern√©s</h3>
                    <div className="space-y-6">
                      {attestationData.biens.map((bien, index) => (
                        <div key={bien.id} className="p-4 bg-white rounded-lg border border-blue-300 space-y-4">
                          <div className="flex justify-between items-center">
                            <h4 className="font-medium text-blue-700">Bien immobilier #{index + 1}</h4>
                            {attestationData.biens.length > 1 && (
                              <Button
                                type="button"
                                variant="destructive"
                                size="sm"
                                onClick={() => {
                                  setAttestationData({
                                    ...attestationData,
                                    biens: attestationData.biens.filter(b => b.id !== bien.id)
                                  });
                                }}
                              >
                                Supprimer ce bien
                              </Button>
                            )}
                          </div>

                          {/* Identit√© cadastrale */}
                          <div className="p-3 bg-gray-50 rounded space-y-3">
                            <h5 className="font-medium text-sm text-gray-700">üìç Identit√© et localisation</h5>
                            
                            <div className="space-y-2">
                              <Label>Adresse compl√®te du bien <span className="text-red-500">*</span></Label>
                              <textarea 
                                value={bien.adresseComplete}
                                onChange={(e) => {
                                  const updated = [...attestationData.biens];
                                  updated[index] = {...bien, adresseComplete: e.target.value};
                                  setAttestationData({...attestationData, biens: updated});
                                }}
                                placeholder="Num√©ro, rue, code postal, ville"
                                className="w-full min-h-[60px] p-2 border rounded-md"
                                required
                              />
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                              <div className="space-y-2">
                                <Label>Code postal</Label>
                                <Input 
                                  value={bien.codePostal}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, codePostal: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="75001"
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Commune</Label>
                                <Input 
                                  value={bien.commune}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, commune: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="Paris"
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Section cadastrale</Label>
                                <Input 
                                  value={bien.cadastreSection}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, cadastreSection: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="AB"
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Num√©ro de parcelle</Label>
                                <Input 
                                  value={bien.cadastreNumero}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, cadastreNumero: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="123"
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Contenance cadastrale</Label>
                                <Input 
                                  value={bien.cadastreContenance}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, cadastreContenance: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="500 m¬≤"
                                />
                              </div>
                            </div>
                          </div>

                          {/* Description du bien */}
                          <div className="p-3 bg-amber-50 rounded space-y-3">
                            <h5 className="font-medium text-sm text-amber-700">üèòÔ∏è Description du bien</h5>
                            
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                              <div className="space-y-2">
                                <Label>Type de bien</Label>
                                <Select 
                                  value={bien.typeBien}
                                  onValueChange={(value) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, typeBien: value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                >
                                  <SelectTrigger>
                                    <SelectValue placeholder="S√©lectionner" />
                                  </SelectTrigger>
                                  <SelectContent>
                                    <SelectItem value="appartement">Appartement</SelectItem>
                                    <SelectItem value="maison">Maison</SelectItem>
                                    <SelectItem value="terrain">Terrain</SelectItem>
                                    <SelectItem value="immeuble">Immeuble</SelectItem>
                                    <SelectItem value="local_commercial">Local commercial</SelectItem>
                                    <SelectItem value="parking">Parking/Garage</SelectItem>
                                    <SelectItem value="autre">Autre</SelectItem>
                                  </SelectContent>
                                </Select>
                              </div>

                              <div className="space-y-2">
                                <Label>Surface habitable</Label>
                                <Input 
                                  value={bien.surfaceHabitable}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, surfaceHabitable: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="80 m¬≤"
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Nombre de pi√®ces</Label>
                                <Input 
                                  value={bien.nombrePieces}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, nombrePieces: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="3"
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>D√©pendances</Label>
                                <Input 
                                  value={bien.dependances}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, dependances: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="Cave, garage..."
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Annexes</Label>
                                <Input 
                                  value={bien.annexes}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, annexes: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="Jardin, terrasse..."
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>√âquipements</Label>
                                <Input 
                                  value={bien.equipements}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, equipements: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="Chauffage, ascenseur..."
                                />
                              </div>
                            </div>
                          </div>

                          {/* Situation locative */}
                          <div className="p-3 bg-green-50 rounded space-y-3">
                            <h5 className="font-medium text-sm text-green-700">üèòÔ∏è Situation locative</h5>
                            
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                              <div className="space-y-2">
                                <Label>Le bien est-il lou√© ?</Label>
                                <Select 
                                  value={bien.situationLocative}
                                  onValueChange={(value) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, situationLocative: value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                >
                                  <SelectTrigger>
                                    <SelectValue placeholder="S√©lectionner" />
                                  </SelectTrigger>
                                  <SelectContent>
                                    <SelectItem value="libre">Libre d'occupation</SelectItem>
                                    <SelectItem value="loue">Lou√©</SelectItem>
                                    <SelectItem value="occupe_heritier">Occup√© par un h√©ritier</SelectItem>
                                  </SelectContent>
                                </Select>
                              </div>

                              {bien.situationLocative === "loue" && (
                                <div className="space-y-2">
                                  <Label>Montant du loyer mensuel</Label>
                                  <Input 
                                    value={bien.montantLoyer}
                                    onChange={(e) => {
                                      const updated = [...attestationData.biens];
                                      updated[index] = {...bien, montantLoyer: e.target.value};
                                      setAttestationData({...attestationData, biens: updated});
                                    }}
                                    placeholder="1200 ‚Ç¨"
                                  />
                                </div>
                              )}
                            </div>
                          </div>

                          {/* Origine de propri√©t√© */}
                          <div className="p-3 bg-purple-50 rounded space-y-3">
                            <h5 className="font-medium text-sm text-purple-700">üìú Origine de propri√©t√© <span className="text-red-500">*</span></h5>
                            
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                              <div className="space-y-2">
                                <Label>Date d'acquisition par le d√©funt</Label>
                                <Input 
                                  type="date"
                                  value={bien.dateAcquisition}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, dateAcquisition: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Nature de l'acquisition</Label>
                                <Select 
                                  value={bien.natureAcquisition}
                                  onValueChange={(value) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, natureAcquisition: value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                >
                                  <SelectTrigger>
                                    <SelectValue placeholder="S√©lectionner" />
                                  </SelectTrigger>
                                  <SelectContent>
                                    <SelectItem value="achat">Achat</SelectItem>
                                    <SelectItem value="donation">Donation</SelectItem>
                                    <SelectItem value="succession">Succession</SelectItem>
                                    <SelectItem value="construction">Construction</SelectItem>
                                  </SelectContent>
                                </Select>
                              </div>

                              <div className="space-y-2">
                                <Label>Notaire r√©dacteur de l'acte <span className="text-red-500">*</span></Label>
                                <Input 
                                  value={bien.notaireAcquisition || ""}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, notaireAcquisition: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="Ma√Ætre X, office notarial de..."
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Date de publication SPF <span className="text-red-500">*</span></Label>
                                <Input 
                                  type="date"
                                  value={bien.datePublicationSPF || ""}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, datePublicationSPF: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Volume SPF <span className="text-red-500">*</span></Label>
                                <Input 
                                  value={bien.volumeSPF || ""}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, volumeSPF: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="Ex: 2024-15"
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Num√©ro SPF <span className="text-red-500">*</span></Label>
                                <Input 
                                  value={bien.numeroSPF || ""}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, numeroSPF: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="Ex: 42"
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>R√©partition des droits</Label>
                                <Input 
                                  value={bien.repartitionDroits}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, repartitionDroits: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="Ex: Pleine propri√©t√©"
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Quote-part du d√©funt</Label>
                                <Input 
                                  value={bien.quotePart}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, quotePart: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="100% ou 1/2, 1/3..."
                                />
                              </div>
                            </div>

                            <div className="p-3 bg-purple-100 border border-purple-300 rounded mt-3">
                              <p className="text-xs text-purple-800">
                                ‚ö†Ô∏è <strong>R√©f√©rences SPF obligatoires</strong> - Le Service de la Publicit√© Fonci√®re refusera l'attestation sans ces informations
                              </p>
                            </div>
                          </div>

                          {/* Legs particuliers */}
                          <div className="p-3 bg-amber-50 rounded space-y-3">
                            <h5 className="font-medium text-sm text-amber-700">üìã Legs particuliers</h5>
                            
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id={`legsParticuliers-${index}`}
                                checked={bien.existenceLegsParticuliers || false}
                                onChange={(e) => {
                                  const updated = [...attestationData.biens];
                                  updated[index] = {...bien, existenceLegsParticuliers: e.target.checked};
                                  setAttestationData({...attestationData, biens: updated});
                                }}
                                className="w-4 h-4"
                              />
                              <Label htmlFor={`legsParticuliers-${index}`} className="cursor-pointer">
                                Existence de legs particuliers portant sur ce bien
                              </Label>
                            </div>

                            {bien.existenceLegsParticuliers && (
                              <div className="space-y-2 mt-2">
                                <Label>Pr√©ciser les legs</Label>
                                <textarea 
                                  value={bien.precisionLegs || ""}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, precisionLegs: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="Nature et b√©n√©ficiaires des legs..."
                                  className="w-full min-h-[60px] p-2 border rounded-md"
                                />
                              </div>
                            )}
                          </div>

                          {/* Servitudes */}
                          <div className="p-3 bg-orange-50 rounded space-y-3">
                            <h5 className="font-medium text-sm text-orange-700">‚öñÔ∏è Servitudes</h5>
                            
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                              <div className="space-y-2">
                                <Label>Servitudes actives (au b√©n√©fice du bien)</Label>
                                <textarea 
                                  value={bien.servitudesActives}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, servitudesActives: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="Ex: Droit de passage..."
                                  className="w-full min-h-[60px] p-2 border rounded-md"
                                />
                              </div>

                              <div className="space-y-2">
                                <Label>Servitudes passives (√† la charge du bien)</Label>
                                <textarea 
                                  value={bien.servitudesPassives}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, servitudesPassives: e.target.value};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  placeholder="Ex: Servitude de vue..."
                                  className="w-full min-h-[60px] p-2 border rounded-md"
                                />
                              </div>
                            </div>
                          </div>

                          {/* Charges et hypoth√®ques */}
                          <div className="p-3 bg-red-50 rounded space-y-3">
                            <h5 className="font-medium text-sm text-red-700">üí∞ Charges, pr√™ts et hypoth√®ques</h5>
                            
                            <div className="space-y-4">
                              <div className="flex items-center space-x-2">
                                <input
                                  type="checkbox"
                                  id={`pretEnCours-${index}`}
                                  checked={bien.pretEnCours}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, pretEnCours: e.target.checked};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  className="w-4 h-4"
                                />
                                <Label htmlFor={`pretEnCours-${index}`} className="cursor-pointer">
                                  Pr√™t immobilier en cours
                                </Label>
                              </div>

                              <div className="flex items-center space-x-2">
                                <input
                                  type="checkbox"
                                  id={`hypothequeInscrite-${index}`}
                                  checked={bien.hypothequeInscrite}
                                  onChange={(e) => {
                                    const updated = [...attestationData.biens];
                                    updated[index] = {...bien, hypothequeInscrite: e.target.checked};
                                    setAttestationData({...attestationData, biens: updated});
                                  }}
                                  className="w-4 h-4"
                                />
                                <Label htmlFor={`hypothequeInscrite-${index}`} className="cursor-pointer">
                                  Hypoth√®que inscrite
                                </Label>
                              </div>

                              {bien.hypothequeInscrite && (
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mt-2">
                                  <div className="space-y-2">
                                    <Label>Type d'hypoth√®que</Label>
                                    <Input 
                                      value={bien.typeHypotheque}
                                      onChange={(e) => {
                                        const updated = [...attestationData.biens];
                                        updated[index] = {...bien, typeHypotheque: e.target.value};
                                        setAttestationData({...attestationData, biens: updated});
                                      }}
                                      placeholder="Conventionnelle, l√©gale..."
                                    />
                                  </div>

                                  <div className="space-y-2">
                                    <Label>Montant r√©siduel</Label>
                                    <Input 
                                      value={bien.montantResiduel}
                                      onChange={(e) => {
                                        const updated = [...attestationData.biens];
                                        updated[index] = {...bien, montantResiduel: e.target.value};
                                        setAttestationData({...attestationData, biens: updated});
                                      }}
                                      placeholder="50 000 ‚Ç¨"
                                    />
                                  </div>

                                  <div className="flex items-center space-x-2 mt-6">
                                    <input
                                      type="checkbox"
                                      id={`necessitMainlevee-${index}`}
                                      checked={bien.necessitMainlevee}
                                      onChange={(e) => {
                                        const updated = [...attestationData.biens];
                                        updated[index] = {...bien, necessitMainlevee: e.target.checked};
                                        setAttestationData({...attestationData, biens: updated});
                                      }}
                                      className="w-4 h-4"
                                    />
                                    <Label htmlFor={`necessitMainlevee-${index}`} className="cursor-pointer">
                                      N√©cessite mainlev√©e
                                    </Label>
                                  </div>
                                </div>
                              )}
                            </div>
                          </div>

                          {/* Copropri√©t√© */}
                          <div className="p-3 bg-indigo-50 rounded space-y-3">
                            <h5 className="font-medium text-sm text-indigo-700">üè¢ Copropri√©t√©</h5>
                            
                            <div className="flex items-center space-x-2">
                              <input
                                type="checkbox"
                                id={`estCopropriete-${index}`}
                                checked={bien.estCopropriete}
                                onChange={(e) => {
                                  const updated = [...attestationData.biens];
                                  updated[index] = {...bien, estCopropriete: e.target.checked};
                                  setAttestationData({...attestationData, biens: updated});
                                }}
                                className="w-4 h-4"
                              />
                              <Label htmlFor={`estCopropriete-${index}`} className="cursor-pointer">
                                Le bien est en copropri√©t√©
                              </Label>
                            </div>

                            {bien.estCopropriete && (
                              <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mt-2">
                                <div className="space-y-2">
                                  <Label>Num√©ro de lot</Label>
                                  <Input 
                                    value={bien.numeroLot}
                                    onChange={(e) => {
                                      const updated = [...attestationData.biens];
                                      updated[index] = {...bien, numeroLot: e.target.value};
                                      setAttestationData({...attestationData, biens: updated});
                                    }}
                                    placeholder="Ex: 42"
                                  />
                                </div>

                                <div className="space-y-2">
                                  <Label>Quote-part parties communes</Label>
                                  <Input 
                                    value={bien.quotepartCommunes}
                                    onChange={(e) => {
                                      const updated = [...attestationData.biens];
                                      updated[index] = {...bien, quotepartCommunes: e.target.value};
                                      setAttestationData({...attestationData, biens: updated});
                                    }}
                                    placeholder="Ex: 125/10000"
                                  />
                                </div>

                                <div className="space-y-2">
                                  <Label>Charges annuelles</Label>
                                  <Input 
                                    value={bien.chargesAnnuelles}
                                    onChange={(e) => {
                                      const updated = [...attestationData.biens];
                                      updated[index] = {...bien, chargesAnnuelles: e.target.value};
                                      setAttestationData({...attestationData, biens: updated});
                                    }}
                                    placeholder="1500 ‚Ç¨"
                                  />
                                </div>
                              </div>
                            )}
                          </div>
                        </div>
                      ))}

                      <Button
                        type="button"
                        variant="outline"
                        className="w-full border-blue-300 text-blue-700 hover:bg-blue-50"
                        onClick={() => {
                          const newId = Math.max(...attestationData.biens.map(b => b.id)) + 1;
                          setAttestationData({
                            ...attestationData,
                            biens: [...attestationData.biens, {
                              id: newId, adresseComplete: "", codePostal: "", commune: "", cadastreSection: "", 
                              cadastreNumero: "", cadastreContenance: "", typeBien: "", surfaceHabitable: "", 
                              nombrePieces: "", dependances: "", annexes: "", equipements: "", situationLocative: "", 
                              montantLoyer: "", dateAcquisition: "", natureAcquisition: "", repartitionDroits: "", 
                              quotePart: "", servitudesActives: "", servitudesPassives: "", pretEnCours: false, 
                              hypothequeInscrite: false, typeHypotheque: "", montantResiduel: "", 
                              necessitMainlevee: false, estCopropriete: false, numeroLot: "", quotepartCommunes: "", 
                              chargesAnnuelles: "",
                            }]
                          });
                        }}
                      >
                        + Ajouter un bien immobilier
                      </Button>
                    </div>
                  </div>

                  {/* Section 4 : R√©partition des droits */}
                  <div>
                    <h3 className="font-semibold text-lg border-b pb-2 mb-4">R√©partition des droits sur les biens</h3>

                    <div className="p-4 bg-red-100 border-2 border-red-400 rounded-lg mb-4">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="indivisionSuccessorale"
                          checked={attestationData.indivisionSuccessorale || false}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            indivisionSuccessorale: e.target.checked
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="indivisionSuccessorale" className="cursor-pointer font-semibold text-red-800">
                          Les biens sont entr√©s en indivision successorale entre les h√©ritiers susnomm√©s √† compter du d√©c√®s <span className="text-red-500">*</span>
                        </Label>
                      </div>
                      <p className="text-xs text-red-700 mt-2 ml-6">
                        ‚ö†Ô∏è <strong>Mention obligatoire</strong> dans l'attestation de propri√©t√© immobili√®re
                      </p>
                    </div>

                    <div className="space-y-4">
                      <div className="space-y-2">
                        <Label>Droits du conjoint survivant (si applicable)</Label>
                        <textarea 
                          value={attestationData.repartitionDroits.conjoint}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            repartitionDroits: {...attestationData.repartitionDroits, conjoint: e.target.value}
                          })}
                          placeholder="Ex: Usufruit sur la totalit√©, 1/4 en pleine propri√©t√©..."
                          className="w-full min-h-[80px] p-2 border rounded-md"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>R√©partition entre les h√©ritiers</Label>
                        <textarea 
                          value={attestationData.repartitionDroits.heritiers}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            repartitionDroits: {...attestationData.repartitionDroits, heritiers: e.target.value}
                          })}
                          placeholder="Ex: Chaque enfant 1/3 en nue-propri√©t√©, parts √©gales..."
                          className="w-full min-h-[100px] p-2 border rounded-md"
                        />
                      </div>

                      <div className="p-3 bg-yellow-100 border border-yellow-300 rounded">
                        <p className="text-xs text-yellow-800">
                          üí° Indiquez pr√©cis√©ment les quotes-parts de chaque h√©ritier et la nature des droits (pleine propri√©t√©, usufruit, nue-propri√©t√©)
                        </p>
                      </div>
                    </div>
                  </div>

                  {/* Section 5 : Destination du bien */}
                  <div>
                    <h3 className="font-semibold text-lg border-b pb-2 mb-4">Destination du bien</h3>

                    <div className="space-y-2">
                      <Label>Que souhaitent faire les h√©ritiers du bien ?</Label>
                      <Select 
                        value={attestationData.destinationBien}
                        onValueChange={(value) => setAttestationData({
                          ...attestationData,
                          destinationBien: value
                        })}
                      >
                        <SelectTrigger>
                          <SelectValue placeholder="S√©lectionner" />
                        </SelectTrigger>
                        <SelectContent>
                          <SelectItem value="conservation_indivision">Conservation en indivision</SelectItem>
                          <SelectItem value="vente">Vente du bien</SelectItem>
                          <SelectItem value="partage">Partage entre h√©ritiers</SelectItem>
                          <SelectItem value="attribution_heritier">Attribution √† un h√©ritier</SelectItem>
                          <SelectItem value="donation">Donation</SelectItem>
                          <SelectItem value="indecis">Pas encore d√©cid√©</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>

                  {/* Section 6 : D√©clarations l√©gales */}
                  <div>
                    <h3 className="font-semibold text-lg border-b pb-2 mb-4">D√©clarations obligatoires</h3>

                    <div className="space-y-4">
                      <div className="space-y-2">
                        <Label>Loi successorale applicable</Label>
                        <Input 
                          value={attestationData.loiSuccessoraleApplicable}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            loiSuccessoraleApplicable: e.target.value
                          })}
                          placeholder="Loi fran√ßaise, loi du dernier domicile..."
                        />
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="confirmationAbsenceAutresHeritiers"
                          checked={attestationData.confirmationAbsenceAutresHeritiers}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            confirmationAbsenceAutresHeritiers: e.target.checked
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="confirmationAbsenceAutresHeritiers" className="cursor-pointer">
                          D√©claration sur l'honneur : absence d'autres h√©ritiers
                        </Label>
                      </div>

                      <div className="p-4 bg-blue-50 border-2 border-blue-300 rounded-lg mt-4">
                        <h4 className="font-semibold text-blue-800 mb-3">üí∂ D√©claration fiscale</h4>
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="declarationFiscale"
                            checked={attestationData.declarationFiscaleHonneur || false}
                            onChange={(e) => setAttestationData({
                              ...attestationData,
                              declarationFiscaleHonneur: e.target.checked
                            })}
                            className="w-4 h-4"
                          />
                          <Label htmlFor="declarationFiscale" className="cursor-pointer">
                            Les h√©ritiers d√©clarent sur l'honneur que les informations fiscales communiqu√©es sont exactes et correspondent √† la valeur r√©elle des biens
                          </Label>
                        </div>
                        <p className="text-xs text-blue-700 mt-2 ml-6">
                          Cette d√©claration engage la responsabilit√© fiscale des h√©ritiers
                        </p>
                      </div>

                      <div className="p-3 bg-red-100 border border-red-300 rounded">
                        <p className="text-xs text-red-800">
                          ‚ö†Ô∏è <strong>Important :</strong> Ces d√©clarations engagent la responsabilit√© des h√©ritiers signataires
                        </p>
                      </div>
                    </div>
                  </div>

                  {/* Section 7 : √âvaluation du bien */}
                  <div>
                    <h3 className="font-semibold text-lg border-b pb-2 mb-4">√âvaluation du bien</h3>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Valeur v√©nale estim√©e</Label>
                        <Input 
                          value={attestationData.valeurVenale}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            valeurVenale: e.target.value
                          })}
                          placeholder="250 000 ‚Ç¨"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>M√©thode d'estimation</Label>
                        <Select 
                          value={attestationData.methodeEstimation}
                          onValueChange={(value) => setAttestationData({
                            ...attestationData,
                            methodeEstimation: value
                          })}
                        >
                          <SelectTrigger>
                            <SelectValue placeholder="S√©lectionner" />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="comparaison">M√©thode par comparaison</SelectItem>
                            <SelectItem value="expertise">Expertise professionnelle</SelectItem>
                            <SelectItem value="avis_valeur">Avis de valeur (agence)</SelectItem>
                            <SelectItem value="valeur_locative">Valeur locative capitalis√©e</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Valeur d√©clar√©e pour le fisc</Label>
                        <Input 
                          value={attestationData.valeurDeclareeFiscale}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            valeurDeclareeFiscale: e.target.value
                          })}
                          placeholder="245 000 ‚Ç¨"
                        />
                      </div>
                    </div>

                    <div className="p-3 bg-teal-100 border border-teal-300 rounded">
                      <p className="text-xs text-teal-800">
                        üí° La valeur v√©nale doit correspondre au prix de vente potentiel au jour du d√©c√®s
                      </p>
                    </div>
                  </div>

                  {/* Section 8 : Formalit√©s de publicit√© fonci√®re */}
                  <div>
                    <h3 className="font-semibold text-lg border-b pb-2 mb-4">Formalit√©s de publicit√© fonci√®re (SPF)</h3>

                    <div className="space-y-4">
                      <div className="space-y-2">
                        <Label>Bureau du Service de la Publicit√© Fonci√®re comp√©tent</Label>
                        <Input 
                          value={attestationData.bureauSPF}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            bureauSPF: e.target.value
                          })}
                          placeholder="Ex: SPF de Paris 1er"
                        />
                      </div>

                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="fichesPreparees"
                          checked={attestationData.fichesPreparees}
                          onChange={(e) => setAttestationData({
                            ...attestationData,
                            fichesPreparees: e.target.checked
                          })}
                          className="w-4 h-4"
                        />
                        <Label htmlFor="fichesPreparees" className="cursor-pointer">
                          Fiches immobili√®res pr√©par√©es pour inscription
                        </Label>
                      </div>

                      <div className="p-3 bg-indigo-100 border border-indigo-300 rounded">
                        <p className="text-xs text-indigo-800">
                          üìå L'attestation doit √™tre publi√©e au SPF dans les 6 mois du d√©c√®s (ou dans l'ann√©e si testament)
                        </p>
                      </div>
                    </div>
                  </div>

                  {/* Section 9 : R√©capitulatif des pi√®ces justificatives */}
                  <div>
                    <h3 className="font-semibold text-lg border-b pb-2 mb-4">Pi√®ces justificatives √† fournir</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      {/* Acte de d√©c√®s */}
                      <div>
                        <p className="text-xs text-gray-500 mb-2">Copie int√©grale r√©cente</p>
                        <MultiFileUpload
                          label="üìÑ Acte de d√©c√®s"
                          required
                          files={attestationActeDecesFiles}
                          onFilesChange={setAttestationActeDecesFiles}
                          accept="application/pdf,image/*"
                        />
                      </div>

                      {/* Pi√®ces d'identit√© h√©ritiers */}
                      <div>
                        <p className="text-xs text-gray-500 mb-2">CNI ou passeport valide de tous les h√©ritiers</p>
                        <MultiFileUpload
                          label="ü™™ Pi√®ces d'identit√© h√©ritiers"
                          required
                          files={attestationIdentiteHeritiers}
                          onFilesChange={setAttestationIdentiteHeritiers}
                          accept="application/pdf,image/*"
                        />
                      </div>

                      {/* Titre de propri√©t√© */}
                      <div>
                        <p className="text-xs text-gray-500 mb-2">Acte notari√© d'acquisition</p>
                        <MultiFileUpload
                          label="üè† Titre de propri√©t√©"
                          required
                          files={attestationTitrePropriete}
                          onFilesChange={setAttestationTitrePropriete}
                          accept="application/pdf,image/*"
                        />
                      </div>

                      {/* Livret de famille */}
                      <div>
                        <p className="text-xs text-gray-500 mb-2">√Ä jour</p>
                        <MultiFileUpload
                          label="üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Livret de famille"
                          required
                          files={attestationLivretFamille}
                          onFilesChange={setAttestationLivretFamille}
                          accept="application/pdf,image/*"
                        />
                      </div>

                      {/* Testament (conditionnel) */}
                      {attestationData.defunt.existenceTestament && (
                        <div>
                          <p className="text-xs text-amber-600 mb-2">Copie authentique ou d√©p√¥t chez notaire</p>
                          <MultiFileUpload
                            label="üìú Testament"
                            required
                            files={attestationTestament}
                            onFilesChange={setAttestationTestament}
                            accept="application/pdf,image/*"
                          />
                        </div>
                      )}

                      {/* Contrat de mariage (conditionnel) */}
                      {attestationData.defunt.existenceContratMariage && (
                        <div>
                          <p className="text-xs text-purple-600 mb-2">Copie authentique</p>
                          <MultiFileUpload
                            label="üíç Contrat de mariage"
                            required
                            files={attestationContratMariage}
                            onFilesChange={setAttestationContratMariage}
                            accept="application/pdf,image/*"
                          />
                        </div>
                      )}

                      {/* R√®glement copropri√©t√© (conditionnel) */}
                      {attestationData.biens.some(b => b.estCopropriete) && (
                        <div>
                          <p className="text-xs text-blue-600 mb-2">+ dernier PV d'assembl√©e g√©n√©rale</p>
                          <MultiFileUpload
                            label="üè¢ R√®glement de copropri√©t√©"
                            files={attestationCopropriete}
                            onFilesChange={setAttestationCopropriete}
                            accept="application/pdf,image/*"
                          />
                        </div>
                      )}

                      {/* Baux (conditionnel) */}
                      {attestationData.biens.some(b => b.situationLocative === "loue") && (
                        <div>
                          <p className="text-xs text-green-600 mb-2">Copies des contrats de location</p>
                          <MultiFileUpload
                            label="üìÑ Baux en cours"
                            files={attestationBaux}
                            onFilesChange={setAttestationBaux}
                            accept="application/pdf,image/*"
                          />
                        </div>
                      )}

                      {/* √âtat hypoth√©caire (conditionnel) */}
                      {attestationData.biens.some(b => b.hypothequeInscrite) && (
                        <div>
                          <p className="text-xs text-red-600 mb-2">Moins de 3 mois</p>
                          <MultiFileUpload
                            label="üí∞ √âtat hypoth√©caire"
                            required
                            files={attestationHypotheque}
                            onFilesChange={setAttestationHypotheque}
                            accept="application/pdf,image/*"
                          />
                        </div>
                      )}

                      {/* Justificatifs de domicile */}
                      <div>
                        <p className="text-xs text-gray-500 mb-2">Moins de 3 mois pour chaque h√©ritier</p>
                        <MultiFileUpload
                          label="üìã Justificatifs de domicile"
                          required
                          files={attestationJustifDomicile}
                          onFilesChange={setAttestationJustifDomicile}
                          accept="application/pdf,image/*"
                        />
                      </div>
                    </div>

                    <div className="p-4 bg-blue-100 border border-blue-300 rounded-lg mt-4">
                      <p className="text-sm font-semibold text-blue-800 mb-2">üìå Documents √† pr√©parer :</p>
                      <ul className="text-xs text-blue-700 space-y-1 list-disc list-inside">
                        <li>Extrait cadastral et plan de masse</li>
                        <li>Taxe fonci√®re (dernier avis)</li>
                        <li>Diagnostic de performance √©nerg√©tique (DPE) si vente pr√©vue</li>
                        <li>Attestation assurance habitation</li>
                        <li>Relev√© d'identit√© bancaire pour succession</li>
                      </ul>
                    </div>
                  </div>

                  {/* Section 10 : Notes et observations */}
                  <div>
                    <h3 className="font-semibold text-lg border-b pb-2 mb-4">Notes et observations compl√©mentaires</h3>

                    <div className="space-y-2">
                      <Label>Informations compl√©mentaires</Label>
                      <textarea 
                        value={attestationData.regimeMatrimonial}
                        onChange={(e) => setAttestationData({
                          ...attestationData,
                          regimeMatrimonial: e.target.value
                        })}
                        placeholder="Toute information utile : particularit√©s de la succession, difficult√©s rencontr√©es, h√©ritiers injoignables, litiges potentiels..."
                        className="w-full min-h-[150px] p-3 border rounded-md"
                      />
                    </div>

                  </div>
                </div>
            )}

            {/* Formulaire Quitus / Reconnaissance de dette */}
            {pendingContractType === "Quitus / reconnaissance de dette" && (
              <div className="space-y-6 max-h-[calc(100vh-250px)] overflow-y-auto pr-2">
                
                {/* Section 1 : Type d'acte √† g√©n√©rer */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Type d'acte √† g√©n√©rer</h3>
                  <div className="space-y-3">
                    <Label>Type d'acte <span className="text-red-500">*</span></Label>
                    <Select
                      value={quitusDetteData.typeActe}
                      onValueChange={(value) => setQuitusDetteData({...quitusDetteData, typeActe: value})}
                    >
                      <SelectTrigger>
                        <SelectValue placeholder="S√©lectionner le type d'acte" />
                      </SelectTrigger>
                      <SelectContent>
                        <SelectItem value="reconnaissance_dette">‚òê Reconnaissance de dette (dette NON r√©gl√©e)</SelectItem>
                        <SelectItem value="reconnaissance_dette_modalites">‚òê Reconnaissance de dette + modalit√©s de remboursement</SelectItem>
                        <SelectItem value="quitus">‚òê Quitus (dette totalement r√©gl√©e)</SelectItem>
                        <SelectItem value="quitus_partiel">‚òê Quitus partiel</SelectItem>
                        <SelectItem value="remise_dette">‚òê Remise de dette (abandon total ou partiel)</SelectItem>
                        <SelectItem value="solde_tout_compte">‚òê Solde de tout compte entre particuliers</SelectItem>
                        <SelectItem value="attestation_reglement">‚òê Attestation de r√®glement d'une somme due</SelectItem>
                      </SelectContent>
                    </Select>
                  </div>
                </div>

                {/* Section 2 : Identit√© compl√®te du cr√©ancier */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Identit√© compl√®te du CR√âANCIER (celui qui pr√™te)</h3>
                  <div className="space-y-2">
                    <Label>Le cr√©ancier est-il votre client ?</Label>
                    <RadioGroup
                      value={quitusDetteData.creancier.isClient ? "client" : "autre"}
                      onValueChange={(value) => {
                        setQuitusDetteData({
                          ...quitusDetteData,
                          creancier: {...quitusDetteData.creancier, isClient: value === "client"}
                        });
                      }}
                    >
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="client" id="creancier_client" />
                        <Label htmlFor="creancier_client" className="cursor-pointer">Oui, c'est un de mes clients</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="autre" id="creancier_autre" />
                        <Label htmlFor="creancier_autre" className="cursor-pointer">Non, saisie manuelle</Label>
                      </div>
                    </RadioGroup>
                  </div>

                  {quitusDetteData.creancier.isClient && (
                    <div className="space-y-2">
                      <Label>S√©lectionner le client cr√©ancier</Label>
                      <Select 
                        value={quitusDetteData.creancier.clientId}
                        onValueChange={(value) => {
                          const selectedClient = clients.find(c => c.id === value);
                          if (selectedClient) {
                            // Extraire la situation familiale de l'objet JSON
                            let situationFamiliale = "";
                            if (typeof selectedClient.situation_familiale === 'object' && selectedClient.situation_familiale !== null) {
                              situationFamiliale = selectedClient.situation_familiale.situation_familiale || "";
                            } else if (typeof selectedClient.situation_familiale === 'string') {
                              situationFamiliale = selectedClient.situation_familiale;
                            }
                            
                            setQuitusDetteData({
                              ...quitusDetteData,
                              creancier: {
                                ...quitusDetteData.creancier,
                                clientId: value,
                                nom: selectedClient.nom,
                                prenom: selectedClient.prenom,
                                dateNaissance: selectedClient.date_naissance || "",
                                lieuNaissance: selectedClient.lieu_naissance || "",
                                nationalite: selectedClient.nationalite || "",
                                profession: selectedClient.profession || "",
                                adresseComplete: selectedClient.adresse || "",
                                telephone: selectedClient.telephone || "",
                                email: selectedClient.email || "",
                                typeIdentite: selectedClient.type_identite || "",
                                numeroIdentite: selectedClient.numero_identite || "",
                                situationMatrimoniale: situationFamiliale || selectedClient.situation_matrimoniale || "",
                              }
                            });
                          }
                        }}
                      >
                        <SelectTrigger><SelectValue placeholder="Choisir un client..." /></SelectTrigger>
                        <SelectContent>
                          {clients.map((client) => (
                            <SelectItem key={client.id} value={client.id}>
                              {client.prenom} {client.nom}
                            </SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                    </div>
                  )}

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Nom <span className="text-red-500">*</span></Label>
                      <Input
                        value={quitusDetteData.creancier.nom}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          creancier: {...quitusDetteData.creancier, nom: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                      <Input
                        value={quitusDetteData.creancier.prenom}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          creancier: {...quitusDetteData.creancier, prenom: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Nom de naissance</Label>
                      <Input
                        value={quitusDetteData.creancier.nomNaissance}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          creancier: {...quitusDetteData.creancier, nomNaissance: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Date de naissance</Label>
                      <Input
                        type="date"
                        value={quitusDetteData.creancier.dateNaissance}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          creancier: {...quitusDetteData.creancier, dateNaissance: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Lieu de naissance</Label>
                      <Input
                        value={quitusDetteData.creancier.lieuNaissance}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          creancier: {...quitusDetteData.creancier, lieuNaissance: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Nationalit√©</Label>
                      <Input
                        value={quitusDetteData.creancier.nationalite}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          creancier: {...quitusDetteData.creancier, nationalite: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Profession</Label>
                      <Input
                        value={quitusDetteData.creancier.profession}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          creancier: {...quitusDetteData.creancier, profession: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Situation matrimoniale</Label>
                      <Input
                        value={quitusDetteData.creancier.situationMatrimoniale}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          creancier: {...quitusDetteData.creancier, situationMatrimoniale: e.target.value}
                        })}
                        placeholder="Renseign√©e automatiquement si client s√©lectionn√©"
                      />
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label>Adresse compl√®te <span className="text-red-500">*</span></Label>
                      <Input
                        value={quitusDetteData.creancier.adresseComplete}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          creancier: {...quitusDetteData.creancier, adresseComplete: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>T√©l√©phone</Label>
                      <Input
                        value={quitusDetteData.creancier.telephone}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          creancier: {...quitusDetteData.creancier, telephone: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Email</Label>
                      <Input
                        type="email"
                        value={quitusDetteData.creancier.email}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          creancier: {...quitusDetteData.creancier, email: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Type de pi√®ce d'identit√©</Label>
                      <Select
                        value={quitusDetteData.creancier.typeIdentite}
                        onValueChange={(value) => setQuitusDetteData({
                          ...quitusDetteData,
                          creancier: {...quitusDetteData.creancier, typeIdentite: value}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="CNI">Carte Nationale d'Identit√©</SelectItem>
                          <SelectItem value="Passeport">Passeport</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div className="space-y-2">
                      <Label>Num√©ro de pi√®ce d'identit√©</Label>
                      <Input
                        value={quitusDetteData.creancier.numeroIdentite}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          creancier: {...quitusDetteData.creancier, numeroIdentite: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label>RIB (si remboursement pr√©vu par virement)</Label>
                      <Input
                        value={quitusDetteData.creancier.rib}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          creancier: {...quitusDetteData.creancier, rib: e.target.value}
                        })}
                        placeholder="FR76..."
                      />
                    </div>
                  </div>

                  <div className="space-y-2">
                    <MultiFileUpload
                      label="üìÑ Pi√®ce d'identit√© du cr√©ancier"
                      required
                      files={quitusCreancierIdentiteFiles}
                      onFilesChange={setQuitusCreancierIdentiteFiles}
                      accept="application/pdf,image/*"
                    />
                  </div>

                  <div className="space-y-2">
                    <MultiFileUpload
                      label="üìã Justificatif de domicile du cr√©ancier"
                      files={quitusJustifDomicileCreancierFiles}
                      onFilesChange={setQuitusJustifDomicileCreancierFiles}
                      accept="application/pdf,image/*"
                    />
                  </div>
                </div>

                {/* Section 3 : Identit√© compl√®te du d√©biteur */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Identit√© compl√®te du D√âBITEUR (celui qui emprunte)</h3>
                  <div className="space-y-2">
                    <Label>Le d√©biteur est-il votre client ?</Label>
                    <RadioGroup
                      value={quitusDetteData.debiteur.isClient ? "client" : "autre"}
                      onValueChange={(value) => {
                        setQuitusDetteData({
                          ...quitusDetteData,
                          debiteur: {...quitusDetteData.debiteur, isClient: value === "client"}
                        });
                      }}
                    >
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="client" id="debiteur_client" />
                        <Label htmlFor="debiteur_client" className="cursor-pointer">Oui, c'est un de mes clients</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="autre" id="debiteur_autre" />
                        <Label htmlFor="debiteur_autre" className="cursor-pointer">Non, saisie manuelle</Label>
                      </div>
                    </RadioGroup>
                  </div>

                  {quitusDetteData.debiteur.isClient && (
                    <div className="space-y-2">
                      <Label>S√©lectionner le client d√©biteur</Label>
                      <Select 
                        value={quitusDetteData.debiteur.clientId}
                        onValueChange={(value) => {
                          const selectedClient = clients.find(c => c.id === value);
                          if (selectedClient) {
                            // Extraire la situation familiale de l'objet JSON
                            let situationFamiliale = "";
                            if (typeof selectedClient.situation_familiale === 'object' && selectedClient.situation_familiale !== null) {
                              situationFamiliale = selectedClient.situation_familiale.situation_familiale || "";
                            } else if (typeof selectedClient.situation_familiale === 'string') {
                              situationFamiliale = selectedClient.situation_familiale;
                            }
                            
                            setQuitusDetteData({
                              ...quitusDetteData,
                              debiteur: {
                                ...quitusDetteData.debiteur,
                                clientId: value,
                                nom: selectedClient.nom,
                                prenom: selectedClient.prenom,
                                dateNaissance: selectedClient.date_naissance || "",
                                lieuNaissance: selectedClient.lieu_naissance || "",
                                nationalite: selectedClient.nationalite || "",
                                profession: selectedClient.profession || "",
                                adresseComplete: selectedClient.adresse || "",
                                telephone: selectedClient.telephone || "",
                                email: selectedClient.email || "",
                                typeIdentite: selectedClient.type_identite || "",
                                numeroIdentite: selectedClient.numero_identite || "",
                                situationMatrimoniale: situationFamiliale || selectedClient.situation_matrimoniale || "",
                              }
                            });
                          }
                        }}
                      >
                        <SelectTrigger><SelectValue placeholder="Choisir un client..." /></SelectTrigger>
                        <SelectContent>
                          {clients.map((client) => (
                            <SelectItem key={client.id} value={client.id}>
                              {client.prenom} {client.nom}
                            </SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                    </div>
                  )}

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Nom <span className="text-red-500">*</span></Label>
                      <Input
                        value={quitusDetteData.debiteur.nom}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          debiteur: {...quitusDetteData.debiteur, nom: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                      <Input
                        value={quitusDetteData.debiteur.prenom}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          debiteur: {...quitusDetteData.debiteur, prenom: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Nom de naissance</Label>
                      <Input
                        value={quitusDetteData.debiteur.nomNaissance}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          debiteur: {...quitusDetteData.debiteur, nomNaissance: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Date de naissance</Label>
                      <Input
                        type="date"
                        value={quitusDetteData.debiteur.dateNaissance}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          debiteur: {...quitusDetteData.debiteur, dateNaissance: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Lieu de naissance</Label>
                      <Input
                        value={quitusDetteData.debiteur.lieuNaissance}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          debiteur: {...quitusDetteData.debiteur, lieuNaissance: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Nationalit√©</Label>
                      <Input
                        value={quitusDetteData.debiteur.nationalite}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          debiteur: {...quitusDetteData.debiteur, nationalite: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Profession</Label>
                      <Input
                        value={quitusDetteData.debiteur.profession}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          debiteur: {...quitusDetteData.debiteur, profession: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Situation matrimoniale</Label>
                      <Input
                        value={quitusDetteData.debiteur.situationMatrimoniale}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          debiteur: {...quitusDetteData.debiteur, situationMatrimoniale: e.target.value}
                        })}
                        placeholder="Renseign√©e automatiquement si client s√©lectionn√©"
                      />
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label>Adresse compl√®te <span className="text-red-500">*</span></Label>
                      <Input
                        value={quitusDetteData.debiteur.adresseComplete}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          debiteur: {...quitusDetteData.debiteur, adresseComplete: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>T√©l√©phone</Label>
                      <Input
                        value={quitusDetteData.debiteur.telephone}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          debiteur: {...quitusDetteData.debiteur, telephone: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Email</Label>
                      <Input
                        type="email"
                        value={quitusDetteData.debiteur.email}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          debiteur: {...quitusDetteData.debiteur, email: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2">
                      <Label>Type de pi√®ce d'identit√©</Label>
                      <Select
                        value={quitusDetteData.debiteur.typeIdentite}
                        onValueChange={(value) => setQuitusDetteData({
                          ...quitusDetteData,
                          debiteur: {...quitusDetteData.debiteur, typeIdentite: value}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="CNI">Carte Nationale d'Identit√©</SelectItem>
                          <SelectItem value="Passeport">Passeport</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div className="space-y-2">
                      <Label>Num√©ro de pi√®ce d'identit√©</Label>
                      <Input
                        value={quitusDetteData.debiteur.numeroIdentite}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          debiteur: {...quitusDetteData.debiteur, numeroIdentite: e.target.value}
                        })}
                      />
                    </div>
                    <div className="space-y-2 md:col-span-2">
                      <Label>RIB (si pr√©l√®vements ou paiements programm√©s)</Label>
                      <Input
                        value={quitusDetteData.debiteur.rib}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          debiteur: {...quitusDetteData.debiteur, rib: e.target.value}
                        })}
                        placeholder="FR76..."
                      />
                    </div>
                  </div>

                  <div className="space-y-2">
                    <MultiFileUpload
                      label="üìÑ Pi√®ce d'identit√© du d√©biteur"
                      required
                      files={quitusDebiteurIdentiteFiles}
                      onFilesChange={setQuitusDebiteurIdentiteFiles}
                      accept="application/pdf,image/*"
                    />
                  </div>

                  <div className="space-y-2">
                    <MultiFileUpload
                      label="üìã Justificatif de domicile du d√©biteur"
                      files={quitusJustifDomicileDebiteurFiles}
                      onFilesChange={setQuitusJustifDomicileDebiteurFiles}
                      accept="application/pdf,image/*"
                    />
                  </div>
                </div>

                {/* Section 4 : Objet de la dette */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Objet de la dette</h3>
                  
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Nature de la dette <span className="text-red-500">*</span></Label>
                      <Select
                        value={quitusDetteData.objetDette.natureDette}
                        onValueChange={(value) => setQuitusDetteData({
                          ...quitusDetteData,
                          objetDette: {...quitusDetteData.objetDette, natureDette: value}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="pret_argent">Pr√™t d'argent</SelectItem>
                          <SelectItem value="avance_fonds">Avance de fonds</SelectItem>
                          <SelectItem value="aide_exceptionnelle">Aide exceptionnelle</SelectItem>
                          <SelectItem value="remboursement_depenses">Remboursement de d√©penses</SelectItem>
                          <SelectItem value="participation_projet">Participation dans un projet</SelectItem>
                          <SelectItem value="dette_commerciale">Dette commerciale informelle</SelectItem>
                          <SelectItem value="dette_familiale">Dette familiale</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    
                    <div className="space-y-2">
                      <Label>Date de naissance de la dette <span className="text-red-500">*</span></Label>
                      <Input
                        type="date"
                        value={quitusDetteData.objetDette.dateNaissanceDette}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          objetDette: {...quitusDetteData.objetDette, dateNaissanceDette: e.target.value}
                        })}
                      />
                    </div>
                    
                    <div className="space-y-2 md:col-span-2">
                      <Label>Circonstances de la dette <span className="text-red-500">*</span></Label>
                      <textarea
                        value={quitusDetteData.objetDette.circonstancesDette}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          objetDette: {...quitusDetteData.objetDette, circonstancesDette: e.target.value}
                        })}
                        className="w-full min-h-[100px] p-3 border rounded-md"
                        placeholder="D√©crivez les circonstances pr√©cises : pourquoi, comment, dans quel contexte..."
                      />
                    </div>
                    
                    <div className="space-y-2">
                      <Label>Preuve √©crite existante ?</Label>
                      <RadioGroup
                        value={quitusDetteData.objetDette.preuveEcriteExiste ? "oui" : "non"}
                        onValueChange={(value) => setQuitusDetteData({
                          ...quitusDetteData,
                          objetDette: {...quitusDetteData.objetDette, preuveEcriteExiste: value === "oui"}
                        })}
                      >
                        <div className="flex items-center space-x-2">
                          <RadioGroupItem value="oui" id="preuve_oui" />
                          <Label htmlFor="preuve_oui" className="cursor-pointer">Oui</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <RadioGroupItem value="non" id="preuve_non" />
                          <Label htmlFor="preuve_non" className="cursor-pointer">Non</Label>
                        </div>
                      </RadioGroup>
                    </div>
                    
                    <div className="space-y-2">
                      <Label>T√©moins √©ventuels</Label>
                      <Input
                        value={quitusDetteData.objetDette.temoinsEventuels}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          objetDette: {...quitusDetteData.objetDette, temoinsEventuels: e.target.value}
                        })}
                        placeholder="Nom(s) et coordonn√©es des t√©moins"
                      />
                    </div>
                  </div>

                  {quitusDetteData.objetDette.preuveEcriteExiste && (
                    <div className="space-y-2">
                      <MultiFileUpload
                        label="üìÑ Preuve √©crite de la dette"
                        files={quitusPreuveDetteFiles}
                        onFilesChange={setQuitusPreuveDetteFiles}
                        accept="application/pdf,image/*"
                      />
                    </div>
                  )}
                </div>

                {/* Section 5 : Montant de la dette */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Montant de la dette</h3>
                  
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Montant total exact (en euros) <span className="text-red-500">*</span></Label>
                      <Input
                        type="number"
                        step="0.01"
                        value={quitusDetteData.montant.montantTotal}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          montant: {...quitusDetteData.montant, montantTotal: e.target.value}
                        })}
                        placeholder="0.00"
                      />
                    </div>
                    
                    <div className="space-y-2">
                      <Label>Devise</Label>
                      <Select
                        value={quitusDetteData.montant.devise}
                        onValueChange={(value) => setQuitusDetteData({
                          ...quitusDetteData,
                          montant: {...quitusDetteData.montant, devise: value}
                        })}
                      >
                        <SelectTrigger><SelectValue /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="EUR">EUR (‚Ç¨)</SelectItem>
                          <SelectItem value="USD">USD ($)</SelectItem>
                          <SelectItem value="GBP">GBP (¬£)</SelectItem>
                          <SelectItem value="CHF">CHF</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    
                    <div className="space-y-2">
                      <Label>Somme d√©j√† rembours√©e</Label>
                      <Input
                        type="number"
                        step="0.01"
                        value={quitusDetteData.montant.sommeDejaRemboursee}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          montant: {...quitusDetteData.montant, sommeDejaRemboursee: e.target.value}
                        })}
                        placeholder="0.00"
                      />
                    </div>
                    
                    <div className="space-y-2">
                      <Label>Somme restant due</Label>
                      <Input
                        type="number"
                        step="0.01"
                        value={quitusDetteData.montant.sommeRestantDue}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          montant: {...quitusDetteData.montant, sommeRestantDue: e.target.value}
                        })}
                        placeholder="0.00"
                      />
                    </div>
                    
                    <div className="space-y-2">
                      <Label>Montant reconnu par le d√©biteur</Label>
                      <Input
                        type="number"
                        step="0.01"
                        value={quitusDetteData.montant.montantReconnuDebiteur}
                        onChange={(e) => setQuitusDetteData({
                          ...quitusDetteData,
                          montant: {...quitusDetteData.montant, montantReconnuDebiteur: e.target.value}
                        })}
                        placeholder="0.00"
                      />
                    </div>
                    
                    <div className="space-y-2">
                      <Label>Modalit√© du pr√™t <span className="text-red-500">*</span></Label>
                      <Select
                        value={quitusDetteData.montant.modalitePret}
                        onValueChange={(value) => setQuitusDetteData({
                          ...quitusDetteData,
                          montant: {...quitusDetteData.montant, modalitePret: value}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="transfert_bancaire">Transfert bancaire</SelectItem>
                          <SelectItem value="cheque">Remise de ch√®que</SelectItem>
                          <SelectItem value="especes">Esp√®ces</SelectItem>
                          <SelectItem value="virement">Virement entre comptes</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>

                  <div className="space-y-2">
                    <MultiFileUpload
                      label="üí∞ Preuve du transfert d'argent"
                      files={quitusPreuveTransfertFiles}
                      onFilesChange={setQuitusPreuveTransfertFiles}
                      accept="application/pdf,image/*"
                    />
                  </div>

                  <div className="p-3 bg-yellow-100 border border-yellow-300 rounded">
                    <p className="text-xs text-yellow-800">
                      üí° Calcul automatique : Somme restant due = Montant total - Somme d√©j√† rembours√©e
                    </p>
                  </div>

                  {/* Date d'exigibilit√© si quitus partiel ou solde restant d√ª */}
                  {(quitusDetteData.typeActe === "quitus_partiel" || parseFloat(quitusDetteData.montant.sommeRestantDue) > 0) && (
                    <div className="p-4 bg-red-100 border-2 border-red-300 rounded-lg mt-4">
                      <div className="space-y-2">
                        <Label htmlFor="date_exigibilite_solde" className="font-medium text-red-900">
                          üî¥ Date d'exigibilit√© du solde restant d√ª <span className="text-red-600">*</span>
                        </Label>
                        <Input
                          id="date_exigibilite_solde"
                          type="date"
                          value={quitusDetteData.montant.dateExigibiliteSolde}
                          onChange={(e) => setQuitusDetteData({
                            ...quitusDetteData,
                            montant: {...quitusDetteData.montant, dateExigibiliteSolde: e.target.value}
                          })}
                        />
                        <p className="text-xs text-red-800">
                          ‚ö†Ô∏è <strong>Indispensable</strong> si la dette n'est pas totalement √©teinte. Fixe la date √† laquelle le solde devient exigible.
                        </p>
                      </div>
                    </div>
                  )}
                </div>

                {/* Section 6 : Conditions de remboursement */}
                {(quitusDetteData.typeActe === "reconnaissance_dette" || quitusDetteData.typeActe === "reconnaissance_dette_modalites") && (
                  <div>
                    <h3 className="font-semibold text-lg border-b pb-2 mb-4">Conditions de remboursement</h3>
                    
                    <div className="space-y-4">
                      <div className="space-y-2">
                        <Label>Modalit√© de remboursement <span className="text-red-500">*</span></Label>
                        <Select
                          value={quitusDetteData.remboursement.modalite}
                          onValueChange={(value) => setQuitusDetteData({
                            ...quitusDetteData,
                            remboursement: {...quitusDetteData.remboursement, modalite: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="une_fois">‚òê En une seule fois</SelectItem>
                            <SelectItem value="plusieurs_echeances">‚òê En plusieurs √©ch√©ances</SelectItem>
                            <SelectItem value="libre">‚òê Remboursement libre sans √©ch√©ances</SelectItem>
                            <SelectItem value="premiere_demande">‚òê Remboursement √† la premi√®re demande</SelectItem>
                            <SelectItem value="conditionnel">‚òê Remboursement conditionnel</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {quitusDetteData.remboursement.modalite === "conditionnel" && (
                        <div className="space-y-2">
                          <Label>Condition du remboursement</Label>
                          <Input
                            value={quitusDetteData.remboursement.conditionRemboursement}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              remboursement: {...quitusDetteData.remboursement, conditionRemboursement: e.target.value}
                            })}
                            placeholder="Ex: vente d'un bien, obtention d'un cr√©dit, etc."
                          />
                        </div>
                      )}

                      {quitusDetteData.remboursement.modalite === "plusieurs_echeances" && (
                        <div className="space-y-4">
                          <div className="flex items-center justify-between">
                            <Label className="font-medium">√âch√©ancier de remboursement</Label>
                            <Button
                              type="button"
                              size="sm"
                              variant="outline"
                              onClick={() => {
                                const newEcheance = {
                                  id: quitusDetteData.remboursement.echeances.length + 1,
                                  date: "",
                                  montant: "",
                                  moyenPaiement: "",
                                  consequencesRetard: ""
                                };
                                setQuitusDetteData({
                                  ...quitusDetteData,
                                  remboursement: {
                                    ...quitusDetteData.remboursement,
                                    echeances: [...quitusDetteData.remboursement.echeances, newEcheance]
                                  }
                                });
                              }}
                            >
                              + Ajouter une √©ch√©ance
                            </Button>
                          </div>

                          {quitusDetteData.remboursement.echeances.map((echeance, index) => (
                            <div key={echeance.id} className="p-4 border rounded-lg bg-white space-y-3">
                              <div className="flex justify-between items-center">
                                <h4 className="font-medium">√âch√©ance #{index + 1}</h4>
                                {quitusDetteData.remboursement.echeances.length > 1 && (
                                  <Button
                                    type="button"
                                    variant="ghost"
                                    size="sm"
                                    onClick={() => {
                                      setQuitusDetteData({
                                        ...quitusDetteData,
                                        remboursement: {
                                          ...quitusDetteData.remboursement,
                                          echeances: quitusDetteData.remboursement.echeances.filter(e => e.id !== echeance.id)
                                        }
                                      });
                                    }}
                                  >
                                    Supprimer
                                  </Button>
                                )}
                              </div>
                              
                              <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <div className="space-y-2">
                                  <Label>Date</Label>
                                  <Input
                                    type="date"
                                    value={echeance.date}
                                    onChange={(e) => {
                                      const updated = [...quitusDetteData.remboursement.echeances];
                                      updated[index] = {...echeance, date: e.target.value};
                                      setQuitusDetteData({
                                        ...quitusDetteData,
                                        remboursement: {...quitusDetteData.remboursement, echeances: updated}
                                      });
                                    }}
                                  />
                                </div>
                                <div className="space-y-2">
                                  <Label>Montant (‚Ç¨)</Label>
                                  <Input
                                    type="number"
                                    step="0.01"
                                    value={echeance.montant}
                                    onChange={(e) => {
                                      const updated = [...quitusDetteData.remboursement.echeances];
                                      updated[index] = {...echeance, montant: e.target.value};
                                      setQuitusDetteData({
                                        ...quitusDetteData,
                                        remboursement: {...quitusDetteData.remboursement, echeances: updated}
                                      });
                                    }}
                                  />
                                </div>
                                <div className="space-y-2">
                                  <Label>Moyen de paiement</Label>
                                  <Input
                                    value={echeance.moyenPaiement}
                                    onChange={(e) => {
                                      const updated = [...quitusDetteData.remboursement.echeances];
                                      updated[index] = {...echeance, moyenPaiement: e.target.value};
                                      setQuitusDetteData({
                                        ...quitusDetteData,
                                        remboursement: {...quitusDetteData.remboursement, echeances: updated}
                                      });
                                    }}
                                    placeholder="Virement, ch√®que, esp√®ces..."
                                  />
                                </div>
                                <div className="space-y-2">
                                  <Label>Cons√©quences en cas de retard</Label>
                                  <Input
                                    value={echeance.consequencesRetard}
                                    onChange={(e) => {
                                      const updated = [...quitusDetteData.remboursement.echeances];
                                      updated[index] = {...echeance, consequencesRetard: e.target.value};
                                      setQuitusDetteData({
                                        ...quitusDetteData,
                                        remboursement: {...quitusDetteData.remboursement, echeances: updated}
                                      });
                                    }}
                                    placeholder="P√©nalit√©s, int√©r√™ts de retard..."
                                  />
                                </div>
                              </div>
                            </div>
                          ))}

                          <div className="space-y-2">
                            <MultiFileUpload
                              label="üìã √âch√©ancier sign√©"
                              files={quitusEcheancierFiles}
                              onFilesChange={setQuitusEcheancierFiles}
                              accept="application/pdf,image/*"
                            />
                          </div>
                        </div>
                      )}

                      {/* Int√©r√™ts */}
                      <div className="space-y-3 p-4 border rounded-lg">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="avec_interets"
                            checked={quitusDetteData.remboursement.avecInterets}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              remboursement: {...quitusDetteData.remboursement, avecInterets: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="avec_interets" className="cursor-pointer font-medium">
                            Avec int√©r√™ts
                          </Label>
                        </div>

                        {quitusDetteData.remboursement.avecInterets && (
                          <div className="grid grid-cols-1 md:grid-cols-3 gap-3 mt-3">
                            <div className="space-y-2">
                              <Label>Taux d'int√©r√™t (%)</Label>
                              <Input
                                type="number"
                                step="0.01"
                                value={quitusDetteData.remboursement.tauxInteret}
                                onChange={(e) => setQuitusDetteData({
                                  ...quitusDetteData,
                                  remboursement: {...quitusDetteData.remboursement, tauxInteret: e.target.value}
                                })}
                                placeholder="Ex: 3.5"
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Taux usuraire applicable</Label>
                              <Input
                                value={quitusDetteData.remboursement.tauxUsuraire}
                                onChange={(e) => setQuitusDetteData({
                                  ...quitusDetteData,
                                  remboursement: {...quitusDetteData.remboursement, tauxUsuraire: e.target.value}
                                })}
                                placeholder="√Ä v√©rifier selon la loi"
                              />
                            </div>
                            <div className="space-y-2 flex items-end">
                              <div className="flex items-center space-x-2">
                                <input
                                  type="checkbox"
                                  id="capitalisation"
                                  checked={quitusDetteData.remboursement.capitalisationInterets}
                                  onChange={(e) => setQuitusDetteData({
                                    ...quitusDetteData,
                                    remboursement: {...quitusDetteData.remboursement, capitalisationInterets: e.target.checked}
                                  })}
                                  className="rounded"
                                />
                                <Label htmlFor="capitalisation" className="cursor-pointer">
                                  Capitalisation des int√©r√™ts
                                </Label>
                              </div>
                            </div>
                          </div>
                        )}
                      </div>

                      {/* Clause p√©nale */}
                      <div className="space-y-3 p-4 border rounded-lg">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="clause_penale"
                            checked={quitusDetteData.remboursement.clausePenale}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              remboursement: {...quitusDetteData.remboursement, clausePenale: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="clause_penale" className="cursor-pointer font-medium">
                            Clause p√©nale en cas d'impay√©
                          </Label>
                        </div>

                        {quitusDetteData.remboursement.clausePenale && (
                          <div className="grid grid-cols-1 md:grid-cols-3 gap-3 mt-3">
                            <div className="space-y-2">
                              <Label>Montant de la p√©nalit√© (‚Ç¨)</Label>
                              <Input
                                type="number"
                                step="0.01"
                                value={quitusDetteData.remboursement.montantPenalite}
                                onChange={(e) => setQuitusDetteData({
                                  ...quitusDetteData,
                                  remboursement: {...quitusDetteData.remboursement, montantPenalite: e.target.value}
                                })}
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>Pourcentage appliqu√© (%)</Label>
                              <Input
                                type="number"
                                step="0.01"
                                value={quitusDetteData.remboursement.pourcentagePenalite}
                                onChange={(e) => setQuitusDetteData({
                                  ...quitusDetteData,
                                  remboursement: {...quitusDetteData.remboursement, pourcentagePenalite: e.target.value}
                                })}
                              />
                            </div>
                            <div className="space-y-2">
                              <Label>D√©lai de gr√¢ce (jours)</Label>
                              <Input
                                value={quitusDetteData.remboursement.delaiGrace}
                                onChange={(e) => setQuitusDetteData({
                                  ...quitusDetteData,
                                  remboursement: {...quitusDetteData.remboursement, delaiGrace: e.target.value}
                                })}
                                placeholder="Ex: 15 jours"
                              />
                            </div>
                          </div>
                        )}
                      </div>
                    </div>
                  </div>
                )}

                {/* Section 7 : S√ªret√©s et garanties */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">S√ªret√©s et garanties (optionnelles)</h3>
                  
                  <div className="space-y-4">
                    {/* Caution personnelle */}
                    <div className="p-4 border rounded-lg space-y-3">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="caution_personnelle"
                          checked={quitusDetteData.suretes.cautionPersonnelle}
                          onChange={(e) => setQuitusDetteData({
                            ...quitusDetteData,
                            suretes: {...quitusDetteData.suretes, cautionPersonnelle: e.target.checked}
                          })}
                          className="rounded"
                        />
                        <Label htmlFor="caution_personnelle" className="cursor-pointer font-medium">
                          ‚òê Caution personnelle
                        </Label>
                      </div>

                      {quitusDetteData.suretes.cautionPersonnelle && (
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-3 mt-3">
                          <div className="space-y-2">
                            <Label>Identit√© du cautionnaire</Label>
                            <Input
                              value={quitusDetteData.suretes.cautionIdentite}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                suretes: {...quitusDetteData.suretes, cautionIdentite: e.target.value}
                              })}
                              placeholder="Nom complet"
                            />
                          </div>
                          <div className="space-y-2">
                            <Label>Montant garanti (‚Ç¨)</Label>
                            <Input
                              type="number"
                              step="0.01"
                              value={quitusDetteData.suretes.cautionMontant}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                suretes: {...quitusDetteData.suretes, cautionMontant: e.target.value}
                              })}
                            />
                          </div>
                          <div className="space-y-2">
                            <Label>Dur√©e du cautionnement</Label>
                            <Input
                              value={quitusDetteData.suretes.cautionDuree}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                suretes: {...quitusDetteData.suretes, cautionDuree: e.target.value}
                              })}
                              placeholder="Ex: 24 mois"
                            />
                          </div>
                        </div>
                      )}

                      {quitusDetteData.suretes.cautionPersonnelle && (
                        <div className="space-y-2">
                          <MultiFileUpload
                            label="üìÑ Pi√®ce d'identit√© de la caution"
                            files={quitusCautionIdentiteFiles}
                            onFilesChange={setQuitusCautionIdentiteFiles}
                            accept="application/pdf,image/*"
                          />
                        </div>
                      )}
                    </div>

                    {/* Autres s√ªret√©s */}
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="flex items-center space-x-2">
                        <input
                          type="checkbox"
                          id="garantie_salaire"
                          checked={quitusDetteData.suretes.garantieSalaire}
                          onChange={(e) => setQuitusDetteData({
                            ...quitusDetteData,
                            suretes: {...quitusDetteData.suretes, garantieSalaire: e.target.checked}
                          })}
                          className="rounded"
                        />
                        <Label htmlFor="garantie_salaire" className="cursor-pointer">
                          ‚òê Garantie sur salaire (engagement moral)
                        </Label>
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="gage_mobilier"
                            checked={quitusDetteData.suretes.gageMobilier}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              suretes: {...quitusDetteData.suretes, gageMobilier: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="gage_mobilier" className="cursor-pointer">
                            ‚òê Gage / nantissement d'un bien mobilier
                          </Label>
                        </div>
                        {quitusDetteData.suretes.gageMobilier && (
                          <Input
                            value={quitusDetteData.suretes.gageDescription}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              suretes: {...quitusDetteData.suretes, gageDescription: e.target.value}
                            })}
                            placeholder="Description du bien"
                            className="mt-2"
                          />
                        )}
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="nantissement_titres"
                            checked={quitusDetteData.suretes.nantissementTitres}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              suretes: {...quitusDetteData.suretes, nantissementTitres: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="nantissement_titres" className="cursor-pointer">
                            ‚òê Nantissement de compte-titres
                          </Label>
                        </div>
                        {quitusDetteData.suretes.nantissementTitres && (
                          <Input
                            value={quitusDetteData.suretes.nantissementDetails}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              suretes: {...quitusDetteData.suretes, nantissementDetails: e.target.value}
                            })}
                            placeholder="D√©tails du compte-titres"
                            className="mt-2"
                          />
                        )}
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="hypotheque"
                            checked={quitusDetteData.suretes.hypotheque}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              suretes: {...quitusDetteData.suretes, hypotheque: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="hypotheque" className="cursor-pointer">
                            ‚òê Hypoth√®que (rare pour particuliers)
                          </Label>
                        </div>
                        {quitusDetteData.suretes.hypotheque && (
                          <Input
                            value={quitusDetteData.suretes.hypothequeDetails}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              suretes: {...quitusDetteData.suretes, hypothequeDetails: e.target.value}
                            })}
                            placeholder="D√©tails de l'hypoth√®que"
                            className="mt-2"
                          />
                        )}
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="depot_garantie"
                            checked={quitusDetteData.suretes.depotGarantie}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              suretes: {...quitusDetteData.suretes, depotGarantie: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="depot_garantie" className="cursor-pointer">
                            ‚òê D√©p√¥t de garantie / somme bloqu√©e
                          </Label>
                        </div>
                        {quitusDetteData.suretes.depotGarantie && (
                          <Input
                            type="number"
                            step="0.01"
                            value={quitusDetteData.suretes.depotMontant}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              suretes: {...quitusDetteData.suretes, depotMontant: e.target.value}
                            })}
                            placeholder="Montant (‚Ç¨)"
                            className="mt-2"
                          />
                        )}
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="acte_authentique"
                            checked={quitusDetteData.suretes.acteAuthentique}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              suretes: {...quitusDetteData.suretes, acteAuthentique: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="acte_authentique" className="cursor-pointer">
                            ‚òê Reconnaissance de dette authentique (devant notaire)
                          </Label>
                        </div>
                        {quitusDetteData.suretes.acteAuthentique && (
                          <Input
                            value={quitusDetteData.suretes.notaireNom}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              suretes: {...quitusDetteData.suretes, notaireNom: e.target.value}
                            })}
                            placeholder="Nom du notaire"
                            className="mt-2"
                          />
                        )}
                      </div>
                    </div>
                  </div>
                </div>

                {/* Section 8 : Remise de dette */}
                {quitusDetteData.typeActe === "remise_dette" && (
                  <div>
                    <h3 className="font-semibold text-lg border-b pb-2 mb-4">Remise de dette (abandon de cr√©ance)</h3>
                    <div className="space-y-4">
                      <div className="space-y-2">
                        <Label>Type de remise</Label>
                        <RadioGroup
                          value={quitusDetteData.remiseDette.remiseTotale ? "totale" : "partielle"}
                          onValueChange={(value) => setQuitusDetteData({
                            ...quitusDetteData,
                            remiseDette: {
                              ...quitusDetteData.remiseDette,
                              remiseTotale: value === "totale",
                              remisePartielle: value === "partielle"
                            }
                          })}
                        >
                          <div className="flex items-center space-x-2">
                            <RadioGroupItem value="totale" id="remise_totale" />
                            <Label htmlFor="remise_totale" className="cursor-pointer">‚òê Remise totale de dette</Label>
                          </div>
                          <div className="flex items-center space-x-2">
                            <RadioGroupItem value="partielle" id="remise_partielle" />
                            <Label htmlFor="remise_partielle" className="cursor-pointer">‚òê Remise partielle</Label>
                          </div>
                        </RadioGroup>
                      </div>

                      {quitusDetteData.remiseDette.remisePartielle && (
                        <div className="space-y-2">
                          <Label>Montant de la remise (‚Ç¨)</Label>
                          <Input
                            type="number"
                            step="0.01"
                            value={quitusDetteData.remiseDette.montantRemise}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              remiseDette: {...quitusDetteData.remiseDette, montantRemise: e.target.value}
                            })}
                          />
                        </div>
                      )}

                      <div className="space-y-2">
                        <Label>Conditions de la remise</Label>
                        <textarea
                          value={quitusDetteData.remiseDette.conditionsRemise}
                          onChange={(e) => setQuitusDetteData({
                            ...quitusDetteData,
                            remiseDette: {...quitusDetteData.remiseDette, conditionsRemise: e.target.value}
                          })}
                          className="w-full min-h-[80px] p-3 border rounded-md"
                          placeholder="Conditions et raisons de la remise de dette..."
                        />
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="effets_retroactifs"
                            checked={quitusDetteData.remiseDette.effetsRetroactifs}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              remiseDette: {...quitusDetteData.remiseDette, effetsRetroactifs: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="effets_retroactifs" className="cursor-pointer">
                            Effets r√©troactifs
                          </Label>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="renonciation_poursuites"
                            checked={quitusDetteData.remiseDette.renonciationPoursuites}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              remiseDette: {...quitusDetteData.remiseDette, renonciationPoursuites: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="renonciation_poursuites" className="cursor-pointer">
                            Renonciation √† poursuites futures
                          </Label>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <Label>Preuve de paiement partiel d√©j√† re√ßu</Label>
                        <textarea
                          value={quitusDetteData.remiseDette.preuvesPaiementsPartiels}
                          onChange={(e) => setQuitusDetteData({
                            ...quitusDetteData,
                            remiseDette: {...quitusDetteData.remiseDette, preuvesPaiementsPartiels: e.target.value}
                          })}
                          className="w-full min-h-[60px] p-3 border rounded-md"
                          placeholder="D√©tails des paiements partiels re√ßus..."
                        />
                      </div>
                    </div>
                  </div>
                )}

                {/* Section 9 : Quitus */}
                {(quitusDetteData.typeActe === "quitus" || quitusDetteData.typeActe === "quitus_partiel" || quitusDetteData.typeActe === "solde_tout_compte" || quitusDetteData.typeActe === "attestation_reglement") && (
                  <div>
                    <h3 className="font-semibold text-lg border-b pb-2 mb-4">Quitus (dette r√©gl√©e)</h3>
                    <div className="space-y-4">
                      <div className="space-y-2">
                        <Label>Type de quitus</Label>
                        <Select
                          value={quitusDetteData.quitus.typeQuitus}
                          onValueChange={(value) => setQuitusDetteData({
                            ...quitusDetteData,
                            quitus: {...quitusDetteData.quitus, typeQuitus: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="total">‚òê Quitus total (dette √©teinte)</SelectItem>
                            <SelectItem value="partiel">‚òê Quitus partiel</SelectItem>
                            <SelectItem value="comptable">‚òê Quitus comptable (solde de tout compte)</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      {/* Paiements re√ßus */}
                      <div className="space-y-4">
                        <div className="flex items-center justify-between">
                          <Label className="font-medium">Paiements re√ßus</Label>
                          <Button
                            type="button"
                            size="sm"
                            variant="outline"
                            onClick={() => {
                              const newPaiement = {
                                id: quitusDetteData.quitus.paiementsRecus.length + 1,
                                date: "",
                                montant: "",
                                modePaiement: "",
                                referenceBancaire: ""
                              };
                              setQuitusDetteData({
                                ...quitusDetteData,
                                quitus: {
                                  ...quitusDetteData.quitus,
                                  paiementsRecus: [...quitusDetteData.quitus.paiementsRecus, newPaiement]
                                }
                              });
                            }}
                          >
                            + Ajouter un paiement
                          </Button>
                        </div>

                        {quitusDetteData.quitus.paiementsRecus.map((paiement, index) => (
                          <div key={paiement.id} className="p-4 border rounded-lg bg-white space-y-3">
                            <div className="flex justify-between items-center">
                              <h4 className="font-medium">Paiement #{index + 1}</h4>
                              {quitusDetteData.quitus.paiementsRecus.length > 1 && (
                                <Button
                                  type="button"
                                  variant="ghost"
                                  size="sm"
                                  onClick={() => {
                                    setQuitusDetteData({
                                      ...quitusDetteData,
                                      quitus: {
                                        ...quitusDetteData.quitus,
                                        paiementsRecus: quitusDetteData.quitus.paiementsRecus.filter(p => p.id !== paiement.id)
                                      }
                                    });
                                  }}
                                >
                                  Supprimer
                                </Button>
                              )}
                            </div>
                            
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                              <div className="space-y-2">
                                <Label>Date</Label>
                                <Input
                                  type="date"
                                  value={paiement.date}
                                  onChange={(e) => {
                                    const updated = [...quitusDetteData.quitus.paiementsRecus];
                                    updated[index] = {...paiement, date: e.target.value};
                                    setQuitusDetteData({
                                      ...quitusDetteData,
                                      quitus: {...quitusDetteData.quitus, paiementsRecus: updated}
                                    });
                                  }}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Montant (‚Ç¨)</Label>
                                <Input
                                  type="number"
                                  step="0.01"
                                  value={paiement.montant}
                                  onChange={(e) => {
                                    const updated = [...quitusDetteData.quitus.paiementsRecus];
                                    updated[index] = {...paiement, montant: e.target.value};
                                    setQuitusDetteData({
                                      ...quitusDetteData,
                                      quitus: {...quitusDetteData.quitus, paiementsRecus: updated}
                                    });
                                  }}
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>Mode de paiement</Label>
                                <Input
                                  value={paiement.modePaiement}
                                  onChange={(e) => {
                                    const updated = [...quitusDetteData.quitus.paiementsRecus];
                                    updated[index] = {...paiement, modePaiement: e.target.value};
                                    setQuitusDetteData({
                                      ...quitusDetteData,
                                      quitus: {...quitusDetteData.quitus, paiementsRecus: updated}
                                    });
                                  }}
                                  placeholder="Virement, ch√®que..."
                                />
                              </div>
                              <div className="space-y-2">
                                <Label>R√©f√©rence bancaire</Label>
                                <Input
                                  value={paiement.referenceBancaire}
                                  onChange={(e) => {
                                    const updated = [...quitusDetteData.quitus.paiementsRecus];
                                    updated[index] = {...paiement, referenceBancaire: e.target.value};
                                    setQuitusDetteData({
                                      ...quitusDetteData,
                                      quitus: {...quitusDetteData.quitus, paiementsRecus: updated}
                                    });
                                  }}
                                  placeholder="Num√©ro de transaction"
                                />
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>

                      <div className="space-y-2">
                        <MultiFileUpload
                          label="üí∞ Preuves des paiements re√ßus"
                          required
                          files={quitusPreuvesPaiementsFiles}
                          onFilesChange={setQuitusPreuvesPaiementsFiles}
                          accept="application/pdf,image/*"
                        />
                      </div>

                      {/* D√©clarations du cr√©ancier */}
                      <div className="space-y-3 p-4 border rounded-lg bg-teal-100">
                        <Label className="font-medium">D√©clarations du cr√©ancier (obligatoires)</Label>
                        
                        <div className="space-y-2">
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="sommes_recues"
                              checked={quitusDetteData.quitus.sommesRecuesTotalement}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                quitus: {...quitusDetteData.quitus, sommesRecuesTotalement: e.target.checked}
                              })}
                              className="rounded"
                            />
                            <Label htmlFor="sommes_recues" className="cursor-pointer">
                              Avoir re√ßu toutes les sommes dues
                            </Label>
                          </div>

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="renonciation_reclamations"
                              checked={quitusDetteData.quitus.renonciationReclamations}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                quitus: {...quitusDetteData.quitus, renonciationReclamations: e.target.checked}
                              })}
                              className="rounded"
                            />
                            <Label htmlFor="renonciation_reclamations" className="cursor-pointer">
                              Renoncer √† toute r√©clamation future
                            </Label>
                          </div>

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="dette_eteinte"
                              checked={quitusDetteData.quitus.detteEteinte}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                quitus: {...quitusDetteData.quitus, detteEteinte: e.target.checked}
                              })}
                              className="rounded"
                            />
                            <Label htmlFor="dette_eteinte" className="cursor-pointer">
                              Reconna√Ætre la dette comme enti√®rement √©teinte
                            </Label>
                          </div>

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="annulation_garanties"
                              checked={quitusDetteData.quitus.annulationGaranties}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                quitus: {...quitusDetteData.quitus, annulationGaranties: e.target.checked}
                              })}
                              className="rounded"
                            />
                            <Label htmlFor="annulation_garanties" className="cursor-pointer">
                              Annuler les garanties √©ventuellement donn√©es
                            </Label>
                          </div>

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="restitution_documents"
                              checked={quitusDetteData.quitus.restitutionDocuments}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                quitus: {...quitusDetteData.quitus, restitutionDocuments: e.target.checked}
                              })}
                              className="rounded"
                            />
                            <Label htmlFor="restitution_documents" className="cursor-pointer">
                              Restituer les documents remis en garantie
                            </Label>
                          </div>
                        </div>
                      </div>

                      <div className="space-y-2">
                        <MultiFileUpload
                          label="üìÑ Ancienne reconnaissance de dette"
                          files={quitusAncienneDetteFiles}
                          onFilesChange={setQuitusAncienneDetteFiles}
                          accept="application/pdf,image/*"
                        />
                      </div>
                    </div>
                  </div>
                )}

                {/* Section 10 : Clauses l√©gales */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Clauses l√©gales</h3>
                  
                  <div className="space-y-4">
                    {(quitusDetteData.typeActe === "reconnaissance_dette" || quitusDetteData.typeActe === "reconnaissance_dette_modalites") && (
                      <div className="space-y-3">
                        <Label className="font-medium text-slate-700">Clauses obligatoires pour reconnaissance de dette</Label>
                        
                        <div className="space-y-2">
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="consentement_libre"
                              checked={quitusDetteData.clausesLegales.consentementLibre}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                clausesLegales: {...quitusDetteData.clausesLegales, consentementLibre: e.target.checked}
                              })}
                              className="rounded"
                            />
                            <Label htmlFor="consentement_libre" className="cursor-pointer">
                              Consentement libre et √©clair√© (absence de vice)
                            </Label>
                          </div>

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="reconnaissance_montant"
                              checked={quitusDetteData.clausesLegales.reconnaissanceMontant}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                clausesLegales: {...quitusDetteData.clausesLegales, reconnaissanceMontant: e.target.checked}
                              })}
                              className="rounded"
                            />
                            <Label htmlFor="reconnaissance_montant" className="cursor-pointer">
                              Reconnaissance du montant exact de la dette
                            </Label>
                          </div>

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="engagement_remboursement"
                              checked={quitusDetteData.clausesLegales.engagementRemboursement}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                clausesLegales: {...quitusDetteData.clausesLegales, engagementRemboursement: e.target.checked}
                              })}
                              className="rounded"
                            />
                            <Label htmlFor="engagement_remboursement" className="cursor-pointer">
                              Engagement de remboursement
                            </Label>
                          </div>

                          <div className="space-y-2 mt-4">
                            <Label htmlFor="mention_manuscrite">
                              Mention manuscrite obligatoire (√† recopier par le d√©biteur) <span className="text-red-600">*</span>
                            </Label>
                            <textarea
                              id="mention_manuscrite"
                              value={quitusDetteData.clausesLegales.mentionManuscrite}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                clausesLegales: {...quitusDetteData.clausesLegales, mentionManuscrite: e.target.value}
                              })}
                              className="w-full min-h-[100px] p-3 border rounded-md"
                              placeholder={`Ex: "Je reconnais devoir la somme de ... euros √† ... au titre de ... Je m'engage √† rembourser selon les modalit√©s d√©crites ci-dessus."`}
                            />
                            <p className="text-xs text-gray-600">
                              ‚ö†Ô∏è Cette mention doit √™tre √©crite de la main du d√©biteur pour √™tre valable
                            </p>
                          </div>

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="clause_solidarite"
                              checked={quitusDetteData.clausesLegales.clauseSolidarite}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                clausesLegales: {...quitusDetteData.clausesLegales, clauseSolidarite: e.target.checked}
                              })}
                              className="rounded"
                            />
                            <Label htmlFor="clause_solidarite" className="cursor-pointer">
                              Clause de solidarit√© (si plusieurs d√©biteurs)
                            </Label>
                          </div>

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="clause_divisibilite"
                              checked={quitusDetteData.clausesLegales.clauseDivisibilite}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                clausesLegales: {...quitusDetteData.clausesLegales, clauseDivisibilite: e.target.checked}
                              })}
                              className="rounded"
                            />
                            <Label htmlFor="clause_divisibilite" className="cursor-pointer">
                              Clause de divisibilit√© / ind√©pendance des clauses
                            </Label>
                          </div>
                        </div>
                      </div>
                    )}

                    {(quitusDetteData.typeActe === "quitus" || quitusDetteData.typeActe === "quitus_partiel" || quitusDetteData.typeActe === "solde_tout_compte" || quitusDetteData.typeActe === "remise_dette" || quitusDetteData.typeActe === "attestation_reglement") && (
                      <div className="space-y-3">
                        <Label className="font-medium text-slate-700">Clauses pour quitus / extinction de dette</Label>
                        
                        <div className="space-y-2">
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="extinction_dette"
                              checked={quitusDetteData.clausesLegales.extinctionDette}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                clausesLegales: {...quitusDetteData.clausesLegales, extinctionDette: e.target.checked}
                              })}
                              className="rounded"
                            />
                            <Label htmlFor="extinction_dette" className="cursor-pointer">
                              Extinction compl√®te de la dette
                            </Label>
                          </div>

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="liberation_definitive"
                              checked={quitusDetteData.clausesLegales.liberationDefinitive}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                clausesLegales: {...quitusDetteData.clausesLegales, liberationDefinitive: e.target.checked}
                              })}
                              className="rounded"
                            />
                            <Label htmlFor="liberation_definitive" className="cursor-pointer">
                              Lib√©ration d√©finitive du d√©biteur
                            </Label>
                          </div>

                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="renonciation_recours"
                              checked={quitusDetteData.clausesLegales.renonciationRecours}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                clausesLegales: {...quitusDetteData.clausesLegales, renonciationRecours: e.target.checked}
                              })}
                              className="rounded"
                            />
                            <Label htmlFor="renonciation_recours" className="cursor-pointer">
                              Renonciation √† tout recours ult√©rieur
                            </Label>
                          </div>

                          <div className="space-y-2 mt-4">
                            <Label htmlFor="identification_dette">
                              Identification pr√©cise de la dette √©teinte
                            </Label>
                            <textarea
                              id="identification_dette"
                              value={quitusDetteData.clausesLegales.identificationDette}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                clausesLegales: {...quitusDetteData.clausesLegales, identificationDette: e.target.value}
                              })}
                              className="w-full min-h-[80px] p-3 border rounded-md"
                              placeholder="Description pr√©cise de la dette qui est √©teinte (date, montant, nature...)"
                            />
                          </div>
                        </div>
                      </div>
                    )}

                    {/* Nouvelles clauses juridiques importantes */}
                    <div className="space-y-3 mt-6 p-4 border-2 border-red-300 rounded-lg bg-red-50">
                      <Label className="font-medium text-red-800 text-base">üî¥ Clauses juridiques essentielles</Label>
                      
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input
                            type="checkbox"
                            id="clause_non_novation"
                            checked={quitusDetteData.clausesLegales.clauseNonNovation}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              clausesLegales: {...quitusDetteData.clausesLegales, clauseNonNovation: e.target.checked}
                            })}
                            className="rounded"
                          />
                          <Label htmlFor="clause_non_novation" className="cursor-pointer text-sm">
                            <strong>Clause de non-novation</strong> - Le pr√©sent acte ne constitue pas novation de la dette initiale
                          </Label>
                        </div>
                        <p className="text-xs text-gray-600 ml-6">
                          ‚ö†Ô∏è Important : Pr√©vient qu'un simple quitus ou reconnaissance ne cr√©e pas une nouvelle dette
                        </p>

                        <div className="space-y-3 mt-4">
                          <div className="space-y-2">
                            <Label htmlFor="droit_applicable">
                              üî¥ Droit applicable <span className="text-red-600">*</span>
                            </Label>
                            <Select
                              value={quitusDetteData.clausesLegales.droitApplicable}
                              onValueChange={(value) => setQuitusDetteData({
                                ...quitusDetteData,
                                clausesLegales: {...quitusDetteData.clausesLegales, droitApplicable: value}
                              })}
                            >
                              <SelectTrigger id="droit_applicable"><SelectValue /></SelectTrigger>
                              <SelectContent>
                                <SelectItem value="france">‚òê Droit fran√ßais</SelectItem>
                                <SelectItem value="autre">‚òê Autre droit (√† pr√©ciser)</SelectItem>
                              </SelectContent>
                            </Select>
                          </div>

                          <div className="space-y-2">
                            <Label htmlFor="tribunal_competent">
                              üî¥ Tribunal comp√©tent <span className="text-red-600">*</span>
                            </Label>
                            <Input
                              id="tribunal_competent"
                              value={quitusDetteData.clausesLegales.tribunalCompetent}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                clausesLegales: {...quitusDetteData.clausesLegales, tribunalCompetent: e.target.value}
                              })}
                              placeholder="Ex: Tribunal de grande instance de Paris"
                            />
                            <p className="text-xs text-gray-600">
                              Indispensable en cas de litige. G√©n√©ralement le tribunal du lieu du domicile du d√©biteur.
                            </p>
                          </div>
                        </div>

                        <div className="space-y-2 mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded">
                          <Label className="font-medium text-sm">Pluralit√© de d√©biteurs (si applicable)</Label>
                          
                          <div className="flex items-center space-x-2">
                            <input
                              type="checkbox"
                              id="pluralite_debiteurs"
                              checked={quitusDetteData.clausesLegales.pluraliteDebiteurs}
                              onChange={(e) => setQuitusDetteData({
                                ...quitusDetteData,
                                clausesLegales: {...quitusDetteData.clausesLegales, pluraliteDebiteurs: e.target.checked}
                              })}
                              className="rounded"
                            />
                            <Label htmlFor="pluralite_debiteurs" className="cursor-pointer">
                              Plusieurs d√©biteurs
                            </Label>
                          </div>

                          {quitusDetteData.clausesLegales.pluraliteDebiteurs && (
                            <div className="mt-3 space-y-2">
                              <RadioGroup
                                value={quitusDetteData.clausesLegales.solidarite ? "solidaire" : "non_solidaire"}
                                onValueChange={(value) => setQuitusDetteData({
                                  ...quitusDetteData,
                                  clausesLegales: {...quitusDetteData.clausesLegales, solidarite: value === "solidaire"}
                                })}
                              >
                                <div className="flex items-center space-x-2">
                                  <RadioGroupItem value="solidaire" id="solidarite_oui" />
                                  <Label htmlFor="solidarite_oui" className="cursor-pointer">
                                    ‚òê Solidarit√© (chaque d√©biteur peut √™tre poursuivi pour la totalit√©)
                                  </Label>
                                </div>
                                <div className="flex items-center space-x-2">
                                  <RadioGroupItem value="non_solidaire" id="solidarite_non" />
                                  <Label htmlFor="solidarite_non" className="cursor-pointer">
                                    ‚òê Non solidarit√© (chacun ne doit que sa part)
                                  </Label>
                                </div>
                              </RadioGroup>
                            </div>
                          )}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Section 11 : Signatures */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Signatures et formalit√©s</h3>
                  
                  <div className="space-y-4">
                    {/* Dates importantes */}
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                      <div className="space-y-2">
                        <Label htmlFor="date_extinction_effective">
                          üî¥ Date effective d'extinction de la dette
                        </Label>
                        <Input
                          id="date_extinction_effective"
                          type="date"
                          value={quitusDetteData.signatures.dateExtinctionEffective}
                          onChange={(e) => setQuitusDetteData({
                            ...quitusDetteData,
                            signatures: {...quitusDetteData.signatures, dateExtinctionEffective: e.target.value}
                          })}
                        />
                        <p className="text-xs text-gray-600">
                          Diff√©rente de la date de signature. Date r√©elle de paiement final ou d'extinction.
                        </p>
                      </div>

                      <div className="space-y-2">
                        <Label htmlFor="date_signature">
                          Date de signature <span className="text-red-600">*</span>
                        </Label>
                        <Input
                          id="date_signature"
                          type="date"
                          value={quitusDetteData.signatures.dateSignature}
                          onChange={(e) => setQuitusDetteData({
                            ...quitusDetteData,
                            signatures: {...quitusDetteData.signatures, dateSignature: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label htmlFor="lieu_signature">
                          Lieu de signature <span className="text-red-600">*</span>
                        </Label>
                        <Input
                          id="lieu_signature"
                          value={quitusDetteData.signatures.lieuSignature}
                          onChange={(e) => setQuitusDetteData({
                            ...quitusDetteData,
                            signatures: {...quitusDetteData.signatures, lieuSignature: e.target.value}
                          })}
                          placeholder="Ville"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label htmlFor="signature_notaire">
                          Signature devant notaire ?
                        </Label>
                        <Select
                          value={quitusDetteData.signatures.signatureNotaire}
                          onValueChange={(value) => setQuitusDetteData({
                            ...quitusDetteData,
                            signatures: {...quitusDetteData.signatures, signatureNotaire: value}
                          })}
                        >
                          <SelectTrigger id="signature_notaire"><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="non">Non (acte sous seing priv√©)</SelectItem>
                            <SelectItem value="oui">Oui (acte authentique)</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                    </div>

                    {quitusDetteData.signatures.signatureNotaire === "oui" && (
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-amber-50 border border-amber-200 rounded-lg">
                        <div className="space-y-2">
                          <Label htmlFor="nom_notaire">
                            Nom du notaire <span className="text-red-600">*</span>
                          </Label>
                          <Input
                            id="nom_notaire"
                            value={quitusDetteData.signatures.nomNotaire}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              signatures: {...quitusDetteData.signatures, nomNotaire: e.target.value}
                            })}
                            placeholder="Nom complet"
                          />
                        </div>
                        <div className="space-y-2">
                          <Label htmlFor="ville_notaire">
                            Ville du notaire <span className="text-red-600">*</span>
                          </Label>
                          <Input
                            id="ville_notaire"
                            value={quitusDetteData.signatures.villeNotaire}
                            onChange={(e) => setQuitusDetteData({
                              ...quitusDetteData,
                              signatures: {...quitusDetteData.signatures, villeNotaire: e.target.value}
                            })}
                            placeholder="Ville de l'√©tude"
                          />
                        </div>
                      </div>
                    )}
                  </div>
                </div>

              </div>
            )}

            {/* Formulaire Acte de cession de parts sociales */}
            {pendingContractType === "Acte de cession de parts sociales" && (
              <div className="space-y-6 max-h-[calc(100vh-250px)] overflow-y-auto pr-2">
                
                {/* Section 1 : Type de soci√©t√© */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Type de soci√©t√©</h3>
                  <div className="space-y-3">
                    <Label>Type de soci√©t√© <span className="text-red-500">*</span></Label>
                    <Select
                      value={cessionPartsData.typeSociete}
                      onValueChange={(value) => setCessionPartsData({...cessionPartsData, typeSociete: value})}
                    >
                      <SelectTrigger><SelectValue placeholder="S√©lectionner le type de soci√©t√©" /></SelectTrigger>
                      <SelectContent>
                        <SelectItem value="sarl">SARL (Soci√©t√© √† responsabilit√© limit√©e)</SelectItem>
                        <SelectItem value="sci">SCI (Soci√©t√© civile immobili√®re)</SelectItem>
                        <SelectItem value="sas">SAS (Soci√©t√© par actions simplifi√©e - acte sous seing priv√©)</SelectItem>
                        <SelectItem value="snc">SNC (Soci√©t√© en nom collectif)</SelectItem>
                        <SelectItem value="autre_personne">Autre soci√©t√© de personnes</SelectItem>
                      </SelectContent>
                    </Select>
                  </div>
                </div>

                {/* Section 2 : Informations sur la soci√©t√© */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Informations sur la soci√©t√©</h3>
                  

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>D√©nomination sociale <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.societe.denominationSociale}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          societe: {...cessionPartsData.societe, denominationSociale: e.target.value}
                        })}
                        placeholder="Raison sociale de la soci√©t√©"
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Sigle (si existant)</Label>
                      <Input
                        value={cessionPartsData.societe.sigle}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          societe: {...cessionPartsData.societe, sigle: e.target.value}
                        })}
                        placeholder="Sigle commercial"
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Forme juridique <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.societe.formeJuridique}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          societe: {...cessionPartsData.societe, formeJuridique: e.target.value}
                        })}
                        placeholder="SARL, SCI, SAS..."
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Capital social <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.societe.capitalSocial}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          societe: {...cessionPartsData.societe, capitalSocial: e.target.value}
                        })}
                        placeholder="Montant du capital"
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Si√®ge social <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.societe.siegeSocial}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          societe: {...cessionPartsData.societe, siegeSocial: e.target.value}
                        })}
                        placeholder="Adresse compl√®te du si√®ge"
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>SIREN <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.societe.siren}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          societe: {...cessionPartsData.societe, siren: e.target.value}
                        })}
                        placeholder="Num√©ro SIREN (9 chiffres)"
                        maxLength={9}
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>RCS + Greffe comp√©tent <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.societe.rcs}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          societe: {...cessionPartsData.societe, rcs: e.target.value}
                        })}
                        placeholder="Ex: RCS Paris 123456789"
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Greffe comp√©tent <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.societe.greffeCompetent}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          societe: {...cessionPartsData.societe, greffeCompetent: e.target.value}
                        })}
                        placeholder="Nom du greffe"
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Activit√© de la soci√©t√© <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.societe.activiteSociete}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          societe: {...cessionPartsData.societe, activiteSociete: e.target.value}
                        })}
                        placeholder="Secteur d'activit√©"
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Date de cr√©ation <span className="text-red-500">*</span></Label>
                      <Input
                        type="date"
                        value={cessionPartsData.societe.dateCreation}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          societe: {...cessionPartsData.societe, dateCreation: e.target.value}
                        })}
                      />
                    </div>
                  </div>

                  <div className="space-y-2">
                    <Label>Objet social <span className="text-red-500">*</span></Label>
                    <Textarea
                      value={cessionPartsData.societe.objetSocial}
                      onChange={(e) => setCessionPartsData({
                        ...cessionPartsData,
                        societe: {...cessionPartsData.societe, objetSocial: e.target.value}
                      })}
                      placeholder="D√©crire l'objet social de la soci√©t√©"
                      rows={3}
                    />
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Existence d'un pacte d'associ√©s</Label>
                      <Select
                        value={cessionPartsData.societe.pacteAssocies ? "oui" : "non"}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          societe: {...cessionPartsData.societe, pacteAssocies: value === "oui"}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="non">Non</SelectItem>
                          <SelectItem value="oui">Oui (√† fournir)</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="space-y-2">
                      <Label>Existence d'un expert-comptable</Label>
                      <Select
                        value={cessionPartsData.societe.expertComptable ? "oui" : "non"}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          societe: {...cessionPartsData.societe, expertComptable: value === "oui"}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="non">Non</SelectItem>
                          <SelectItem value="oui">Oui</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>

                  {/* Identit√© du g√©rant/pr√©sident */}
                  <div className="bg-white p-4 rounded-lg border border-green-300 space-y-4">
                    <h4 className="font-semibold text-green-800">Identit√© du g√©rant / pr√©sident</h4>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Nom <span className="text-red-500">*</span></Label>
                        <Input
                          value={cessionPartsData.societe.gerantNom}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            societe: {...cessionPartsData.societe, gerantNom: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                        <Input
                          value={cessionPartsData.societe.gerantPrenom}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            societe: {...cessionPartsData.societe, gerantPrenom: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Adresse <span className="text-red-500">*</span></Label>
                        <Input
                          value={cessionPartsData.societe.gerantAdresse}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            societe: {...cessionPartsData.societe, gerantAdresse: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Pouvoirs selon statuts</Label>
                        <Textarea
                          value={cessionPartsData.societe.gerantPouvoirs}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            societe: {...cessionPartsData.societe, gerantPouvoirs: e.target.value}
                          })}
                          placeholder="D√©crire les pouvoirs du g√©rant/pr√©sident"
                          rows={2}
                        />
                      </div>
                    </div>
                  </div>

                  {/* Upload statuts */}
                  <div className="space-y-2">
                    <Label className="text-red-600 font-semibold">üìÑ Statuts de la soci√©t√© (obligatoire)</Label>
                    <MultiFileUpload
                      files={cessionStatutsFiles}
                      onFilesChange={setCessionStatutsFiles}
                      accept=".pdf,.doc,.docx"
                      label="Joindre les statuts √† jour"
                    />
                  </div>
                </div>

                {/* Section 3 : Identit√© du c√©dant (vendeur) */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Identit√© compl√®te du c√©dant (vendeur des parts)</h3>
                  {clients && clients.length > 0 && (
                    <div className="space-y-2">
                      <Label>Lier √† un client existant (facultatif)</Label>
                      <Select
                        value={cessionPartsData.cedant.clientId}
                        onValueChange={(value) => {
                          const selectedClient = clients.find(c => c.id === value);
                          if (selectedClient) {
                            // Extraire la situation familiale de l'objet JSON
                            let situationFamiliale = "";
                            if (typeof selectedClient.situation_familiale === 'object' && selectedClient.situation_familiale !== null) {
                              situationFamiliale = selectedClient.situation_familiale.situation_familiale || "";
                            } else if (typeof selectedClient.situation_familiale === 'string') {
                              situationFamiliale = selectedClient.situation_familiale;
                            }
                            
                            // Extraire r√©gime matrimonial seulement si mari√©/pacs√©
                            let regimeMatrimonial = "";
                            const situation = situationFamiliale.toLowerCase();
                            if (situation.includes("mari√©") || situation.includes("pacs√©") || situation.includes("pacse")) {
                              if (typeof selectedClient.regime_matrimonial === 'object' && selectedClient.regime_matrimonial !== null) {
                                regimeMatrimonial = selectedClient.regime_matrimonial.regime_matrimonial || "";
                              } else if (typeof selectedClient.regime_matrimonial === 'string') {
                                regimeMatrimonial = selectedClient.regime_matrimonial;
                              }
                            }
                            
                            setCessionPartsData({
                              ...cessionPartsData,
                              cedant: {
                                ...cessionPartsData.cedant,
                                clientId: value,
                                nom: selectedClient.nom,
                                prenom: selectedClient.prenom,
                                dateNaissance: selectedClient.date_naissance || "",
                                nationalite: selectedClient.nationalite || "",
                                profession: selectedClient.profession || "",
                                adresseComplete: selectedClient.adresse || "",
                                telephone: selectedClient.telephone || "",
                                email: selectedClient.email || "",
                                typeIdentite: selectedClient.type_identite || "",
                                numeroIdentite: selectedClient.numero_identite || "",
                                situationMatrimoniale: situationFamiliale || selectedClient.situation_matrimoniale || "",
                                regimeMatrimonial: regimeMatrimonial,
                              }
                            });
                          }
                        }}
                      >
                        <SelectTrigger><SelectValue placeholder="Choisir un client..." /></SelectTrigger>
                        <SelectContent>
                          {clients.map((client) => (
                            <SelectItem key={client.id} value={client.id}>
                              {client.prenom} {client.nom}
                            </SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                    </div>
                  )}

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Nom <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.cedant.nom}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          cedant: {...cessionPartsData.cedant, nom: e.target.value}
                        })}
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.cedant.prenom}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          cedant: {...cessionPartsData.cedant, prenom: e.target.value}
                        })}
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Nom de naissance</Label>
                      <Input
                        value={cessionPartsData.cedant.nomNaissance}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          cedant: {...cessionPartsData.cedant, nomNaissance: e.target.value}
                        })}
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Date de naissance <span className="text-red-500">*</span></Label>
                      <Input
                        type="date"
                        value={cessionPartsData.cedant.dateNaissance}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          cedant: {...cessionPartsData.cedant, dateNaissance: e.target.value}
                        })}
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Nationalit√© <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.cedant.nationalite}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          cedant: {...cessionPartsData.cedant, nationalite: e.target.value}
                        })}
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Profession</Label>
                      <Input
                        value={cessionPartsData.cedant.profession}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          cedant: {...cessionPartsData.cedant, profession: e.target.value}
                        })}
                      />
                    </div>

                    <div className="space-y-2 md:col-span-2">
                      <Label>Adresse compl√®te <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.cedant.adresseComplete}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          cedant: {...cessionPartsData.cedant, adresseComplete: e.target.value}
                        })}
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Email</Label>
                      <Input
                        type="email"
                        value={cessionPartsData.cedant.email}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          cedant: {...cessionPartsData.cedant, email: e.target.value}
                        })}
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>T√©l√©phone</Label>
                      <Input
                        value={cessionPartsData.cedant.telephone}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          cedant: {...cessionPartsData.cedant, telephone: e.target.value}
                        })}
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Situation matrimoniale</Label>
                      <Input
                        value={cessionPartsData.cedant.situationMatrimoniale}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          cedant: {...cessionPartsData.cedant, situationMatrimoniale: e.target.value}
                        })}
                        placeholder="C√©libataire, mari√©(e), pacs√©(e)..."
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>R√©gime matrimonial</Label>
                      <Input
                        value={cessionPartsData.cedant.regimeMatrimonial}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          cedant: {...cessionPartsData.cedant, regimeMatrimonial: e.target.value}
                        })}
                        placeholder="Communaut√©, s√©paration de biens..."
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Type de pi√®ce d'identit√© <span className="text-red-500">*</span></Label>
                      <Select
                        value={cessionPartsData.cedant.typeIdentite}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          cedant: {...cessionPartsData.cedant, typeIdentite: value}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="cni">Carte nationale d'identit√©</SelectItem>
                          <SelectItem value="passeport">Passeport</SelectItem>
                          <SelectItem value="titre_sejour">Titre de s√©jour</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="space-y-2">
                      <Label>Num√©ro de pi√®ce d'identit√© <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.cedant.numeroIdentite}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          cedant: {...cessionPartsData.cedant, numeroIdentite: e.target.value}
                        })}
                      />
                    </div>

                    <div className="space-y-2 md:col-span-2">
                      <Label>Qualit√© dans la soci√©t√© <span className="text-red-500">*</span></Label>
                      <Select
                        value={cessionPartsData.cedant.qualiteSociete}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          cedant: {...cessionPartsData.cedant, qualiteSociete: value}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner la qualit√©" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="associe">Associ√©</SelectItem>
                          <SelectItem value="gerant_president">G√©rant / Pr√©sident</SelectItem>
                          <SelectItem value="associe_fondateur">Associ√© fondateur</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>
                </div>

                {/* Section 4 : Identit√© du cessionnaire (acheteur) */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Identit√© compl√®te du cessionnaire (acheteur)</h3>
                  <div className="space-y-2">
                    <Label>Type de personne <span className="text-red-500">*</span></Label>
                    <Select
                      value={cessionPartsData.cessionnaire.typePersonne}
                      onValueChange={(value) => setCessionPartsData({
                        ...cessionPartsData,
                        cessionnaire: {...cessionPartsData.cessionnaire, typePersonne: value as "physique" | "morale"}
                      })}
                    >
                      <SelectTrigger><SelectValue /></SelectTrigger>
                      <SelectContent>
                        <SelectItem value="physique">Personne physique</SelectItem>
                        <SelectItem value="morale">Personne morale (soci√©t√©)</SelectItem>
                      </SelectContent>
                    </Select>
                  </div>

                  {cessionPartsData.cessionnaire.typePersonne === "physique" && (
                    <>
                      {clients && clients.length > 0 && (
                        <div className="space-y-2">
                          <Label>Lier √† un client existant (facultatif)</Label>
                          <Select
                            value={cessionPartsData.cessionnaire.clientId || ""}
                            onValueChange={(value) => {
                              const selectedClient = clients.find(c => c.id === value);
                              if (selectedClient) {
                                // Extraire la situation familiale
                                let situationFamiliale = "";
                                if (typeof selectedClient.situation_familiale === 'object' && selectedClient.situation_familiale !== null) {
                                  situationFamiliale = selectedClient.situation_familiale.situation_familiale || "";
                                } else if (typeof selectedClient.situation_familiale === 'string') {
                                  situationFamiliale = selectedClient.situation_familiale;
                                }
                                
                                setCessionPartsData({
                                  ...cessionPartsData,
                                  cessionnaire: {
                                    ...cessionPartsData.cessionnaire,
                                    clientId: value,
                                    nom: selectedClient.nom,
                                    prenom: selectedClient.prenom,
                                    dateNaissance: selectedClient.date_naissance || "",
                                    nationalite: selectedClient.nationalite || "",
                                    profession: selectedClient.profession || "",
                                    adresseComplete: selectedClient.adresse || "",
                                    telephone: selectedClient.telephone || "",
                                    email: selectedClient.email || "",
                                    typeIdentite: selectedClient.type_identite || "",
                                    numeroIdentite: selectedClient.numero_identite || "",
                                    situationMatrimoniale: situationFamiliale || selectedClient.situation_matrimoniale || "",
                                  }
                                });
                              }
                            }}
                          >
                            <SelectTrigger><SelectValue placeholder="Choisir un client..." /></SelectTrigger>
                            <SelectContent>
                              {clients.map((client) => (
                                <SelectItem key={client.id} value={client.id}>
                                  {client.prenom} {client.nom}
                                </SelectItem>
                              ))}
                            </SelectContent>
                          </Select>
                        </div>
                      )}

                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Nom <span className="text-red-500">*</span></Label>
                        <Input
                          value={cessionPartsData.cessionnaire.nom}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            cessionnaire: {...cessionPartsData.cessionnaire, nom: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Pr√©nom <span className="text-red-500">*</span></Label>
                        <Input
                          value={cessionPartsData.cessionnaire.prenom}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            cessionnaire: {...cessionPartsData.cessionnaire, prenom: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Adresse compl√®te <span className="text-red-500">*</span></Label>
                        <Input
                          value={cessionPartsData.cessionnaire.adresseComplete}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            cessionnaire: {...cessionPartsData.cessionnaire, adresseComplete: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Email</Label>
                        <Input
                          type="email"
                          value={cessionPartsData.cessionnaire.email}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            cessionnaire: {...cessionPartsData.cessionnaire, email: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>T√©l√©phone</Label>
                        <Input
                          value={cessionPartsData.cessionnaire.telephone}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            cessionnaire: {...cessionPartsData.cessionnaire, telephone: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Date de naissance <span className="text-red-500">*</span></Label>
                        <Input
                          type="date"
                          value={cessionPartsData.cessionnaire.dateNaissance}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            cessionnaire: {...cessionPartsData.cessionnaire, dateNaissance: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Nationalit√© <span className="text-red-500">*</span></Label>
                        <Input
                          value={cessionPartsData.cessionnaire.nationalite}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            cessionnaire: {...cessionPartsData.cessionnaire, nationalite: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Profession</Label>
                        <Input
                          value={cessionPartsData.cessionnaire.profession}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            cessionnaire: {...cessionPartsData.cessionnaire, profession: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Situation matrimoniale</Label>
                        <Input
                          value={cessionPartsData.cessionnaire.situationMatrimoniale}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            cessionnaire: {...cessionPartsData.cessionnaire, situationMatrimoniale: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Type pi√®ce d'identit√© <span className="text-red-500">*</span></Label>
                        <Select
                          value={cessionPartsData.cessionnaire.typeIdentite}
                          onValueChange={(value) => setCessionPartsData({
                            ...cessionPartsData,
                            cessionnaire: {...cessionPartsData.cessionnaire, typeIdentite: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="cni">CNI</SelectItem>
                            <SelectItem value="passeport">Passeport</SelectItem>
                            <SelectItem value="titre_sejour">Titre de s√©jour</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="space-y-2">
                        <Label>Num√©ro pi√®ce d'identit√© <span className="text-red-500">*</span></Label>
                        <Input
                          value={cessionPartsData.cessionnaire.numeroIdentite}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            cessionnaire: {...cessionPartsData.cessionnaire, numeroIdentite: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Capacit√© juridique</Label>
                        <Select
                          value={cessionPartsData.cessionnaire.capaciteJuridique}
                          onValueChange={(value) => setCessionPartsData({
                            ...cessionPartsData,
                            cessionnaire: {...cessionPartsData.cessionnaire, capaciteJuridique: value}
                          })}
                        >
                          <SelectTrigger><SelectValue /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="majeur">Majeur capable</SelectItem>
                            <SelectItem value="mineur">Mineur</SelectItem>
                            <SelectItem value="protege">Majeur prot√©g√©</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                    </div>
                    </>
                  )}

                  {cessionPartsData.cessionnaire.typePersonne === "morale" && (
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label>D√©nomination sociale <span className="text-red-500">*</span></Label>
                        <Input
                          value={cessionPartsData.cessionnaire.denominationMorale}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            cessionnaire: {...cessionPartsData.cessionnaire, denominationMorale: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Repr√©sentant l√©gal <span className="text-red-500">*</span></Label>
                        <Input
                          value={cessionPartsData.cessionnaire.representantLegal}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            cessionnaire: {...cessionPartsData.cessionnaire, representantLegal: e.target.value}
                          })}
                          placeholder="Nom et pr√©nom du repr√©sentant"
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label className="text-red-600 font-semibold">üìÑ Extrait Kbis (obligatoire)</Label>
                        <MultiFileUpload
                          files={cessionCessionnaireKbisFiles}
                          onFilesChange={setCessionCessionnaireKbisFiles}
                          accept=".pdf"
                          label="Joindre Kbis de moins de 3 mois"
                        />
                      </div>
                    </div>
                  )}
                </div>

                {/* Section 5 : Objet de la cession */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Objet de la cession</h3>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2 md:col-span-2">
                      <Label>Nature exacte des titres selon la forme sociale <span className="text-red-500">*</span></Label>
                      <Select
                        value={cessionPartsData.objetCession.natureTitres}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          objetCession: {...cessionPartsData.objetCession, natureTitres: value}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="parts_sociales">Parts sociales (SARL / SNC / SCI)</SelectItem>
                          <SelectItem value="actions">Actions (SAS / SA)</SelectItem>
                        </SelectContent>
                      </Select>
                      <p className="text-xs text-amber-700">‚ö†Ô∏è Qualification juridique essentielle</p>
                    </div>

                    <div className="space-y-2 md:col-span-2">
                      <Label>Type de droits c√©d√©s <span className="text-red-500">*</span></Label>
                      <Select
                        value={cessionPartsData.objetCession.typeDroits}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          objetCession: {...cessionPartsData.objetCession, typeDroits: value}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="parts_sociales">Parts sociales</SelectItem>
                          <SelectItem value="actions">Actions (SAS)</SelectItem>
                          <SelectItem value="droits_indivis">Droits indivis sur parts</SelectItem>
                          <SelectItem value="compte_courant">Compte courant d'associ√© (cr√©ance)</SelectItem>
                          <SelectItem value="cession_reprise_dette">Cession + reprise de dette √©ventuelle</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="space-y-2">
                      <Label>Nombre de parts c√©d√©es <span className="text-red-500">*</span></Label>
                      <Input
                        type="number"
                        value={cessionPartsData.objetCession.nombreParts}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          objetCession: {...cessionPartsData.objetCession, nombreParts: e.target.value}
                        })}
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Pourcentage du capital <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.objetCession.pourcentageCapital}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          objetCession: {...cessionPartsData.objetCession, pourcentageCapital: e.target.value}
                        })}
                        placeholder="Ex: 25%"
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Valeur nominale <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.objetCession.valeurNominale}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          objetCession: {...cessionPartsData.objetCession, valeurNominale: e.target.value}
                        })}
                        placeholder="Valeur nominale par part"
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Prix total de cession <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.objetCession.prixTotal}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          objetCession: {...cessionPartsData.objetCession, prixTotal: e.target.value}
                        })}
                        placeholder="Montant total en ‚Ç¨"
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Prix unitaire par part</Label>
                      <Input
                        value={cessionPartsData.objetCession.prixUnitaire}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          objetCession: {...cessionPartsData.objetCession, prixUnitaire: e.target.value}
                        })}
                        placeholder="Prix par part"
                      />
                    </div>

                    <div className="space-y-2 md:col-span-2">
                      <Label>Mode de calcul du prix <span className="text-red-500">*</span></Label>
                      <Select
                        value={cessionPartsData.objetCession.modeCalcul}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          objetCession: {...cessionPartsData.objetCession, modeCalcul: value}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="valeur_marche">Valeur de march√©</SelectItem>
                          <SelectItem value="valeur_comptable">Valeur comptable</SelectItem>
                          <SelectItem value="clause_statutaire">Clause statutaire</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="space-y-2 md:col-span-2">
                      <Label>Modalit√©s de paiement <span className="text-red-500">*</span></Label>
                      <Select
                        value={cessionPartsData.objetCession.modalitePaiement}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          objetCession: {...cessionPartsData.objetCession, modalitePaiement: value}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="comptant">Comptant</SelectItem>
                          <SelectItem value="echelonne">√âchelonn√©</SelectItem>
                          <SelectItem value="differe">Paiement diff√©r√©</SelectItem>
                          <SelectItem value="conditionnel">Paiement conditionnel</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="space-y-2 md:col-span-2">
                      <Label>RIB du c√©dant <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.objetCession.ribCedant}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          objetCession: {...cessionPartsData.objetCession, ribCedant: e.target.value}
                        })}
                        placeholder="IBAN"
                      />
                    </div>
                  </div>

                  {/* Date d'effet de la cession */}
                  <div className="bg-white p-4 rounded-lg border border-yellow-300 space-y-3">
                    <h4 className="font-semibold text-yellow-800">Date d'effet de la cession (cl√© fiscale & sociale)</h4>
                    
                    <div className="space-y-2">
                      <Label>Date d'effet <span className="text-red-500">*</span></Label>
                      <Select
                        value={cessionPartsData.objetCession.dateEffetCession}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          objetCession: {...cessionPartsData.objetCession, dateEffetCession: value}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="date_signature">√Ä la date de signature</SelectItem>
                          <SelectItem value="date_differee">√Ä une date diff√©r√©e</SelectItem>
                        </SelectContent>
                      </Select>
                      <p className="text-xs text-yellow-700">
                        ‚û°Ô∏è Impact : droits de vote, dividendes, plus-value, responsabilit√©
                      </p>
                    </div>

                    {cessionPartsData.objetCession.dateEffetCession === "date_differee" && (
                      <div className="space-y-2">
                        <Label>Date diff√©r√©e pr√©cise <span className="text-red-500">*</span></Label>
                        <Input
                          type="date"
                          value={cessionPartsData.objetCession.dateEffetDifferee}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            objetCession: {...cessionPartsData.objetCession, dateEffetDifferee: e.target.value}
                          })}
                        />
                      </div>
                    )}
                  </div>

                  {/* Clause de non-garantie de passif */}
                  <div className="bg-white p-4 rounded-lg border border-yellow-300 space-y-3">
                    <h4 className="font-semibold text-yellow-800">Garantie de passif</h4>
                    
                    <div className="space-y-2">
                      <Label>La cession est-elle consentie sans garantie de passif ?</Label>
                      <Select
                        value={cessionPartsData.objetCession.sansGarantiePassif ? "oui" : "non"}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          objetCession: {...cessionPartsData.objetCession, sansGarantiePassif: value === "oui"}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="non">Non (avec garantie de passif)</SelectItem>
                          <SelectItem value="oui">Oui (sans garantie de passif)</SelectItem>
                        </SelectContent>
                      </Select>
                      <p className="text-xs text-yellow-700">
                        ‚ö†Ô∏è Sans cette pr√©cision ‚Üí zone grise interpr√©tative
                      </p>
                    </div>
                  </div>

                  {/* Conditions suspensives */}
                  <div className="bg-white p-4 rounded-lg border border-yellow-300 space-y-3">
                    <h4 className="font-semibold text-yellow-800">Conditions suspensives</h4>
                    
                    <div className="space-y-2">
                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={cessionPartsData.objetCession.agrement}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            objetCession: {...cessionPartsData.objetCession, agrement: e.target.checked}
                          })}
                        />
                        <span>Agr√©ment par les associ√©s</span>
                      </label>

                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={cessionPartsData.objetCession.approbationConjoint}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            objetCession: {...cessionPartsData.objetCession, approbationConjoint: e.target.checked}
                          })}
                        />
                        <span>Approbation du conjoint (si bien commun)</span>
                      </label>

                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={cessionPartsData.objetCession.financementBancaire}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            objetCession: {...cessionPartsData.objetCession, financementBancaire: e.target.checked}
                          })}
                        />
                        <span>Financement bancaire</span>
                      </label>

                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={cessionPartsData.objetCession.leveeNantissement}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            objetCession: {...cessionPartsData.objetCession, leveeNantissement: e.target.checked}
                          })}
                        />
                        <span>Lev√©e d'un nantissement sur parts</span>
                      </label>
                    </div>
                  </div>
                </div>

                {/* Section 6 : Agr√©ment (SARL & SCI) */}
                {(cessionPartsData.typeSociete === "sarl" || cessionPartsData.typeSociete === "sci") && (
                  <div>
                    <h3 className="font-semibold text-lg border-b pb-2 mb-4">Agr√©ment (obligatoire pour SARL & SCI)</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2 md:col-span-2">
                        <Label>Organe comp√©tent pour l'agr√©ment <span className="text-red-500">*</span></Label>
                        <Select
                          value={cessionPartsData.agrement.organeCompetent}
                          onValueChange={(value) => setCessionPartsData({
                            ...cessionPartsData,
                            agrement: {...cessionPartsData.agrement, organeCompetent: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="assemblee_generale">Assembl√©e g√©n√©rale</SelectItem>
                            <SelectItem value="gerant_president">G√©rant / Pr√©sident</SelectItem>
                            <SelectItem value="autre">Autre (selon statuts)</SelectItem>
                          </SelectContent>
                        </Select>
                        <p className="text-xs text-red-700">‚ö†Ô∏è Le greffe peut refuser l'acte sans cette pr√©cision</p>
                      </div>

                      <div className="space-y-2">
                        <Label>Date de la d√©cision d'agr√©ment</Label>
                        <Input
                          type="date"
                          value={cessionPartsData.agrement.dateDecisionAgrement}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            agrement: {...cessionPartsData.agrement, dateDecisionAgrement: e.target.value}
                          })}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Mode de vote et majorit√©</Label>
                        <Input
                          value={cessionPartsData.agrement.modeVoteMajorite}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            agrement: {...cessionPartsData.agrement, modeVoteMajorite: e.target.value}
                          })}
                          placeholder="Ex: 2/3 des voix pr√©sentes"
                        />
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label>Proc√©dure d'agr√©ment</Label>
                        <Textarea
                          value={cessionPartsData.agrement.procedureAgrement}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            agrement: {...cessionPartsData.agrement, procedureAgrement: e.target.value}
                          })}
                          placeholder="D√©crire la proc√©dure suivie"
                          rows={2}
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Convocation des associ√©s</Label>
                        <Select
                          value={cessionPartsData.agrement.convocationAssocies ? "oui" : "non"}
                          onValueChange={(value) => setCessionPartsData({
                            ...cessionPartsData,
                            agrement: {...cessionPartsData.agrement, convocationAssocies: value === "oui"}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="non">Non</SelectItem>
                            <SelectItem value="oui">Oui</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="space-y-2">
                        <Label>Vote effectu√©</Label>
                        <Select
                          value={cessionPartsData.agrement.voteEffectue ? "oui" : "non"}
                          onValueChange={(value) => setCessionPartsData({
                            ...cessionPartsData,
                            agrement: {...cessionPartsData.agrement, voteEffectue: value === "oui"}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="non">Non</SelectItem>
                            <SelectItem value="oui">Oui</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="space-y-2">
                        <Label>Majorit√© requise</Label>
                        <Input
                          value={cessionPartsData.agrement.majoriteRequise}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            agrement: {...cessionPartsData.agrement, majoriteRequise: e.target.value}
                          })}
                          placeholder="Ex: 2/3, majorit√© simple..."
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Statut de la notification</Label>
                        <Select
                          value={cessionPartsData.agrement.notificationStatut}
                          onValueChange={(value) => setCessionPartsData({
                            ...cessionPartsData,
                            agrement: {...cessionPartsData.agrement, notificationStatut: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="acceptation">Acceptation</SelectItem>
                            <SelectItem value="refus">Refus</SelectItem>
                            <SelectItem value="en_attente">En attente</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="space-y-2">
                        <Label>D√©lai l√©gal respect√©</Label>
                        <Select
                          value={cessionPartsData.agrement.delaiLegalRespecte ? "oui" : "non"}
                          onValueChange={(value) => setCessionPartsData({
                            ...cessionPartsData,
                            agrement: {...cessionPartsData.agrement, delaiLegalRespecte: value === "oui"}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="non">Non</SelectItem>
                            <SelectItem value="oui">Oui</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>

                      <div className="space-y-2 md:col-span-2">
                        <Label className="text-red-600 font-semibold">üìÑ Proc√®s-verbal d'assembl√©e g√©n√©rale</Label>
                        <MultiFileUpload
                          files={cessionPVAgrementFiles}
                          onFilesChange={setCessionPVAgrementFiles}
                          accept=".pdf,.doc,.docx"
                          label="Joindre le PV d'agr√©ment"
                        />
                      </div>
                    </div>
                  </div>
                )}

                {/* Section 7 : Compte courant d'associ√© */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Compte courant d'associ√© / Dettes li√©es</h3>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-3 md:col-span-2">
                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={cessionPartsData.compteCourant.cessionCCA}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            compteCourant: {...cessionPartsData.compteCourant, cessionCCA: e.target.checked}
                          })}
                        />
                        <span>Cession du compte courant d'associ√© au cessionnaire</span>
                      </label>

                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={cessionPartsData.compteCourant.maintienCCA}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            compteCourant: {...cessionPartsData.compteCourant, maintienCCA: e.target.checked}
                          })}
                        />
                        <span>Maintien du compte courant au c√©dant</span>
                      </label>

                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={cessionPartsData.compteCourant.remboursementImmediat}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            compteCourant: {...cessionPartsData.compteCourant, remboursementImmediat: e.target.checked}
                          })}
                        />
                        <span>Remboursement imm√©diat du compte courant</span>
                      </label>

                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={cessionPartsData.compteCourant.remboursementEchelonne}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            compteCourant: {...cessionPartsData.compteCourant, remboursementEchelonne: e.target.checked}
                          })}
                        />
                        <span>Remboursement √©chelonn√©</span>
                      </label>

                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={cessionPartsData.compteCourant.compensationPrix}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            compteCourant: {...cessionPartsData.compteCourant, compensationPrix: e.target.checked}
                          })}
                        />
                        <span>Compensation entre prix de cession et dette CCA</span>
                      </label>

                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={cessionPartsData.compteCourant.garantieSolde}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            compteCourant: {...cessionPartsData.compteCourant, garantieSolde: e.target.checked}
                          })}
                        />
                        <span>Garantie du solde du compte courant</span>
                      </label>
                    </div>

                    <div className="space-y-2 md:col-span-2">
                      <Label>Montant exact du solde CCA</Label>
                      <Input
                        value={cessionPartsData.compteCourant.montantSoldeCCA}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          compteCourant: {...cessionPartsData.compteCourant, montantSoldeCCA: e.target.value}
                        })}
                        placeholder="Montant en ‚Ç¨"
                      />
                    </div>

                    <div className="space-y-2 md:col-span-2">
                      <Label className="font-semibold">üìÑ Preuves comptables (justificatif CCA)</Label>
                      <MultiFileUpload
                        files={cessionCCAFiles}
                        onFilesChange={setCessionCCAFiles}
                        accept=".pdf,.xlsx,.xls"
                        label="Joindre les justificatifs du compte courant"
                      />
                    </div>

                    <div className="space-y-2 md:col-span-2">
                      <Label>Dette envers un tiers ?</Label>
                      <Select
                        value={cessionPartsData.compteCourant.detteVersTiers ? "oui" : "non"}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          compteCourant: {...cessionPartsData.compteCourant, detteVersTiers: value === "oui"}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="non">Non</SelectItem>
                          <SelectItem value="oui">Oui</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    {cessionPartsData.compteCourant.detteVersTiers && (
                      <>
                        <div className="space-y-2">
                          <Label>Nature de la dette</Label>
                          <Input
                            value={cessionPartsData.compteCourant.natureDetteTiers}
                            onChange={(e) => setCessionPartsData({
                              ...cessionPartsData,
                              compteCourant: {...cessionPartsData.compteCourant, natureDetteTiers: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Montant de la dette</Label>
                          <Input
                            value={cessionPartsData.compteCourant.montantDetteTiers}
                            onChange={(e) => setCessionPartsData({
                              ...cessionPartsData,
                              compteCourant: {...cessionPartsData.compteCourant, montantDetteTiers: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Cr√©ancier</Label>
                          <Input
                            value={cessionPartsData.compteCourant.creancierTiers}
                            onChange={(e) => setCessionPartsData({
                              ...cessionPartsData,
                              compteCourant: {...cessionPartsData.compteCourant, creancierTiers: e.target.value}
                            })}
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Acceptation par le cr√©ancier</Label>
                          <Select
                            value={cessionPartsData.compteCourant.acceptationCreancier ? "oui" : "non"}
                            onValueChange={(value) => setCessionPartsData({
                              ...cessionPartsData,
                              compteCourant: {...cessionPartsData.compteCourant, acceptationCreancier: value === "oui"}
                            })}
                          >
                            <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="non">Non</SelectItem>
                              <SelectItem value="oui">Oui</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                      </>
                    )}
                  </div>
                </div>

                {/* Section 8 : Garanties donn√©es par le c√©dant */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Garanties donn√©es par le c√©dant</h3>

                  <div className="space-y-4">
                    <div className="bg-white p-4 rounded-lg border border-pink-300 space-y-3">
                      <h4 className="font-semibold text-pink-800">Garanties classiques</h4>
                      
                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={cessionPartsData.garanties.garantieEviction}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            garanties: {...cessionPartsData.garanties, garantieEviction: e.target.checked}
                          })}
                        />
                        <span>Garantie d'√©viction</span>
                      </label>

                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={cessionPartsData.garanties.garantiePropriete}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            garanties: {...cessionPartsData.garanties, garantiePropriete: e.target.checked}
                          })}
                        />
                        <span>Garantie de propri√©t√© des parts</span>
                      </label>

                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={cessionPartsData.garanties.garantieActifNet}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            garanties: {...cessionPartsData.garanties, garantieActifNet: e.target.checked}
                          })}
                        />
                        <span>Garantie d'actif net</span>
                      </label>

                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={cessionPartsData.garanties.absenceNantissement}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            garanties: {...cessionPartsData.garanties, absenceNantissement: e.target.checked}
                          })}
                        />
                        <span>Absence de nantissement des parts</span>
                      </label>

                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={cessionPartsData.garanties.absenceLitiges}
                          onChange={(e) => setCessionPartsData({
                            ...cessionPartsData,
                            garanties: {...cessionPartsData.garanties, absenceLitiges: e.target.checked}
                          })}
                        />
                        <span>Absence de litiges en cours</span>
                      </label>

                      <div className="space-y-2">
                        <Label>Garantie de passif</Label>
                        <Select
                          value={cessionPartsData.garanties.garantiePassif}
                          onValueChange={(value) => setCessionPartsData({
                            ...cessionPartsData,
                            garanties: {...cessionPartsData.garanties, garantiePassif: value}
                          })}
                        >
                          <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="aucune">Aucune</SelectItem>
                            <SelectItem value="limitee">Limit√©e</SelectItem>
                            <SelectItem value="generale">G√©n√©rale</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                    </div>

                    <div className="bg-white p-4 rounded-lg border border-pink-300 space-y-4">
                      <h4 className="font-semibold text-pink-800">Garanties renforc√©es (optionnelles)</h4>
                      
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-2">
                          <Label>Plafond de garantie</Label>
                          <Input
                            value={cessionPartsData.garanties.plafondGarantie}
                            onChange={(e) => setCessionPartsData({
                              ...cessionPartsData,
                              garanties: {...cessionPartsData.garanties, plafondGarantie: e.target.value}
                            })}
                            placeholder="Montant maximum"
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Dur√©e de garantie</Label>
                          <Input
                            value={cessionPartsData.garanties.dureeGarantie}
                            onChange={(e) => setCessionPartsData({
                              ...cessionPartsData,
                              garanties: {...cessionPartsData.garanties, dureeGarantie: e.target.value}
                            })}
                            placeholder="Ex: 2 ans, 5 ans..."
                          />
                        </div>

                        <div className="space-y-2 md:col-span-2">
                          <Label>Exclusions</Label>
                          <Textarea
                            value={cessionPartsData.garanties.exclusions}
                            onChange={(e) => setCessionPartsData({
                              ...cessionPartsData,
                              garanties: {...cessionPartsData.garanties, exclusions: e.target.value}
                            })}
                            placeholder="√âl√©ments exclus de la garantie"
                            rows={2}
                          />
                        </div>

                        <div className="space-y-2 md:col-span-2">
                          <Label>Proc√©dure de mise en jeu de la garantie</Label>
                          <Textarea
                            value={cessionPartsData.garanties.procedureMiseEnJeu}
                            onChange={(e) => setCessionPartsData({
                              ...cessionPartsData,
                              garanties: {...cessionPartsData.garanties, procedureMiseEnJeu: e.target.value}
                            })}
                            placeholder="D√©crire la proc√©dure"
                            rows={2}
                          />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Section 9 : Droit du conjoint */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Droit du conjoint (si r√©gime matrimonial = communaut√©)</h3>

                  <div className="bg-amber-100 border border-amber-300 p-4 rounded-lg">
                    <p className="text-sm font-semibold text-amber-900">
                      ‚ö†Ô∏è Obligatoire si les parts sont des biens communs. Sinon l'acte est NUL.
                    </p>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2 md:col-span-2">
                      <Label>Identit√© du conjoint</Label>
                      <Input
                        value={cessionPartsData.conjoint.identiteConjoint}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          conjoint: {...cessionPartsData.conjoint, identiteConjoint: e.target.value}
                        })}
                        placeholder="Nom et pr√©nom du conjoint"
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Acceptation de la cession</Label>
                      <Select
                        value={cessionPartsData.conjoint.acceptationCession ? "oui" : "non"}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          conjoint: {...cessionPartsData.conjoint, acceptationCession: value === "oui"}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="non">Non</SelectItem>
                          <SelectItem value="oui">Oui</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="space-y-2">
                      <Label>Renonciation √† la cession</Label>
                      <Select
                        value={cessionPartsData.conjoint.renonciationCession ? "oui" : "non"}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          conjoint: {...cessionPartsData.conjoint, renonciationCession: value === "oui"}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="non">Non</SelectItem>
                          <SelectItem value="oui">Oui</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="space-y-2">
                      <Label>Signature obligatoire du conjoint</Label>
                      <Select
                        value={cessionPartsData.conjoint.signatureObligatoire ? "oui" : "non"}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          conjoint: {...cessionPartsData.conjoint, signatureObligatoire: value === "oui"}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="non">Non</SelectItem>
                          <SelectItem value="oui">Oui (requis)</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="space-y-2">
                      <Label>R√©gime matrimonial pr√©cis√©</Label>
                      <Input
                        value={cessionPartsData.conjoint.regimeMatrimonialPrecise}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          conjoint: {...cessionPartsData.conjoint, regimeMatrimonialPrecise: e.target.value}
                        })}
                        placeholder="Communaut√©, s√©paration..."
                      />
                    </div>
                  </div>
                </div>

                {/* Section 10 : Droits d'enregistrement */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Droits d'enregistrement (fiscal - obligatoire)</h3>

                  <div className="bg-amber-100 border border-amber-300 p-4 rounded-lg">
                    <p className="text-sm font-semibold text-amber-900">
                      ‚ö†Ô∏è Indispensable pour la validit√© fiscale
                    </p>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Taux applicable <span className="text-red-500">*</span></Label>
                      <Select
                        value={cessionPartsData.droitsEnregistrement.tauxApplicable}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          droitsEnregistrement: {...cessionPartsData.droitsEnregistrement, tauxApplicable: value}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="3_pourcent">3 % apr√®s abattement (parts sociales)</SelectItem>
                          <SelectItem value="0_1_pourcent">0,1 % (actions)</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    <div className="space-y-2">
                      <Label>Charge des droits <span className="text-red-500">*</span></Label>
                      <Select
                        value={cessionPartsData.droitsEnregistrement.chargeDroits}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          droitsEnregistrement: {...cessionPartsData.droitsEnregistrement, chargeDroits: value}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="cessionnaire">Cessionnaire (acheteur)</SelectItem>
                          <SelectItem value="cedant">C√©dant (vendeur)</SelectItem>
                          <SelectItem value="autre">Autre (moiti√©-moiti√© ou convention)</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>
                </div>

                {/* Section 11 : Clause de non-concurrence */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Clause de non-concurrence</h3>

                  <div className="space-y-4">
                    <div className="space-y-2">
                      <Label>Clause de non-concurrence</Label>
                      <Select
                        value={cessionPartsData.nonConcurrence.clauseNonConcurrence ? "oui" : "non"}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          nonConcurrence: {...cessionPartsData.nonConcurrence, clauseNonConcurrence: value === "oui"}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="non">Non</SelectItem>
                          <SelectItem value="oui">Oui</SelectItem>
                        </SelectContent>
                      </Select>
                      <p className="text-xs text-violet-700">
                        Pas obligatoire l√©galement, mais attendue en pratique
                      </p>
                    </div>

                    {cessionPartsData.nonConcurrence.clauseNonConcurrence && (
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-white border border-violet-300 rounded-lg">
                        <div className="space-y-2">
                          <Label>Dur√©e</Label>
                          <Input
                            value={cessionPartsData.nonConcurrence.dureeNonConcurrence}
                            onChange={(e) => setCessionPartsData({
                              ...cessionPartsData,
                              nonConcurrence: {...cessionPartsData.nonConcurrence, dureeNonConcurrence: e.target.value}
                            })}
                            placeholder="Ex: 2 ans, 5 ans..."
                          />
                        </div>

                        <div className="space-y-2">
                          <Label>Zone g√©ographique</Label>
                          <Input
                            value={cessionPartsData.nonConcurrence.zoneGeographique}
                            onChange={(e) => setCessionPartsData({
                              ...cessionPartsData,
                              nonConcurrence: {...cessionPartsData.nonConcurrence, zoneGeographique: e.target.value}
                            })}
                            placeholder="Ex: France, √éle-de-France..."
                          />
                        </div>

                        <div className="space-y-2 md:col-span-2">
                          <Label>Activit√© interdite</Label>
                          <Textarea
                            value={cessionPartsData.nonConcurrence.activiteInterdite}
                            onChange={(e) => setCessionPartsData({
                              ...cessionPartsData,
                              nonConcurrence: {...cessionPartsData.nonConcurrence, activiteInterdite: e.target.value}
                            })}
                            placeholder="D√©crire l'activit√© interdite"
                            rows={2}
                          />
                        </div>
                      </div>
                    )}
                  </div>
                </div>

                {/* Section 12 : Notification √† la soci√©t√© */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Information de la soci√©t√© (formalisme interne)</h3>

                  <div className="bg-amber-100 border border-amber-300 p-4 rounded-lg">
                    <p className="text-sm font-semibold text-amber-900">
                      ‚ö†Ô∏è Article 1690 du Code civil / pratique soci√©taire
                    </p>
                  </div>

                  <div className="space-y-2">
                    <Label>Notification de la cession √† la soci√©t√© <span className="text-red-500">*</span></Label>
                    <Select
                      value={cessionPartsData.notificationSociete.modeNotification}
                      onValueChange={(value) => setCessionPartsData({
                        ...cessionPartsData,
                        notificationSociete: {...cessionPartsData.notificationSociete, modeNotification: value}
                      })}
                    >
                      <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                      <SelectContent>
                        <SelectItem value="signification_huissier">Signification par huissier</SelectItem>
                        <SelectItem value="acceptation_acte">Acceptation dans l'acte</SelectItem>
                      </SelectContent>
                    </Select>
                  </div>
                </div>

                {/* Section 13 : D√©clarations l√©gales obligatoires */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">D√©clarations l√©gales obligatoires</h3>

                  <div className="space-y-3">
                    <label className="flex items-center gap-2">
                      <input
                        type="checkbox"
                        checked={cessionPartsData.declarationsLegales.consentementLibre}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          declarationsLegales: {...cessionPartsData.declarationsLegales, consentementLibre: e.target.checked}
                        })}
                      />
                      <span>Consentement libre et √©clair√©</span>
                    </label>

                    <label className="flex items-center gap-2">
                      <input
                        type="checkbox"
                        checked={cessionPartsData.declarationsLegales.origineLiciteFonds}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          declarationsLegales: {...cessionPartsData.declarationsLegales, origineLiciteFonds: e.target.checked}
                        })}
                      />
                      <span>Origine licite des fonds</span>
                    </label>

                    <label className="flex items-center gap-2">
                      <input
                        type="checkbox"
                        checked={cessionPartsData.declarationsLegales.absenceFraude}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          declarationsLegales: {...cessionPartsData.declarationsLegales, absenceFraude: e.target.checked}
                        })}
                      />
                      <span>Absence de fraude ou simulation</span>
                    </label>

                    <label className="flex items-center gap-2">
                      <input
                        type="checkbox"
                        checked={cessionPartsData.declarationsLegales.acceptationPrix}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          declarationsLegales: {...cessionPartsData.declarationsLegales, acceptationPrix: e.target.checked}
                        })}
                      />
                      <span>Acceptation du prix</span>
                    </label>

                    <label className="flex items-center gap-2">
                      <input
                        type="checkbox"
                        checked={cessionPartsData.declarationsLegales.transfertProprieteDateSignature}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          declarationsLegales: {...cessionPartsData.declarationsLegales, transfertProprieteDateSignature: e.target.checked}
                        })}
                      />
                      <span>Transfert de propri√©t√© √† la date de signature</span>
                    </label>

                    <label className="flex items-center gap-2">
                      <input
                        type="checkbox"
                        checked={cessionPartsData.declarationsLegales.mentionStatutsMisAJour}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          declarationsLegales: {...cessionPartsData.declarationsLegales, mentionStatutsMisAJour: e.target.checked}
                        })}
                      />
                      <span>Mention des statuts mis √† jour</span>
                    </label>

                    <label className="flex items-center gap-2">
                      <input
                        type="checkbox"
                        checked={cessionPartsData.declarationsLegales.mentionImpositionFiscale}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          declarationsLegales: {...cessionPartsData.declarationsLegales, mentionImpositionFiscale: e.target.checked}
                        })}
                      />
                      <span>Mention d'imposition fiscale potentielle (plus-value)</span>
                    </label>

                    <label className="flex items-center gap-2">
                      <input
                        type="checkbox"
                        checked={cessionPartsData.declarationsLegales.renonciationDroitPreemption}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          declarationsLegales: {...cessionPartsData.declarationsLegales, renonciationDroitPreemption: e.target.checked}
                        })}
                      />
                      <span>Renonciation √©ventuelle au droit de pr√©emption d'autres associ√©s</span>
                    </label>
                  </div>
                </div>

                {/* Section 14 : Mise √† jour statuts et formalit√©s */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Mise √† jour des statuts et formalit√©s</h3>
                  <div className="space-y-3">
                    <label className="flex items-center gap-2">
                      <input
                        type="checkbox"
                        checked={cessionPartsData.formalites.modificationCapital}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          formalites: {...cessionPartsData.formalites, modificationCapital: e.target.checked}
                        })}
                      />
                      <span>Modification de la r√©partition du capital</span>
                    </label>

                    <label className="flex items-center gap-2">
                      <input
                        type="checkbox"
                        checked={cessionPartsData.formalites.miseAJourRegistreMouvements}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          formalites: {...cessionPartsData.formalites, miseAJourRegistreMouvements: e.target.checked}
                        })}
                      />
                      <span>Mise √† jour du registre des mouvements de titres</span>
                    </label>

                    <label className="flex items-center gap-2">
                      <input
                        type="checkbox"
                        checked={cessionPartsData.formalites.miseAJourRegistreAssocies}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          formalites: {...cessionPartsData.formalites, miseAJourRegistreAssocies: e.target.checked}
                        })}
                      />
                      <span>Mise √† jour du registre des associ√©s</span>
                    </label>

                    <label className="flex items-center gap-2">
                      <input
                        type="checkbox"
                        checked={cessionPartsData.formalites.depotGreffe}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          formalites: {...cessionPartsData.formalites, depotGreffe: e.target.checked}
                        })}
                      />
                      <span>D√©p√¥t au greffe (si applicable)</span>
                    </label>

                    <label className="flex items-center gap-2">
                      <input
                        type="checkbox"
                        checked={cessionPartsData.formalites.publicationLegale}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          formalites: {...cessionPartsData.formalites, publicationLegale: e.target.checked}
                        })}
                      />
                      <span>Publication l√©gale (si obligation)</span>
                    </label>

                    <label className="flex items-center gap-2">
                      <input
                        type="checkbox"
                        checked={cessionPartsData.formalites.informationBanques}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          formalites: {...cessionPartsData.formalites, informationBanques: e.target.checked}
                        })}
                      />
                      <span>Information des banques / partenaires</span>
                    </label>
                  </div>
                </div>

                {/* Section 15 : Signatures */}
                <div>
                  <h3 className="font-semibold text-lg border-b pb-2 mb-4">Signatures et formalit√©s finales</h3>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label>Date de signature <span className="text-red-500">*</span></Label>
                      <Input
                        type="date"
                        value={cessionPartsData.signatures.dateSignature}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          signatures: {...cessionPartsData.signatures, dateSignature: e.target.value}
                        })}
                      />
                    </div>

                    <div className="space-y-2">
                      <Label>Lieu de signature <span className="text-red-500">*</span></Label>
                      <Input
                        value={cessionPartsData.signatures.lieuSignature}
                        onChange={(e) => setCessionPartsData({
                          ...cessionPartsData,
                          signatures: {...cessionPartsData.signatures, lieuSignature: e.target.value}
                        })}
                        placeholder="Ville de signature"
                      />
                    </div>

                    <div className="space-y-2 md:col-span-2">
                      <Label>Signature du notaire</Label>
                      <Select
                        value={cessionPartsData.signatures.signatureNotaire ? "oui" : "non"}
                        onValueChange={(value) => setCessionPartsData({
                          ...cessionPartsData,
                          signatures: {...cessionPartsData.signatures, signatureNotaire: value === "oui"}
                        })}
                      >
                        <SelectTrigger><SelectValue placeholder="S√©lectionner" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="non">Non (acte sous seing priv√©)</SelectItem>
                          <SelectItem value="oui">Oui (acte authentique)</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>

                    {cessionPartsData.signatures.signatureNotaire && (
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 md:col-span-2 p-4 bg-amber-50 border border-amber-200 rounded-lg">
                        <div className="space-y-2">
                          <Label>Nom du notaire <span className="text-red-600">*</span></Label>
                          <Input
                            value={cessionPartsData.signatures.nomNotaire}
                            onChange={(e) => setCessionPartsData({
                              ...cessionPartsData,
                              signatures: {...cessionPartsData.signatures, nomNotaire: e.target.value}
                            })}
                            placeholder="Nom complet"
                          />
                        </div>
                        <div className="space-y-2">
                          <Label>Ville du notaire <span className="text-red-600">*</span></Label>
                          <Input
                            value={cessionPartsData.signatures.villeNotaire}
                            onChange={(e) => setCessionPartsData({
                              ...cessionPartsData,
                              signatures: {...cessionPartsData.signatures, villeNotaire: e.target.value}
                            })}
                            placeholder="Ville de l'√©tude"
                          />
                        </div>
                      </div>
                    )}
                  </div>

                  {/* Pi√®ces justificatives (tous les uploads) */}
                  <div className="space-y-4 mt-6">
                    <h4 className="font-semibold text-lime-800 text-base border-b pb-2">
                      üìé Pi√®ces justificatives √† fournir
                    </h4>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="space-y-2">
                        <Label>Kbis de la soci√©t√©</Label>
                        <MultiFileUpload
                          files={cessionKbisFiles}
                          onFilesChange={setCessionKbisFiles}
                          accept=".pdf"
                          label="Joindre Kbis"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Comptes annuels</Label>
                        <MultiFileUpload
                          files={cessionComptesFiles}
                          onFilesChange={setCessionComptesFiles}
                          accept=".pdf,.xlsx,.xls"
                          label="Joindre comptes"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Registre des associ√©s</Label>
                        <MultiFileUpload
                          files={cessionRegistreFiles}
                          onFilesChange={setCessionRegistreFiles}
                          accept=".pdf"
                          label="Joindre registre"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Pacte d'associ√©s (si existant)</Label>
                        <MultiFileUpload
                          files={cessionPacteFiles}
                          onFilesChange={setCessionPacteFiles}
                          accept=".pdf"
                          label="Joindre pacte"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Pi√®ce d'identit√© c√©dant</Label>
                        <MultiFileUpload
                          files={cessionCedantIdFiles}
                          onFilesChange={setCessionCedantIdFiles}
                          accept=".pdf,.jpg,.jpeg,.png"
                          label="Joindre ID c√©dant"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Contrat de mariage (si applicable)</Label>
                        <MultiFileUpload
                          files={cessionCedantMariageFiles}
                          onFilesChange={setCessionCedantMariageFiles}
                          accept=".pdf"
                          label="Joindre contrat mariage"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Expertise des parts (si existante)</Label>
                        <MultiFileUpload
                          files={cessionExpertiseFiles}
                          onFilesChange={setCessionExpertiseFiles}
                          accept=".pdf"
                          label="Joindre expertise"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Pi√®ce d'identit√© cessionnaire</Label>
                        <MultiFileUpload
                          files={cessionCessionnaireIdFiles}
                          onFilesChange={setCessionCessionnaireIdFiles}
                          accept=".pdf,.jpg,.jpeg,.png"
                          label="Joindre ID cessionnaire"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Justificatif de domicile cessionnaire</Label>
                        <MultiFileUpload
                          files={cessionCessionnaireDomicileFiles}
                          onFilesChange={setCessionCessionnaireDomicileFiles}
                          accept=".pdf,.jpg,.jpeg,.png"
                          label="Joindre justif domicile"
                        />
                      </div>

                      <div className="space-y-2">
                        <Label>Justificatif origine des fonds (anti-blanchiment)</Label>
                        <MultiFileUpload
                          files={cessionOrigineFondsFiles}
                          onFilesChange={setCessionOrigineFondsFiles}
                          accept=".pdf"
                          label="Joindre justificatifs"
                        />
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            )}

            {/* Formulaire complet pour Contrat de prestation de services */}
            {pendingContractType === "Contrat de prestation de services" && (
              <div className="space-y-6">
                <h3 className="font-semibold text-xl border-b-2 border-blue-300 pb-2 text-blue-700">üìù Contrat de prestation de services</h3>
                
                {/* 1. IDENTIFICATION DES PARTIES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£ Identification des parties</h4>
                  
                  {/* PRESTATAIRE */}
                  <div className="space-y-3 p-3 bg-white rounded border border-blue-100">
                    <h5 className="font-medium text-blue-600">üë§ Prestataire (fournis le service)</h5>
                    <ClientSelector clients={clients} selectedClientId={prestationPrestataireClientId} onClientChange={(id) => {
                      setPrestationPrestataireClientId(id);
                      const client = clients.find(c => c.id === id);
                      if (client) {
                        setPrestationData(prev => ({
                          ...prev,
                          prestataireDenomination: `${client.prenom} ${client.nom}`,
                          prestataireEmail: client.email || "",
                          prestataireTelephone: client.telephone || "",
                        }));
                      }
                    }} label="S√©lectionner le prestataire depuis vos clients" />
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3 mt-3">
                      <div><Label>D√©nomination / Nom *</Label><Input value={prestationData.prestataireDenomination} onChange={(e) => setPrestationData({...prestationData, prestataireDenomination: e.target.value})} /></div>
                      <div><Label>Forme juridique</Label><Select value={prestationData.prestataireFormeJuridique} onValueChange={(v) => setPrestationData({...prestationData, prestataireFormeJuridique: v})}><SelectTrigger><SelectValue placeholder="Choisir" /></SelectTrigger><SelectContent><SelectItem value="SARL">SARL</SelectItem><SelectItem value="SAS">SAS</SelectItem><SelectItem value="SASU">SASU</SelectItem><SelectItem value="EURL">EURL</SelectItem><SelectItem value="auto-entrepreneur">Auto-entrepreneur</SelectItem><SelectItem value="EI">Entreprise Individuelle</SelectItem><SelectItem value="association">Association</SelectItem><SelectItem value="particulier">Particulier</SelectItem></SelectContent></Select></div>
                      <div><Label>RCS / SIREN</Label><Input value={prestationData.prestataireRCS} onChange={(e) => setPrestationData({...prestationData, prestataireRCS: e.target.value})} placeholder="123 456 789" /></div>
                      <div><Label>Si√®ge social</Label><Input value={prestationData.prestataireSiegeSocial} onChange={(e) => setPrestationData({...prestationData, prestataireSiegeSocial: e.target.value})} /></div>
                      <div><Label>Repr√©sentant l√©gal</Label><Input value={prestationData.prestataireRepresentant} onChange={(e) => setPrestationData({...prestationData, prestataireRepresentant: e.target.value})} /></div>
                      <div><Label>Fonction du signataire</Label><Input value={prestationData.prestataireFonctionSignataire} onChange={(e) => setPrestationData({...prestationData, prestataireFonctionSignataire: e.target.value})} placeholder="G√©rant, Pr√©sident..." /></div>
                      <div><Label>Email *</Label><Input type="email" value={prestationData.prestataireEmail} onChange={(e) => setPrestationData({...prestationData, prestataireEmail: e.target.value})} /></div>
                      <div><Label>T√©l√©phone</Label><Input value={prestationData.prestataireTelephone} onChange={(e) => setPrestationData({...prestationData, prestataireTelephone: e.target.value})} /></div>
                    </div>
                    
                    <div className="space-y-2">
                      <Label>Assurance RC Professionnelle *</Label>
                      <RadioGroup value={prestationData.prestataireAssuranceRC} onValueChange={(v) => setPrestationData({...prestationData, prestataireAssuranceRC: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="assur-oui" /><Label htmlFor="assur-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="assur-non" /><Label htmlFor="assur-non">Non</Label></div>
                      </RadioGroup>
                      {prestationData.prestataireAssuranceRC === "oui" && (
                        <Input value={prestationData.prestataireNumeroAssurance} onChange={(e) => setPrestationData({...prestationData, prestataireNumeroAssurance: e.target.value})} placeholder="Num√©ro de police d'assurance" className="mt-2" />
                      )}
                    </div>
                    
                    <MultiFileUpload label="Pi√®ces justificatives prestataire (Kbis, assurance, etc.)" files={prestationPrestataireFiles} onFilesChange={setPrestationPrestataireFiles} accept=".pdf,.jpg,.jpeg,.png" role="avocat" />
                  </div>
                  
                  {/* CLIENT */}
                  <div className="space-y-3 p-3 bg-white rounded border border-blue-100">
                    <h5 className="font-medium text-blue-600">üè¢ Client (b√©n√©ficiaire du service)</h5>
                    <ClientSelector clients={clients} selectedClientId={prestationClientClientId} onClientChange={(id) => {
                      setPrestationClientClientId(id);
                      const client = clients.find(c => c.id === id);
                      if (client) {
                        setPrestationData(prev => ({
                          ...prev,
                          clientDenomination: `${client.prenom} ${client.nom}`,
                          clientEmail: client.email || "",
                          clientTelephone: client.telephone || "",
                        }));
                      }
                    }} label="S√©lectionner le client depuis vos clients" />
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3 mt-3">
                      <div><Label>D√©nomination / Nom *</Label><Input value={prestationData.clientDenomination} onChange={(e) => setPrestationData({...prestationData, clientDenomination: e.target.value})} /></div>
                      <div><Label>Forme juridique</Label><Input value={prestationData.clientFormeJuridique} onChange={(e) => setPrestationData({...prestationData, clientFormeJuridique: e.target.value})} placeholder="SARL, SAS, Particulier..." /></div>
                      <div className="md:col-span-2"><Label>Adresse compl√®te *</Label><Input value={prestationData.clientAdresse} onChange={(e) => setPrestationData({...prestationData, clientAdresse: e.target.value})} /></div>
                      <div><Label>RCS / SIREN</Label><Input value={prestationData.clientRCS} onChange={(e) => setPrestationData({...prestationData, clientRCS: e.target.value})} /></div>
                      <div><Label>Repr√©sentant l√©gal</Label><Input value={prestationData.clientRepresentant} onChange={(e) => setPrestationData({...prestationData, clientRepresentant: e.target.value})} /></div>
                      <div><Label>Fonction</Label><Input value={prestationData.clientFonction} onChange={(e) => setPrestationData({...prestationData, clientFonction: e.target.value})} /></div>
                      <div><Label>Contact op√©rationnel</Label><Input value={prestationData.clientContactOperationnel} onChange={(e) => setPrestationData({...prestationData, clientContactOperationnel: e.target.value})} /></div>
                      <div><Label>Email *</Label><Input type="email" value={prestationData.clientEmail} onChange={(e) => setPrestationData({...prestationData, clientEmail: e.target.value})} /></div>
                      <div><Label>T√©l√©phone</Label><Input value={prestationData.clientTelephone} onChange={(e) => setPrestationData({...prestationData, clientTelephone: e.target.value})} /></div>
                    </div>
                    
                    <MultiFileUpload label="Pi√®ces justificatives client" files={prestationClientFiles} onFilesChange={setPrestationClientFiles} accept=".pdf,.jpg,.jpeg,.png" role="avocat" />
                  </div>
                </div>
                
                {/* 2. OBJET DU CONTRAT */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">2Ô∏è‚É£ Objet du contrat ‚Äî D√©finition du service</h4>
                  <div className="space-y-3">
                    <div><Label>Nature exacte de la prestation *</Label><Input value={prestationData.naturePrestation} onChange={(e) => setPrestationData({...prestationData, naturePrestation: e.target.value})} placeholder="Ex: D√©veloppement web, Conseil juridique, Formation..." /></div>
                    <div><Label>Description d√©taill√©e du service *</Label><Textarea value={prestationData.descriptionDetaillee} onChange={(e) => setPrestationData({...prestationData, descriptionDetaillee: e.target.value})} className="min-h-[100px]" placeholder="D√©crivez pr√©cis√©ment le service fourni..." /></div>
                    <div><Label>P√©rim√®tre d'intervention</Label><Textarea value={prestationData.perimetreIntervention} onChange={(e) => setPrestationData({...prestationData, perimetreIntervention: e.target.value})} placeholder="Zone g√©ographique, domaine d'activit√©..." /></div>
                    <div><Label>Ce qui est inclus dans la prestation</Label><Textarea value={prestationData.inclusionsPrestations} onChange={(e) => setPrestationData({...prestationData, inclusionsPrestations: e.target.value})} placeholder="Liste des √©l√©ments inclus..." /></div>
                    <div><Label>Ce qui est exclu de la prestation</Label><Textarea value={prestationData.exclusionsPrestations} onChange={(e) => setPrestationData({...prestationData, exclusionsPrestations: e.target.value})} placeholder="Liste des √©l√©ments exclus..." /></div>
                    <div><Label>R√©sultats attendus / Livrables</Label><Textarea value={prestationData.resultatsAttendus} onChange={(e) => setPrestationData({...prestationData, resultatsAttendus: e.target.value})} placeholder="Quels sont les livrables concrets ?" /></div>
                    <div>
                      <Label>Type d'obligation *</Label>
                      <RadioGroup value={prestationData.typeObligation} onValueChange={(v) => setPrestationData({...prestationData, typeObligation: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="moyens" id="obl-moyens" /><Label htmlFor="obl-moyens">Obligation de moyens</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="resultat" id="obl-resultat" /><Label htmlFor="obl-resultat">Obligation de r√©sultat</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Comp√©tences techniques requises</Label><Input value={prestationData.competencesTechniques} onChange={(e) => setPrestationData({...prestationData, competencesTechniques: e.target.value})} /></div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                      <div><Label>R√©f√©rent technique prestataire</Label><Input value={prestationData.referentTechniquePrestataire} onChange={(e) => setPrestationData({...prestationData, referentTechniquePrestataire: e.target.value})} /></div>
                      <div><Label>R√©f√©rent technique client</Label><Input value={prestationData.referentTechniqueClient} onChange={(e) => setPrestationData({...prestationData, referentTechniqueClient: e.target.value})} /></div>
                    </div>
                  </div>
                </div>

                {/* 3. DUR√âE DU CONTRAT */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">3Ô∏è‚É£ Dur√©e du contrat</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Type de dur√©e *</Label>
                      <RadioGroup value={prestationData.typeDuree} onValueChange={(v) => setPrestationData({...prestationData, typeDuree: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="determinee" id="dur-det" /><Label htmlFor="dur-det">Dur√©e d√©termin√©e</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="ponctuelle" id="dur-ponc" /><Label htmlFor="dur-ponc">Ex√©cution ponctuelle</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="indeterminee" id="dur-ind" /><Label htmlFor="dur-ind">Dur√©e ind√©termin√©e</Label></div>
                      </RadioGroup>
                    </div>
                    {(prestationData.typeDuree === "determinee" || prestationData.typeDuree === "ponctuelle") && (
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <div><Label>Date de d√©but</Label><Input type="date" value={prestationData.dateDebut} onChange={(e) => setPrestationData({...prestationData, dateDebut: e.target.value})} /></div>
                        <div><Label>Date de fin</Label><Input type="date" value={prestationData.dateFin} onChange={(e) => setPrestationData({...prestationData, dateFin: e.target.value})} /></div>
                      </div>
                    )}
                    <div>
                      <Label>Reconduction tacite ?</Label>
                      <RadioGroup value={prestationData.reconductionTacite} onValueChange={(v) => setPrestationData({...prestationData, reconductionTacite: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="recon-oui" /><Label htmlFor="recon-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="recon-non" /><Label htmlFor="recon-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Dur√©e minimale d'engagement</Label><Input value={prestationData.dureeMinimale} onChange={(e) => setPrestationData({...prestationData, dureeMinimale: e.target.value})} placeholder="Ex: 6 mois, 1 an..." /></div>
                  </div>
                </div>

                {/* 4. MODALIT√âS DE R√âALISATION */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">4Ô∏è‚É£ Modalit√©s de r√©alisation</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Lieu d'ex√©cution *</Label>
                      <Select value={prestationData.lieuExecution} onValueChange={(v) => setPrestationData({...prestationData, lieuExecution: v})}>
                        <SelectTrigger><SelectValue placeholder="Choisir" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="teletravail">T√©l√©travail</SelectItem>
                          <SelectItem value="locaux_client">Locaux du client</SelectItem>
                          <SelectItem value="locaux_prestataire">Locaux du prestataire</SelectItem>
                          <SelectItem value="mixte">Mixte</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div><Label>Conditions d'intervention</Label><Textarea value={prestationData.conditionsIntervention} onChange={(e) => setPrestationData({...prestationData, conditionsIntervention: e.target.value})} placeholder="Acc√®s, badges, autorisations..." /></div>
                    <div>
                      <Label>Horaires impos√©s ?</Label>
                      <RadioGroup value={prestationData.horairesImpose} onValueChange={(v) => setPrestationData({...prestationData, horairesImpose: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="hor-oui" /><Label htmlFor="hor-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="hor-non" /><Label htmlFor="hor-non">Non</Label></div>
                      </RadioGroup>
                      {prestationData.horairesImpose === "oui" && (
                        <Input value={prestationData.detailsHoraires} onChange={(e) => setPrestationData({...prestationData, detailsHoraires: e.target.value})} placeholder="Pr√©ciser les horaires" className="mt-2" />
                      )}
                    </div>
                    <div><Label>Mat√©riel mis √† disposition</Label><Textarea value={prestationData.materielMisADisposition} onChange={(e) => setPrestationData({...prestationData, materielMisADisposition: e.target.value})} placeholder="Ordinateur, logiciels, outils..." /></div>
                    <div><Label>Obligations du client</Label><Textarea value={prestationData.obligationsClient} onChange={(e) => setPrestationData({...prestationData, obligationsClient: e.target.value})} placeholder="Fournir acc√®s, donn√©es, outils..." /></div>
                    <div><Label>D√©lais de r√©alisation</Label><Input value={prestationData.delaisRealisation} onChange={(e) => setPrestationData({...prestationData, delaisRealisation: e.target.value})} placeholder="Ex: 3 mois, 15 jours..." /></div>
                    <div><Label>Planning / Jalons</Label><Textarea value={prestationData.planning} onChange={(e) => setPrestationData({...prestationData, planning: e.target.value})} placeholder="√âtapes, dates cl√©s..." /></div>
                    <div><Label>Crit√®res d'acceptation des livrables</Label><Textarea value={prestationData.criteresAcceptation} onChange={(e) => setPrestationData({...prestationData, criteresAcceptation: e.target.value})} placeholder="Comment valide-t-on les livrables ?" /></div>
                  </div>
                </div>

                {/* 5. PRIX ET CONDITIONS FINANCI√àRES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">5Ô∏è‚É£ Prix et conditions financi√®res</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Mode de facturation *</Label>
                      <Select value={prestationData.modeFacturation} onValueChange={(v) => setPrestationData({...prestationData, modeFacturation: v})}>
                        <SelectTrigger><SelectValue placeholder="Choisir" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="forfait">Forfait global</SelectItem>
                          <SelectItem value="horaire">Taux horaire</SelectItem>
                          <SelectItem value="journalier">Taux journalier (TJM)</SelectItem>
                          <SelectItem value="livrable">Facturation au livrable</SelectItem>
                          <SelectItem value="abonnement">Abonnement p√©riodique</SelectItem>
                          <SelectItem value="performance">Paiement √† la performance</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                      <div><Label>Montant HT *</Label><Input type="number" value={prestationData.montantHT} onChange={(e) => setPrestationData({...prestationData, montantHT: e.target.value})} placeholder="0.00" /></div>
                      <div><Label>TVA applicable (%)</Label><Input type="number" value={prestationData.tva} onChange={(e) => setPrestationData({...prestationData, tva: e.target.value})} placeholder="20" /></div>
                    </div>
                    <div><Label>Modalit√©s de variation</Label><Input value={prestationData.modalitesVariation} onChange={(e) => setPrestationData({...prestationData, modalitesVariation: e.target.value})} placeholder="R√©vision annuelle, indexation..." /></div>
                    <div><Label>Frais annexes</Label><Textarea value={prestationData.fraisAnnexes} onChange={(e) => setPrestationData({...prestationData, fraisAnnexes: e.target.value})} placeholder="D√©placement, h√©bergement, mat√©riel..." /></div>
                    <div>
                      <Label>Modalit√©s de paiement *</Label>
                      <Select value={prestationData.modalitesPaiement} onValueChange={(v) => setPrestationData({...prestationData, modalitesPaiement: v})}>
                        <SelectTrigger><SelectValue placeholder="Choisir" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="comptant">Comptant</SelectItem>
                          <SelectItem value="30j">30 jours</SelectItem>
                          <SelectItem value="45j">45 jours</SelectItem>
                          <SelectItem value="60j">60 jours</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div><Label>Acompte initial</Label><Input value={prestationData.acompte} onChange={(e) => setPrestationData({...prestationData, acompte: e.target.value})} placeholder="Ex: 30%, 5000‚Ç¨..." /></div>
                    <div><Label>√âch√©ancier</Label><Textarea value={prestationData.echeancier} onChange={(e) => setPrestationData({...prestationData, echeancier: e.target.value})} placeholder="D√©tail des paiements..." /></div>
                    <div>
                      <Label>Facturation √©lectronique ?</Label>
                      <RadioGroup value={prestationData.facturationElectronique} onValueChange={(v) => setPrestationData({...prestationData, facturationElectronique: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="fact-oui" /><Label htmlFor="fact-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="fact-non" /><Label htmlFor="fact-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>P√©nalit√©s de retard</Label><Input value={prestationData.penalitesRetard} onChange={(e) => setPrestationData({...prestationData, penalitesRetard: e.target.value})} placeholder="Ex: 3 fois le taux l√©gal" /></div>
                    <div><Label>Indemnit√© l√©gale de recouvrement</Label><Input value={prestationData.indemniteLegale} onChange={(e) => setPrestationData({...prestationData, indemniteLegale: e.target.value})} placeholder="40‚Ç¨" /></div>
                    <div>
                      <Label>Suspension en cas d'impay√© ?</Label>
                      <RadioGroup value={prestationData.suspensionImpaye} onValueChange={(v) => setPrestationData({...prestationData, suspensionImpaye: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="susp-oui" /><Label htmlFor="susp-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="susp-non" /><Label htmlFor="susp-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                  </div>
                </div>

                {/* 6. PROPRI√âT√â INTELLECTUELLE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">6Ô∏è‚É£ Propri√©t√© intellectuelle</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Droits sur les cr√©ations du prestataire *</Label>
                      <Select value={prestationData.droitsCreationsPrestataire} onValueChange={(v) => setPrestationData({...prestationData, droitsCreationsPrestataire: v})}>
                        <SelectTrigger><SelectValue placeholder="Choisir" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="licence">Licence d'utilisation c√©d√©e au client</SelectItem>
                          <SelectItem value="cession">Cession totale des droits au client</SelectItem>
                          <SelectItem value="reserves">Droits r√©serv√©s au prestataire</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div><Label>Limitation des droits</Label><Input value={prestationData.limitationDroits} onChange={(e) => setPrestationData({...prestationData, limitationDroits: e.target.value})} placeholder="Dans le temps, l'espace..." /></div>
                    <div><Label>Droits sur les cr√©ations du client</Label><Textarea value={prestationData.droitsCreationsClient} onChange={(e) => setPrestationData({...prestationData, droitsCreationsClient: e.target.value})} placeholder="Utilisation autoris√©e ou interdite par le prestataire" /></div>
                    <div>
                      <Label>Propri√©taire du code/designs/textes</Label>
                      <RadioGroup value={prestationData.proprietaireCode} onValueChange={(v) => setPrestationData({...prestationData, proprietaireCode: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="prestataire" id="prop-prest" /><Label htmlFor="prop-prest">Prestataire</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="client" id="prop-client" /><Label htmlFor="prop-client">Client</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Droits de reproduction</Label><Input value={prestationData.droitsReproduction} onChange={(e) => setPrestationData({...prestationData, droitsReproduction: e.target.value})} /></div>
                    <div><Label>Garanties contre la contrefa√ßon</Label><Textarea value={prestationData.garantiesContrefacon} onChange={(e) => setPrestationData({...prestationData, garantiesContrefacon: e.target.value})} placeholder="Engagement du prestataire..." /></div>
                  </div>
                </div>

                {/* 7. CONFIDENTIALIT√â */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">7Ô∏è‚É£ Confidentialit√©</h4>
                  <div className="space-y-3">
                    <div><Label>D√©finition des informations confidentielles</Label><Textarea value={prestationData.definitionInfosConfidentielles} onChange={(e) => setPrestationData({...prestationData, definitionInfosConfidentielles: e.target.value})} placeholder="Toutes informations commerciales, techniques, financi√®res..." /></div>
                    <div><Label>Dur√©e de confidentialit√© (ann√©es)</Label><Input type="number" value={prestationData.dureeConfidentialite} onChange={(e) => setPrestationData({...prestationData, dureeConfidentialite: e.target.value})} placeholder="5" /></div>
                    <div><Label>Exceptions</Label><Textarea value={prestationData.exceptionsConfidentialite} onChange={(e) => setPrestationData({...prestationData, exceptionsConfidentialite: e.target.value})} placeholder="Ordre public, d√©j√† publique..." /></div>
                    <div><Label>Sanctions en cas de violation</Label><Input value={prestationData.sanctionsViolation} onChange={(e) => setPrestationData({...prestationData, sanctionsViolation: e.target.value})} placeholder="Dommages et int√©r√™ts..." /></div>
                  </div>
                </div>

                {/* 8. DONN√âES PERSONNELLES / RGPD */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">8Ô∏è‚É£ Donn√©es personnelles / RGPD</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Le prestataire agit-il en tant que sous-traitant ?</Label>
                      <RadioGroup value={prestationData.prestataireSousTraitant} onValueChange={(v) => setPrestationData({...prestationData, prestataireSousTraitant: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="st-oui" /><Label htmlFor="st-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="st-non" /><Label htmlFor="st-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div>
                      <Label>Le client agit-il en tant que responsable de traitement ?</Label>
                      <RadioGroup value={prestationData.clientResponsableTraitement} onValueChange={(v) => setPrestationData({...prestationData, clientResponsableTraitement: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="rt-oui" /><Label htmlFor="rt-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="rt-non" /><Label htmlFor="rt-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Nature des donn√©es trait√©es</Label><Textarea value={prestationData.natureDonnees} onChange={(e) => setPrestationData({...prestationData, natureDonnees: e.target.value})} placeholder="Donn√©es d'identification, coordonn√©es..." /></div>
                    <div><Label>Finalit√©s du traitement</Label><Textarea value={prestationData.finalitesTraitement} onChange={(e) => setPrestationData({...prestationData, finalitesTraitement: e.target.value})} placeholder="Gestion des clients, facturation..." /></div>
                    <div><Label>Mesures de s√©curit√©</Label><Textarea value={prestationData.mesuresSecurite} onChange={(e) => setPrestationData({...prestationData, mesuresSecurite: e.target.value})} placeholder="Chiffrement, acc√®s restreints..." /></div>
                    <div><Label>Dur√©e de conservation</Label><Input value={prestationData.dureeConservation} onChange={(e) => setPrestationData({...prestationData, dureeConservation: e.target.value})} placeholder="Ex: 3 ans" /></div>
                    <div><Label>Clause de violation de donn√©es (data breach)</Label><Input value={prestationData.clauseDataBreach} onChange={(e) => setPrestationData({...prestationData, clauseDataBreach: e.target.value})} placeholder="Notification sous 72h..." /></div>
                    <div>
                      <Label>DPA (Data Processing Agreement) requis ?</Label>
                      <RadioGroup value={prestationData.dpaRequis} onValueChange={(v) => setPrestationData({...prestationData, dpaRequis: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="dpa-oui" /><Label htmlFor="dpa-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="dpa-non" /><Label htmlFor="dpa-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                  </div>
                </div>

                {/* 9. SOUS-TRAITANCE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">9Ô∏è‚É£ Sous-traitance</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Sous-traitance autoris√©e ?</Label>
                      <Select value={prestationData.sousTraitanceAutorisee} onValueChange={(v) => setPrestationData({...prestationData, sousTraitanceAutorisee: v})}>
                        <SelectTrigger><SelectValue placeholder="Choisir" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="oui">Oui, autoris√©e</SelectItem>
                          <SelectItem value="non">Non, interdite</SelectItem>
                          <SelectItem value="avec_validation">Avec validation pr√©alable du client</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    {prestationData.sousTraitanceAutorisee === "avec_validation" && (
                      <div>
                        <Label>Validation pr√©alable n√©cessaire ?</Label>
                        <RadioGroup value={prestationData.validationPrealable} onValueChange={(v) => setPrestationData({...prestationData, validationPrealable: v})}>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="val-oui" /><Label htmlFor="val-oui">Oui</Label></div>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="val-non" /><Label htmlFor="val-non">Non</Label></div>
                        </RadioGroup>
                      </div>
                    )}
                    <div><Label>Responsabilit√© du prestataire en cas de sous-traitance</Label><Textarea value={prestationData.responsabilitePrestataire} onChange={(e) => setPrestationData({...prestationData, responsabilitePrestataire: e.target.value})} placeholder="Le prestataire reste responsable..." /></div>
                  </div>
                </div>

                {/* 10. RESPONSABILIT√â */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">üîü Responsabilit√©</h4>
                  <div className="space-y-3">
                    <div><Label>Plafond de responsabilit√©</Label><Input value={prestationData.plafondResponsabilite} onChange={(e) => setPrestationData({...prestationData, plafondResponsabilite: e.target.value})} placeholder="Ex: Montant du contrat, 100 000‚Ç¨..." /></div>
                    <div><Label>Exclusions de responsabilit√©</Label><Textarea value={prestationData.exclusionsDommages} onChange={(e) => setPrestationData({...prestationData, exclusionsDommages: e.target.value})} placeholder="Dommages indirects, perte de CA..." /></div>
                    <div><Label>Cas de force majeure</Label><Textarea value={prestationData.forceMajeure} onChange={(e) => setPrestationData({...prestationData, forceMajeure: e.target.value})} placeholder="√âv√©nements impr√©visibles..." /></div>
                    <div><Label>Responsabilit√© en cas de non-conformit√©</Label><Textarea value={prestationData.responsabiliteNonConformite} onChange={(e) => setPrestationData({...prestationData, responsabiliteNonConformite: e.target.value})} /></div>
                    <div><Label>Montant de couverture assurance</Label><Input value={prestationData.montantCouverture} onChange={(e) => setPrestationData({...prestationData, montantCouverture: e.target.value})} placeholder="Ex: 500 000‚Ç¨" /></div>
                  </div>
                </div>

                {/* 11. R√âSILIATION */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£1Ô∏è‚É£ R√©siliation anticip√©e</h4>
                  <div className="space-y-3">
                    <div><Label>Pr√©avis de r√©siliation</Label><Input value={prestationData.resiliationPreavis} onChange={(e) => setPrestationData({...prestationData, resiliationPreavis: e.target.value})} placeholder="Ex: 3 mois, 30 jours..." /></div>
                    <div>
                      <Label>R√©siliation imm√©diate en cas de :</Label>
                      <Select value={prestationData.resiliationImmediate} onValueChange={(v) => setPrestationData({...prestationData, resiliationImmediate: v})}>
                        <SelectTrigger><SelectValue placeholder="Choisir" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="faute">Faute grave</SelectItem>
                          <SelectItem value="non_paiement">Non-paiement</SelectItem>
                          <SelectItem value="non_respect">Non-respect du contrat</SelectItem>
                          <SelectItem value="tous">Tous les cas ci-dessus</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div><Label>Effets de la r√©siliation</Label><Textarea value={prestationData.effetsResiliation} onChange={(e) => setPrestationData({...prestationData, effetsResiliation: e.target.value})} placeholder="Paiement des prestations accomplies, restitution du mat√©riel..." /></div>
                  </div>
                </div>

                {/* 12. R√âVERSIBILIT√â */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£2Ô∏è‚É£ R√©versibilit√© / Fin de contrat</h4>
                  <div className="space-y-3">
                    <div><Label>Restitution des donn√©es</Label><Textarea value={prestationData.restitutionDonnees} onChange={(e) => setPrestationData({...prestationData, restitutionDonnees: e.target.value})} placeholder="Format, d√©lai..." /></div>
                    <div><Label>Restitution des documents</Label><Textarea value={prestationData.restitutionDocuments} onChange={(e) => setPrestationData({...prestationData, restitutionDocuments: e.target.value})} /></div>
                    <div><Label>Continuation du service pendant la transition</Label><Input value={prestationData.continuationTransition} onChange={(e) => setPrestationData({...prestationData, continuationTransition: e.target.value})} placeholder="Ex: 3 mois" /></div>
                    <div><Label>Assistance √† la migration</Label><Textarea value={prestationData.assistanceMigration} onChange={(e) => setPrestationData({...prestationData, assistanceMigration: e.target.value})} /></div>
                    <div><Label>Co√ªt de la r√©versibilit√©</Label><Input value={prestationData.coutReversibilite} onChange={(e) => setPrestationData({...prestationData, coutReversibilite: e.target.value})} placeholder="Gratuit, 2000‚Ç¨..." /></div>
                  </div>
                </div>

                {/* 13. LITIGES / LOI APPLICABLE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£3Ô∏è‚É£ Litiges / Loi applicable</h4>
                  <div className="space-y-3">
                    <div><Label>Loi applicable</Label><Input value={prestationData.loiApplicable} onChange={(e) => setPrestationData({...prestationData, loiApplicable: e.target.value})} placeholder="France" /></div>
                    <div><Label>Tribunal comp√©tent</Label><Input value={prestationData.tribunalCompetent} onChange={(e) => setPrestationData({...prestationData, tribunalCompetent: e.target.value})} placeholder="Ex: Tribunal de Commerce de Paris" /></div>
                    <div>
                      <Label>Clause de m√©diation ou arbitrage ?</Label>
                      <RadioGroup value={prestationData.mediationArbitrage} onValueChange={(v) => setPrestationData({...prestationData, mediationArbitrage: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="med-oui" /><Label htmlFor="med-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="med-non" /><Label htmlFor="med-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div>
                      <Label>Clause amiable obligatoire avant contentieux ?</Label>
                      <RadioGroup value={prestationData.clauseAmiable} onValueChange={(v) => setPrestationData({...prestationData, clauseAmiable: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="am-oui" /><Label htmlFor="am-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="am-non" /><Label htmlFor="am-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                  </div>
                </div>

                {/* 14. DATE D'EFFET & IND√âPENDANCE DES PARTIES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£4Ô∏è‚É£ Date d'effet & Ind√©pendance des parties</h4>
                  <div className="space-y-3">
                    <div><Label>Date d'entr√©e en vigueur du contrat *</Label><Input type="date" value={prestationData.dateEffetContrat} onChange={(e) => setPrestationData({...prestationData, dateEffetContrat: e.target.value})} /></div>
                    
                    <div className="p-3 bg-yellow-50 rounded border border-yellow-200">
                      <p className="text-sm font-semibold text-yellow-800 mb-2">‚ö†Ô∏è Clause d'ind√©pendance (fondamentale pour √©viter la requalification en contrat de travail)</p>
                    </div>
                    
                    <div>
                      <Label>Absence de lien de subordination</Label>
                      <RadioGroup value={prestationData.absenceSubordination} onValueChange={(v) => setPrestationData({...prestationData, absenceSubordination: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="sub-oui" /><Label htmlFor="sub-oui">Oui, le prestataire est ind√©pendant</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="sub-non" /><Label htmlFor="sub-non">Non (attention : risque de requalification)</Label></div>
                      </RadioGroup>
                    </div>
                    
                    <div>
                      <Label>Libert√© d'organisation du prestataire</Label>
                      <RadioGroup value={prestationData.liberteOrganisation} onValueChange={(v) => setPrestationData({...prestationData, liberteOrganisation: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="lib-oui" /><Label htmlFor="lib-oui">Oui, le prestataire organise librement son travail</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="lib-non" /><Label htmlFor="lib-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    
                    <div>
                      <Label>Clause d'exclusivit√©</Label>
                      <RadioGroup value={prestationData.exclusivite} onValueChange={(v) => setPrestationData({...prestationData, exclusivite: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="excl-non" /><Label htmlFor="excl-non">Non, le prestataire peut travailler pour d'autres clients</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="excl-oui" /><Label htmlFor="excl-oui">Oui, exclusivit√© totale</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="partielle" id="excl-part" /><Label htmlFor="excl-part">Exclusivit√© partielle / encadr√©e</Label></div>
                      </RadioGroup>
                      {prestationData.exclusivite === "oui" || prestationData.exclusivite === "partielle" ? (
                        <Textarea value={prestationData.precisionExclusivite} onChange={(e) => setPrestationData({...prestationData, precisionExclusivite: e.target.value})} placeholder="Pr√©ciser les modalit√©s de l'exclusivit√©..." className="mt-2" />
                      ) : null}
                    </div>
                  </div>
                </div>

                {/* 15. CLAUSE DE NON-SOLLICITATION / NON-D√âBAUCHAGE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£5Ô∏è‚É£ Clause de non-sollicitation / non-d√©bauchage</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Clause de non-d√©bauchage des salari√©s / sous-traitants</Label>
                      <RadioGroup value={prestationData.nonDebauchage} onValueChange={(v) => setPrestationData({...prestationData, nonDebauchage: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="deb-oui" /><Label htmlFor="deb-oui">Oui, interdiction de d√©baucher</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="deb-non" /><Label htmlFor="deb-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    
                    {prestationData.nonDebauchage === "oui" && (
                      <>
                        <div><Label>Dur√©e de la clause</Label><Input value={prestationData.dureeNonDebauchage} onChange={(e) => setPrestationData({...prestationData, dureeNonDebauchage: e.target.value})} placeholder="Ex: 2 ans √† compter de la fin du contrat" /></div>
                        <div><Label>P√©nalit√© en cas de violation</Label><Input value={prestationData.penaliteNonDebauchage} onChange={(e) => setPrestationData({...prestationData, penaliteNonDebauchage: e.target.value})} placeholder="Ex: 12 mois de salaire brut de la personne d√©bauch√©e" /></div>
                      </>
                    )}
                  </div>
                </div>

                {/* 16. MODIFICATION DU CONTRAT */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£6Ô∏è‚É£ Modification du contrat</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Toute modification doit faire l'objet d'un avenant √©crit et sign√©</Label>
                      <RadioGroup value={prestationData.modificationAvenant} onValueChange={(v) => setPrestationData({...prestationData, modificationAvenant: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="aven-oui" /><Label htmlFor="aven-oui">Oui (recommand√©)</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="aven-non" /><Label htmlFor="aven-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <p className="text-xs text-gray-600">Cette clause s√©curise toute √©volution de la prestation en exigeant un accord √©crit des deux parties.</p>
                  </div>
                </div>

                {/* 17. CLAUSES JURIDIQUES STANDARDS */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£7Ô∏è‚É£ Clauses juridiques standards</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Clause de tol√©rance / non-renonciation</Label>
                      <RadioGroup value={prestationData.clauseTolerance} onValueChange={(v) => setPrestationData({...prestationData, clauseTolerance: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="tol-oui" /><Label htmlFor="tol-oui">Oui (recommand√©)</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="tol-non" /><Label htmlFor="tol-non">Non</Label></div>
                      </RadioGroup>
                      <p className="text-xs text-gray-600 mt-1">Le fait pour une partie de ne pas se pr√©valoir d'un droit ne constitue pas une renonciation d√©finitive √† ce droit.</p>
                    </div>
                    
                    <div>
                      <Label>Clause de nullit√© partielle (divisibilit√©)</Label>
                      <RadioGroup value={prestationData.clauseNullitePartielle} onValueChange={(v) => setPrestationData({...prestationData, clauseNullitePartielle: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="null-oui" /><Label htmlFor="null-oui">Oui (recommand√©)</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="null-non" /><Label htmlFor="null-non">Non</Label></div>
                      </RadioGroup>
                      <p className="text-xs text-gray-600 mt-1">Si une clause est d√©clar√©e nulle ou inapplicable, le reste du contrat demeure valable et applicable.</p>
                    </div>
                  </div>
                </div>

                {/* 18. ANNEXES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£8Ô∏è‚É£ Annexes et pi√®ces justificatives</h4>
                  <MultiFileUpload 
                    label="Annexes (Cahier des charges, planning, liste livrables, CGV, devis, RGPD/DPA, plans techniques...)" 
                    files={prestationAnnexesFiles} 
                    onFilesChange={setPrestationAnnexesFiles} 
                    accept=".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png"
                    role="avocat"
                  />
                </div>
              </div>
            )}

            {/* Formulaire complet pour Contrat de vente B2B / distribution */}
            {pendingContractType === "Contrat de vente B2B / distribution" && (
              <div className="space-y-6">
                <h3 className="font-semibold text-xl border-b-2 border-blue-300 pb-2 text-blue-700">ü§ù Contrat de vente B2B / distribution</h3>
                
                {/* 1. IDENTIFICATION DES PARTIES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£ Identification des parties</h4>
                  
                  {/* FOURNISSEUR / VENDEUR */}
                  <div className="space-y-3 p-3 bg-white rounded border border-blue-100">
                    <h5 className="font-medium text-blue-600">üè≠ Fournisseur / Vendeur</h5>
                    <ClientSelector clients={clients} selectedClientId={venteB2BFournisseurClientId} onClientChange={(id) => {
                      setVenteB2BFournisseurClientId(id);
                      const client = clients.find(c => c.id === id);
                      if (client) {
                        setVenteB2BData(prev => ({
                          ...prev,
                          fournisseurDenomination: `${client.prenom} ${client.nom}`,
                          fournisseurEmail: client.email || "",
                          fournisseurTelephone: client.telephone || "",
                        }));
                      }
                    }} label="S√©lectionner le fournisseur depuis vos clients" />
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3 mt-3">
                      <div><Label>D√©nomination sociale *</Label><Input value={venteB2BData.fournisseurDenomination} onChange={(e) => setVenteB2BData({...venteB2BData, fournisseurDenomination: e.target.value})} /></div>
                      <div><Label>Forme juridique *</Label><Input value={venteB2BData.fournisseurFormeJuridique} onChange={(e) => setVenteB2BData({...venteB2BData, fournisseurFormeJuridique: e.target.value})} placeholder="SARL, SAS, SA..." /></div>
                      <div><Label>Capital social</Label><Input value={venteB2BData.fournisseurCapital} onChange={(e) => setVenteB2BData({...venteB2BData, fournisseurCapital: e.target.value})} placeholder="Ex: 10 000‚Ç¨" /></div>
                      <div><Label>RCS / SIREN *</Label><Input value={venteB2BData.fournisseurRCS} onChange={(e) => setVenteB2BData({...venteB2BData, fournisseurRCS: e.target.value})} /></div>
                      <div className="md:col-span-2"><Label>Adresse du si√®ge social *</Label><Input value={venteB2BData.fournisseurSiegeSocial} onChange={(e) => setVenteB2BData({...venteB2BData, fournisseurSiegeSocial: e.target.value})} /></div>
                      <div><Label>Repr√©sentant l√©gal *</Label><Input value={venteB2BData.fournisseurRepresentant} onChange={(e) => setVenteB2BData({...venteB2BData, fournisseurRepresentant: e.target.value})} /></div>
                      <div><Label>Email *</Label><Input type="email" value={venteB2BData.fournisseurEmail} onChange={(e) => setVenteB2BData({...venteB2BData, fournisseurEmail: e.target.value})} /></div>
                      <div><Label>T√©l√©phone</Label><Input value={venteB2BData.fournisseurTelephone} onChange={(e) => setVenteB2BData({...venteB2BData, fournisseurTelephone: e.target.value})} /></div>
                    </div>
                    <div>
                      <Label>Assurance professionnelle</Label>
                      <RadioGroup value={venteB2BData.fournisseurAssurancePro} onValueChange={(v) => setVenteB2BData({...venteB2BData, fournisseurAssurancePro: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="f-ass-oui" /><Label htmlFor="f-ass-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="f-ass-non" /><Label htmlFor="f-ass-non">Non</Label></div>
                      </RadioGroup>
                      {venteB2BData.fournisseurAssurancePro === "oui" && (
                        <Input value={venteB2BData.fournisseurNumeroAssurance} onChange={(e) => setVenteB2BData({...venteB2BData, fournisseurNumeroAssurance: e.target.value})} placeholder="Num√©ro de police" className="mt-2" />
                      )}
                    </div>
                    
                    <MultiFileUpload label="Pi√®ces justificatives fournisseur (Kbis, statuts, assurance, fiches techniques)" files={venteB2BFournisseurFiles} onFilesChange={setVenteB2BFournisseurFiles} accept=".pdf,.jpg,.jpeg,.png" role="avocat" />
                  </div>
                  
                  {/* ACHETEUR / DISTRIBUTEUR */}
                  <div className="space-y-3 p-3 bg-white rounded border border-blue-100">
                    <h5 className="font-medium text-blue-600">üè¢ Acheteur / Distributeur</h5>
                    <ClientSelector clients={clients} selectedClientId={venteB2BDistributeurClientId} onClientChange={(id) => {
                      setVenteB2BDistributeurClientId(id);
                      const client = clients.find(c => c.id === id);
                      if (client) {
                        setVenteB2BData(prev => ({
                          ...prev,
                          acheteurDenomination: `${client.prenom} ${client.nom}`,
                          acheteurEmail: client.email || "",
                          acheteurTelephone: client.telephone || "",
                        }));
                      }
                    }} label="S√©lectionner le client (acheteur/distributeur)" />
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3 mt-3">
                      <div><Label>D√©nomination *</Label><Input value={venteB2BData.acheteurDenomination} onChange={(e) => setVenteB2BData({...venteB2BData, acheteurDenomination: e.target.value})} /></div>
                      <div><Label>Forme juridique</Label><Input value={venteB2BData.acheteurFormeJuridique} onChange={(e) => setVenteB2BData({...venteB2BData, acheteurFormeJuridique: e.target.value})} /></div>
                      <div><Label>RCS / SIREN</Label><Input value={venteB2BData.acheteurRCS} onChange={(e) => setVenteB2BData({...venteB2BData, acheteurRCS: e.target.value})} /></div>
                      <div className="md:col-span-2"><Label>Adresse compl√®te *</Label><Input value={venteB2BData.acheteurAdresse} onChange={(e) => setVenteB2BData({...venteB2BData, acheteurAdresse: e.target.value})} /></div>
                      <div><Label>Repr√©sentant l√©gal</Label><Input value={venteB2BData.acheteurRepresentant} onChange={(e) => setVenteB2BData({...venteB2BData, acheteurRepresentant: e.target.value})} /></div>
                      <div><Label>Email *</Label><Input type="email" value={venteB2BData.acheteurEmail} onChange={(e) => setVenteB2BData({...venteB2BData, acheteurEmail: e.target.value})} /></div>
                      <div><Label>T√©l√©phone</Label><Input value={venteB2BData.acheteurTelephone} onChange={(e) => setVenteB2BData({...venteB2BData, acheteurTelephone: e.target.value})} /></div>
                      <div><Label>Zone g√©ographique d'activit√©</Label><Input value={venteB2BData.acheteurZoneGeographique} onChange={(e) => setVenteB2BData({...venteB2BData, acheteurZoneGeographique: e.target.value})} placeholder="Ex: France, Europe, International" /></div>
                      <div className="md:col-span-2">
                        <Label>Statut commercial</Label>
                        <Select value={venteB2BData.acheteurStatutCommercial} onValueChange={(v) => setVenteB2BData({...venteB2BData, acheteurStatutCommercial: v})}>
                          <SelectTrigger><SelectValue placeholder="Choisir" /></SelectTrigger>
                          <SelectContent>
                            <SelectItem value="revendeur">Revendeur</SelectItem>
                            <SelectItem value="agent">Agent commercial</SelectItem>
                            <SelectItem value="importateur">Importateur</SelectItem>
                            <SelectItem value="grossiste">Grossiste</SelectItem>
                            <SelectItem value="detaillant">D√©taillant</SelectItem>
                            <SelectItem value="distributeur_exclusif">Distributeur exclusif</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                    </div>
                    
                    <MultiFileUpload label="Pi√®ces justificatives distributeur (Kbis, assurance RC Pro, liste points de vente)" files={venteB2BDistributeurFiles} onFilesChange={setVenteB2BDistributeurFiles} accept=".pdf,.jpg,.jpeg,.png,.xlsx" role="avocat" />
                  </div>
                </div>
                
                {/* 2. OBJET DU CONTRAT */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">2Ô∏è‚É£ Objet du contrat</h4>
                  <div className="space-y-3">
                    <div><Label>Nature des produits vendus *</Label><Textarea value={venteB2BData.natureProduits} onChange={(e) => setVenteB2BData({...venteB2BData, natureProduits: e.target.value})} placeholder="D√©tail, r√©f√©rence, gamme..." className="min-h-[80px]" /></div>
                    <div><Label>Cat√©gories de produits concern√©es</Label><Input value={venteB2BData.categoriesProduits} onChange={(e) => setVenteB2BData({...venteB2BData, categoriesProduits: e.target.value})} placeholder="Ex: √âlectronique, Textile, Alimentaire..." /></div>
                    <div>
                      <Label>P√©rim√®tre de la distribution *</Label>
                      <Select value={venteB2BData.perimetreDistribution} onValueChange={(v) => setVenteB2BData({...venteB2BData, perimetreDistribution: v})}>
                        <SelectTrigger><SelectValue placeholder="Choisir" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="vente_simple">Vente simple B2B</SelectItem>
                          <SelectItem value="distribution_generale">Contrat de distribution g√©n√©rale</SelectItem>
                          <SelectItem value="exclusive">Distribution exclusive</SelectItem>
                          <SelectItem value="selective">Distribution s√©lective</SelectItem>
                          <SelectItem value="franchise">Franchise</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div><Label>Obligations minimales du distributeur</Label><Textarea value={venteB2BData.obligationsMinimalesDistributeur} onChange={(e) => setVenteB2BData({...venteB2BData, obligationsMinimalesDistributeur: e.target.value})} placeholder="Volumes minimum, actions promotionnelles..." /></div>
                    <div><Label>Canaux de vente autoris√©s</Label><Input value={venteB2BData.canauxVenteAutorises} onChange={(e) => setVenteB2BData({...venteB2BData, canauxVenteAutorises: e.target.value})} placeholder="Boutique physique, en ligne, marketplace, export..." /></div>
                  </div>
                </div>

                {/* 3. CONDITIONS DE VENTE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">3Ô∏è‚É£ Conditions de vente (Terms & Conditions)</h4>
                  
                  {/* 3A. TARIFS */}
                  <div className="space-y-3 p-3 bg-white rounded border border-blue-100">
                    <h5 className="font-medium text-blue-600">üí∞ A. Tarifs</h5>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                      <div><Label>Prix unitaire</Label><Input value={venteB2BData.prixUnitaire} onChange={(e) => setVenteB2BData({...venteB2BData, prixUnitaire: e.target.value})} placeholder="Ex: 50‚Ç¨ HT / unit√©" /></div>
                      <div><Label>Grille tarifaire</Label><Input value={venteB2BData.grilleTarifaire} onChange={(e) => setVenteB2BData({...venteB2BData, grilleTarifaire: e.target.value})} placeholder="Annexe ou lien vers tarifs" /></div>
                    </div>
                    <div><Label>Remises (quantit√©, volume, saison...)</Label><Textarea value={venteB2BData.remises} onChange={(e) => setVenteB2BData({...venteB2BData, remises: e.target.value})} placeholder="Ex: -5% d√®s 100 unit√©s, -10% d√®s 500 unit√©s" /></div>
                    <div><Label>R√©visions de prix / Indexation</Label><Input value={venteB2BData.revisionsPrix} onChange={(e) => setVenteB2BData({...venteB2BData, revisionsPrix: e.target.value})} placeholder="Ex: R√©vision annuelle selon l'inflation" /></div>
                    <div><Label>Conditions pr√©f√©rentielles (si exclusivit√©)</Label><Input value={venteB2BData.conditionsPreferentielles} onChange={(e) => setVenteB2BData({...venteB2BData, conditionsPreferentielles: e.target.value})} /></div>
                  </div>
                  
                  {/* 3B. COMMANDES */}
                  <div className="space-y-3 p-3 bg-white rounded border border-blue-100">
                    <h5 className="font-medium text-blue-600">üì¶ B. Commandes</h5>
                    <div><Label>Modalit√©s de passation</Label><Input value={venteB2BData.modalitesPassationCommande} onChange={(e) => setVenteB2BData({...venteB2BData, modalitesPassationCommande: e.target.value})} placeholder="Email, plateforme, t√©l√©phone..." /></div>
                    <div><Label>Minimums de commande</Label><Input value={venteB2BData.minimumsCommande} onChange={(e) => setVenteB2BData({...venteB2BData, minimumsCommande: e.target.value})} placeholder="Ex: 100 unit√©s ou 1000‚Ç¨ HT" /></div>
                    <div><Label>D√©lais de commande</Label><Input value={venteB2BData.delaisCommande} onChange={(e) => setVenteB2BData({...venteB2BData, delaisCommande: e.target.value})} placeholder="Ex: 15 jours avant livraison souhait√©e" /></div>
                    <div>
                      <Label>Confirmation de commande</Label>
                      <RadioGroup value={venteB2BData.confirmationCommande} onValueChange={(v) => setVenteB2BData({...venteB2BData, confirmationCommande: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="automatique" id="conf-auto" /><Label htmlFor="conf-auto">Automatique</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="manuelle" id="conf-man" /><Label htmlFor="conf-man">Manuelle (validation fournisseur)</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Conditions annulation / modification</Label><Textarea value={venteB2BData.conditionsAnnulation} onChange={(e) => setVenteB2BData({...venteB2BData, conditionsAnnulation: e.target.value})} placeholder="D√©lais, p√©nalit√©s √©ventuelles..." /></div>
                  </div>
                  
                  {/* 3C. LIVRAISON */}
                  <div className="space-y-3 p-3 bg-white rounded border border-blue-100">
                    <h5 className="font-medium text-blue-600">üöö C. Livraison</h5>
                    <div>
                      <Label>Incoterms *</Label>
                      <Select value={venteB2BData.incoterms} onValueChange={(v) => setVenteB2BData({...venteB2BData, incoterms: v})}>
                        <SelectTrigger><SelectValue placeholder="Choisir" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="EXW">EXW (Ex Works - d√©part usine)</SelectItem>
                          <SelectItem value="FCA">FCA (Free Carrier - franco transporteur)</SelectItem>
                          <SelectItem value="CPT">CPT (Carriage Paid To - port pay√© jusqu'√†)</SelectItem>
                          <SelectItem value="CIP">CIP (Carriage and Insurance Paid - port et assurance pay√©s)</SelectItem>
                          <SelectItem value="DAP">DAP (Delivered At Place - rendu au lieu de destination)</SelectItem>
                          <SelectItem value="DPU">DPU (Delivered at Place Unloaded - rendu d√©charg√©)</SelectItem>
                          <SelectItem value="DDP">DDP (Delivered Duty Paid - rendu droits acquitt√©s)</SelectItem>
                          <SelectItem value="FOB">FOB (Free On Board - franco √† bord)</SelectItem>
                          <SelectItem value="CFR">CFR (Cost and Freight - co√ªt et fret)</SelectItem>
                          <SelectItem value="CIF">CIF (Cost, Insurance and Freight - co√ªt, assurance, fret)</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div><Label>Transporteur</Label><Input value={venteB2BData.transporteur} onChange={(e) => setVenteB2BData({...venteB2BData, transporteur: e.target.value})} placeholder="Choisi par fournisseur / acheteur" /></div>
                    <div><Label>Transfert des risques</Label><Input value={venteB2BData.transfertRisques} onChange={(e) => setVenteB2BData({...venteB2BData, transfertRisques: e.target.value})} placeholder="Selon Incoterms ou pr√©cision" /></div>
                    <div><Label>D√©lais de livraison</Label><Input value={venteB2BData.delaisLivraison} onChange={(e) => setVenteB2BData({...venteB2BData, delaisLivraison: e.target.value})} placeholder="Ex: 10 jours ouvr√©s" /></div>
                    <div><Label>P√©nalit√©s de retard de livraison</Label><Input value={venteB2BData.penalitesRetardLivraison} onChange={(e) => setVenteB2BData({...venteB2BData, penalitesRetardLivraison: e.target.value})} placeholder="Ex: 1% du montant HT par semaine" /></div>
                    <div><Label>Modalit√©s de r√©ception et contr√¥le</Label><Textarea value={venteB2BData.modalitesReception} onChange={(e) => setVenteB2BData({...venteB2BData, modalitesReception: e.target.value})} placeholder="D√©lai de r√©clamation, r√©serves..." /></div>
                  </div>
                  
                  {/* 3D. PAIEMENT */}
                  <div className="space-y-3 p-3 bg-white rounded border border-blue-100">
                    <h5 className="font-medium text-blue-600">üí≥ D. Paiement</h5>
                    <div>
                      <Label>Mode de paiement *</Label>
                      <Select value={venteB2BData.modePaiement} onValueChange={(v) => setVenteB2BData({...venteB2BData, modePaiement: v})}>
                        <SelectTrigger><SelectValue placeholder="Choisir" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="virement">Virement bancaire</SelectItem>
                          <SelectItem value="prelevement">Pr√©l√®vement SEPA</SelectItem>
                          <SelectItem value="LCR">LCR (Lettre de Change Relev√©)</SelectItem>
                          <SelectItem value="cheque">Ch√®que</SelectItem>
                          <SelectItem value="carte">Carte bancaire</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div>
                      <Label>D√©lais de paiement *</Label>
                      <Select value={venteB2BData.delaisPaiement} onValueChange={(v) => setVenteB2BData({...venteB2BData, delaisPaiement: v})}>
                        <SelectTrigger><SelectValue placeholder="Choisir" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="comptant">Comptant</SelectItem>
                          <SelectItem value="30j">30 jours</SelectItem>
                          <SelectItem value="45j">45 jours fin de mois</SelectItem>
                          <SelectItem value="60j">60 jours</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div><Label>Acompte √©ventuel</Label><Input value={venteB2BData.acomptePaiement} onChange={(e) => setVenteB2BData({...venteB2BData, acomptePaiement: e.target.value})} placeholder="Ex: 30% √† la commande" /></div>
                    <div><Label>P√©nalit√©s de retard</Label><Input value={venteB2BData.penalitesRetardPaiement} onChange={(e) => setVenteB2BData({...venteB2BData, penalitesRetardPaiement: e.target.value})} placeholder="Ex: 3 fois le taux l√©gal" /></div>
                    <div><Label>Indemnit√© forfaitaire de recouvrement</Label><Input value={venteB2BData.indemniteLegaleRecouvrement} onChange={(e) => setVenteB2BData({...venteB2BData, indemniteLegaleRecouvrement: e.target.value})} placeholder="40‚Ç¨" /></div>
                    <div>
                      <Label>Suspension des livraisons en cas d'impay√©</Label>
                      <RadioGroup value={venteB2BData.suspensionLivraisonImpaye} onValueChange={(v) => setVenteB2BData({...venteB2BData, suspensionLivraisonImpaye: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="susp-liv-oui" /><Label htmlFor="susp-liv-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="susp-liv-non" /><Label htmlFor="susp-liv-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                  </div>
                </div>
                
                {/* 4. OBLIGATIONS DU FOURNISSEUR */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">4Ô∏è‚É£ Obligations du fournisseur</h4>
                  <div className="space-y-2">
                    <div className="flex items-center space-x-2">
                      <input type="checkbox" checked={venteB2BData.obligationConformite} onChange={(e) => setVenteB2BData({...venteB2BData, obligationConformite: e.target.checked})} id="oblig-conf" className="rounded" />
                      <Label htmlFor="oblig-conf" className="font-normal cursor-pointer">Fournir des produits conformes</Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <input type="checkbox" checked={venteB2BData.respectNormesCertifications} onChange={(e) => setVenteB2BData({...venteB2BData, respectNormesCertifications: e.target.checked})} id="oblig-normes" className="rounded" />
                      <Label htmlFor="oblig-normes" className="font-normal cursor-pointer">Respect des normes et certifications</Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <input type="checkbox" checked={venteB2BData.garantieDisponibilite} onChange={(e) => setVenteB2BData({...venteB2BData, garantieDisponibilite: e.target.checked})} id="oblig-dispo" className="rounded" />
                      <Label htmlFor="oblig-dispo" className="font-normal cursor-pointer">Garantir disponibilit√© et respect des d√©lais</Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <input type="checkbox" checked={venteB2BData.assuranceQualite} onChange={(e) => setVenteB2BData({...venteB2BData, assuranceQualite: e.target.checked})} id="oblig-qualite" className="rounded" />
                      <Label htmlFor="oblig-qualite" className="font-normal cursor-pointer">Assurer la qualit√© (contr√¥les, tests)</Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <input type="checkbox" checked={venteB2BData.remplacementDefectueux} onChange={(e) => setVenteB2BData({...venteB2BData, remplacementDefectueux: e.target.checked})} id="oblig-remplacement" className="rounded" />
                      <Label htmlFor="oblig-remplacement" className="font-normal cursor-pointer">Remplacer les produits d√©fectueux</Label>
                    </div>
                    <div>
                      <Label>Former le distributeur</Label>
                      <RadioGroup value={venteB2BData.formationDistributeur} onValueChange={(v) => setVenteB2BData({...venteB2BData, formationDistributeur: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="form-dist-oui" /><Label htmlFor="form-dist-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="form-dist-non" /><Label htmlFor="form-dist-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div>
                      <Label>Assistance technique / apr√®s-vente</Label>
                      <RadioGroup value={venteB2BData.assistanceTechnique} onValueChange={(v) => setVenteB2BData({...venteB2BData, assistanceTechnique: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="assist-tech-oui" /><Label htmlFor="assist-tech-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="assist-tech-non" /><Label htmlFor="assist-tech-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div className="flex items-center space-x-2">
                      <input type="checkbox" checked={venteB2BData.obligationInformation} onChange={(e) => setVenteB2BData({...venteB2BData, obligationInformation: e.target.checked})} id="oblig-info" className="rounded" />
                      <Label htmlFor="oblig-info" className="font-normal cursor-pointer">Obligation d'information (ruptures, nouveaut√©s)</Label>
                    </div>
                  </div>
                </div>

                {/* 5. OBLIGATIONS DE L'ACHETEUR / DISTRIBUTEUR */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">5Ô∏è‚É£ Obligations de l'acheteur / distributeur</h4>
                  <div className="space-y-2">
                    <div className="flex items-center space-x-2">
                      <input type="checkbox" checked={venteB2BData.commercialisationImageMarque} onChange={(e) => setVenteB2BData({...venteB2BData, commercialisationImageMarque: e.target.checked})} id="comm-image" className="rounded" />
                      <Label htmlFor="comm-image" className="font-normal cursor-pointer">Commercialiser conform√©ment √† l'image de la marque</Label>
                    </div>
                    <div>
                      <Label>Respecter les prix recommand√©s (non obligatoire juridiquement)</Label>
                      <RadioGroup value={venteB2BData.respectPrixRecommandes} onValueChange={(v) => setVenteB2BData({...venteB2BData, respectPrixRecommandes: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="prix-rec-oui" /><Label htmlFor="prix-rec-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="prix-rec-non" /><Label htmlFor="prix-rec-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div className="flex items-center space-x-2">
                      <input type="checkbox" checked={venteB2BData.promotionActive} onChange={(e) => setVenteB2BData({...venteB2BData, promotionActive: e.target.checked})} id="promo-active" className="rounded" />
                      <Label htmlFor="promo-active" className="font-normal cursor-pointer">Promouvoir activement les produits</Label>
                    </div>
                    <div><Label>Maintenir un stock minimum (si exig√©)</Label><Input value={venteB2BData.stockMinimum} onChange={(e) => setVenteB2BData({...venteB2BData, stockMinimum: e.target.value})} placeholder="Ex: 100 unit√©s ou 3 mois de ventes" /></div>
                    <div className="flex items-center space-x-2">
                      <input type="checkbox" checked={venteB2BData.reportingMarche} onChange={(e) => setVenteB2BData({...venteB2BData, reportingMarche: e.target.checked})} id="reporting" className="rounded" />
                      <Label htmlFor="reporting" className="font-normal cursor-pointer">Informations sur le march√© / reporting</Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <input type="checkbox" checked={venteB2BData.respectNormesLocales} onChange={(e) => setVenteB2BData({...venteB2BData, respectNormesLocales: e.target.checked})} id="normes-loc" className="rounded" />
                      <Label htmlFor="normes-loc" className="font-normal cursor-pointer">Respect des normes locales (import/export)</Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <input type="checkbox" checked={venteB2BData.serviceClientRetours} onChange={(e) => setVenteB2BData({...venteB2BData, serviceClientRetours: e.target.checked})} id="sav-retours" className="rounded" />
                      <Label htmlFor="sav-retours" className="font-normal cursor-pointer">Service client et gestion des retours</Label>
                    </div>
                    <div>
                      <Label>Formation du personnel de vente</Label>
                      <RadioGroup value={venteB2BData.formationPersonnel} onValueChange={(v) => setVenteB2BData({...venteB2BData, formationPersonnel: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="form-pers-oui" /><Label htmlFor="form-pers-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="form-pers-non" /><Label htmlFor="form-pers-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                  </div>
                </div>

                {/* 6. EXCLUSIVIT√â */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">6Ô∏è‚É£ Exclusivit√© (si applicable)</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Exclusivit√© territoriale</Label>
                      <RadioGroup value={venteB2BData.exclusiviteTerritoriale} onValueChange={(v) => setVenteB2BData({...venteB2BData, exclusiviteTerritoriale: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="excl-terr-oui" /><Label htmlFor="excl-terr-oui">Oui, distributeur unique dans une zone</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="excl-terr-non" /><Label htmlFor="excl-terr-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    
                    {venteB2BData.exclusiviteTerritoriale === "oui" && (
                      <>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                          <div><Label>Pays / R√©gion</Label><Input value={venteB2BData.exclusivitePays} onChange={(e) => setVenteB2BData({...venteB2BData, exclusivitePays: e.target.value})} placeholder="Ex: France, √éle-de-France..." /></div>
                          <div><Label>Zone pr√©cise</Label><Input value={venteB2BData.exclusiviteRegion} onChange={(e) => setVenteB2BData({...venteB2BData, exclusiviteRegion: e.target.value})} placeholder="D√©partements, villes..." /></div>
                        </div>
                        <div><Label>Dur√©e de l'exclusivit√©</Label><Input value={venteB2BData.dureeExclusivite} onChange={(e) => setVenteB2BData({...venteB2BData, dureeExclusivite: e.target.value})} placeholder="Ex: 2 ans renouvelables" /></div>
                        <div><Label>Engagement de volume minimal</Label><Input value={venteB2BData.volumeMinimalExclusivite} onChange={(e) => setVenteB2BData({...venteB2BData, volumeMinimalExclusivite: e.target.value})} placeholder="Ex: 10 000 unit√©s/an" /></div>
                        <div><Label>Objectifs de vente</Label><Textarea value={venteB2BData.objectifsVenteExclusivite} onChange={(e) => setVenteB2BData({...venteB2BData, objectifsVenteExclusivite: e.target.value})} placeholder="Objectifs annuels, trimestriels..." /></div>
                      </>
                    )}
                    
                    <div>
                      <Label>Exclusivit√© produit (fournisseur ne vend pas √† d'autres distributeurs)</Label>
                      <RadioGroup value={venteB2BData.exclusiviteProduit} onValueChange={(v) => setVenteB2BData({...venteB2BData, exclusiviteProduit: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="excl-prod-oui" /><Label htmlFor="excl-prod-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="excl-prod-non" /><Label htmlFor="excl-prod-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    
                    <div><Label>Sanctions en cas d'√©chec des objectifs</Label><Textarea value={venteB2BData.sanctionsEchecExclusivite} onChange={(e) => setVenteB2BData({...venteB2BData, sanctionsEchecExclusivite: e.target.value})} placeholder="Perte de l'exclusivit√©, r√©siliation, p√©nalit√©..." /></div>
                  </div>
                </div>

                {/* 7. DISTRIBUTION S√âLECTIVE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">7Ô∏è‚É£ Distribution s√©lective (si applicable)</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Distribution s√©lective</Label>
                      <RadioGroup value={venteB2BData.distributionSelective} onValueChange={(v) => setVenteB2BData({...venteB2BData, distributionSelective: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="dist-sel-oui" /><Label htmlFor="dist-sel-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="dist-sel-non" /><Label htmlFor="dist-sel-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    
                    {venteB2BData.distributionSelective === "oui" && (
                      <>
                        <div><Label>Crit√®res d'agr√©ment</Label><Textarea value={venteB2BData.criteresAgrement} onChange={(e) => setVenteB2BData({...venteB2BData, criteresAgrement: e.target.value})} placeholder="Comp√©tences techniques, r√©putation, moyens financiers..." /></div>
                        <div><Label>Exigences de pr√©sentation des produits</Label><Textarea value={venteB2BData.exigencesPresentationProduits} onChange={(e) => setVenteB2BData({...venteB2BData, exigencesPresentationProduits: e.target.value})} placeholder="Merchandising, PLV, agencement..." /></div>
                        <div><Label>Qualit√© minimale du point de vente</Label><Input value={venteB2BData.qualiteMinimalePointVente} onChange={(e) => setVenteB2BData({...venteB2BData, qualiteMinimalePointVente: e.target.value})} placeholder="Surface, emplacement, d√©coration..." /></div>
                        <div><Label>Conditions de formation du personnel</Label><Input value={venteB2BData.conditionsFormationPersonnel} onChange={(e) => setVenteB2BData({...venteB2BData, conditionsFormationPersonnel: e.target.value})} placeholder="Formation produits, certification..." /></div>
                        <div>
                          <Label>Interdiction de revente hors r√©seau</Label>
                          <RadioGroup value={venteB2BData.interdictionReventeHorsReseau} onValueChange={(v) => setVenteB2BData({...venteB2BData, interdictionReventeHorsReseau: v})}>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="inter-res-oui" /><Label htmlFor="inter-res-oui">Oui</Label></div>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="inter-res-non" /><Label htmlFor="inter-res-non">Non</Label></div>
                          </RadioGroup>
                        </div>
                      </>
                    )}
                  </div>
                </div>
                
                {/* 8. PROPRI√âT√â INTELLECTUELLE & MARQUE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">8Ô∏è‚É£ Propri√©t√© intellectuelle & Marque</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Droit d'utiliser la marque du fournisseur</Label>
                      <RadioGroup value={venteB2BData.droitUtilisationMarque} onValueChange={(v) => setVenteB2BData({...venteB2BData, droitUtilisationMarque: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="marque-oui" /><Label htmlFor="marque-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="marque-non" /><Label htmlFor="marque-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Conditions d'utilisation des logos / images</Label><Textarea value={venteB2BData.conditionsUtilisationLogos} onChange={(e) => setVenteB2BData({...venteB2BData, conditionsUtilisationLogos: e.target.value})} placeholder="Charte graphique, autorisations pr√©alables..." /></div>
                    <div>
                      <Label>Interdiction de modification des produits</Label>
                      <RadioGroup value={venteB2BData.interdictionModificationProduits} onValueChange={(v) => setVenteB2BData({...venteB2BData, interdictionModificationProduits: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="modif-non" /><Label htmlFor="modif-non">Oui, interdiction</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="modif-oui" /><Label htmlFor="modif-oui">Non, modifications autoris√©es</Label></div>
                      </RadioGroup>
                    </div>
                    <div>
                      <Label>Propri√©taire des documents marketing</Label>
                      <RadioGroup value={venteB2BData.proprietaireDocumentsMarketing} onValueChange={(v) => setVenteB2BData({...venteB2BData, proprietaireDocumentsMarketing: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="fournisseur" id="prop-four" /><Label htmlFor="prop-four">Fournisseur</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="acheteur" id="prop-ach" /><Label htmlFor="prop-ach">Acheteur</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="partage" id="prop-part" /><Label htmlFor="prop-part">Partage</Label></div>
                      </RadioGroup>
                    </div>
                    <div>
                      <Label>Interdiction de d√©p√¥t de marque similaire</Label>
                      <RadioGroup value={venteB2BData.interdictionDepotMarque} onValueChange={(v) => setVenteB2BData({...venteB2BData, interdictionDepotMarque: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="depot-non" /><Label htmlFor="depot-non">Oui, interdiction</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="depot-oui" /><Label htmlFor="depot-oui">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Clause contre la contrefa√ßon</Label><Textarea value={venteB2BData.clauseContreContrefacon} onChange={(e) => setVenteB2BData({...venteB2BData, clauseContreContrefacon: e.target.value})} placeholder="Engagement du distributeur, sanctions..." /></div>
                  </div>
                </div>

                {/* 9. GARANTIES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">9Ô∏è‚É£ Garanties</h4>
                  <div className="space-y-3">
                    <div className="p-3 bg-white rounded border border-blue-100">
                      <h5 className="font-medium text-blue-600 mb-2">A. Garantie l√©gale</h5>
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <input type="checkbox" checked={venteB2BData.garantieLegaleConformite} onChange={(e) => setVenteB2BData({...venteB2BData, garantieLegaleConformite: e.target.checked})} id="gar-conf" className="rounded" />
                          <Label htmlFor="gar-conf" className="font-normal cursor-pointer">Garantie de conformit√©</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <input type="checkbox" checked={venteB2BData.garantieLegaleVicesCaches} onChange={(e) => setVenteB2BData({...venteB2BData, garantieLegaleVicesCaches: e.target.checked})} id="gar-vices" className="rounded" />
                          <Label htmlFor="gar-vices" className="font-normal cursor-pointer">Garantie des vices cach√©s</Label>
                        </div>
                      </div>
                    </div>
                    
                    <div className="p-3 bg-white rounded border border-blue-100">
                      <h5 className="font-medium text-blue-600 mb-2">B. Garantie commerciale</h5>
                      <div className="space-y-2">
                        <div><Label>Dur√©e</Label><Input value={venteB2BData.garantieCommercialeDuree} onChange={(e) => setVenteB2BData({...venteB2BData, garantieCommercialeDuree: e.target.value})} placeholder="Ex: 2 ans" /></div>
                        <div><Label>√âtendue</Label><Input value={venteB2BData.garantieCommercialeEtendue} onChange={(e) => setVenteB2BData({...venteB2BData, garantieCommercialeEtendue: e.target.value})} placeholder="Pi√®ces et main d'≈ìuvre, remplacement..." /></div>
                        <div><Label>Exclusions</Label><Textarea value={venteB2BData.garantieCommercialeExclusions} onChange={(e) => setVenteB2BData({...venteB2BData, garantieCommercialeExclusions: e.target.value})} placeholder="Usure normale, mauvaise utilisation..." /></div>
                      </div>
                    </div>
                    
                    <div className="p-3 bg-white rounded border border-blue-100">
                      <h5 className="font-medium text-blue-600 mb-2">C. Retours</h5>
                      <div className="space-y-2">
                        <div><Label>Conditions de retour</Label><Textarea value={venteB2BData.conditionsRetour} onChange={(e) => setVenteB2BData({...venteB2BData, conditionsRetour: e.target.value})} placeholder="D√©lai, √©tat du produit, emballage..." /></div>
                        <div><Label>Proc√©dure SAV</Label><Textarea value={venteB2BData.procedureSAV} onChange={(e) => setVenteB2BData({...venteB2BData, procedureSAV: e.target.value})} placeholder="Contact, RMA, r√©paration/remplacement..." /></div>
                      </div>
                    </div>
                  </div>
                </div>

                {/* 10. RESPONSABILIT√â */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">üîü Responsabilit√©</h4>
                  <div className="space-y-3">
                    <div><Label>Limitation de responsabilit√© du fournisseur</Label><Textarea value={venteB2BData.limitationResponsabiliteFournisseur} onChange={(e) => setVenteB2BData({...venteB2BData, limitationResponsabiliteFournisseur: e.target.value})} placeholder="Plafond, type de dommages..." /></div>
                    <div>
                      <Label>Exclusion des dommages indirects</Label>
                      <RadioGroup value={venteB2BData.exclusionDommagesIndirects} onValueChange={(v) => setVenteB2BData({...venteB2BData, exclusionDommagesIndirects: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="excl-dom-oui" /><Label htmlFor="excl-dom-oui">Oui, exclusion (perte de CA, manque √† gagner...)</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="excl-dom-non" /><Label htmlFor="excl-dom-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Plafond indemnitaire</Label><Input value={venteB2BData.plafondIndemnitaire} onChange={(e) => setVenteB2BData({...venteB2BData, plafondIndemnitaire: e.target.value})} placeholder="Ex: Montant du contrat sur 12 mois" /></div>
                    <div><Label>Cas de force majeure</Label><Textarea value={venteB2BData.casForceMajeure} onChange={(e) => setVenteB2BData({...venteB2BData, casForceMajeure: e.target.value})} placeholder="√âv√©nements impr√©visibles exon√©rant de responsabilit√©..." /></div>
                    <div><Label>Responsabilit√© du distributeur vis-√†-vis de ses clients</Label><Textarea value={venteB2BData.responsabiliteDistributeurClients} onChange={(e) => setVenteB2BData({...venteB2BData, responsabiliteDistributeurClients: e.target.value})} placeholder="Le distributeur assume la responsabilit√©..." /></div>
                  </div>
                </div>

                {/* 11. NON-CONCURRENCE & CONFIDENTIALIT√â */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£1Ô∏è‚É£ Non-concurrence & Confidentialit√©</h4>
                  <div className="space-y-3">
                    <div className="p-3 bg-white rounded border border-blue-100">
                      <h5 className="font-medium text-blue-600 mb-2">Non-concurrence</h5>
                      <div className="space-y-2">
                        <div>
                          <Label>Interdiction de distribuer des produits concurrents</Label>
                          <RadioGroup value={venteB2BData.interdictionProduitsConcurrents} onValueChange={(v) => setVenteB2BData({...venteB2BData, interdictionProduitsConcurrents: v})}>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="non-conc-oui" /><Label htmlFor="non-conc-oui">Oui</Label></div>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="non-conc-non" /><Label htmlFor="non-conc-non">Non</Label></div>
                          </RadioGroup>
                        </div>
                        {venteB2BData.interdictionProduitsConcurrents === "oui" && (
                          <>
                            <div><Label>Dur√©e</Label><Input value={venteB2BData.dureeNonConcurrence} onChange={(e) => setVenteB2BData({...venteB2BData, dureeNonConcurrence: e.target.value})} placeholder="Ex: Pendant la dur√©e du contrat + 1 an" /></div>
                            <div><Label>Sanctions</Label><Input value={venteB2BData.sanctionsNonConcurrence} onChange={(e) => setVenteB2BData({...venteB2BData, sanctionsNonConcurrence: e.target.value})} placeholder="R√©siliation, p√©nalit√©..." /></div>
                          </>
                        )}
                      </div>
                    </div>
                    
                    <div className="p-3 bg-white rounded border border-blue-100">
                      <h5 className="font-medium text-blue-600 mb-2">Confidentialit√©</h5>
                      <div className="space-y-2">
                        <div><Label>Dur√©e de confidentialit√©</Label><Input value={venteB2BData.confidentialiteDuree} onChange={(e) => setVenteB2BData({...venteB2BData, confidentialiteDuree: e.target.value})} placeholder="Ex: 5 ans apr√®s fin du contrat" /></div>
                        <div><Label>Nature des informations confidentielles</Label><Textarea value={venteB2BData.natureInformationsConfidentielles} onChange={(e) => setVenteB2BData({...venteB2BData, natureInformationsConfidentielles: e.target.value})} placeholder="Prix, techniques, strat√©gies commerciales..." /></div>
                      </div>
                    </div>
                  </div>
                </div>
                
                {/* 12. DUR√âE & R√âSILIATION */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£2Ô∏è‚É£ Dur√©e & R√©siliation</h4>
                  <div className="space-y-3">
                    <div className="p-3 bg-white rounded border border-blue-100">
                      <h5 className="font-medium text-blue-600 mb-2">Dur√©e du contrat</h5>
                      <div className="space-y-2">
                        <div><Label>Date d'entr√©e en vigueur *</Label><Input type="date" value={venteB2BData.dateEntreeVigueur} onChange={(e) => setVenteB2BData({...venteB2BData, dateEntreeVigueur: e.target.value})} /></div>
                        <div>
                          <Label>Type de dur√©e *</Label>
                          <RadioGroup value={venteB2BData.dureeContrat} onValueChange={(v) => setVenteB2BData({...venteB2BData, dureeContrat: v})}>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="determinee" id="duree-det" /><Label htmlFor="duree-det">Dur√©e d√©termin√©e</Label></div>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="indeterminee" id="duree-ind" /><Label htmlFor="duree-ind">Dur√©e ind√©termin√©e</Label></div>
                          </RadioGroup>
                        </div>
                        {venteB2BData.dureeContrat === "determinee" && (
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div><Label>Date de d√©but</Label><Input type="date" value={venteB2BData.dateDebutContrat} onChange={(e) => setVenteB2BData({...venteB2BData, dateDebutContrat: e.target.value})} /></div>
                            <div><Label>Date de fin</Label><Input type="date" value={venteB2BData.dateFinContrat} onChange={(e) => setVenteB2BData({...venteB2BData, dateFinContrat: e.target.value})} /></div>
                          </div>
                        )}
                        <div>
                          <Label>Reconduction tacite ?</Label>
                          <RadioGroup value={venteB2BData.reconductionTacite} onValueChange={(v) => setVenteB2BData({...venteB2BData, reconductionTacite: v})}>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="recon-oui" /><Label htmlFor="recon-oui">Oui</Label></div>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="recon-non" /><Label htmlFor="recon-non">Non</Label></div>
                          </RadioGroup>
                        </div>
                      </div>
                    </div>
                    
                    <div className="p-3 bg-white rounded border border-blue-100">
                      <h5 className="font-medium text-blue-600 mb-2">R√©siliation</h5>
                      <div className="space-y-2">
                        <div><Label>Pr√©avis de r√©siliation</Label><Input value={venteB2BData.preavisResiliation} onChange={(e) => setVenteB2BData({...venteB2BData, preavisResiliation: e.target.value})} placeholder="Ex: 3 mois, 90 jours..." /></div>
                        <div><Label>R√©siliation imm√©diate en cas de</Label><Textarea value={venteB2BData.resiliationImmediateMotifs} onChange={(e) => setVenteB2BData({...venteB2BData, resiliationImmediateMotifs: e.target.value})} placeholder="Impay√©s, atteinte √† l'image, non-respect des objectifs, violation des obligations..." /></div>
                        
                        <div className="mt-3">
                          <Label className="font-medium">Fautes graves qualifi√©es</Label>
                          <div className="space-y-2 mt-2">
                            <div className="flex items-center space-x-2"><Checkbox checked={venteB2BData.fautesGravesDefautPaiement} onCheckedChange={(v) => setVenteB2BData({...venteB2BData, fautesGravesDefautPaiement: !!v})} id="fg-paiement" /><Label htmlFor="fg-paiement" className="font-normal">D√©faut de paiement</Label></div>
                            <div className="flex items-center space-x-2"><Checkbox checked={venteB2BData.fautesGravesAtteintemarque} onCheckedChange={(v) => setVenteB2BData({...venteB2BData, fautesGravesAtteintemarque: !!v})} id="fg-marque" /><Label htmlFor="fg-marque" className="font-normal">Atteinte √† la marque</Label></div>
                            <div className="flex items-center space-x-2"><Checkbox checked={venteB2BData.fautesGravesNonRespectExclusivite} onCheckedChange={(v) => setVenteB2BData({...venteB2BData, fautesGravesNonRespectExclusivite: !!v})} id="fg-exclu" /><Label htmlFor="fg-exclu" className="font-normal">Non-respect exclusivit√© / territoire</Label></div>
                            <div className="flex items-center space-x-2"><Checkbox checked={venteB2BData.fautesGravesViolationPI} onCheckedChange={(v) => setVenteB2BData({...venteB2BData, fautesGravesViolationPI: !!v})} id="fg-pi" /><Label htmlFor="fg-pi" className="font-normal">Violation PI ou confidentialit√©</Label></div>
                          </div>
                        </div>
                        
                        <div className="mt-3">
                          <Label>Indemnit√© de fin de contrat (distribution)</Label>
                          <RadioGroup value={venteB2BData.indemniteFinContrat} onValueChange={(v) => setVenteB2BData({...venteB2BData, indemniteFinContrat: v})}>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="ifc-oui" /><Label htmlFor="ifc-oui">Oui</Label></div>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="ifc-non" /><Label htmlFor="ifc-non">Non</Label></div>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="exclusion" id="ifc-excl" /><Label htmlFor="ifc-excl">Exclusion expresse</Label></div>
                          </RadioGroup>
                          {venteB2BData.indemniteFinContrat === "oui" && (
                            <Input value={venteB2BData.montantIndemniteFinContrat} onChange={(e) => setVenteB2BData({...venteB2BData, montantIndemniteFinContrat: e.target.value})} placeholder="Montant ou formule de calcul" className="mt-2" />
                          )}
                        </div>
                        
                        <div><Label>Effets de la r√©siliation</Label><Textarea value={venteB2BData.effetsResiliation} onChange={(e) => setVenteB2BData({...venteB2BData, effetsResiliation: e.target.value})} placeholder="Derni√®res commandes, restitution mat√©riels, arr√™t marque, stocks..." /></div>
                      </div>
                    </div>
                  </div>
                </div>

                {/* 13. CLAUSES SP√âCIFIQUES B2B */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£3Ô∏è‚É£ Clauses sp√©cifiques B2B</h4>
                  <div className="space-y-4">
                    {/* R√©serve de propri√©t√© */}
                    <div className="p-3 bg-white rounded border border-blue-100">
                      <h5 className="font-medium text-blue-600 mb-2">üîí Clause de r√©serve de propri√©t√©</h5>
                      <div className="space-y-2">
                        <div>
                          <Label>Les produits restent la propri√©t√© du fournisseur jusqu'au paiement int√©gral ?</Label>
                          <RadioGroup value={venteB2BData.reservePropriete} onValueChange={(v) => setVenteB2BData({...venteB2BData, reservePropriete: v})}>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="rp-oui" /><Label htmlFor="rp-oui">Oui</Label></div>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="rp-non" /><Label htmlFor="rp-non">Non</Label></div>
                          </RadioGroup>
                        </div>
                        {venteB2BData.reservePropriete === "oui" && (
                          <div><Label>Pr√©cisions sur la r√©serve de propri√©t√©</Label><Textarea value={venteB2BData.reserveProprietePrecisions} onChange={(e) => setVenteB2BData({...venteB2BData, reserveProprietePrecisions: e.target.value})} placeholder="Transfert de propri√©t√©, risques, revendication en cas d'impay√©..." /></div>
                        )}
                      </div>
                    </div>
                    
                    {/* Non-sollicitation */}
                    <div className="p-3 bg-white rounded border border-blue-100">
                      <h5 className="font-medium text-blue-600 mb-2">üö´ Clause de non-sollicitation / non-d√©bauchage</h5>
                      <div className="space-y-2">
                        <div>
                          <Label>Interdiction de d√©baucher salari√©s / agents</Label>
                          <RadioGroup value={venteB2BData.nonSollicitationSalaries} onValueChange={(v) => setVenteB2BData({...venteB2BData, nonSollicitationSalaries: v})}>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="ns-oui" /><Label htmlFor="ns-oui">Oui</Label></div>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="ns-non" /><Label htmlFor="ns-non">Non</Label></div>
                          </RadioGroup>
                        </div>
                        {venteB2BData.nonSollicitationSalaries === "oui" && (
                          <>
                            <div><Label>Dur√©e de l'interdiction</Label><Input value={venteB2BData.dureeNonSollicitation} onChange={(e) => setVenteB2BData({...venteB2BData, dureeNonSollicitation: e.target.value})} placeholder="Ex: 2 ans apr√®s fin du contrat" /></div>
                            <div><Label>P√©nalit√© en cas de violation</Label><Input value={venteB2BData.penaliteNonSollicitation} onChange={(e) => setVenteB2BData({...venteB2BData, penaliteNonSollicitation: e.target.value})} placeholder="Montant ou formule" /></div>
                          </>
                        )}
                      </div>
                    </div>
                    
                    {/* Cession du contrat */}
                    <div className="p-3 bg-white rounded border border-blue-100">
                      <h5 className="font-medium text-blue-600 mb-2">üìã Clause de cession du contrat</h5>
                      <div className="space-y-2">
                        <div>
                          <Label>Cession du contrat autoris√©e ?</Label>
                          <RadioGroup value={venteB2BData.cessionContratAutorisee} onValueChange={(v) => setVenteB2BData({...venteB2BData, cessionContratAutorisee: v})}>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="cc-oui" /><Label htmlFor="cc-oui">Oui</Label></div>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="cc-non" /><Label htmlFor="cc-non">Non (interdite)</Label></div>
                          </RadioGroup>
                        </div>
                        {venteB2BData.cessionContratAutorisee === "oui" && (
                          <div>
                            <Label>Accord pr√©alable requis ?</Label>
                            <RadioGroup value={venteB2BData.cessionContratAccordPrealable} onValueChange={(v) => setVenteB2BData({...venteB2BData, cessionContratAccordPrealable: v})}>
                              <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="cca-oui" /><Label htmlFor="cca-oui">Oui</Label></div>
                              <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="cca-non" /><Label htmlFor="cca-non">Non (libre)</Label></div>
                            </RadioGroup>
                          </div>
                        )}
                      </div>
                    </div>
                    
                    {/* Clause de survie */}
                    <div className="p-3 bg-white rounded border border-blue-100">
                      <h5 className="font-medium text-blue-600 mb-2">‚è∞ Clause de survie (apr√®s r√©siliation)</h5>
                      <div className="space-y-2">
                        <Label className="font-medium">Les clauses suivantes survivent √† la fin du contrat :</Label>
                        <div className="space-y-2 mt-2">
                          <div className="flex items-center space-x-2"><Checkbox checked={venteB2BData.clausesSurvieConfidentialite} onCheckedChange={(v) => setVenteB2BData({...venteB2BData, clausesSurvieConfidentialite: !!v})} id="cs-conf" /><Label htmlFor="cs-conf" className="font-normal">Confidentialit√©</Label></div>
                          <div className="flex items-center space-x-2"><Checkbox checked={venteB2BData.clausesSurviePI} onCheckedChange={(v) => setVenteB2BData({...venteB2BData, clausesSurviePI: !!v})} id="cs-pi" /><Label htmlFor="cs-pi" className="font-normal">Propri√©t√© intellectuelle</Label></div>
                          <div className="flex items-center space-x-2"><Checkbox checked={venteB2BData.clausesSurvieResponsabilite} onCheckedChange={(v) => setVenteB2BData({...venteB2BData, clausesSurvieResponsabilite: !!v})} id="cs-resp" /><Label htmlFor="cs-resp" className="font-normal">Responsabilit√©</Label></div>
                          <div className="flex items-center space-x-2"><Checkbox checked={venteB2BData.clausesSurvieNonConcurrence} onCheckedChange={(v) => setVenteB2BData({...venteB2BData, clausesSurvieNonConcurrence: !!v})} id="cs-nc" /><Label htmlFor="cs-nc" className="font-normal">Non-concurrence</Label></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                {/* 13. CLAUSES SP√âCIFIQUES B2B */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£3Ô∏è‚É£ Clauses sp√©cifiques B2B</h4>
                  <div className="space-y-4">
                    {/* R√©serve de propri√©t√© */}
                    <div className="p-3 bg-white rounded border border-blue-100">
                      <h5 className="font-medium text-blue-600 mb-2">üîí Clause de r√©serve de propri√©t√©</h5>
                      <div className="space-y-2">
                        <div>
                          <Label>Les produits restent la propri√©t√© du fournisseur jusqu'au paiement int√©gral ?</Label>
                          <RadioGroup value={venteB2BData.reservePropriete} onValueChange={(v) => setVenteB2BData({...venteB2BData, reservePropriete: v})}>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="rp-oui" /><Label htmlFor="rp-oui">Oui</Label></div>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="rp-non" /><Label htmlFor="rp-non">Non</Label></div>
                          </RadioGroup>
                        </div>
                        {venteB2BData.reservePropriete === "oui" && (
                          <div><Label>Pr√©cisions sur la r√©serve de propri√©t√©</Label><Textarea value={venteB2BData.reserveProprietePrecisions} onChange={(e) => setVenteB2BData({...venteB2BData, reserveProprietePrecisions: e.target.value})} placeholder="Transfert de propri√©t√©, risques, revendication en cas d'impay√©..." /></div>
                        )}
                      </div>
                    </div>
                    
                    {/* Non-sollicitation */}
                    <div className="p-3 bg-white rounded border border-blue-100">
                      <h5 className="font-medium text-blue-600 mb-2">üö´ Clause de non-sollicitation / non-d√©bauchage</h5>
                      <div className="space-y-2">
                        <div>
                          <Label>Interdiction de d√©baucher salari√©s / agents</Label>
                          <RadioGroup value={venteB2BData.nonSollicitationSalaries} onValueChange={(v) => setVenteB2BData({...venteB2BData, nonSollicitationSalaries: v})}>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="ns-oui" /><Label htmlFor="ns-oui">Oui</Label></div>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="ns-non" /><Label htmlFor="ns-non">Non</Label></div>
                          </RadioGroup>
                        </div>
                        {venteB2BData.nonSollicitationSalaries === "oui" && (
                          <>
                            <div><Label>Dur√©e de l'interdiction</Label><Input value={venteB2BData.dureeNonSollicitation} onChange={(e) => setVenteB2BData({...venteB2BData, dureeNonSollicitation: e.target.value})} placeholder="Ex: 2 ans apr√®s fin du contrat" /></div>
                            <div><Label>P√©nalit√© en cas de violation</Label><Input value={venteB2BData.penaliteNonSollicitation} onChange={(e) => setVenteB2BData({...venteB2BData, penaliteNonSollicitation: e.target.value})} placeholder="Montant ou formule" /></div>
                          </>
                        )}
                      </div>
                    </div>
                    
                    {/* Cession du contrat */}
                    <div className="p-3 bg-white rounded border border-blue-100">
                      <h5 className="font-medium text-blue-600 mb-2">üìã Clause de cession du contrat</h5>
                      <div className="space-y-2">
                        <div>
                          <Label>Cession du contrat autoris√©e ?</Label>
                          <RadioGroup value={venteB2BData.cessionContratAutorisee} onValueChange={(v) => setVenteB2BData({...venteB2BData, cessionContratAutorisee: v})}>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="cc-oui" /><Label htmlFor="cc-oui">Oui</Label></div>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="cc-non" /><Label htmlFor="cc-non">Non (interdite)</Label></div>
                          </RadioGroup>
                        </div>
                        {venteB2BData.cessionContratAutorisee === "oui" && (
                          <div>
                            <Label>Accord pr√©alable requis ?</Label>
                            <RadioGroup value={venteB2BData.cessionContratAccordPrealable} onValueChange={(v) => setVenteB2BData({...venteB2BData, cessionContratAccordPrealable: v})}>
                              <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="cca-oui" /><Label htmlFor="cca-oui">Oui</Label></div>
                              <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="cca-non" /><Label htmlFor="cca-non">Non (libre)</Label></div>
                            </RadioGroup>
                          </div>
                        )}
                      </div>
                    </div>
                    
                    {/* Clause de survie */}
                    <div className="p-3 bg-white rounded border border-blue-100">
                      <h5 className="font-medium text-blue-600 mb-2">‚è∞ Clause de survie (apr√®s r√©siliation)</h5>
                      <div className="space-y-2">
                        <Label className="font-medium">Les clauses suivantes survivent √† la fin du contrat :</Label>
                        <div className="space-y-2 mt-2">
                          <div className="flex items-center space-x-2"><Checkbox checked={venteB2BData.clausesSurvieConfidentialite} onCheckedChange={(v) => setVenteB2BData({...venteB2BData, clausesSurvieConfidentialite: !!v})} id="cs-conf" /><Label htmlFor="cs-conf" className="font-normal">Confidentialit√©</Label></div>
                          <div className="flex items-center space-x-2"><Checkbox checked={venteB2BData.clausesSurviePI} onCheckedChange={(v) => setVenteB2BData({...venteB2BData, clausesSurviePI: !!v})} id="cs-pi" /><Label htmlFor="cs-pi" className="font-normal">Propri√©t√© intellectuelle</Label></div>
                          <div className="flex items-center space-x-2"><Checkbox checked={venteB2BData.clausesSurvieResponsabilite} onCheckedChange={(v) => setVenteB2BData({...venteB2BData, clausesSurvieResponsabilite: !!v})} id="cs-resp" /><Label htmlFor="cs-resp" className="font-normal">Responsabilit√©</Label></div>
                          <div className="flex items-center space-x-2"><Checkbox checked={venteB2BData.clausesSurvieNonConcurrence} onCheckedChange={(v) => setVenteB2BData({...venteB2BData, clausesSurvieNonConcurrence: !!v})} id="cs-nc" /><Label htmlFor="cs-nc" className="font-normal">Non-concurrence</Label></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                {/* 14. COMPLIANCE / DROIT APPLICABLE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£4Ô∏è‚É£ Compliance / Droit applicable</h4>
                  <div className="space-y-3">
                    <div><Label>Loi applicable</Label><Input value={venteB2BData.loiApplicable} onChange={(e) => setVenteB2BData({...venteB2BData, loiApplicable: e.target.value})} placeholder="France" /></div>
                    <div><Label>Tribunal comp√©tent</Label><Input value={venteB2BData.tribunalCompetent} onChange={(e) => setVenteB2BData({...venteB2BData, tribunalCompetent: e.target.value})} placeholder="Ex: Tribunal de Commerce de Paris" /></div>
                    <div>
                      <Label>Clause de m√©diation</Label>
                      <RadioGroup value={venteB2BData.clauseMediation} onValueChange={(v) => setVenteB2BData({...venteB2BData, clauseMediation: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="med-b2b-oui" /><Label htmlFor="med-b2b-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="med-b2b-non" /><Label htmlFor="med-b2b-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div>
                      <Label>Clause anti-corruption (Sapin II)</Label>
                      <RadioGroup value={venteB2BData.clauseAntiCorruption} onValueChange={(v) => setVenteB2BData({...venteB2BData, clauseAntiCorruption: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="sapin-oui" /><Label htmlFor="sapin-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="sapin-non" /><Label htmlFor="sapin-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div>
                      <Label>Clause RGPD (si donn√©es personnelles)</Label>
                      <RadioGroup value={venteB2BData.clauseRGPD} onValueChange={(v) => setVenteB2BData({...venteB2BData, clauseRGPD: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="rgpd-b2b-oui" /><Label htmlFor="rgpd-b2b-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="rgpd-b2b-non" /><Label htmlFor="rgpd-b2b-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Clause de conformit√© export / import</Label><Textarea value={venteB2BData.clauseConformiteExportImport} onChange={(e) => setVenteB2BData({...venteB2BData, clauseConformiteExportImport: e.target.value})} placeholder="Douanes, licences, embargos..." /></div>
                  </div>
                </div>

                {/* 15. ANNEXES ET PI√àCES JUSTIFICATIVES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£5Ô∏è‚É£ Annexes et pi√®ces justificatives</h4>
                  <MultiFileUpload 
                    label="Annexes (CGV B2B, grilles tarifaires, guides marketing, fiches techniques, cahier des charges, objectifs, proc√©dures SAV, chartes qualit√©...)" 
                    files={venteB2BAnnexesFiles} 
                    onFilesChange={setVenteB2BAnnexesFiles} 
                    accept=".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png"
                    role="avocat"
                  />
                </div>
              </div>
            )}



            {/* Formulaire complet pour Conditions G√©n√©rales de Vente (CGV) */}
            {pendingContractType === "Conditions G√©n√©rales de Vente (CGV)" && (
              <div className="space-y-6">
                <h3 className="font-semibold text-xl border-b-2 border-blue-300 pb-2 text-blue-700">üìã Conditions G√©n√©rales de Vente (CGV)</h3>
                
                {/* 1. IDENTIFICATION DU VENDEUR */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£ Identification du vendeur</h4>
                  <div className="space-y-3">
                    <ClientSelector 
                      clients={clients} 
                      selectedClientId={cgvVendeurClientId} 
                      onClientChange={(clientId) => {
                        setCgvVendeurClientId(clientId);
                        const client = clients.find(c => c.id === clientId);
                        if (client) {
                          setCgvData({
                            ...cgvData,
                            vendeurDenomination: `${client.prenom} ${client.nom}`,
                            vendeurAdresseSiege: client.adresse || "",
                            vendeurEmail: client.email || "",
                            vendeurTelephone: client.telephone || ""
                          });
                        }
                      }} 
                      label="S√©lectionner un client comme vendeur" 
                    />
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                      <div><Label>D√©nomination sociale / Nom *</Label><Input value={cgvData.vendeurDenomination} onChange={(e) => setCgvData({...cgvData, vendeurDenomination: e.target.value})} /></div>
                      <div><Label>Forme juridique</Label><Input value={cgvData.vendeurFormeJuridique} onChange={(e) => setCgvData({...cgvData, vendeurFormeJuridique: e.target.value})} placeholder="SARL, SAS, SASU, EI..." /></div>
                      <div><Label>Capital social</Label><Input value={cgvData.vendeurCapitalSocial} onChange={(e) => setCgvData({...cgvData, vendeurCapitalSocial: e.target.value})} placeholder="Ex: 10 000‚Ç¨" /></div>
                      <div><Label>SIREN</Label><Input value={cgvData.vendeurSIREN} onChange={(e) => setCgvData({...cgvData, vendeurSIREN: e.target.value})} placeholder="123 456 789" /></div>
                      <div><Label>RCS</Label><Input value={cgvData.vendeurRCS} onChange={(e) => setCgvData({...cgvData, vendeurRCS: e.target.value})} placeholder="RCS Ville" /></div>
                      <div><Label>TVA intracommunautaire</Label><Input value={cgvData.vendeurTVAIntracommunautaire} onChange={(e) => setCgvData({...cgvData, vendeurTVAIntracommunautaire: e.target.value})} placeholder="FR12345678901" /></div>
                    </div>
                    <div><Label>Adresse du si√®ge social *</Label><Input value={cgvData.vendeurAdresseSiege} onChange={(e) => setCgvData({...cgvData, vendeurAdresseSiege: e.target.value})} /></div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                      <div><Label>Email *</Label><Input type="email" value={cgvData.vendeurEmail} onChange={(e) => setCgvData({...cgvData, vendeurEmail: e.target.value})} /></div>
                      <div><Label>T√©l√©phone</Label><Input value={cgvData.vendeurTelephone} onChange={(e) => setCgvData({...cgvData, vendeurTelephone: e.target.value})} /></div>
                      <div><Label>Nom du responsable l√©gal</Label><Input value={cgvData.vendeurResponsableLegal} onChange={(e) => setCgvData({...cgvData, vendeurResponsableLegal: e.target.value})} /></div>
                    </div>
                    <div>
                      <Label>Profession r√©glement√©e ?</Label>
                      <RadioGroup value={cgvData.vendeurProfessionReglementee} onValueChange={(v) => setCgvData({...cgvData, vendeurProfessionReglementee: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="prof-oui" /><Label htmlFor="prof-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="prof-non" /><Label htmlFor="prof-non">Non</Label></div>
                      </RadioGroup>
                      {cgvData.vendeurProfessionReglementee === "oui" && (
                        <Input value={cgvData.vendeurPrecisionProfession} onChange={(e) => setCgvData({...cgvData, vendeurPrecisionProfession: e.target.value})} placeholder="Pr√©cisez la profession et l'organisme" className="mt-2" />
                      )}
                    </div>
                    <div>
                      <Label>Assurance professionnelle</Label>
                      <RadioGroup value={cgvData.vendeurAssurancePro} onValueChange={(v) => setCgvData({...cgvData, vendeurAssurancePro: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="ass-oui" /><Label htmlFor="ass-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="ass-non" /><Label htmlFor="ass-non">Non</Label></div>
                      </RadioGroup>
                      {cgvData.vendeurAssurancePro === "oui" && (
                        <Input value={cgvData.vendeurNumeroAssurance} onChange={(e) => setCgvData({...cgvData, vendeurNumeroAssurance: e.target.value})} placeholder="Num√©ro de police d'assurance" className="mt-2" />
                      )}
                    </div>
                    
                    <MultiFileUpload label="Pi√®ces justificatives vendeur (Kbis, mentions l√©gales, RC Pro)" files={cgvVendeurFiles} onFilesChange={setCgvVendeurFiles} accept=".pdf,.jpg,.jpeg,.png" role="avocat" />
                  </div>
                </div>
                
                {/* 2. CHAMP D'APPLICATION */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">2Ô∏è‚É£ Champ d'application des CGV</h4>
                  <div className="space-y-3">
                    <div><Label>Types de produits / services vendus *</Label><Textarea value={cgvData.typesProduitsServices} onChange={(e) => setCgvData({...cgvData, typesProduitsServices: e.target.value})} placeholder="D√©crivez les produits et services couverts par ces CGV..." className="min-h-[80px]" /></div>
                    <div>
                      <Label className="font-medium">Types de clients concern√©s</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={cgvData.typesClients.includes("B2C")} onCheckedChange={(v) => setCgvData({...cgvData, typesClients: v ? [...cgvData.typesClients, "B2C"] : cgvData.typesClients.filter(t => t !== "B2C")})} id="client-b2c" /><Label htmlFor="client-b2c" className="font-normal">B2C (consommateurs)</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cgvData.typesClients.includes("B2B")} onCheckedChange={(v) => setCgvData({...cgvData, typesClients: v ? [...cgvData.typesClients, "B2B"] : cgvData.typesClients.filter(t => t !== "B2B")})} id="client-b2b" /><Label htmlFor="client-b2b" className="font-normal">B2B (professionnels)</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cgvData.typesClients.includes("mixte")} onCheckedChange={(v) => setCgvData({...cgvData, typesClients: v ? [...cgvData.typesClients, "mixte"] : cgvData.typesClients.filter(t => t !== "mixte")})} id="client-mixte" /><Label htmlFor="client-mixte" className="font-normal">Mixte (professionnels & consommateurs)</Label></div>
                      </div>
                    </div>
                    <div>
                      <Label className="font-medium">Canaux de vente</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={cgvData.canalVente.includes("e-commerce")} onCheckedChange={(v) => setCgvData({...cgvData, canalVente: v ? [...cgvData.canalVente, "e-commerce"] : cgvData.canalVente.filter(c => c !== "e-commerce")})} id="canal-ecom" /><Label htmlFor="canal-ecom" className="font-normal">Site e-commerce</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cgvData.canalVente.includes("physique")} onCheckedChange={(v) => setCgvData({...cgvData, canalVente: v ? [...cgvData.canalVente, "physique"] : cgvData.canalVente.filter(c => c !== "physique")})} id="canal-phys" /><Label htmlFor="canal-phys" className="font-normal">Vente physique</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cgvData.canalVente.includes("marketplace")} onCheckedChange={(v) => setCgvData({...cgvData, canalVente: v ? [...cgvData.canalVente, "marketplace"] : cgvData.canalVente.filter(c => c !== "marketplace")})} id="canal-market" /><Label htmlFor="canal-market" className="font-normal">Marketplace</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cgvData.canalVente.includes("contrat-cadre")} onCheckedChange={(v) => setCgvData({...cgvData, canalVente: v ? [...cgvData.canalVente, "contrat-cadre"] : cgvData.canalVente.filter(c => c !== "contrat-cadre")})} id="canal-cadre" /><Label htmlFor="canal-cadre" className="font-normal">Contrat cadre + CGV annex√©es</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cgvData.canalVente.includes("autre")} onCheckedChange={(v) => setCgvData({...cgvData, canalVente: v ? [...cgvData.canalVente, "autre"] : cgvData.canalVente.filter(c => c !== "autre")})} id="canal-autre" /><Label htmlFor="canal-autre" className="font-normal">Autre</Label></div>
                      </div>
                      {cgvData.canalVente.includes("autre") && (
                        <Input value={cgvData.canalAutrePrecision} onChange={(e) => setCgvData({...cgvData, canalAutrePrecision: e.target.value})} placeholder="Pr√©cisez" className="mt-2" />
                      )}
                    </div>
                  </div>
                </div>
                
                {/* 3. D√âFINITIONS */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">3Ô∏è‚É£ D√©finitions indispensables</h4>
                  <p className="text-sm text-gray-600">D√©finissez les termes cl√©s utilis√©s dans vos CGV</p>
                  <div className="space-y-3">
                    <div><Label>Produit</Label><Textarea value={cgvData.definitionProduit} onChange={(e) => setCgvData({...cgvData, definitionProduit: e.target.value})} placeholder="Ex: D√©signe tout bien meuble propos√© √† la vente..." className="min-h-[60px]" /></div>
                    <div><Label>Service</Label><Textarea value={cgvData.definitionService} onChange={(e) => setCgvData({...cgvData, definitionService: e.target.value})} placeholder="Ex: D√©signe toute prestation fournie par le vendeur..." className="min-h-[60px]" /></div>
                    <div><Label>Client</Label><Textarea value={cgvData.definitionClient} onChange={(e) => setCgvData({...cgvData, definitionClient: e.target.value})} placeholder="Ex: D√©signe toute personne physique ou morale proc√©dant √† un achat..." className="min-h-[60px]" /></div>
                    <div><Label>Commande</Label><Textarea value={cgvData.definitionCommande} onChange={(e) => setCgvData({...cgvData, definitionCommande: e.target.value})} placeholder="Ex: D√©signe tout ordre d'achat de produits ou services..." className="min-h-[60px]" /></div>
                    <div><Label>Compte utilisateur</Label><Textarea value={cgvData.definitionCompteUtilisateur} onChange={(e) => setCgvData({...cgvData, definitionCompteUtilisateur: e.target.value})} placeholder="Ex: Espace personnel cr√©√© par le client..." className="min-h-[60px]" /></div>
                    <div><Label>Livraison</Label><Textarea value={cgvData.definitionLivraison} onChange={(e) => setCgvData({...cgvData, definitionLivraison: e.target.value})} placeholder="Ex: D√©signe le transfert physique des produits..." className="min-h-[60px]" /></div>
                    <div><Label>Abonnement</Label><Textarea value={cgvData.definitionAbonnement} onChange={(e) => setCgvData({...cgvData, definitionAbonnement: e.target.value})} placeholder="Ex: Formule de paiement r√©current..." className="min-h-[60px]" /></div>
                    <div><Label>Prix</Label><Textarea value={cgvData.definitionPrix} onChange={(e) => setCgvData({...cgvData, definitionPrix: e.target.value})} placeholder="Ex: Montant d√ª par le client en contrepartie..." className="min-h-[60px]" /></div>
                    <div><Label>Force majeure</Label><Textarea value={cgvData.definitionForceMajeure} onChange={(e) => setCgvData({...cgvData, definitionForceMajeure: e.target.value})} placeholder="Ex: Tout √©v√©nement ext√©rieur, impr√©visible et irr√©sistible..." className="min-h-[60px]" /></div>
                    <div><Label>Contrat</Label><Textarea value={cgvData.definitionContrat} onChange={(e) => setCgvData({...cgvData, definitionContrat: e.target.value})} placeholder="Ex: D√©signe l'ensemble form√© par les pr√©sentes CGV et la commande..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 4. CARACT√âRISTIQUES DES PRODUITS/SERVICES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">4Ô∏è‚É£ Caract√©ristiques des produits / services</h4>
                  <div className="space-y-3">
                    <div><Label>Description pr√©cise des produits/services *</Label><Textarea value={cgvData.descriptionProduits} onChange={(e) => setCgvData({...cgvData, descriptionProduits: e.target.value})} placeholder="D√©crivez pr√©cis√©ment les caract√©ristiques, sp√©cifications, qualit√©s..." className="min-h-[100px]" /></div>
                    <div>
                      <Label>Visuels / Photos / Maquettes disponibles</Label>
                      <RadioGroup value={cgvData.visuelsDisponibles} onValueChange={(v) => setCgvData({...cgvData, visuelsDisponibles: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="vis-oui" /><Label htmlFor="vis-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="vis-non" /><Label htmlFor="vis-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Sp√©cifications techniques</Label><Textarea value={cgvData.specificationstechniques} onChange={(e) => setCgvData({...cgvData, specificationstechniques: e.target.value})} placeholder="Dimensions, poids, mat√©riaux, compatibilit√©s, performances..." className="min-h-[80px]" /></div>
                    <div><Label>Disponibilit√©s</Label><Input value={cgvData.disponibilites} onChange={(e) => setCgvData({...cgvData, disponibilites: e.target.value})} placeholder="Ex: En stock, sur devis, sur mesure, d√©lai de fabrication..." /></div>
                    <div><Label>Restrictions d'usage</Label><Textarea value={cgvData.restrictionsUsage} onChange={(e) => setCgvData({...cgvData, restrictionsUsage: e.target.value})} placeholder="Interdictions, limitations, pr√©cautions d'emploi..." className="min-h-[60px]" /></div>
                    <div><Label>Conditions pr√©alables d'utilisation</Label><Textarea value={cgvData.conditionsPrealables} onChange={(e) => setCgvData({...cgvData, conditionsPrealables: e.target.value})} placeholder="Pr√©requis techniques, comp√©tences n√©cessaires, √©quipements requis..." className="min-h-[60px]" /></div>
                    
                    <MultiFileUpload label="Fiches techniques, certificats produits" files={cgvProduitsFiles} onFilesChange={setCgvProduitsFiles} accept=".pdf,.jpg,.jpeg,.png" role="avocat" />
                  </div>
                </div>
                
                {/* 5. PROCESSUS DE COMMANDE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">5Ô∏è‚É£ Processus de commande</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Cr√©ation d'un compte client obligatoire ?</Label>
                      <RadioGroup value={cgvData.creationCompteObligatoire} onValueChange={(v) => setCgvData({...cgvData, creationCompteObligatoire: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="compte-oui" /><Label htmlFor="compte-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="compte-non" /><Label htmlFor="compte-non">Non (achat invit√© possible)</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>√âtapes de commande</Label><Textarea value={cgvData.etapesCommande} onChange={(e) => setCgvData({...cgvData, etapesCommande: e.target.value})} placeholder="Ex: 1. Ajout au panier, 2. Identification, 3. Adresse livraison, 4. Mode de paiement, 5. Validation..." className="min-h-[80px]" /></div>
                    <div className="flex items-center space-x-2">
                      <Checkbox checked={cgvData.validationDoubleClick} onCheckedChange={(v) => setCgvData({...cgvData, validationDoubleClick: !!v})} id="double-click" />
                      <Label htmlFor="double-click" className="font-normal">Validation du double-clic (obligatoire e-commerce) ‚úÖ</Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox checked={cgvData.confirmationEmail} onCheckedChange={(v) => setCgvData({...cgvData, confirmationEmail: !!v})} id="confirm-email" />
                      <Label htmlFor="confirm-email" className="font-normal">Confirmation par email ‚úÖ</Label>
                    </div>
                    <div>
                      <Label>Annulation possible avant exp√©dition ?</Label>
                      <RadioGroup value={cgvData.annulationAvantExpedition} onValueChange={(v) => setCgvData({...cgvData, annulationAvantExpedition: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="annul-oui" /><Label htmlFor="annul-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="annul-non" /><Label htmlFor="annul-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div>
                      <Label>Commandes sur devis uniquement ?</Label>
                      <RadioGroup value={cgvData.commandesSurDevis} onValueChange={(v) => setCgvData({...cgvData, commandesSurDevis: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="devis-oui" /><Label htmlFor="devis-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="devis-non" /><Label htmlFor="devis-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                  </div>
                </div>
                
                {/* 6. PRIX */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">6Ô∏è‚É£ Prix</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Prix affich√©s *</Label>
                      <RadioGroup value={cgvData.prixAffichesTTC} onValueChange={(v) => setCgvData({...cgvData, prixAffichesTTC: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="TTC" id="prix-ttc" /><Label htmlFor="prix-ttc">TTC (B2C)</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="HT" id="prix-ht" /><Label htmlFor="prix-ht">HT (B2B)</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="mixte" id="prix-mixte" /><Label htmlFor="prix-mixte">Mixte (selon client)</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>TVA applicable</Label><Input value={cgvData.tvaApplicable} onChange={(e) => setCgvData({...cgvData, tvaApplicable: e.target.value})} placeholder="Ex: 20%, 10%, 5.5%..." /></div>
                    <div><Label>Variation des prix</Label><Textarea value={cgvData.variationPrix} onChange={(e) => setCgvData({...cgvData, variationPrix: e.target.value})} placeholder="Les prix peuvent-ils varier ? Conditions de r√©vision..." className="min-h-[60px]" /></div>
                    <div><Label>Frais suppl√©mentaires</Label><Textarea value={cgvData.fraisSupplementaires} onChange={(e) => setCgvData({...cgvData, fraisSupplementaires: e.target.value})} placeholder="Livraison, installation, personnalisation..." className="min-h-[60px]" /></div>
                    <div><Label>Remises, r√©ductions, promotions</Label><Textarea value={cgvData.remisesReductions} onChange={(e) => setCgvData({...cgvData, remisesReductions: e.target.value})} placeholder="Conditions d'application des remises..." className="min-h-[60px]" /></div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                      <div><Label>Dur√©e de validit√© des devis</Label><Input value={cgvData.devisDureeValidite} onChange={(e) => setCgvData({...cgvData, devisDureeValidite: e.target.value})} placeholder="Ex: 30 jours" /></div>
                      <div><Label>R√©vision du devis</Label><Input value={cgvData.devisRevision} onChange={(e) => setCgvData({...cgvData, devisRevision: e.target.value})} placeholder="Conditions de r√©vision" /></div>
                    </div>
                  </div>
                </div>
                
                {/* 7. CONDITIONS DE PAIEMENT */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">7Ô∏è‚É£ Conditions de paiement</h4>
                  <div className="space-y-3">
                    <div>
                      <Label className="font-medium">Modes de paiement accept√©s</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={cgvData.modesPaiement.includes("carte")} onCheckedChange={(v) => setCgvData({...cgvData, modesPaiement: v ? [...cgvData.modesPaiement, "carte"] : cgvData.modesPaiement.filter(m => m !== "carte")})} id="pay-carte" /><Label htmlFor="pay-carte" className="font-normal">Carte bancaire</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cgvData.modesPaiement.includes("virement")} onCheckedChange={(v) => setCgvData({...cgvData, modesPaiement: v ? [...cgvData.modesPaiement, "virement"] : cgvData.modesPaiement.filter(m => m !== "virement")})} id="pay-vir" /><Label htmlFor="pay-vir" className="font-normal">Virement bancaire</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cgvData.modesPaiement.includes("sepa")} onCheckedChange={(v) => setCgvData({...cgvData, modesPaiement: v ? [...cgvData.modesPaiement, "sepa"] : cgvData.modesPaiement.filter(m => m !== "sepa")})} id="pay-sepa" /><Label htmlFor="pay-sepa" className="font-normal">Pr√©l√®vement SEPA</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cgvData.modesPaiement.includes("paypal")} onCheckedChange={(v) => setCgvData({...cgvData, modesPaiement: v ? [...cgvData.modesPaiement, "paypal"] : cgvData.modesPaiement.filter(m => m !== "paypal")})} id="pay-pp" /><Label htmlFor="pay-pp" className="font-normal">PayPal</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cgvData.modesPaiement.includes("plusieurs-fois")} onCheckedChange={(v) => setCgvData({...cgvData, modesPaiement: v ? [...cgvData.modesPaiement, "plusieurs-fois"] : cgvData.modesPaiement.filter(m => m !== "plusieurs-fois")})} id="pay-plusieurs" /><Label htmlFor="pay-plusieurs" className="font-normal">Paiement en plusieurs fois</Label></div>
                      </div>
                    </div>
                    <div>
                      <Label>Paiement</Label>
                      <RadioGroup value={cgvData.paiementImmediatDiffere} onValueChange={(v) => setCgvData({...cgvData, paiementImmediatDiffere: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="immediat" id="pay-immed" /><Label htmlFor="pay-immed">Imm√©diat</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="differe" id="pay-diff" /><Label htmlFor="pay-diff">Diff√©r√©</Label></div>
                      </RadioGroup>
                    </div>
                    <div>
                      <Label>Acompte / Arrhes / Engagement</Label>
                      <Select value={cgvData.acompteArrhes} onValueChange={(v) => setCgvData({...cgvData, acompteArrhes: v})}>
                        <SelectTrigger><SelectValue placeholder="Choisir" /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="aucun">Aucun</SelectItem>
                          <SelectItem value="acompte">Acompte (engagement ferme)</SelectItem>
                          <SelectItem value="arrhes">Arrhes (possibilit√© de se d√©sister)</SelectItem>
                        </SelectContent>
                      </Select>
                      {cgvData.acompteArrhes !== "aucun" && cgvData.acompteArrhes && (
                        <Input value={cgvData.montantAcompte} onChange={(e) => setCgvData({...cgvData, montantAcompte: e.target.value})} placeholder="Montant ou pourcentage" className="mt-2" />
                      )}
                    </div>
                    <div><Label>S√©curisation du paiement</Label><Input value={cgvData.securisationPaiement} onChange={(e) => setCgvData({...cgvData, securisationPaiement: e.target.value})} placeholder="3D Secure, SSL, prestataire..." /></div>
                    <div><Label>Frais li√©s √† certains paiements</Label><Input value={cgvData.fraisPaiement} onChange={(e) => setCgvData({...cgvData, fraisPaiement: e.target.value})} placeholder="Frais pour certains modes de paiement" /></div>
                    <div>
                      <Label>Factures √©lectroniques</Label>
                      <RadioGroup value={cgvData.facturesElectroniques} onValueChange={(v) => setCgvData({...cgvData, facturesElectroniques: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="fact-elec-oui" /><Label htmlFor="fact-elec-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="fact-elec-non" /><Label htmlFor="fact-elec-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    
                    {cgvData.typesClients.includes("B2B") && (
                      <div className="p-3 bg-orange-50 border border-orange-200 rounded">
                        <Label className="font-medium text-orange-700">‚ö†Ô∏è Paiement B2B (obligatoire)</Label>
                        <div className="space-y-2 mt-2">
                          <div><Label>D√©lai de paiement</Label><Select value={cgvData.paiementB2BEcheance} onValueChange={(v) => setCgvData({...cgvData, paiementB2BEcheance: v})}><SelectTrigger><SelectValue placeholder="Choisir" /></SelectTrigger><SelectContent><SelectItem value="comptant">Comptant</SelectItem><SelectItem value="30j">30 jours (LME)</SelectItem><SelectItem value="45j">45 jours</SelectItem><SelectItem value="60j">60 jours (max)</SelectItem></SelectContent></Select></div>
                          <div><Label>P√©nalit√©s de retard (taux) *</Label><Input value={cgvData.penalitesRetardTaux} onChange={(e) => setCgvData({...cgvData, penalitesRetardTaux: e.target.value})} placeholder="Ex: 3 fois le taux l√©gal" /></div>
                          <div><Label>Indemnit√© forfaitaire de recouvrement *</Label><Input value={cgvData.indemniteRecouvrementB2B} onChange={(e) => setCgvData({...cgvData, indemniteRecouvrementB2B: e.target.value})} placeholder="40‚Ç¨" /></div>
                        </div>
                      </div>
                    )}
                  </div>
                </div>
                
                {/* 8. LIVRAISON */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">8Ô∏è‚É£ Livraison</h4>
                  <div className="space-y-3">
                    <div><Label>Zones livr√©es</Label><Input value={cgvData.zonesLivrees} onChange={(e) => setCgvData({...cgvData, zonesLivrees: e.target.value})} placeholder="France m√©tropolitaine, Europe, International..." /></div>
                    <div><Label>Mode de livraison</Label><Input value={cgvData.modeLivraison} onChange={(e) => setCgvData({...cgvData, modeLivraison: e.target.value})} placeholder="Colissimo, transporteur, retrait magasin..." /></div>
                    <div><Label>D√©lais de livraison indicatifs</Label><Input value={cgvData.delaisLivraison} onChange={(e) => setCgvData({...cgvData, delaisLivraison: e.target.value})} placeholder="Ex: 48h, 5 jours ouvr√©s..." /></div>
                    <div><Label>Frais de livraison</Label><Textarea value={cgvData.fraisLivraison} onChange={(e) => setCgvData({...cgvData, fraisLivraison: e.target.value})} placeholder="Montants selon zone, poids, offerts si..." className="min-h-[60px]" /></div>
                    <div className="p-3 bg-gray-50 rounded border">
                      <Label className="font-medium">Transfert des risques</Label>
                      <div className="space-y-2 mt-2">
                        <div><Label className="text-sm">B2C (consommateurs)</Label><Input value={cgvData.transfertRisquesB2C} onChange={(e) => setCgvData({...cgvData, transfertRisquesB2C: e.target.value})} placeholder="√Ä la r√©ception" className="text-sm" /></div>
                        <div><Label className="text-sm">B2B (professionnels)</Label><Input value={cgvData.transfertRisquesB2B} onChange={(e) => setCgvData({...cgvData, transfertRisquesB2B: e.target.value})} placeholder="√Ä la remise au transporteur" className="text-sm" /></div>
                      </div>
                    </div>
                    <div><Label>Retards de livraison</Label><Textarea value={cgvData.retardsLivraison} onChange={(e) => setCgvData({...cgvData, retardsLivraison: e.target.value})} placeholder="Proc√©dure en cas de retard : remboursement, annulation..." className="min-h-[60px]" /></div>
                    <div><Label>Cas de force majeure</Label><Textarea value={cgvData.casForceMajeureLivraison} onChange={(e) => setCgvData({...cgvData, casForceMajeureLivraison: e.target.value})} placeholder="√âv√©nements exon√©rant le vendeur de sa responsabilit√©..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 9. EX√âCUTION DU SERVICE (SI PRESTATION) */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">9Ô∏è‚É£ Ex√©cution du service (si prestation)</h4>
                  <p className="text-sm text-gray-600">Remplir uniquement si vous vendez des services/prestations</p>
                  <div className="space-y-3">
                    <div><Label>Calendrier d'ex√©cution</Label><Textarea value={cgvData.calendrierService} onChange={(e) => setCgvData({...cgvData, calendrierService: e.target.value})} placeholder="D√©lais, planning, phases..." className="min-h-[60px]" /></div>
                    <div><Label>√âtapes de r√©alisation</Label><Textarea value={cgvData.etapesRealisation} onChange={(e) => setCgvData({...cgvData, etapesRealisation: e.target.value})} placeholder="Description des diff√©rentes √©tapes..." className="min-h-[60px]" /></div>
                    <div>
                      <Label>Type d'obligation</Label>
                      <RadioGroup value={cgvData.obligationMoyensResultat} onValueChange={(v) => setCgvData({...cgvData, obligationMoyensResultat: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="moyens" id="obl-moy" /><Label htmlFor="obl-moy">Obligation de moyens</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="resultat" id="obl-res" /><Label htmlFor="obl-res">Obligation de r√©sultat</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Validation des livrables</Label><Textarea value={cgvData.validationLivrables} onChange={(e) => setCgvData({...cgvData, validationLivrables: e.target.value})} placeholder="Proc√©dure de validation par le client..." className="min-h-[60px]" /></div>
                    <div><Label>Report / Annulation du service</Label><Textarea value={cgvData.reportAnnulationService} onChange={(e) => setCgvData({...cgvData, reportAnnulationService: e.target.value})} placeholder="Conditions et d√©lais de report ou annulation..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 10. DROIT DE R√âTRACTATION (B2C) */}
                {cgvData.typesClients.includes("B2C") && (
                  <div className="space-y-4 p-4 bg-green-50/50 rounded-lg border border-green-200">
                    <h4 className="font-semibold text-lg text-green-700">üîü Droit de r√©tractation (B2C uniquement)</h4>
                    <p className="text-sm text-green-600">‚ö†Ô∏è Obligatoire pour les ventes √† distance aux consommateurs</p>
                    <div className="space-y-3">
                      <div className="flex items-center space-x-2">
                        <Checkbox checked={cgvData.droitRetractation14jours} onCheckedChange={(v) => setCgvData({...cgvData, droitRetractation14jours: !!v})} id="retract-14j" disabled />
                        <Label htmlFor="retract-14j" className="font-normal">D√©lai l√©gal : 14 jours ‚úÖ (obligatoire)</Label>
                      </div>
                      <div>
                        <Label className="font-medium">Exceptions au droit de r√©tractation</Label>
                        <p className="text-xs text-gray-500 mb-2">Cochez les exceptions applicables</p>
                        <div className="space-y-2">
                          <div className="flex items-center space-x-2"><Checkbox checked={cgvData.exceptionsRetractation.includes("sur-mesure")} onCheckedChange={(v) => setCgvData({...cgvData, exceptionsRetractation: v ? [...cgvData.exceptionsRetractation, "sur-mesure"] : cgvData.exceptionsRetractation.filter(e => e !== "sur-mesure")})} id="exc-mesure" /><Label htmlFor="exc-mesure" className="font-normal">Produits confectionn√©s sur mesure</Label></div>
                          <div className="flex items-center space-x-2"><Checkbox checked={cgvData.exceptionsRetractation.includes("numerique-telecharge")} onCheckedChange={(v) => setCgvData({...cgvData, exceptionsRetractation: v ? [...cgvData.exceptionsRetractation, "numerique-telecharge"] : cgvData.exceptionsRetractation.filter(e => e !== "numerique-telecharge")})} id="exc-num" /><Label htmlFor="exc-num" className="font-normal">Contenus num√©riques t√©l√©charg√©s</Label></div>
                          <div className="flex items-center space-x-2"><Checkbox checked={cgvData.exceptionsRetractation.includes("service-execute")} onCheckedChange={(v) => setCgvData({...cgvData, exceptionsRetractation: v ? [...cgvData.exceptionsRetractation, "service-execute"] : cgvData.exceptionsRetractation.filter(e => e !== "service-execute")})} id="exc-serv" /><Label htmlFor="exc-serv" className="font-normal">Services pleinement ex√©cut√©s</Label></div>
                          <div className="flex items-center space-x-2"><Checkbox checked={cgvData.exceptionsRetractation.includes("scelles")} onCheckedChange={(v) => setCgvData({...cgvData, exceptionsRetractation: v ? [...cgvData.exceptionsRetractation, "scelles"] : cgvData.exceptionsRetractation.filter(e => e !== "scelles")})} id="exc-scell" /><Label htmlFor="exc-scell" className="font-normal">Produits scell√©s descell√©s (hygi√®ne)</Label></div>
                          <div className="flex items-center space-x-2"><Checkbox checked={cgvData.exceptionsRetractation.includes("perissables")} onCheckedChange={(v) => setCgvData({...cgvData, exceptionsRetractation: v ? [...cgvData.exceptionsRetractation, "perissables"] : cgvData.exceptionsRetractation.filter(e => e !== "perissables")})} id="exc-perish" /><Label htmlFor="exc-perish" className="font-normal">Produits p√©rissables</Label></div>
                          <div className="flex items-center space-x-2"><Checkbox checked={cgvData.exceptionsRetractation.includes("journaux")} onCheckedChange={(v) => setCgvData({...cgvData, exceptionsRetractation: v ? [...cgvData.exceptionsRetractation, "journaux"] : cgvData.exceptionsRetractation.filter(e => e !== "journaux")})} id="exc-journ" /><Label htmlFor="exc-journ" className="font-normal">Journaux, p√©riodiques</Label></div>
                        </div>
                      </div>
                      <div><Label>Proc√©dure de r√©tractation</Label><Textarea value={cgvData.procedureRetractation} onChange={(e) => setCgvData({...cgvData, procedureRetractation: e.target.value})} placeholder="Comment exercer le droit de r√©tractation : formulaire, email, courrier..." className="min-h-[60px]" /></div>
                      <div className="flex items-center space-x-2">
                        <Checkbox checked={cgvData.formulaireRetractation} onCheckedChange={(v) => setCgvData({...cgvData, formulaireRetractation: !!v})} id="form-retract" disabled />
                        <Label htmlFor="form-retract" className="font-normal">Formulaire type de r√©tractation ‚úÖ (obligatoire)</Label>
                      </div>
                      <div><Label>D√©lais de remboursement</Label><Input value={cgvData.remboursementDelais} onChange={(e) => setCgvData({...cgvData, remboursementDelais: e.target.value})} placeholder="Ex: 14 jours apr√®s r√©ception du retour" /></div>
                      <div><Label>M√©thode de remboursement</Label><Input value={cgvData.remboursementMethode} onChange={(e) => setCgvData({...cgvData, remboursementMethode: e.target.value})} placeholder="Ex: M√™me moyen de paiement que l'achat" /></div>
                    </div>
                  </div>
                )}
                
                {/* 11. RETOURS & REMBOURSEMENTS */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£1Ô∏è‚É£ Retours & Remboursements</h4>
                  <div className="space-y-3">
                    <div><Label>Conditions de retour</Label><Textarea value={cgvData.conditionsRetour} onChange={(e) => setCgvData({...cgvData, conditionsRetour: e.target.value})} placeholder="Dans quels cas un retour est accept√©..." className="min-h-[60px]" /></div>
                    <div><Label>Frais de retour</Label><Input value={cgvData.fraisRetour} onChange={(e) => setCgvData({...cgvData, fraisRetour: e.target.value})} placeholder="√Ä la charge du client ou du vendeur" /></div>
                    <div><Label>√âtat des produits retourn√©s</Label><Input value={cgvData.etatProduits} onChange={(e) => setCgvData({...cgvData, etatProduits: e.target.value})} placeholder="Neuf, emballage d'origine..." /></div>
                    <div><Label>D√©lais de retour</Label><Input value={cgvData.delaisRetour} onChange={(e) => setCgvData({...cgvData, delaisRetour: e.target.value})} placeholder="Ex: 14 jours, 30 jours..." /></div>
                    <div><Label>Retour des produits non conformes</Label><Textarea value={cgvData.produitsNonConformes} onChange={(e) => setCgvData({...cgvData, produitsNonConformes: e.target.value})} placeholder="Proc√©dure en cas de produit d√©fectueux ou non conforme..." className="min-h-[60px]" /></div>
                    <div><Label>SAV (Service Apr√®s-Vente)</Label><Textarea value={cgvData.sav} onChange={(e) => setCgvData({...cgvData, sav: e.target.value})} placeholder="Organisation du SAV, contacts, d√©lais..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 12. GARANTIES L√âGALES (OBLIGATOIRE B2C) */}
                {cgvData.typesClients.includes("B2C") && (
                  <div className="space-y-4 p-4 bg-green-50/50 rounded-lg border border-green-200">
                    <h4 className="font-semibold text-lg text-green-700">1Ô∏è‚É£2Ô∏è‚É£ Garanties l√©gales (obligatoire B2C)</h4>
                    <div className="space-y-3">
                      <div className="flex items-center space-x-2">
                        <Checkbox checked={cgvData.garantieLegaleConformite} onCheckedChange={(v) => setCgvData({...cgvData, garantieLegaleConformite: !!v})} id="gar-conf" disabled />
                        <Label htmlFor="gar-conf" className="font-normal">Garantie l√©gale de conformit√© (2 ans) ‚úÖ</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <Checkbox checked={cgvData.garantieVicesCaches} onCheckedChange={(v) => setCgvData({...cgvData, garantieVicesCaches: !!v})} id="gar-vices" disabled />
                        <Label htmlFor="gar-vices" className="font-normal">Garantie contre les vices cach√©s (2 ans apr√®s d√©couverte) ‚úÖ</Label>
                      </div>
                      <div>
                        <Label>Garantie commerciale (facultative)</Label>
                        <RadioGroup value={cgvData.garantieCommerciale} onValueChange={(v) => setCgvData({...cgvData, garantieCommerciale: v})}>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="gar-comm-oui" /><Label htmlFor="gar-comm-oui">Oui</Label></div>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="gar-comm-non" /><Label htmlFor="gar-comm-non">Non</Label></div>
                        </RadioGroup>
                        {cgvData.garantieCommerciale === "oui" && (
                          <div className="space-y-2 mt-2">
                            <Input value={cgvData.garantieCommercialeDuree} onChange={(e) => setCgvData({...cgvData, garantieCommercialeDuree: e.target.value})} placeholder="Dur√©e de la garantie commerciale" />
                            <Textarea value={cgvData.garantieCommercialeConditions} onChange={(e) => setCgvData({...cgvData, garantieCommercialeConditions: e.target.value})} placeholder="Conditions et √©tendue de la garantie..." className="min-h-[60px]" />
                          </div>
                        )}
                      </div>
                    </div>
                  </div>
                )}
                
                {/* 13. TRANSFERT DE PROPRI√âT√â & DES RISQUES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£3Ô∏è‚É£ Transfert de propri√©t√© & des risques</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Transfert de propri√©t√©</Label>
                      <Select value={cgvData.transfertPropriete} onValueChange={(v) => setCgvData({...cgvData, transfertPropriete: v})}>
                        <SelectTrigger><SelectValue /></SelectTrigger>
                        <SelectContent>
                          <SelectItem value="paiement-complet">Au paiement complet</SelectItem>
                          <SelectItem value="livraison">√Ä la livraison</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    <div>
                      <Label>Clause de r√©serve de propri√©t√©</Label>
                      <RadioGroup value={cgvData.reservePropriete} onValueChange={(v) => setCgvData({...cgvData, reservePropriete: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="reserve-oui" /><Label htmlFor="reserve-oui">Oui (recommand√© B2B)</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="reserve-non" /><Label htmlFor="reserve-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Transfert des risques</Label><Textarea value={cgvData.transfertRisques} onChange={(e) => setCgvData({...cgvData, transfertRisques: e.target.value})} placeholder="B2C: √† la livraison, B2B: remise au transporteur..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 14. RESPONSABILIT√â */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£4Ô∏è‚É£ Responsabilit√©</h4>
                  <div className="space-y-3">
                    <div><Label>Limitation de responsabilit√©</Label><Textarea value={cgvData.limitationResponsabilite} onChange={(e) => setCgvData({...cgvData, limitationResponsabilite: e.target.value})} placeholder="Plafond, exclusions, restrictions..." className="min-h-[80px]" /></div>
                    <div>
                      <Label>Exclusion des dommages indirects</Label>
                      <RadioGroup value={cgvData.exclusionDommagesIndirects} onValueChange={(v) => setCgvData({...cgvData, exclusionDommagesIndirects: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="dmg-oui" /><Label htmlFor="dmg-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="dmg-non" /><Label htmlFor="dmg-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Plafond de responsabilit√© (si applicable)</Label><Input value={cgvData.plafondResponsabilite} onChange={(e) => setCgvData({...cgvData, plafondResponsabilite: e.target.value})} placeholder="Ex: Montant de la commande, 10 000‚Ç¨..." /></div>
                    <div><Label>Force majeure</Label><Textarea value={cgvData.forceMajeureResponsabilite} onChange={(e) => setCgvData({...cgvData, forceMajeureResponsabilite: e.target.value})} placeholder="Exon√©ration en cas de force majeure..." className="min-h-[60px]" /></div>
                    <div><Label>Responsabilit√© d√©faut information</Label><Textarea value={cgvData.responsabiliteDefautInfo} onChange={(e) => setCgvData({...cgvData, responsabiliteDefautInfo: e.target.value})} placeholder="Inexactitudes, omissions..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 15. PROPRI√âT√â INTELLECTUELLE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£5Ô∏è‚É£ Propri√©t√© intellectuelle</h4>
                  <div className="space-y-3">
                    <div><Label>Marques & logos</Label><Textarea value={cgvData.marquesLogos} onChange={(e) => setCgvData({...cgvData, marquesLogos: e.target.value})} placeholder="Titularit√©, protection..." className="min-h-[60px]" /></div>
                    <div>
                      <Label>Interdiction reproduction</Label>
                      <RadioGroup value={cgvData.interdictionReproduction} onValueChange={(v) => setCgvData({...cgvData, interdictionReproduction: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="repro-oui" /><Label htmlFor="repro-oui">Oui (interdiction totale)</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="partiel" id="repro-part" /><Label htmlFor="repro-part">Partielle</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="repro-non" /><Label htmlFor="repro-non">Autoris√©e</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Licence client (si applicable)</Label><Textarea value={cgvData.licenceClient} onChange={(e) => setCgvData({...cgvData, licenceClient: e.target.value})} placeholder="Droit d'usage personnel, restrictions..." className="min-h-[60px]" /></div>
                    <div><Label>Protection contenus num√©riques</Label><Textarea value={cgvData.protectionContenusNumeriques} onChange={(e) => setCgvData({...cgvData, protectionContenusNumeriques: e.target.value})} placeholder="T√©l√©chargements, copies, DRM..." className="min-h-[60px]" /></div>
                    <div><Label>Clause anti-contrefa√ßon</Label><Textarea value={cgvData.clauseAntiContrefacon} onChange={(e) => setCgvData({...cgvData, clauseAntiContrefacon: e.target.value})} placeholder="Engagement du vendeur, garanties..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 16. RGPD & DONN√âES PERSONNELLES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£6Ô∏è‚É£ RGPD & Donn√©es personnelles</h4>
                  <div className="space-y-3">
                    <div><Label>Nature des donn√©es collect√©es *</Label><Textarea value={cgvData.natureDonneesCollectees} onChange={(e) => setCgvData({...cgvData, natureDonneesCollectees: e.target.value})} placeholder="Identit√©, coordonn√©es, donn√©es bancaires..." className="min-h-[80px]" /></div>
                    <div><Label>Finalit√©s du traitement *</Label><Textarea value={cgvData.finalitesTraitement} onChange={(e) => setCgvData({...cgvData, finalitesTraitement: e.target.value})} placeholder="Gestion commandes, facturation, livraison, marketing..." className="min-h-[80px]" /></div>
                    <div><Label>Responsable de traitement</Label><Input value={cgvData.responsableTraitement} onChange={(e) => setCgvData({...cgvData, responsableTraitement: e.target.value})} placeholder="Nom de l'entreprise" /></div>
                    <div><Label>Dur√©e de conservation</Label><Input value={cgvData.dureeConservation} onChange={(e) => setCgvData({...cgvData, dureeConservation: e.target.value})} placeholder="Ex: 3 ans apr√®s derni√®re commande" /></div>
                    <div><Label>Droits des personnes</Label><Textarea value={cgvData.droitsPersonnes} onChange={(e) => setCgvData({...cgvData, droitsPersonnes: e.target.value})} placeholder="Acc√®s, rectification, suppression, portabilit√©, opposition..." className="min-h-[80px]" /></div>
                    <div>
                      <Label>Transfert hors UE</Label>
                      <RadioGroup value={cgvData.transfertHorsUE} onValueChange={(v) => setCgvData({...cgvData, transfertHorsUE: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="ue-oui" /><Label htmlFor="ue-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="ue-non" /><Label htmlFor="ue-non">Non</Label></div>
                      </RadioGroup>
                      {cgvData.transfertHorsUE === "oui" && (
                        <Input value={cgvData.transfertHorsUEPrecisions} onChange={(e) => setCgvData({...cgvData, transfertHorsUEPrecisions: e.target.value})} placeholder="Pays, garanties..." className="mt-2" />
                      )}
                    </div>
                    <div><Label>Traitement des donn√©es de paiement</Label><Textarea value={cgvData.traitementPaiement} onChange={(e) => setCgvData({...cgvData, traitementPaiement: e.target.value})} placeholder="Prestataire, s√©curisation, PCI DSS..." className="min-h-[60px]" /></div>
                    <div><Label>Politique cookies</Label><Textarea value={cgvData.politiqueCookies} onChange={(e) => setCgvData({...cgvData, politiqueCookies: e.target.value})} placeholder="Types, finalit√©s, dur√©e, consentement..." className="min-h-[80px]" /></div>
                  </div>
                </div>
                
                {/* 17. SERVICE CLIENT & M√âDIATION */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£7Ô∏è‚É£ Service client & M√©diation</h4>
                  <div className="space-y-3">
                    <div><Label>Contact service client *</Label><Textarea value={cgvData.contactServiceClient} onChange={(e) => setCgvData({...cgvData, contactServiceClient: e.target.value})} placeholder="Email, t√©l√©phone, horaires, adresse postale..." className="min-h-[80px]" /></div>
                    <div><Label>Proc√©dure de r√©clamation</Label><Textarea value={cgvData.procedureReclamation} onChange={(e) => setCgvData({...cgvData, procedureReclamation: e.target.value})} placeholder="√âtapes, d√©lais de r√©ponse..." className="min-h-[80px]" /></div>
                    {cgvData.typesClients.includes("B2C") && (
                      <div className="p-3 bg-green-50 rounded border border-green-200">
                        <Label className="font-medium text-green-700">Service de m√©diation (obligatoire B2C) *</Label>
                        <p className="text-xs text-gray-600 mb-2 mt-1">Conform√©ment √† l'article L.612-1 du Code de la consommation</p>
                        <Input value={cgvData.serviceMediationNom} onChange={(e) => setCgvData({...cgvData, serviceMediationNom: e.target.value})} placeholder="Nom du m√©diateur" className="mb-2" />
                        <Textarea value={cgvData.coordonneesMediateur} onChange={(e) => setCgvData({...cgvData, coordonneesMediateur: e.target.value})} placeholder="Adresse, email, site web du m√©diateur..." className="min-h-[60px]" />
                      </div>
                    )}
                  </div>
                </div>
                
                {/* 18. R√âSILIATION ABONNEMENTS (si applicable) */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£8Ô∏è‚É£ R√©siliation abonnements (si applicable)</h4>
                  <div className="space-y-3">
                    <div><Label>Dur√©e de l'abonnement</Label><Input value={cgvData.dureeAbonnement} onChange={(e) => setCgvData({...cgvData, dureeAbonnement: e.target.value})} placeholder="Ex: 1 mois, 1 an..." /></div>
                    <div>
                      <Label>Reconduction tacite</Label>
                      <RadioGroup value={cgvData.reconductionTacite} onValueChange={(v) => setCgvData({...cgvData, reconductionTacite: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="recon-oui" /><Label htmlFor="recon-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="recon-non" /><Label htmlFor="recon-non">Non</Label></div>
                      </RadioGroup>
                      {cgvData.reconductionTacite === "oui" && (
                        <p className="text-xs text-gray-600 mt-1">‚ö†Ô∏è Information pr√©alable (Loi Chatel) requise avant √©ch√©ance</p>
                      )}
                    </div>
                    <div><Label>Proc√©dure de r√©siliation</Label><Textarea value={cgvData.procedureResiliation} onChange={(e) => setCgvData({...cgvData, procedureResiliation: e.target.value})} placeholder="Modalit√©s, lettre recommand√©e, email..." className="min-h-[80px]" /></div>
                    <div><Label>Pr√©avis</Label><Input value={cgvData.preavisResiliation} onChange={(e) => setCgvData({...cgvData, preavisResiliation: e.target.value})} placeholder="Ex: 1 mois avant √©ch√©ance" /></div>
                    <div><Label>Restitution / exportation des donn√©es</Label><Textarea value={cgvData.restitutionDonnees} onChange={(e) => setCgvData({...cgvData, restitutionDonnees: e.target.value})} placeholder="Format, d√©lai, conditions..." className="min-h-[60px]" /></div>
                    <div><Label>Suppression du compte</Label><Textarea value={cgvData.suppressionCompte} onChange={(e) => setCgvData({...cgvData, suppressionCompte: e.target.value})} placeholder="D√©lai de suppression d√©finitive..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 19. LOI APPLICABLE & TRIBUNAL COMP√âTENT */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£9Ô∏è‚É£ Loi applicable & Tribunal comp√©tent</h4>
                  <div className="space-y-3">
                    <div><Label>Loi applicable *</Label><Input value={cgvData.loiApplicable} onChange={(e) => setCgvData({...cgvData, loiApplicable: e.target.value})} placeholder="Ex: Droit fran√ßais" /></div>
                    <div><Label>Tribunal comp√©tent</Label><Textarea value={cgvData.tribunalCompetent} onChange={(e) => setCgvData({...cgvData, tribunalCompetent: e.target.value})} placeholder="Ex: Tribunaux du ressort de Paris" className="min-h-[60px]" /></div>
                    <div>
                      <Label>Clause de m√©diation (alternative au tribunal)</Label>
                      <RadioGroup value={cgvData.clauseMediation} onValueChange={(v) => setCgvData({...cgvData, clauseMediation: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="mediation-oui" /><Label htmlFor="mediation-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="mediation-non" /><Label htmlFor="mediation-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    {cgvData.typesClients.includes("B2B") && (
                      <div>
                        <Label>Clause d'arbitrage (B2B)</Label>
                        <RadioGroup value={cgvData.clauseArbitrage} onValueChange={(v) => setCgvData({...cgvData, clauseArbitrage: v})}>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="arb-oui" /><Label htmlFor="arb-oui">Oui</Label></div>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="arb-non" /><Label htmlFor="arb-non">Non</Label></div>
                        </RadioGroup>
                      </div>
                    )}
                  </div>
                </div>
                
                {/* 20. ANNEXES (LISTE) */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">2Ô∏è‚É£0Ô∏è‚É£ Annexes (liste des documents)</h4>
                  <div className="space-y-3">
                    <p className="text-sm text-gray-600">Cochez les annexes fournies avec les CGV :</p>
                    <div className="space-y-2">
                      <div className="flex items-center space-x-2">
                        <Checkbox checked={cgvData.annexeFormulaireRetractation} onCheckedChange={(v) => setCgvData({...cgvData, annexeFormulaireRetractation: !!v})} id="ann-retr" />
                        <Label htmlFor="ann-retr" className="font-normal">Formulaire de r√©tractation (B2C)</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <Checkbox checked={cgvData.annexePolitiqueConfidentialite} onCheckedChange={(v) => setCgvData({...cgvData, annexePolitiqueConfidentialite: !!v})} id="ann-conf" />
                        <Label htmlFor="ann-conf" className="font-normal">Politique de confidentialit√©</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <Checkbox checked={cgvData.annexeGrilleTarifaire} onCheckedChange={(v) => setCgvData({...cgvData, annexeGrilleTarifaire: !!v})} id="ann-tarif" />
                        <Label htmlFor="ann-tarif" className="font-normal">Grille tarifaire</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <Checkbox checked={cgvData.annexeFichesTechniques} onCheckedChange={(v) => setCgvData({...cgvData, annexeFichesTechniques: !!v})} id="ann-tech" />
                        <Label htmlFor="ann-tech" className="font-normal">Fiches techniques produits</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <Checkbox checked={cgvData.annexeProcedureSAV} onCheckedChange={(v) => setCgvData({...cgvData, annexeProcedureSAV: !!v})} id="ann-sav" />
                        <Label htmlFor="ann-sav" className="font-normal">Proc√©dure SAV</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <Checkbox checked={cgvData.annexeNoticesUtilisation} onCheckedChange={(v) => setCgvData({...cgvData, annexeNoticesUtilisation: !!v})} id="ann-notice" />
                        <Label htmlFor="ann-notice" className="font-normal">Notices d'utilisation</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <Checkbox checked={cgvData.annexeAutres} onCheckedChange={(v) => setCgvData({...cgvData, annexeAutres: !!v})} id="ann-autre" />
                        <Label htmlFor="ann-autre" className="font-normal">Autres (√† pr√©ciser dans les fichiers)</Label>
                      </div>
                    </div>
                  </div>
                </div>
                
                {/* UPLOAD FICHIERS ANNEXES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">üìé Upload des fichiers annexes</h4>
                  <MultiFileUpload 
                    label="Joindre les fichiers annexes (Formulaire r√©tractation, politique confidentialit√©, grilles tarifaires, fiches techniques, proc√©dure SAV, notices...)" 
                    files={cgvAnnexesFiles} 
                    onFilesChange={setCgvAnnexesFiles} 
                    accept=".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png"
                    role="avocat"
                  />
                </div>
                
              </div>
            )}

            {/* Formulaire complet pour CGU (Conditions G√©n√©rales d'Utilisation) */}
            {(() => {
              console.log('üîç DEBUG CGU - pendingContractType:', JSON.stringify(pendingContractType));
              console.log('üîç DEBUG CGU - includes CGU:', pendingContractType.includes("CGU"));
              console.log('üîç DEBUG CGU - includes SaaS:', pendingContractType.includes("SaaS"));
              console.log('üîç DEBUG CGU - includes saas (lowercase):', pendingContractType.toLowerCase().includes("saas"));
              console.log('üîç DEBUG CGU - Match result:', pendingContractType.includes("CGU") && pendingContractType.includes("SaaS"));
              console.log('üîç DEBUG CGU - Char codes:', Array.from(pendingContractType).map(c => c.charCodeAt(0)).join(','));
              return null;
            })()}
            {(pendingContractType.includes("CGU") && pendingContractType.toLowerCase().includes("saas")) && (
              <div className="space-y-6">
                <h3 className="font-semibold text-xl border-b-2 border-blue-300 pb-2 text-blue-700">üì± Conditions G√©n√©rales d'Utilisation (CGU) ‚Äî SaaS / Site Web</h3>
                
                {/* 1. IDENTIFICATION DE L'√âDITEUR */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£ Identification de l'√©diteur du site / application</h4>
                  <div className="p-3 bg-orange-50 rounded border border-orange-200">
                    <p className="text-xs text-orange-700">‚ö†Ô∏è Obligatoire par la LCEN (Loi pour la Confiance dans l'√âconomie Num√©rique)</p>
                  </div>
                  <div className="space-y-3">
                    <ClientSelector 
                      clients={clients} 
                      selectedClientId={cguVendeurClientId} 
                      onClientChange={(clientId) => {
                        setCguVendeurClientId(clientId);
                        const client = clients.find(c => c.id === clientId);
                        if (client) {
                          setCguData({
                            ...cguData,
                            editeurNom: `${client.prenom} ${client.nom}`,
                            editeurDenomination: `${client.prenom} ${client.nom}`,
                            editeurSiegeSocial: client.adresse || "",
                            editeurEmail: client.email || "",
                            editeurTelephone: client.telephone || ""
                          });
                        }
                      }} 
                      label="S√©lectionner un client comme √©diteur" 
                    />
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                      <div><Label>Nom de l'√©diteur *</Label><Input value={cguData.editeurNom} onChange={(e) => setCguData({...cguData, editeurNom: e.target.value})} /></div>
                      <div><Label>D√©nomination sociale *</Label><Input value={cguData.editeurDenomination} onChange={(e) => setCguData({...cguData, editeurDenomination: e.target.value})} /></div>
                      <div><Label>Forme juridique</Label><Input value={cguData.editeurFormeJuridique} onChange={(e) => setCguData({...cguData, editeurFormeJuridique: e.target.value})} placeholder="SARL, SAS, SASU, EI..." /></div>
                      <div><Label>Capital social</Label><Input value={cguData.editeurCapitalSocial} onChange={(e) => setCguData({...cguData, editeurCapitalSocial: e.target.value})} placeholder="Ex: 10 000‚Ç¨" /></div>
                      <div><Label>SIREN *</Label><Input value={cguData.editeurSIREN} onChange={(e) => setCguData({...cguData, editeurSIREN: e.target.value})} placeholder="123 456 789" /></div>
                      <div><Label>RCS</Label><Input value={cguData.editeurRCS} onChange={(e) => setCguData({...cguData, editeurRCS: e.target.value})} placeholder="RCS Ville" /></div>
                      <div><Label>TVA intracommunautaire</Label><Input value={cguData.editeurTVA} onChange={(e) => setCguData({...cguData, editeurTVA: e.target.value})} placeholder="FR12345678901" /></div>
                      <div><Label>Directeur de la publication *</Label><Input value={cguData.editeurDirecteurPublication} onChange={(e) => setCguData({...cguData, editeurDirecteurPublication: e.target.value})} /></div>
                    </div>
                    <div><Label>Si√®ge social *</Label><Input value={cguData.editeurSiegeSocial} onChange={(e) => setCguData({...cguData, editeurSiegeSocial: e.target.value})} /></div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                      <div><Label>Email de contact *</Label><Input type="email" value={cguData.editeurEmail} onChange={(e) => setCguData({...cguData, editeurEmail: e.target.value})} /></div>
                      <div><Label>T√©l√©phone</Label><Input value={cguData.editeurTelephone} onChange={(e) => setCguData({...cguData, editeurTelephone: e.target.value})} /></div>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                      <div><Label>Nom de l'h√©bergeur *</Label><Input value={cguData.hebergeurNom} onChange={(e) => setCguData({...cguData, hebergeurNom: e.target.value})} placeholder="Ex: OVH, AWS, Vercel..." /></div>
                      <div><Label>Coordonn√©es h√©bergeur *</Label><Textarea value={cguData.hebergeurCoordonnees} onChange={(e) => setCguData({...cguData, hebergeurCoordonnees: e.target.value})} placeholder="Adresse compl√®te de l'h√©bergeur..." className="min-h-[60px]" /></div>
                    </div>
                    <div>
                      <Label>Secteur r√©glement√© ?</Label>
                      <RadioGroup value={cguData.secteurReglemente} onValueChange={(v) => setCguData({...cguData, secteurReglemente: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="sect-oui" /><Label htmlFor="sect-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="sect-non" /><Label htmlFor="sect-non">Non</Label></div>
                      </RadioGroup>
                      {cguData.secteurReglemente === "oui" && (
                        <Input value={cguData.secteurReglementeAutorite} onChange={(e) => setCguData({...cguData, secteurReglementeAutorite: e.target.value})} placeholder="Nom de l'autorit√© de r√©gulation..." className="mt-2" />
                      )}
                    </div>
                  </div>
                </div>
                
                {/* 2. OBJET DES CGU */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">2Ô∏è‚É£ Objet des CGU</h4>
                  <div className="space-y-3">
                    <div><Label>Service fourni *</Label><Textarea value={cguData.serviceFourni} onChange={(e) => setCguData({...cguData, serviceFourni: e.target.value})} placeholder="Description d√©taill√©e du service..." className="min-h-[100px]" /></div>
                    <div>
                      <Label>Type de plateforme *</Label>
                      <div className="space-y-2">
                        <div className="flex items-center space-x-2">
                          <Checkbox checked={cguData.typePlateforme.includes("SaaS")} onCheckedChange={(v) => setCguData({...cguData, typePlateforme: v ? [...cguData.typePlateforme, "SaaS"] : cguData.typePlateforme.filter(t => t !== "SaaS")})} id="type-saas" />
                          <Label htmlFor="type-saas" className="font-normal">SaaS</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <Checkbox checked={cguData.typePlateforme.includes("Application mobile")} onCheckedChange={(v) => setCguData({...cguData, typePlateforme: v ? [...cguData.typePlateforme, "Application mobile"] : cguData.typePlateforme.filter(t => t !== "Application mobile")})} id="type-app" />
                          <Label htmlFor="type-app" className="font-normal">Application mobile</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <Checkbox checked={cguData.typePlateforme.includes("Marketplace")} onCheckedChange={(v) => setCguData({...cguData, typePlateforme: v ? [...cguData.typePlateforme, "Marketplace"] : cguData.typePlateforme.filter(t => t !== "Marketplace")})} id="type-market" />
                          <Label htmlFor="type-market" className="font-normal">Marketplace</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <Checkbox checked={cguData.typePlateforme.includes("R√©seau social")} onCheckedChange={(v) => setCguData({...cguData, typePlateforme: v ? [...cguData.typePlateforme, "R√©seau social"] : cguData.typePlateforme.filter(t => t !== "R√©seau social")})} id="type-social" />
                          <Label htmlFor="type-social" className="font-normal">R√©seau social</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <Checkbox checked={cguData.typePlateforme.includes("Service d'information")} onCheckedChange={(v) => setCguData({...cguData, typePlateforme: v ? [...cguData.typePlateforme, "Service d'information"] : cguData.typePlateforme.filter(t => t !== "Service d'information")})} id="type-info" />
                          <Label htmlFor="type-info" className="font-normal">Service d'information</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <Checkbox checked={cguData.typePlateforme.includes("Plateforme d'√©change")} onCheckedChange={(v) => setCguData({...cguData, typePlateforme: v ? [...cguData.typePlateforme, "Plateforme d'√©change"] : cguData.typePlateforme.filter(t => t !== "Plateforme d'√©change")})} id="type-echange" />
                          <Label htmlFor="type-echange" className="font-normal">Plateforme d'√©change ou de mise en relation</Label>
                        </div>
                      </div>
                    </div>
                    <div><Label>Limites du service</Label><Textarea value={cguData.limitesService} onChange={(e) => setCguData({...cguData, limitesService: e.target.value})} placeholder="Ce que le service ne fait pas..." className="min-h-[80px]" /></div>
                    <div><Label>Exclusions explicites</Label><Textarea value={cguData.exclusionsExplicites} onChange={(e) => setCguData({...cguData, exclusionsExplicites: e.target.value})} placeholder="Ce que le service exclut explicitement..." className="min-h-[80px]" /></div>
                  </div>
                </div>
                
                {/* 3. D√âFINITIONS INDISPENSABLES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">3Ô∏è‚É£ D√©finitions indispensables</h4>
                  <div className="space-y-3">
                    <div><Label>Utilisateur</Label><Textarea value={cguData.defUtilisateur} onChange={(e) => setCguData({...cguData, defUtilisateur: e.target.value})} placeholder="Ex: Toute personne qui acc√®de au service..." className="min-h-[60px]" /></div>
                    <div><Label>Compte utilisateur</Label><Textarea value={cguData.defCompteUtilisateur} onChange={(e) => setCguData({...cguData, defCompteUtilisateur: e.target.value})} placeholder="Ex: Espace personnel cr√©√© par l'utilisateur..." className="min-h-[60px]" /></div>
                    <div><Label>Service</Label><Textarea value={cguData.defService} onChange={(e) => setCguData({...cguData, defService: e.target.value})} placeholder="Ex: L'ensemble des fonctionnalit√©s propos√©es..." className="min-h-[60px]" /></div>
                    <div><Label>Contenu</Label><Textarea value={cguData.defContenu} onChange={(e) => setCguData({...cguData, defContenu: e.target.value})} placeholder="Ex: Toute information disponible sur la plateforme..." className="min-h-[60px]" /></div>
                    <div><Label>Contenu utilisateur</Label><Textarea value={cguData.defContenuUtilisateur} onChange={(e) => setCguData({...cguData, defContenuUtilisateur: e.target.value})} placeholder="Ex: Contenu publi√© par l'utilisateur..." className="min-h-[60px]" /></div>
                    <div><Label>Donn√©es personnelles</Label><Textarea value={cguData.defDonneesPersonnelles} onChange={(e) => setCguData({...cguData, defDonneesPersonnelles: e.target.value})} placeholder="Ex: Toute information relative √† une personne physique identifi√©e..." className="min-h-[60px]" /></div>
                    <div><Label>Plateforme</Label><Textarea value={cguData.defPlateforme} onChange={(e) => setCguData({...cguData, defPlateforme: e.target.value})} placeholder="Ex: Le site web ou l'application..." className="min-h-[60px]" /></div>
                    <div><Label>Espace client</Label><Textarea value={cguData.defEspaceClient} onChange={(e) => setCguData({...cguData, defEspaceClient: e.target.value})} placeholder="Ex: Interface personnelle de gestion..." className="min-h-[60px]" /></div>
                    <div><Label>Mod√©ration</Label><Textarea value={cguData.defModeration} onChange={(e) => setCguData({...cguData, defModeration: e.target.value})} placeholder="Ex: Contr√¥le des contenus publi√©s..." className="min-h-[60px]" /></div>
                    <div><Label>Force majeure</Label><Textarea value={cguData.defForceMajeure} onChange={(e) => setCguData({...cguData, defForceMajeure: e.target.value})} placeholder="Ex: √âv√©nement impr√©visible et insurmontable..." className="min-h-[60px]" /></div>
                    <div><Label>Acceptation des CGU</Label><Textarea value={cguData.defAcceptationCGU} onChange={(e) => setCguData({...cguData, defAcceptationCGU: e.target.value})} placeholder="Ex: Validation expresse lors de l'inscription..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 4. ACC√àS AU SITE / COMPTE UTILISATEUR */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">4Ô∏è‚É£ Acc√®s au site / Compte utilisateur</h4>
                  <div className="space-y-4">
                    <div>
                      <Label className="font-medium">A. Cr√©ation de compte - Champs collect√©s</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.champsCreeCompteNom} onCheckedChange={(v) => setCguData({...cguData, champsCreeCompteNom: !!v})} id="champ-nom" /><Label htmlFor="champ-nom" className="font-normal">Nom</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.champsCreeComptePrenom} onCheckedChange={(v) => setCguData({...cguData, champsCreeComptePrenom: !!v})} id="champ-prenom" /><Label htmlFor="champ-prenom" className="font-normal">Pr√©nom</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.champsCreeCompteEmail} onCheckedChange={(v) => setCguData({...cguData, champsCreeCompteEmail: !!v})} id="champ-email" /><Label htmlFor="champ-email" className="font-normal">Email</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.champsCreeCompteTelephone} onCheckedChange={(v) => setCguData({...cguData, champsCreeCompteTelephone: !!v})} id="champ-tel" /><Label htmlFor="champ-tel" className="font-normal">T√©l√©phone</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.champsCreeCompteMotDePasse} onCheckedChange={(v) => setCguData({...cguData, champsCreeCompteMotDePasse: !!v})} id="champ-mdp" /><Label htmlFor="champ-mdp" className="font-normal">Mot de passe</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.champsCreeCompteEntreprise} onCheckedChange={(v) => setCguData({...cguData, champsCreeCompteEntreprise: !!v})} id="champ-ent" /><Label htmlFor="champ-ent" className="font-normal">Entreprise (si B2B)</Label></div>
                      </div>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                      <div>
                        <Label>V√©rification email n√©cessaire ?</Label>
                        <RadioGroup value={cguData.verificationEmail} onValueChange={(v) => setCguData({...cguData, verificationEmail: v})}>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="verif-email-oui" /><Label htmlFor="verif-email-oui">Oui</Label></div>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="verif-email-non" /><Label htmlFor="verif-email-non">Non</Label></div>
                        </RadioGroup>
                      </div>
                      <div>
                        <Label>V√©rification t√©l√©phone n√©cessaire ?</Label>
                        <RadioGroup value={cguData.verificationTelephone} onValueChange={(v) => setCguData({...cguData, verificationTelephone: v})}>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="verif-tel-oui" /><Label htmlFor="verif-tel-oui">Oui</Label></div>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="verif-tel-non" /><Label htmlFor="verif-tel-non">Non</Label></div>
                        </RadioGroup>
                      </div>
                    </div>
                    <div>
                      <Label className="font-medium">B. Conditions d'acc√®s</Label>
                      <div className="space-y-2 mt-2">
                        <div><Label>√Çge minimum *</Label>
                          <Select value={cguData.ageMinimum} onValueChange={(v) => setCguData({...cguData, ageMinimum: v})}>
                            <SelectTrigger><SelectValue /></SelectTrigger>
                            <SelectContent>
                              <SelectItem value="16">16 ans (RGPD)</SelectItem>
                              <SelectItem value="18">18 ans (services sensibles)</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div><Label>Interdictions d'acc√®s</Label><Textarea value={cguData.interdictionsAcces} onChange={(e) => setCguData({...cguData, interdictionsAcces: e.target.value})} placeholder="Professionnels interdits, mineurs, etc..." className="min-h-[60px]" /></div>
                        <div><Label>Exactitude des donn√©es fournies</Label><Textarea value={cguData.exactitudeDonnees} onChange={(e) => setCguData({...cguData, exactitudeDonnees: e.target.value})} placeholder="L'utilisateur s'engage √† fournir des informations exactes..." className="min-h-[60px]" /></div>
                      </div>
                    </div>
                    <div>
                      <Label className="font-medium">C. S√©curit√© du compte</Label>
                      <div className="space-y-2 mt-2">
                        <div><Label>Obligation de confidentialit√© du mot de passe</Label><Textarea value={cguData.confidentialiteMotDePasse} onChange={(e) => setCguData({...cguData, confidentialiteMotDePasse: e.target.value})} placeholder="L'utilisateur est responsable de la confidentialit√©..." className="min-h-[60px]" /></div>
                        <div>
                          <Label>Double authentification (optionnel)</Label>
                          <RadioGroup value={cguData.doubleAuthentification} onValueChange={(v) => setCguData({...cguData, doubleAuthentification: v})}>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="2fa-oui" /><Label htmlFor="2fa-oui">Oui (disponible)</Label></div>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="2fa-non" /><Label htmlFor="2fa-non">Non</Label></div>
                          </RadioGroup>
                        </div>
                        <div><Label>Responsabilit√© en cas de vol de compte</Label><Textarea value={cguData.responsabiliteVolCompte} onChange={(e) => setCguData({...cguData, responsabiliteVolCompte: e.target.value})} placeholder="L'utilisateur doit signaler imm√©diatement tout acc√®s non autoris√©..." className="min-h-[60px]" /></div>
                      </div>
                    </div>
                  </div>
                </div>
                
                {/* 5. FONCTIONNEMENT DU SERVICE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">5Ô∏è‚É£ Fonctionnement du service</h4>
                  <div className="space-y-3">
                    <div><Label>Fonctionnalit√©s disponibles *</Label><Textarea value={cguData.fonctionnalitesDisponibles} onChange={(e) => setCguData({...cguData, fonctionnalitesDisponibles: e.target.value})} placeholder="Liste des fonctionnalit√©s offertes..." className="min-h-[100px]" /></div>
                    <div><Label>Limitations du service</Label><Textarea value={cguData.limitationsService} onChange={(e) => setCguData({...cguData, limitationsService: e.target.value})} placeholder="Limites techniques, quotas, restrictions..." className="min-h-[80px]" /></div>
                    <div><Label>Pr√©requis techniques</Label><Textarea value={cguData.prerequisTechniques} onChange={(e) => setCguData({...cguData, prerequisTechniques: e.target.value})} placeholder="Navigateur, OS, connexion Internet..." className="min-h-[80px]" /></div>
                    <div><Label>Mises √† jour possibles</Label><Textarea value={cguData.misesAJour} onChange={(e) => setCguData({...cguData, misesAJour: e.target.value})} placeholder="Le service peut √™tre mis √† jour r√©guli√®rement..." className="min-h-[60px]" /></div>
                    <div><Label>Interruptions de service (maintenance)</Label><Textarea value={cguData.interruptionsService} onChange={(e) => setCguData({...cguData, interruptionsService: e.target.value})} placeholder="Maintenance programm√©e, coupures techniques..." className="min-h-[60px]" /></div>
                    <div><Label>√âvolutions sans pr√©avis</Label><Textarea value={cguData.evolutionsSansPreavis} onChange={(e) => setCguData({...cguData, evolutionsSansPreavis: e.target.value})} placeholder="Le service peut √©voluer sans notification pr√©alable..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 6. R√àGLES D'UTILISATION / COMPORTEMENTS INTERDITS */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">6Ô∏è‚É£ R√®gles d'utilisation / Comportements interdits</h4>
                  <div className="space-y-4">
                    <div>
                      <Label className="font-medium">A. Interdictions g√©n√©rales</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.interdictionUsurpationIdentite} onCheckedChange={(v) => setCguData({...cguData, interdictionUsurpationIdentite: !!v})} id="int-usurp" disabled /><Label htmlFor="int-usurp" className="font-normal">Usurpation d'identit√© ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.interdictionViolationLois} onCheckedChange={(v) => setCguData({...cguData, interdictionViolationLois: !!v})} id="int-lois" disabled /><Label htmlFor="int-lois" className="font-normal">Violation des lois (fraude, harc√®lement, haine) ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.interdictionSpamPhishing} onCheckedChange={(v) => setCguData({...cguData, interdictionSpamPhishing: !!v})} id="int-spam" disabled /><Label htmlFor="int-spam" className="font-normal">Spam / Phishing ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.interdictionExploitationCommerciale} onCheckedChange={(v) => setCguData({...cguData, interdictionExploitationCommerciale: !!v})} id="int-comm" disabled /><Label htmlFor="int-comm" className="font-normal">Exploitation commerciale non autoris√©e ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.interdictionAccesNonAutorise} onCheckedChange={(v) => setCguData({...cguData, interdictionAccesNonAutorise: !!v})} id="int-acces" disabled /><Label htmlFor="int-acces" className="font-normal">Acc√®s non autoris√© √† des donn√©es ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.interdictionContournementProtections} onCheckedChange={(v) => setCguData({...cguData, interdictionContournementProtections: !!v})} id="int-protect" disabled /><Label htmlFor="int-protect" className="font-normal">Contournement des protections ‚úÖ</Label></div>
                      </div>
                    </div>
                    <div>
                      <Label className="font-medium">B. Contenu interdit</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.contenuIllicite} onCheckedChange={(v) => setCguData({...cguData, contenuIllicite: !!v})} id="cont-illic" disabled /><Label htmlFor="cont-illic" className="font-normal">Contenu illicite ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.contenuViolentHaineux} onCheckedChange={(v) => setCguData({...cguData, contenuViolentHaineux: !!v})} id="cont-viol" disabled /><Label htmlFor="cont-viol" className="font-normal">Contenu violent ou haineux ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.contenuPornographique} onCheckedChange={(v) => setCguData({...cguData, contenuPornographique: !!v})} id="cont-porno" disabled /><Label htmlFor="cont-porno" className="font-normal">Pornographie / mineurs ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.contenuDiffamatoire} onCheckedChange={(v) => setCguData({...cguData, contenuDiffamatoire: !!v})} id="cont-diff" disabled /><Label htmlFor="cont-diff" className="font-normal">Contenu diffamatoire ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.violationDroitsAuteur} onCheckedChange={(v) => setCguData({...cguData, violationDroitsAuteur: !!v})} id="cont-da" disabled /><Label htmlFor="cont-da" className="font-normal">Violation droits d'auteur ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.publiciteDissimulee} onCheckedChange={(v) => setCguData({...cguData, publiciteDissimulee: !!v})} id="cont-pub" disabled /><Label htmlFor="cont-pub" className="font-normal">Publicit√© dissimul√©e ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.venteProduitsInterdits} onCheckedChange={(v) => setCguData({...cguData, venteProduitsInterdits: !!v})} id="cont-vente" disabled /><Label htmlFor="cont-vente" className="font-normal">Vente de produits interdits ‚úÖ</Label></div>
                      </div>
                    </div>
                    <div>
                      <Label className="font-medium">C. Activit√©s interdites (SaaS / plateformes techniques)</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.reverseEngineering} onCheckedChange={(v) => setCguData({...cguData, reverseEngineering: !!v})} id="act-reverse" disabled /><Label htmlFor="act-reverse" className="font-normal">Reverse engineering ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.scrapingIntensif} onCheckedChange={(v) => setCguData({...cguData, scrapingIntensif: !!v})} id="act-scraping" disabled /><Label htmlFor="act-scraping" className="font-normal">Scraping intensif ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.surutilisationService} onCheckedChange={(v) => setCguData({...cguData, surutilisationService: !!v})} id="act-surutil" disabled /><Label htmlFor="act-surutil" className="font-normal">Surutilisation du service ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.automatisationNonAutorisee} onCheckedChange={(v) => setCguData({...cguData, automatisationNonAutorisee: !!v})} id="act-auto" disabled /><Label htmlFor="act-auto" className="font-normal">Automatisation non autoris√©e ‚úÖ</Label></div>
                      </div>
                    </div>
                    <div><Label>Autres interdictions sp√©cifiques</Label><Textarea value={cguData.autresInterdictions} onChange={(e) => setCguData({...cguData, autresInterdictions: e.target.value})} placeholder="Ajoutez d'autres interdictions sp√©cifiques √† votre service..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 7. CONTENUS UTILISATEURS (UGC) */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">7Ô∏è‚É£ Contenus utilisateurs (UGC)</h4>
                  <div className="space-y-3">
                    <div><Label>D√©finition du contenu utilisateur</Label><Textarea value={cguData.definitionContenuUGC} onChange={(e) => setCguData({...cguData, definitionContenuUGC: e.target.value})} placeholder="Tout contenu publi√©, partag√© ou transmis par l'utilisateur..." className="min-h-[60px]" /></div>
                    <div><Label>Droits conc√©d√©s par l'utilisateur √† la plateforme</Label><Textarea value={cguData.droitsConcedes} onChange={(e) => setCguData({...cguData, droitsConcedes: e.target.value})} placeholder="Licence d'utilisation, droits de reproduction..." className="min-h-[80px]" /></div>
                    <div><Label>Licence d'utilisation</Label><Textarea value={cguData.licenceUtilisation} onChange={(e) => setCguData({...cguData, licenceUtilisation: e.target.value})} placeholder="Type de licence accord√©e (mondiale, gratuite, non-exclusive...)..." className="min-h-[60px]" /></div>
                    <div><Label>Droits de reproduction / h√©bergement</Label><Textarea value={cguData.droitsReproduction} onChange={(e) => setCguData({...cguData, droitsReproduction: e.target.value})} placeholder="Autorisation de reproduire, h√©berger, diffuser..." className="min-h-[60px]" /></div>
                    <div><Label>Dur√©e de la licence</Label><Input value={cguData.dureeLicence} onChange={(e) => setCguData({...cguData, dureeLicence: e.target.value})} placeholder="Ex: Dur√©e de pr√©sence du contenu, ou perp√©tuelle" /></div>
                    <div><Label>Responsabilit√© de l'utilisateur sur son contenu</Label><Textarea value={cguData.responsabiliteContenu} onChange={(e) => setCguData({...cguData, responsabiliteContenu: e.target.value})} placeholder="L'utilisateur garantit √™tre titulaire des droits..." className="min-h-[80px]" /></div>
                    <div><Label>Pouvoir de suppression par la plateforme</Label><Textarea value={cguData.pouvoirSuppression} onChange={(e) => setCguData({...cguData, pouvoirSuppression: e.target.value})} placeholder="La plateforme se r√©serve le droit de supprimer tout contenu..." className="min-h-[60px]" /></div>
                    <div><Label>Proc√©dure de signalement</Label><Textarea value={cguData.procedureSignalement} onChange={(e) => setCguData({...cguData, procedureSignalement: e.target.value})} placeholder="Comment les utilisateurs peuvent signaler un contenu..." className="min-h-[60px]" /></div>
                    <div><Label>Suspension du compte</Label><Textarea value={cguData.suspensionCompte} onChange={(e) => setCguData({...cguData, suspensionCompte: e.target.value})} placeholder="Conditions de suspension en cas de violation..." className="min-h-[60px]" /></div>
                    <div className="p-3 bg-orange-50 rounded border border-orange-200">
                      <Label className="font-medium text-orange-700">DSA (Digital Services Act)</Label>
                      <div className="space-y-2 mt-2">
                        <div><Label>Proc√©dures de signalement DSA</Label><Textarea value={cguData.dsaSignalement} onChange={(e) => setCguData({...cguData, dsaSignalement: e.target.value})} placeholder="Formulaire de signalement conforme DSA..." className="min-h-[60px]" /></div>
                        <div><Label>Transparence sur la mod√©ration</Label><Textarea value={cguData.dsaTransparence} onChange={(e) => setCguData({...cguData, dsaTransparence: e.target.value})} placeholder="Crit√®res de mod√©ration, d√©lais de traitement..." className="min-h-[60px]" /></div>
                      </div>
                    </div>
                  </div>
                </div>
                
                {/* 8. PROPRI√âT√â INTELLECTUELLE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">8Ô∏è‚É£ Propri√©t√© intellectuelle</h4>
                  <div className="space-y-3">
                    <div><Label>Titularit√© des droits du site / application</Label><Textarea value={cguData.titulariteDroits} onChange={(e) => setCguData({...cguData, titulariteDroits: e.target.value})} placeholder="Tous les √©l√©ments du service sont prot√©g√©s..." className="min-h-[60px]" /></div>
                    <div><Label>Marques, logos, design</Label><Textarea value={cguData.marquesLogosDesign} onChange={(e) => setCguData({...cguData, marquesLogosDesign: e.target.value})} placeholder="Protection des marques et √©l√©ments graphiques..." className="min-h-[60px]" /></div>
                    <div><Label>Logiciels utilis√©s</Label><Textarea value={cguData.logicielsUtilises} onChange={(e) => setCguData({...cguData, logicielsUtilises: e.target.value})} placeholder="Frameworks, biblioth√®ques, licences tierces..." className="min-h-[60px]" /></div>
                    <div className="flex items-center space-x-2"><Checkbox checked={cguData.interdictionReproductionPI} onCheckedChange={(v) => setCguData({...cguData, interdictionReproductionPI: !!v})} id="pi-interdit" disabled /><Label htmlFor="pi-interdit" className="font-normal">Interdiction de reproduction sans accord ‚úÖ</Label></div>
                    <div className="flex items-center space-x-2"><Checkbox checked={cguData.protectionCodePI} onCheckedChange={(v) => setCguData({...cguData, protectionCodePI: !!v})} id="pi-code" disabled /><Label htmlFor="pi-code" className="font-normal">Protection par le Code de la propri√©t√© intellectuelle ‚úÖ</Label></div>
                    <div><Label>Droits du client sur son contenu</Label><Textarea value={cguData.droitsClientContenu} onChange={(e) => setCguData({...cguData, droitsClientContenu: e.target.value})} placeholder="Le client conserve tous les droits sur ses donn√©es et contenus..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 9. DONN√âES PERSONNELLES / RGPD */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">9Ô∏è‚É£ Donn√©es personnelles / RGPD</h4>
                  <div className="space-y-4">
                    <div>
                      <Label className="font-medium">A. Donn√©es collect√©es</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.donneesIdentite} onCheckedChange={(v) => setCguData({...cguData, donneesIdentite: !!v})} id="data-id" /><Label htmlFor="data-id" className="font-normal">Identit√© (nom, pr√©nom)</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.donneesContacts} onCheckedChange={(v) => setCguData({...cguData, donneesContacts: !!v})} id="data-contact" /><Label htmlFor="data-contact" className="font-normal">Contacts (email, t√©l√©phone)</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.donneesIdentifiants} onCheckedChange={(v) => setCguData({...cguData, donneesIdentifiants: !!v})} id="data-idfs" /><Label htmlFor="data-idfs" className="font-normal">Identifiants (login, mot de passe)</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.donneesCookiesTracking} onCheckedChange={(v) => setCguData({...cguData, donneesCookiesTracking: !!v})} id="data-cookie" /><Label htmlFor="data-cookie" className="font-normal">Cookies / tracking</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.donneesNavigation} onCheckedChange={(v) => setCguData({...cguData, donneesNavigation: !!v})} id="data-nav" /><Label htmlFor="data-nav" className="font-normal">Donn√©es de navigation</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.donneesUsage} onCheckedChange={(v) => setCguData({...cguData, donneesUsage: !!v})} id="data-usage" /><Label htmlFor="data-usage" className="font-normal">Donn√©es d'usage</Label></div>
                      </div>
                    </div>
                    <div>
                      <Label className="font-medium">B. Finalit√©s</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.finaliteFonctionnement} onCheckedChange={(v) => setCguData({...cguData, finaliteFonctionnement: !!v})} id="fin-fonc" /><Label htmlFor="fin-fonc" className="font-normal">Fonctionnement du service</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.finaliteSecurite} onCheckedChange={(v) => setCguData({...cguData, finaliteSecurite: !!v})} id="fin-secu" /><Label htmlFor="fin-secu" className="font-normal">S√©curit√©</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.finaliteStatistiques} onCheckedChange={(v) => setCguData({...cguData, finaliteStatistiques: !!v})} id="fin-stat" /><Label htmlFor="fin-stat" className="font-normal">Statistiques</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.finalitePublicite} onCheckedChange={(v) => setCguData({...cguData, finalitePublicite: !!v})} id="fin-pub" /><Label htmlFor="fin-pub" className="font-normal">Publicit√© / marketing (optionnel)</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.finalitePreventionFraude} onCheckedChange={(v) => setCguData({...cguData, finalitePreventionFraude: !!v})} id="fin-fraud" /><Label htmlFor="fin-fraud" className="font-normal">Pr√©vention fraude</Label></div>
                      </div>
                    </div>
                    <div>
                      <Label className="font-medium">C. Base l√©gale</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.baseLegaleConsentement} onCheckedChange={(v) => setCguData({...cguData, baseLegaleConsentement: !!v})} id="base-consent" /><Label htmlFor="base-consent" className="font-normal">Consentement</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.baseLegaleContrat} onCheckedChange={(v) => setCguData({...cguData, baseLegaleContrat: !!v})} id="base-contrat" /><Label htmlFor="base-contrat" className="font-normal">Ex√©cution du contrat</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.baseLegaleInteretLegitime} onCheckedChange={(v) => setCguData({...cguData, baseLegaleInteretLegitime: !!v})} id="base-interet" /><Label htmlFor="base-interet" className="font-normal">Int√©r√™t l√©gitime</Label></div>
                      </div>
                    </div>
                    <div><Label>D. Dur√©es de conservation</Label><Textarea value={cguData.dureeConservationRGPD} onChange={(e) => setCguData({...cguData, dureeConservationRGPD: e.target.value})} placeholder="Dur√©es de conservation selon le type de donn√©es..." className="min-h-[80px]" /></div>
                    <div>
                      <Label className="font-medium">E. Droits des utilisateurs ‚úÖ</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.droitAcces} onCheckedChange={(v) => setCguData({...cguData, droitAcces: !!v})} id="droit-acces" disabled /><Label htmlFor="droit-acces" className="font-normal">Acc√®s ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.droitRectification} onCheckedChange={(v) => setCguData({...cguData, droitRectification: !!v})} id="droit-rect" disabled /><Label htmlFor="droit-rect" className="font-normal">Rectification ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.droitSuppression} onCheckedChange={(v) => setCguData({...cguData, droitSuppression: !!v})} id="droit-suppr" disabled /><Label htmlFor="droit-suppr" className="font-normal">Suppression ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.droitOpposition} onCheckedChange={(v) => setCguData({...cguData, droitOpposition: !!v})} id="droit-oppos" disabled /><Label htmlFor="droit-oppos" className="font-normal">Opposition ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.droitPortabilite} onCheckedChange={(v) => setCguData({...cguData, droitPortabilite: !!v})} id="droit-port" disabled /><Label htmlFor="droit-port" className="font-normal">Portabilit√© ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.droitLimitation} onCheckedChange={(v) => setCguData({...cguData, droitLimitation: !!v})} id="droit-limit" disabled /><Label htmlFor="droit-limit" className="font-normal">Limitation ‚úÖ</Label></div>
                      </div>
                    </div>
                    <div><Label>F. Sous-traitants (API, stockage, paiement)</Label><Textarea value={cguData.sousTraitants} onChange={(e) => setCguData({...cguData, sousTraitants: e.target.value})} placeholder="Liste des sous-traitants et services tiers..." className="min-h-[80px]" /></div>
                    <div>
                      <Label>G. Transfert hors UE</Label>
                      <RadioGroup value={cguData.transfertHorsUERGPD} onValueChange={(v) => setCguData({...cguData, transfertHorsUERGPD: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="ue-rgpd-oui" /><Label htmlFor="ue-rgpd-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="ue-rgpd-non" /><Label htmlFor="ue-rgpd-non">Non</Label></div>
                      </RadioGroup>
                      {cguData.transfertHorsUERGPD === "oui" && (
                        <Input value={cguData.transfertHorsUEPays} onChange={(e) => setCguData({...cguData, transfertHorsUEPays: e.target.value})} placeholder="Pays et garanties (clauses contractuelles types...)" className="mt-2" />
                      )}
                    </div>
                    <div><Label>H. D√©l√©gu√© √† la protection des donn√©es (DPO)</Label><Input value={cguData.dpo} onChange={(e) => setCguData({...cguData, dpo: e.target.value})} placeholder="Contact DPO ou email de contact RGPD" /></div>
                  </div>
                </div>
                
                {/* 10. COOKIES ET TRACEURS */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">üîü Cookies et traceurs</h4>
                  <div className="space-y-3">
                    <div className="flex items-center space-x-2"><Checkbox checked={cguData.cookiesNecessaires} onCheckedChange={(v) => setCguData({...cguData, cookiesNecessaires: !!v})} id="cook-nec" disabled /><Label htmlFor="cook-nec" className="font-normal">Cookies n√©cessaires ‚úÖ</Label></div>
                    <div className="flex items-center space-x-2"><Checkbox checked={cguData.cookiesStatistiques} onCheckedChange={(v) => setCguData({...cguData, cookiesStatistiques: !!v})} id="cook-stat" /><Label htmlFor="cook-stat" className="font-normal">Cookies statistiques</Label></div>
                    <div className="flex items-center space-x-2"><Checkbox checked={cguData.cookiesPublicitaires} onCheckedChange={(v) => setCguData({...cguData, cookiesPublicitaires: !!v})} id="cook-pub" /><Label htmlFor="cook-pub" className="font-normal">Cookies publicitaires</Label></div>
                    <div className="flex items-center space-x-2"><Checkbox checked={cguData.consentementCookies} onCheckedChange={(v) => setCguData({...cguData, consentementCookies: !!v})} id="cook-consent" disabled /><Label htmlFor="cook-consent" className="font-normal">Consentement et refus ‚úÖ</Label></div>
                    <div><Label>Conservation du choix</Label><Input value={cguData.conservationChoixCookies} onChange={(e) => setCguData({...cguData, conservationChoixCookies: e.target.value})} placeholder="Ex: 6 mois, 13 mois..." /></div>
                    <div><Label>Lien vers politique cookies</Label><Input value={cguData.lienPolitiqueCookies} onChange={(e) => setCguData({...cguData, lienPolitiqueCookies: e.target.value})} placeholder="URL vers la politique cookies compl√®te" /></div>
                  </div>
                </div>
                
                {/* 11. RESPONSABILIT√â */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£1Ô∏è‚É£ Responsabilit√©</h4>
                  <div className="space-y-4">
                    <div>
                      <Label className="font-medium">Engagements du fournisseur</Label>
                      <div className="space-y-2 mt-2">
                        <div><Label>Disponibilit√© raisonnable du service</Label><Textarea value={cguData.engagementDisponibilite} onChange={(e) => setCguData({...cguData, engagementDisponibilite: e.target.value})} placeholder="Objectif de disponibilit√©, maintenance..." className="min-h-[60px]" /></div>
                        <div><Label>S√©curit√© technique</Label><Textarea value={cguData.engagementSecurite} onChange={(e) => setCguData({...cguData, engagementSecurite: e.target.value})} placeholder="Mesures de s√©curit√© mises en ≈ìuvre..." className="min-h-[60px]" /></div>
                        <div><Label>Maintenance</Label><Textarea value={cguData.engagementMaintenance} onChange={(e) => setCguData({...cguData, engagementMaintenance: e.target.value})} placeholder="Maintenance corrective et √©volutive..." className="min-h-[60px]" /></div>
                        <div><Label>Respect des lois</Label><Textarea value={cguData.engagementRespectLois} onChange={(e) => setCguData({...cguData, engagementRespectLois: e.target.value})} placeholder="Conformit√© r√©glementaire..." className="min-h-[60px]" /></div>
                      </div>
                    </div>
                    <div>
                      <Label className="font-medium">Exclusions de responsabilit√© (dans la limite l√©gale)</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.exclusionUtilisationIncorrecte} onCheckedChange={(v) => setCguData({...cguData, exclusionUtilisationIncorrecte: !!v})} id="excl-util" disabled /><Label htmlFor="excl-util" className="font-normal">Utilisation incorrecte du service ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.exclusionPanneInternet} onCheckedChange={(v) => setCguData({...cguData, exclusionPanneInternet: !!v})} id="excl-net" disabled /><Label htmlFor="excl-net" className="font-normal">Panne Internet ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.exclusionDommagesIndirects} onCheckedChange={(v) => setCguData({...cguData, exclusionDommagesIndirects: !!v})} id="excl-dmg" disabled /><Label htmlFor="excl-dmg" className="font-normal">Dommages indirects ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.exclusionPerteDonnees} onCheckedChange={(v) => setCguData({...cguData, exclusionPerteDonnees: !!v})} id="excl-data" disabled /><Label htmlFor="excl-data" className="font-normal">Perte de donn√©es imputable √† l'utilisateur ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.exclusionIntrusionExterne} onCheckedChange={(v) => setCguData({...cguData, exclusionIntrusionExterne: !!v})} id="excl-hack" disabled /><Label htmlFor="excl-hack" className="font-normal">Intrusion informatique ext√©rieure ‚úÖ</Label></div>
                      </div>
                    </div>
                    <div><Label>Force majeure</Label><Textarea value={cguData.forceMajeureResponsabilite} onChange={(e) => setCguData({...cguData, forceMajeureResponsabilite: e.target.value})} placeholder="Cas de force majeure exon√©rant de responsabilit√©..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 12. SUSPENSION / SUPPRESSION DU COMPTE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£2Ô∏è‚É£ Suspension / Suppression du compte</h4>
                  <div className="space-y-3">
                    <div>
                      <Label className="font-medium">Cas de suspension/suppression</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.suspensionNonRespectCGU} onCheckedChange={(v) => setCguData({...cguData, suspensionNonRespectCGU: !!v})} id="susp-cgu" disabled /><Label htmlFor="susp-cgu" className="font-normal">Non-respect des CGU ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.suspensionComportementsIllicites} onCheckedChange={(v) => setCguData({...cguData, suspensionComportementsIllicites: !!v})} id="susp-illic" disabled /><Label htmlFor="susp-illic" className="font-normal">Comportements illicites ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.suspensionUtilisationAbusive} onCheckedChange={(v) => setCguData({...cguData, suspensionUtilisationAbusive: !!v})} id="susp-abus" disabled /><Label htmlFor="susp-abus" className="font-normal">Utilisation abusive ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.suppressionDemandeUtilisateur} onCheckedChange={(v) => setCguData({...cguData, suppressionDemandeUtilisateur: !!v})} id="susp-user" disabled /><Label htmlFor="susp-user" className="font-normal">Demande de suppression par l'utilisateur ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={cguData.suppressionDecesUtilisateur} onCheckedChange={(v) => setCguData({...cguData, suppressionDecesUtilisateur: !!v})} id="susp-deces" disabled /><Label htmlFor="susp-deces" className="font-normal">D√©c√®s de l'utilisateur ‚úÖ</Label></div>
                      </div>
                    </div>
                    <div><Label>Dur√©e de suspension</Label><Input value={cguData.dureeSuspension} onChange={(e) => setCguData({...cguData, dureeSuspension: e.target.value})} placeholder="Ex: Temporaire (1 mois) ou d√©finitive" /></div>
                    <div><Label>Proc√©dure de recours</Label><Textarea value={cguData.procedureRecours} onChange={(e) => setCguData({...cguData, procedureRecours: e.target.value})} placeholder="Comment contester une suspension..." className="min-h-[80px]" /></div>
                  </div>
                </div>
                
                {/* 13. MODIFICATION DES CGU */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£3Ô∏è‚É£ Modification des CGU</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Notification de la modification</Label>
                      <RadioGroup value={cguData.notificationModification} onValueChange={(v) => setCguData({...cguData, notificationModification: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="notif-oui" /><Label htmlFor="notif-oui">Oui (par email ou sur le site)</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="notif-non" /><Label htmlFor="notif-non">Non (publication suffit)</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Date d'entr√©e en vigueur</Label><Input value={cguData.dateEntreeVigueur} onChange={(e) => setCguData({...cguData, dateEntreeVigueur: e.target.value})} placeholder="Ex: Imm√©diate, ou 30 jours apr√®s notification" /></div>
                    <div>
                      <Label>Acceptation tacite / expresse</Label>
                      <RadioGroup value={cguData.acceptationTaciteExpresse} onValueChange={(v) => setCguData({...cguData, acceptationTaciteExpresse: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="tacite" id="accept-tacite" /><Label htmlFor="accept-tacite">Tacite (poursuite de l'utilisation)</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="expresse" id="accept-expresse" /><Label htmlFor="accept-expresse">Expresse (validation requise)</Label></div>
                      </RadioGroup>
                    </div>
                    <div>
                      <Label>Archivage des anciennes versions</Label>
                      <RadioGroup value={cguData.archivageVersions} onValueChange={(v) => setCguData({...cguData, archivageVersions: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="arch-oui" /><Label htmlFor="arch-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="arch-non" /><Label htmlFor="arch-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                  </div>
                </div>
                
                {/* 14. R√âSILIATION DU SERVICE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£4Ô∏è‚É£ R√©siliation du service</h4>
                  <div className="space-y-3">
                    <div><Label>R√©siliation par l'utilisateur</Label><Textarea value={cguData.resiliationParUtilisateur} onChange={(e) => setCguData({...cguData, resiliationParUtilisateur: e.target.value})} placeholder="Modalit√©s de r√©siliation √† l'initiative de l'utilisateur..." className="min-h-[80px]" /></div>
                    <div><Label>R√©siliation par la plateforme</Label><Textarea value={cguData.resiliationParPlateforme} onChange={(e) => setCguData({...cguData, resiliationParPlateforme: e.target.value})} placeholder="Cas de r√©siliation par la plateforme..." className="min-h-[80px]" /></div>
                    <div>
                      <Label className="font-medium">Effets de la r√©siliation</Label>
                      <div className="space-y-2 mt-2">
                        <div><Label>Cl√¥ture du compte</Label><Textarea value={cguData.effetsClotureCompte} onChange={(e) => setCguData({...cguData, effetsClotureCompte: e.target.value})} placeholder="Acc√®s supprim√©, fonctionnalit√©s d√©sactiv√©es..." className="min-h-[60px]" /></div>
                        <div><Label>Suppression ou conservation des donn√©es</Label><Textarea value={cguData.effetsSuppressionDonnees} onChange={(e) => setCguData({...cguData, effetsSuppressionDonnees: e.target.value})} placeholder="Donn√©es supprim√©es apr√®s X jours, archivage l√©gal..." className="min-h-[60px]" /></div>
                        <div><Label>Restitution des acc√®s</Label><Textarea value={cguData.effetsRestitutionAcces} onChange={(e) => setCguData({...cguData, effetsRestitutionAcces: e.target.value})} placeholder="Export des donn√©es, transfert vers autre service..." className="min-h-[60px]" /></div>
                      </div>
                    </div>
                  </div>
                </div>
                
                {/* 15. LITIGES / DROIT APPLICABLE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£5Ô∏è‚É£ Litiges / Droit applicable</h4>
                  <div className="space-y-3">
                    <div><Label>Droit applicable *</Label><Input value={cguData.droitApplicable} onChange={(e) => setCguData({...cguData, droitApplicable: e.target.value})} placeholder="Ex: Droit fran√ßais" /></div>
                    <div><Label>Tribunal comp√©tent</Label><Textarea value={cguData.tribunalCompetent} onChange={(e) => setCguData({...cguData, tribunalCompetent: e.target.value})} placeholder="Ex: Tribunaux de Paris" className="min-h-[60px]" /></div>
                    <div>
                      <Label>Proc√©dure amiable pr√©alable</Label>
                      <RadioGroup value={cguData.procedureAmiable} onValueChange={(v) => setCguData({...cguData, procedureAmiable: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="amiable-oui" /><Label htmlFor="amiable-oui">Oui (obligatoire)</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="amiable-non" /><Label htmlFor="amiable-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                    <div>
                      <Label>Clause de m√©diation</Label>
                      <RadioGroup value={cguData.clauseMediationLitiges} onValueChange={(v) => setCguData({...cguData, clauseMediationLitiges: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="mediation-lit-oui" /><Label htmlFor="mediation-lit-oui">Oui</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="mediation-lit-non" /><Label htmlFor="mediation-lit-non">Non</Label></div>
                      </RadioGroup>
                    </div>
                  </div>
                </div>
                
                {/* 15bis. HI√âRARCHIE DES DOCUMENTS */}
                <div className="space-y-4 p-4 bg-green-50/50 rounded-lg border border-green-200">
                  <h4 className="font-semibold text-lg text-green-700">1Ô∏è‚É£5Ô∏è‚É£bis Clause de hi√©rarchie des documents</h4>
                  <div className="p-3 bg-green-100 rounded border border-green-300">
                    <p className="text-xs text-green-800">üí° Utile si CGU + CGV + contrats particuliers coexistent</p>
                  </div>
                  <div>
                    <Label>Ordre de priorit√© des documents</Label>
                    <Textarea 
                      value={cguData.hierarchieDocuments} 
                      onChange={(e) => setCguData({...cguData, hierarchieDocuments: e.target.value})} 
                      placeholder="Ex: En cas de contradiction entre les documents contractuels, l'ordre de priorit√© est le suivant : 1. Contrats particuliers, 2. CGV, 3. CGU, 4. Conditions commerciales..."
                      className="min-h-[100px]" 
                    />
                  </div>
                </div>
                
                {/* 15ter. NULLIT√â PARTIELLE */}
                <div className="space-y-4 p-4 bg-green-50/50 rounded-lg border border-green-200">
                  <h4 className="font-semibold text-lg text-green-700">1Ô∏è‚É£5Ô∏è‚É£ter Clause de nullit√© partielle (s√©parabilit√©)</h4>
                  <div className="p-3 bg-green-100 rounded border border-green-300">
                    <p className="text-xs text-green-800">üí° Standard juridique : si une clause est annul√©e, les autres restent valables</p>
                  </div>
                  <div>
                    <Label>Clause de s√©parabilit√©</Label>
                    <Textarea 
                      value={cguData.clauseNullitePartielle} 
                      onChange={(e) => setCguData({...cguData, clauseNullitePartielle: e.target.value})} 
                      placeholder="Ex: Si une ou plusieurs stipulations des pr√©sentes CGU sont tenues pour non valides ou d√©clar√©es nulles en application d'une loi, d'un r√®glement ou √† la suite d'une d√©cision d√©finitive d'une juridiction comp√©tente, les autres stipulations garderont toute leur force et leur port√©e."
                      className="min-h-[100px]" 
                    />
                  </div>
                </div>
                
                {/* 15quater. PREUVE √âLECTRONIQUE */}
                <div className="space-y-4 p-4 bg-green-50/50 rounded-lg border border-green-200">
                  <h4 className="font-semibold text-lg text-green-700">1Ô∏è‚É£5Ô∏è‚É£quater Clause de preuve √©lectronique</h4>
                  <div className="p-3 bg-green-100 rounded border border-green-300">
                    <p className="text-xs text-green-800">üí° Essentiel en SaaS : logs, horodatage, donn√©es informatiques font foi</p>
                  </div>
                  <div>
                    <Label>Valeur probante des donn√©es √©lectroniques</Label>
                    <Textarea 
                      value={cguData.clausePreuveElectronique} 
                      onChange={(e) => setCguData({...cguData, clausePreuveElectronique: e.target.value})} 
                      placeholder="Ex: Les registres informatis√©s, conserv√©s dans les syst√®mes informatiques de la Plateforme dans des conditions raisonnables de s√©curit√©, seront consid√©r√©s comme des preuves des communications, des commandes et des paiements intervenus entre les parties. L'archivage des contrats et des documents est effectu√© sur un support fiable et durable de mani√®re √† correspondre √† une copie fid√®le."
                      className="min-h-[120px]" 
                    />
                  </div>
                </div>
                
                {/* 16. ANNEXES TECHNIQUES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£6Ô∏è‚É£ Annexes techniques possibles</h4>
                  <div className="space-y-3">
                    <SingleFileUpload label="Politique de confidentialit√©" file={cguPolitiqueConfidentialiteFile} onFileChange={setCguPolitiqueConfidentialiteFile} role="avocat" />
                    <SingleFileUpload label="Politique cookies" file={cguPolitiqueCookiesFile} onFileChange={setCguPolitiqueCookiesFile} role="avocat" />
                    <SingleFileUpload label="Charte d'utilisation" file={cguCharteUtilisationFile} onFileChange={setCguCharteUtilisationFile} role="avocat" />
                    <SingleFileUpload label="Documentation API (si applicable)" file={cguDocumentationAPIFile} onFileChange={setCguDocumentationAPIFile} role="avocat" />
                    <SingleFileUpload label="R√®gles de mod√©ration (DSA)" file={cguReglesModerationFile} onFileChange={setCguReglesModerationFile} role="avocat" />
                  </div>
                </div>
                
                {/* 17. PI√àCES JUSTIFICATIVES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£7Ô∏è‚É£ Pi√®ces justificatives (liste)</h4>
                  <div className="space-y-3">
                    <SingleFileUpload label="Mentions l√©gales (Kbis, statuts...)" file={cguMentionsLegalesFile} onFileChange={setCguMentionsLegalesFile} role="avocat" />
                    <SingleFileUpload label="Politique de confidentialit√©" file={cguPolitiqueConfidentialite2File} onFileChange={setCguPolitiqueConfidentialite2File} role="avocat" />
                    <SingleFileUpload label="Politique de cookies" file={cguPolitiqueCookies2File} onFileChange={setCguPolitiqueCookies2File} role="avocat" />
                    <SingleFileUpload label="Conditions commerciales (si li√©es)" file={cguConditionsCommercialesFile} onFileChange={setCguConditionsCommercialesFile} role="avocat" />
                  </div>
                </div>
                
              </div>
            )}

            {/* Formulaire complet pour Contrat d'agence commerciale */}
            {(pendingContractType.includes("agence commerciale") || pendingContractType.includes("Contrat d'agence commerciale")) && (
              <div className="space-y-6">
                <h3 className="font-semibold text-xl border-b-2 border-blue-300 pb-2 text-blue-700">ü§ù Contrat d'Agence Commerciale</h3>
                
                {/* 1. IDENTIFICATION DES PARTIES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£ Identification des parties</h4>
                  
                  {/* MANDANT */}
                  <div className="space-y-3 p-3 bg-white rounded border border-blue-100">
                    <h5 className="font-semibold text-blue-600">A. Mandant (entreprise repr√©sent√©e)</h5>
                    <ClientSelector 
                      clients={clients} 
                      selectedClientId={agenceClientId} 
                      onClientChange={(clientId) => {
                        setAgenceClientId(clientId);
                        const client = clients.find(c => c.id === clientId);
                        if (client) {
                          setAgenceData({
                            ...agenceData,
                            mandantDenomination: client.nom || "",
                            mandantSiege: client.adresse || "",
                            mandantEmail: client.email || "",
                            mandantTelephone: client.telephone || "",
                          });
                        }
                      }}
                      label="S√©lectionner le mandant (facultatif)"
                      role="avocat"
                    />
                    <div className="grid grid-cols-2 gap-3">
                      <div><Label>D√©nomination sociale *</Label><Input value={agenceData.mandantDenomination} onChange={(e) => setAgenceData({...agenceData, mandantDenomination: e.target.value})} placeholder="SAS EXEMPLE" /></div>
                      <div><Label>Forme juridique *</Label><Input value={agenceData.mandantFormeJuridique} onChange={(e) => setAgenceData({...agenceData, mandantFormeJuridique: e.target.value})} placeholder="SAS, SARL, SA..." /></div>
                      <div><Label>Capital social</Label><Input value={agenceData.mandantCapital} onChange={(e) => setAgenceData({...agenceData, mandantCapital: e.target.value})} placeholder="100 000 ‚Ç¨" /></div>
                      <div><Label>RCS</Label><Input value={agenceData.mandantRCS} onChange={(e) => setAgenceData({...agenceData, mandantRCS: e.target.value})} placeholder="RCS Paris" /></div>
                      <div><Label>SIREN *</Label><Input value={agenceData.mandantSIREN} onChange={(e) => setAgenceData({...agenceData, mandantSIREN: e.target.value})} placeholder="123 456 789" /></div>
                      <div><Label>Repr√©sentant l√©gal *</Label><Input value={agenceData.mandantRepresentant} onChange={(e) => setAgenceData({...agenceData, mandantRepresentant: e.target.value})} placeholder="M. Jean DUPONT" /></div>
                    </div>
                    <div><Label>Adresse si√®ge social *</Label><Textarea value={agenceData.mandantSiege} onChange={(e) => setAgenceData({...agenceData, mandantSiege: e.target.value})} placeholder="Adresse compl√®te" className="min-h-[60px]" /></div>
                    <div className="grid grid-cols-2 gap-3">
                      <div><Label>Activit√© principale</Label><Input value={agenceData.mandantActivite} onChange={(e) => setAgenceData({...agenceData, mandantActivite: e.target.value})} placeholder="Vente de produits..." /></div>
                      <div><Label>Email</Label><Input type="email" value={agenceData.mandantEmail} onChange={(e) => setAgenceData({...agenceData, mandantEmail: e.target.value})} placeholder="contact@entreprise.com" /></div>
                    </div>
                    <div><Label>T√©l√©phone</Label><Input value={agenceData.mandantTelephone} onChange={(e) => setAgenceData({...agenceData, mandantTelephone: e.target.value})} placeholder="+33 1 23 45 67 89" /></div>
                  </div>
                  
                  {/* AGENT COMMERCIAL */}
                  <div className="space-y-3 p-3 bg-white rounded border border-blue-100">
                    <h5 className="font-semibold text-blue-600">B. Agent commercial (mandataire ind√©pendant)</h5>
                    <div className="p-3 bg-orange-50 rounded border border-orange-200">
                      <p className="text-xs text-orange-700">‚ö†Ô∏è L'agent doit √™tre inscrit au RSAC (Registre Sp√©cial des Agents Commerciaux)</p>
                    </div>
                    <div className="grid grid-cols-2 gap-3">
                      <div><Label>Nom / Pr√©nom (si personne physique)</Label><Input value={agenceData.agentNomPrenom} onChange={(e) => setAgenceData({...agenceData, agentNomPrenom: e.target.value})} placeholder="Jean MARTIN" /></div>
                      <div><Label>Ou d√©nomination sociale (si soci√©t√©)</Label><Input value={agenceData.agentDenomination} onChange={(e) => setAgenceData({...agenceData, agentDenomination: e.target.value})} placeholder="AGENT SOLUTIONS SARL" /></div>
                      <div><Label>Statut juridique *</Label><Input value={agenceData.agentStatutJuridique} onChange={(e) => setAgenceData({...agenceData, agentStatutJuridique: e.target.value})} placeholder="EI, EURL, SASU..." /></div>
                      <div><Label>RCS</Label><Input value={agenceData.agentRCS} onChange={(e) => setAgenceData({...agenceData, agentRCS: e.target.value})} placeholder="RCS Lyon" /></div>
                      <div><Label>SIREN</Label><Input value={agenceData.agentSIREN} onChange={(e) => setAgenceData({...agenceData, agentSIREN: e.target.value})} placeholder="987 654 321" /></div>
                      <div><Label>N¬∞ RSAC *</Label><Input value={agenceData.agentRSAC} onChange={(e) => setAgenceData({...agenceData, agentRSAC: e.target.value})} placeholder="RSAC 12345678" /></div>
                    </div>
                    <div><Label>Adresse compl√®te *</Label><Textarea value={agenceData.agentAdresse} onChange={(e) => setAgenceData({...agenceData, agentAdresse: e.target.value})} placeholder="Adresse compl√®te de l'agent" className="min-h-[60px]" /></div>
                    <div className="grid grid-cols-2 gap-3">
                      <div>
                        <Label>Assurance RC Professionnelle *</Label>
                        <RadioGroup value={agenceData.agentRCPro} onValueChange={(v) => setAgenceData({...agenceData, agentRCPro: v})}>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="rc-oui" /><Label htmlFor="rc-oui">Oui</Label></div>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="rc-non" /><Label htmlFor="rc-non">Non</Label></div>
                        </RadioGroup>
                      </div>
                      {agenceData.agentRCPro === "oui" && (
                        <div><Label>Num√©ro de police</Label><Input value={agenceData.agentNumeroRCPro} onChange={(e) => setAgenceData({...agenceData, agentNumeroRCPro: e.target.value})} placeholder="N¬∞ police RC Pro" /></div>
                      )}
                    </div>
                    <div className="grid grid-cols-2 gap-3">
                      <div><Label>Email</Label><Input type="email" value={agenceData.agentEmail} onChange={(e) => setAgenceData({...agenceData, agentEmail: e.target.value})} placeholder="agent@email.com" /></div>
                      <div><Label>T√©l√©phone</Label><Input value={agenceData.agentTelephone} onChange={(e) => setAgenceData({...agenceData, agentTelephone: e.target.value})} placeholder="+33 6 12 34 56 78" /></div>
                    </div>
                    <div className="space-y-2">
                      <div className="flex items-center space-x-2">
                        <Checkbox checked={agenceData.agentEtranger} onCheckedChange={(v) => setAgenceData({...agenceData, agentEtranger: !!v})} id="agent-etranger" />
                        <Label htmlFor="agent-etranger" className="font-normal">Agent √©tranger</Label>
                      </div>
                      <div>
                        <Label>Sous-agents utilis√©s</Label>
                        <RadioGroup value={agenceData.agentSousAgents} onValueChange={(v) => setAgenceData({...agenceData, agentSousAgents: v})}>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="sa-oui" /><Label htmlFor="sa-oui">Oui</Label></div>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="sa-non" /><Label htmlFor="sa-non">Non</Label></div>
                        </RadioGroup>
                      </div>
                    </div>
                  </div>
                </div>
                
                {/* 2. OBJET DU CONTRAT */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">2Ô∏è‚É£ Objet du contrat</h4>
                  <div className="space-y-3">
                    <div><Label>Produits ou services √† promouvoir *</Label><Textarea value={agenceData.produits} onChange={(e) => setAgenceData({...agenceData, produits: e.target.value})} placeholder="Description des produits/services..." className="min-h-[80px]" /></div>
                    <div><Label>March√©s cibles</Label><Input value={agenceData.marchesCibles} onChange={(e) => setAgenceData({...agenceData, marchesCibles: e.target.value})} placeholder="B2B, B2C, secteur industriel..." /></div>
                    <div><Label>Secteurs g√©ographiques *</Label><Input value={agenceData.secteursGeographiques} onChange={(e) => setAgenceData({...agenceData, secteursGeographiques: e.target.value})} placeholder="France, Europe, r√©gions..." /></div>
                    <div><Label>Type de client√®le vis√©e</Label><Input value={agenceData.clienteleVisee} onChange={(e) => setAgenceData({...agenceData, clienteleVisee: e.target.value})} placeholder="PME, grands comptes, particuliers..." /></div>
                    <div><Label>Conditions g√©n√©rales de vente applicables</Label><Input value={agenceData.cgvApplicables} onChange={(e) => setAgenceData({...agenceData, cgvApplicables: e.target.value})} placeholder="R√©f√©rence aux CGV du mandant" /></div>
                  </div>
                </div>
                
                {/* 3. NATURE JURIDIQUE */}
                <div className="space-y-4 p-4 bg-orange-50/50 rounded-lg border border-orange-200">
                  <h4 className="font-semibold text-lg text-orange-700">3Ô∏è‚É£ Nature juridique ‚Äî Rappels obligatoires</h4>
                  <div className="p-3 bg-orange-100 rounded border border-orange-300">
                    <p className="text-xs text-orange-800">‚ö†Ô∏è Articles L134-1 √† L134-17 du Code de commerce</p>
                  </div>
                  <div className="space-y-2">
                    <div className="flex items-center space-x-2"><Checkbox checked={agenceData.rappelIntermediaireIndependant} onCheckedChange={(v) => setAgenceData({...agenceData, rappelIntermediaireIndependant: !!v})} id="rappel-1" disabled /><Label htmlFor="rappel-1" className="font-normal">L'agent commercial agit en tant qu'interm√©diaire ind√©pendant ‚úÖ</Label></div>
                    <div className="flex items-center space-x-2"><Checkbox checked={agenceData.rappelPasRisqueVente} onCheckedChange={(v) => setAgenceData({...agenceData, rappelPasRisqueVente: !!v})} id="rappel-2" disabled /><Label htmlFor="rappel-2" className="font-normal">Il ne supporte pas les risques de la vente ‚úÖ</Label></div>
                    <div className="flex items-center space-x-2"><Checkbox checked={agenceData.rappelPasEncaissementSaufClause} onCheckedChange={(v) => setAgenceData({...agenceData, rappelPasEncaissementSaufClause: !!v})} id="rappel-3" disabled /><Label htmlFor="rappel-3" className="font-normal">Il ne peut pas encaisser de paiements sauf clause sp√©ciale ‚úÖ</Label></div>
                    <div className="flex items-center space-x-2"><Checkbox checked={agenceData.rappelArticlesCodeCommerce} onCheckedChange={(v) => setAgenceData({...agenceData, rappelArticlesCodeCommerce: !!v})} id="rappel-4" disabled /><Label htmlFor="rappel-4" className="font-normal">R√©gi par les articles L134-1 √† L134-17 du Code de commerce ‚úÖ</Label></div>
                  </div>
                </div>
                
                {/* 4. MANDAT & POUVOIRS */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">4Ô∏è‚É£ Mandat & Pouvoirs de l'agent</h4>
                  <div className="space-y-3">
                    <div>
                      <Label className="font-medium">Pouvoirs accord√©s</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={agenceData.pouvoirProspection} onCheckedChange={(v) => setAgenceData({...agenceData, pouvoirProspection: !!v})} id="pouv-1" /><Label htmlFor="pouv-1" className="font-normal">Prospection commerciale</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={agenceData.pouvoirPresentation} onCheckedChange={(v) => setAgenceData({...agenceData, pouvoirPresentation: !!v})} id="pouv-2" /><Label htmlFor="pouv-2" className="font-normal">Pr√©sentation des produits</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={agenceData.pouvoirNegociation} onCheckedChange={(v) => setAgenceData({...agenceData, pouvoirNegociation: !!v})} id="pouv-3" /><Label htmlFor="pouv-3" className="font-normal">N√©gociation des contrats</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={agenceData.pouvoirConclusion} onCheckedChange={(v) => setAgenceData({...agenceData, pouvoirConclusion: !!v})} id="pouv-4" /><Label htmlFor="pouv-4" className="font-normal">Conclusion des contrats au nom du mandant (optionnel)</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={agenceData.pouvoirSalons} onCheckedChange={(v) => setAgenceData({...agenceData, pouvoirSalons: !!v})} id="pouv-5" /><Label htmlFor="pouv-5" className="font-normal">Participation aux salons / √©v√©nements</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={agenceData.pouvoirReporting} onCheckedChange={(v) => setAgenceData({...agenceData, pouvoirReporting: !!v})} id="pouv-6" /><Label htmlFor="pouv-6" className="font-normal">Reporting commercial</Label></div>
                      </div>
                    </div>
                    <div>
                      <Label className="font-medium">Pouvoirs interdits (standards)</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={agenceData.interdictionModifTarifs} onCheckedChange={(v) => setAgenceData({...agenceData, interdictionModifTarifs: !!v})} id="int-1" disabled /><Label htmlFor="int-1" className="font-normal">Modifier les tarifs ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={agenceData.interdictionRemises} onCheckedChange={(v) => setAgenceData({...agenceData, interdictionRemises: !!v})} id="int-2" disabled /><Label htmlFor="int-2" className="font-normal">Accorder des remises non autoris√©es ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={agenceData.interdictionClausesNonApprouvees} onCheckedChange={(v) => setAgenceData({...agenceData, interdictionClausesNonApprouvees: !!v})} id="int-3" disabled /><Label htmlFor="int-3" className="font-normal">Engager la soci√©t√© sur des clauses non approuv√©es ‚úÖ</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={agenceData.interdictionEncaissement} onCheckedChange={(v) => setAgenceData({...agenceData, interdictionEncaissement: !!v})} id="int-4" disabled /><Label htmlFor="int-4" className="font-normal">Encaisser des paiements (sauf autorisation √©crite) ‚úÖ</Label></div>
                      </div>
                    </div>
                    <div className="grid grid-cols-2 gap-3">
                      <div>
                        <Label>Type de mandat *</Label>
                        <RadioGroup value={agenceData.mandatExclusif} onValueChange={(v) => setAgenceData({...agenceData, mandatExclusif: v})}>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="exclusif" id="mand-exc" /><Label htmlFor="mand-exc">Exclusif</Label></div>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="non_exclusif" id="mand-non" /><Label htmlFor="mand-non">Non exclusif</Label></div>
                        </RadioGroup>
                      </div>
                      <div>
                        <Label>Possibilit√© de sous-agents</Label>
                        <RadioGroup value={agenceData.possibiliteSousAgents} onValueChange={(v) => setAgenceData({...agenceData, possibiliteSousAgents: v})}>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="sa-yes" /><Label htmlFor="sa-yes">Oui</Label></div>
                          <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="sa-no" /><Label htmlFor="sa-no">Non</Label></div>
                        </RadioGroup>
                      </div>
                    </div>
                  </div>
                </div>
                
                {/* 5. EXCLUSIVIT√â */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">5Ô∏è‚É£ Exclusivit√© (si applicable)</h4>
                  <div className="space-y-3">
                    <div>
                      <Label className="font-medium">Exclusivit√© accord√©e √† l'agent</Label>
                      <div className="space-y-2 mt-2">
                        <div><Label>Zone g√©ographique</Label><Input value={agenceData.exclusiviteZone} onChange={(e) => setAgenceData({...agenceData, exclusiviteZone: e.target.value})} placeholder="Ex: Ile-de-France, Sud-Est..." /></div>
                        <div><Label>March√© / Secteur</Label><Input value={agenceData.exclusiviteSecteur} onChange={(e) => setAgenceData({...agenceData, exclusiviteSecteur: e.target.value})} placeholder="Ex: Secteur industriel" /></div>
                        <div><Label>Gamme de produits</Label><Input value={agenceData.exclusiviteGamme} onChange={(e) => setAgenceData({...agenceData, exclusiviteGamme: e.target.value})} placeholder="Ex: Gamme Premium uniquement" /></div>
                      </div>
                    </div>
                    <div>
                      <Label className="font-medium">Exclusivit√© accord√©e au mandant</Label>
                      <div className="space-y-2 mt-2">
                        <div>
                          <Label>Interdiction pour l'agent de repr√©senter un concurrent</Label>
                          <RadioGroup value={agenceData.exclusiviteMandantInterdictionConcurrent} onValueChange={(v) => setAgenceData({...agenceData, exclusiviteMandantInterdictionConcurrent: v})}>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="excl-conc-oui" /><Label htmlFor="excl-conc-oui">Oui</Label></div>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="excl-conc-non" /><Label htmlFor="excl-conc-non">Non</Label></div>
                          </RadioGroup>
                        </div>
                        <div>
                          <Label>Interdiction de proposer des produits concurrents</Label>
                          <RadioGroup value={agenceData.exclusiviteMandantInterdictionProduitsConcurrents} onValueChange={(v) => setAgenceData({...agenceData, exclusiviteMandantInterdictionProduitsConcurrents: v})}>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="oui" id="excl-prod-oui" /><Label htmlFor="excl-prod-oui">Oui</Label></div>
                            <div className="flex items-center space-x-2"><RadioGroupItem value="non" id="excl-prod-non" /><Label htmlFor="excl-prod-non">Non</Label></div>
                          </RadioGroup>
                        </div>
                      </div>
                    </div>
                    <div><Label>Volume ou objectifs minimaux</Label><Textarea value={agenceData.objectifsMinimaux} onChange={(e) => setAgenceData({...agenceData, objectifsMinimaux: e.target.value})} placeholder="Objectifs chiffr√©s, quotas..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 6. OBLIGATIONS DE L'AGENT */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">6Ô∏è‚É£ Obligations de l'agent</h4>
                  <div className="space-y-3">
                    <div><Label>Prospecter activement</Label><Textarea value={agenceData.obligationProspecter} onChange={(e) => setAgenceData({...agenceData, obligationProspecter: e.target.value})} placeholder="Modalit√©s de prospection..." className="min-h-[60px]" /></div>
                    <div><Label>Promouvoir selon l'image de marque</Label><Textarea value={agenceData.obligationPromouvoir} onChange={(e) => setAgenceData({...agenceData, obligationPromouvoir: e.target.value})} placeholder="Respect de la charte graphique, communication..." className="min-h-[60px]" /></div>
                    <div><Label>Respecter la politique commerciale</Label><Textarea value={agenceData.obligationPolitiqueCommerciale} onChange={(e) => setAgenceData({...agenceData, obligationPolitiqueCommerciale: e.target.value})} placeholder="R√®gles de tarification, remises..." className="min-h-[60px]" /></div>
                    <div><Label>Informer le mandant des opportunit√©s</Label><Textarea value={agenceData.obligationInformer} onChange={(e) => setAgenceData({...agenceData, obligationInformer: e.target.value})} placeholder="Transmission des leads, alertes march√©..." className="min-h-[60px]" /></div>
                    <div><Label>Fr√©quence du reporting</Label><Input value={agenceData.obligationReportingFrequence} onChange={(e) => setAgenceData({...agenceData, obligationReportingFrequence: e.target.value})} placeholder="Hebdomadaire, mensuel..." /></div>
                    <div><Label>Respecter la confidentialit√©</Label><Textarea value={agenceData.obligationConfidentialite} onChange={(e) => setAgenceData({...agenceData, obligationConfidentialite: e.target.value})} placeholder="Non-divulgation informations..." className="min-h-[60px]" /></div>
                    <div><Label>Absence de conflits d'int√©r√™ts</Label><Textarea value={agenceData.obligationNonConflit} onChange={(e) => setAgenceData({...agenceData, obligationNonConflit: e.target.value})} placeholder="Incompatibilit√©s..." className="min-h-[60px]" /></div>
                    <div><Label>Non-concurrence (si applicable)</Label><Textarea value={agenceData.obligationNonConcurrence} onChange={(e) => setAgenceData({...agenceData, obligationNonConcurrence: e.target.value})} placeholder="Restrictions concurrentielles..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 7. OBLIGATIONS DU MANDANT */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">7Ô∏è‚É£ Obligations du mandant</h4>
                  <div className="space-y-3">
                    <div><Label>Remettre catalogues, tarifs, documentation</Label><Textarea value={agenceData.obligationCatalogues} onChange={(e) => setAgenceData({...agenceData, obligationCatalogues: e.target.value})} placeholder="Documents fournis √† l'agent..." className="min-h-[60px]" /></div>
                    <div><Label>Informer des modifications tarifaires</Label><Textarea value={agenceData.obligationInformerModifs} onChange={(e) => setAgenceData({...agenceData, obligationInformerModifs: e.target.value})} placeholder="D√©lai de notification..." className="min-h-[60px]" /></div>
                    <div><Label>Fournir un support technique</Label><Textarea value={agenceData.obligationSupportTechnique} onChange={(e) => setAgenceData({...agenceData, obligationSupportTechnique: e.target.value})} placeholder="Assistance, formation..." className="min-h-[60px]" /></div>
                    <div><Label>Respecter l'exclusivit√© (si applicable)</Label><Textarea value={agenceData.obligationRespecterExclusivite} onChange={(e) => setAgenceData({...agenceData, obligationRespecterExclusivite: e.target.value})} placeholder="Ne pas court-circuiter l'agent..." className="min-h-[60px]" /></div>
                    <div><Label>Payer les commissions</Label><Textarea value={agenceData.obligationPayerCommissions} onChange={(e) => setAgenceData({...agenceData, obligationPayerCommissions: e.target.value})} placeholder="D√©lais de paiement..." className="min-h-[60px]" /></div>
                    <div><Label>Informer des op√©rations commerciales</Label><Textarea value={agenceData.obligationInformerOperations} onChange={(e) => setAgenceData({...agenceData, obligationInformerOperations: e.target.value})} placeholder="Ventes directes sur la zone..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 8. COMMISSIONNEMENT */}
                <div className="space-y-4 p-4 bg-green-50/50 rounded-lg border border-green-200">
                  <h4 className="font-semibold text-lg text-green-700">8Ô∏è‚É£ Commissionnement (POINT CL√â)</h4>
                  <div className="p-3 bg-green-100 rounded border border-green-300">
                    <p className="text-xs text-green-800">üí∞ √âl√©ment essentiel du contrat - d√©finir pr√©cis√©ment les modalit√©s</p>
                  </div>
                  <div className="space-y-3">
                    <div>
                      <Label className="font-medium">A. Type de commission *</Label>
                      <RadioGroup value={agenceData.commissionType} onValueChange={(v) => setAgenceData({...agenceData, commissionType: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="pourcentage" id="comm-pct" /><Label htmlFor="comm-pct">Pourcentage sur CA</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="fixe" id="comm-fix" /><Label htmlFor="comm-fix">Montant fixe par contrat</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="degressif" id="comm-deg" /><Label htmlFor="comm-deg">Tarifs d√©gressifs</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="progressif" id="comm-prog" /><Label htmlFor="comm-prog">Tarifs progressifs</Label></div>
                      </RadioGroup>
                    </div>
                    {agenceData.commissionType === "pourcentage" && (
                      <div><Label>Pourcentage *</Label><Input value={agenceData.commissionPourcentage} onChange={(e) => setAgenceData({...agenceData, commissionPourcentage: e.target.value})} placeholder="Ex: 10%" /></div>
                    )}
                    {agenceData.commissionType === "fixe" && (
                      <div><Label>Montant fixe *</Label><Input value={agenceData.commissionMontantFixe} onChange={(e) => setAgenceData({...agenceData, commissionMontantFixe: e.target.value})} placeholder="Ex: 500 ‚Ç¨ par contrat" /></div>
                    )}
                    <div><Label>Commissions diff√©rentes par gamme</Label><Textarea value={agenceData.commissionGammes} onChange={(e) => setAgenceData({...agenceData, commissionGammes: e.target.value})} placeholder="D√©tail par produit/service..." className="min-h-[60px]" /></div>
                    <div>
                      <Label className="font-medium">B. Sur quelles ventes ?</Label>
                      <div className="space-y-2 mt-2">
                        <div className="flex items-center space-x-2"><Checkbox checked={agenceData.commissionVentesAgent} onCheckedChange={(v) => setAgenceData({...agenceData, commissionVentesAgent: !!v})} id="vente-1" /><Label htmlFor="vente-1" className="font-normal">Ventes conclues par l'agent</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={agenceData.commissionVentesMandant} onCheckedChange={(v) => setAgenceData({...agenceData, commissionVentesMandant: !!v})} id="vente-2" /><Label htmlFor="vente-2" className="font-normal">Ventes conclues par le mandant sur la zone de l'agent (obligatoire l√©galement)</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={agenceData.commissionRenouvellements} onCheckedChange={(v) => setAgenceData({...agenceData, commissionRenouvellements: !!v})} id="vente-3" /><Label htmlFor="vente-3" className="font-normal">Renouvellements de contrats</Label></div>
                        <div className="flex items-center space-x-2"><Checkbox checked={agenceData.commissionAugmentations} onCheckedChange={(v) => setAgenceData({...agenceData, commissionAugmentations: !!v})} id="vente-4" /><Label htmlFor="vente-4" className="font-normal">Augmentations de volume</Label></div>
                      </div>
                    </div>
                    <div>
                      <Label className="font-medium">C. Moment o√π la commission est due *</Label>
                      <RadioGroup value={agenceData.commissionMomentDue} onValueChange={(v) => setAgenceData({...agenceData, commissionMomentDue: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="conclusion" id="moment-1" /><Label htmlFor="moment-1">√Ä la conclusion du contrat</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="paiement" id="moment-2" /><Label htmlFor="moment-2">Au paiement par le client</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="expedition" id="moment-3" /><Label htmlFor="moment-3">√Ä l'exp√©dition des produits</Label></div>
                      </RadioGroup>
                    </div>
                    <div>
                      <Label className="font-medium">D. P√©riodicit√© de paiement *</Label>
                      <RadioGroup value={agenceData.commissionPeriodicite} onValueChange={(v) => setAgenceData({...agenceData, commissionPeriodicite: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="mensuelle" id="period-1" /><Label htmlFor="period-1">Mensuelle</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="trimestrielle" id="period-2" /><Label htmlFor="period-2">Trimestrielle</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>E. Droit √† l'information</Label><Textarea value={agenceData.commissionDroitInformation} onChange={(e) => setAgenceData({...agenceData, commissionDroitInformation: e.target.value})} placeholder="Liste des contrats conclus, montants factur√©s et encaiss√©s..." className="min-h-[80px]" /></div>
                  </div>
                </div>
                
                {/* 9. NON-CONCURRENCE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">9Ô∏è‚É£ Clause de non-concurrence (optionnelle mais fr√©quente)</h4>
                  <div className="space-y-3">
                    <div><Label>Avant r√©siliation (pendant le contrat)</Label><Textarea value={agenceData.nonConcurrenceAvant} onChange={(e) => setAgenceData({...agenceData, nonConcurrenceAvant: e.target.value})} placeholder="Interdiction de repr√©senter des produits concurrents..." className="min-h-[60px]" /></div>
                    <div className="p-3 bg-orange-50 rounded border border-orange-200">
                      <p className="text-xs text-orange-700">‚ö†Ô∏è Apr√®s r√©siliation : dur√©e max 2 ans (obligation l√©gale)</p>
                    </div>
                    <div><Label>Dur√©e apr√®s r√©siliation (max 2 ans)</Label><Input value={agenceData.nonConcurrenceApresDuree} onChange={(e) => setAgenceData({...agenceData, nonConcurrenceApresDuree: e.target.value})} placeholder="Ex: 12 mois, 24 mois" /></div>
                    <div><Label>Zone g√©ographique concern√©e</Label><Input value={agenceData.nonConcurrenceApresZone} onChange={(e) => setAgenceData({...agenceData, nonConcurrenceApresZone: e.target.value})} placeholder="Ex: Ile-de-France" /></div>
                    <div><Label>Secteur concern√©</Label><Input value={agenceData.nonConcurrenceApresSecteur} onChange={(e) => setAgenceData({...agenceData, nonConcurrenceApresSecteur: e.target.value})} placeholder="Secteur d'activit√©" /></div>
                    <div><Label>Compensation financi√®re (optionnelle)</Label><Textarea value={agenceData.nonConcurrenceCompensation} onChange={(e) => setAgenceData({...agenceData, nonConcurrenceCompensation: e.target.value})} placeholder="Indemnit√© compensatrice..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 10. RESPONSABILIT√â & ASSURANCE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">üîü Responsabilit√© & Assurance</h4>
                  <div className="space-y-3">
                    <div><Label>Responsabilit√© de l'agent</Label><Textarea value={agenceData.responsabiliteAgent} onChange={(e) => setAgenceData({...agenceData, responsabiliteAgent: e.target.value})} placeholder="Responsable de ses fautes professionnelles, doit √™tre assur√© en RC Pro..." className="min-h-[80px]" /></div>
                    <div><Label>Responsabilit√© du mandant</Label><Textarea value={agenceData.responsabiliteMandant} onChange={(e) => setAgenceData({...agenceData, responsabiliteMandant: e.target.value})} placeholder="Responsable des d√©fauts produits, de la politique tarifaire..." className="min-h-[80px]" /></div>
                    <div><Label>Exclusions de responsabilit√©</Label><Textarea value={agenceData.exclusionsResponsabilite} onChange={(e) => setAgenceData({...agenceData, exclusionsResponsabilite: e.target.value})} placeholder="Perte de clients, dommages indirects..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 11. CONFIDENTIALIT√â */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£1Ô∏è‚É£ Confidentialit√©</h4>
                  <div className="space-y-3">
                    <div><Label>Obligation pendant le contrat</Label><Textarea value={agenceData.confidentialitePendant} onChange={(e) => setAgenceData({...agenceData, confidentialitePendant: e.target.value})} placeholder="Non-divulgation des informations confidentielles..." className="min-h-[60px]" /></div>
                    <div><Label>Obligation apr√®s le contrat</Label><Textarea value={agenceData.confidentialiteApres} onChange={(e) => setAgenceData({...agenceData, confidentialiteApres: e.target.value})} placeholder="Dur√©e de maintien de la confidentialit√©..." className="min-h-[60px]" /></div>
                    <div><Label>Interdiction de divulguer donn√©es sensibles</Label><Textarea value={agenceData.confidentialiteDonneesSensibles} onChange={(e) => setAgenceData({...agenceData, confidentialiteDonneesSensibles: e.target.value})} placeholder="Liste des donn√©es sensibles..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 12. PROPRI√âT√â INTELLECTUELLE */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£2Ô∏è‚É£ Propri√©t√© intellectuelle</h4>
                  <div className="space-y-3">
                    <div className="flex items-center space-x-2">
                      <Checkbox checked={agenceData.piInterdictionMarques} onCheckedChange={(v) => setAgenceData({...agenceData, piInterdictionMarques: !!v})} id="pi-marques" disabled />
                      <Label htmlFor="pi-marques" className="font-normal">Interdiction d'utiliser les marques sans autorisation ‚úÖ</Label>
                    </div>
                    <div><Label>Licence limit√©e et non exclusive</Label><Textarea value={agenceData.piLicenceLimitee} onChange={(e) => setAgenceData({...agenceData, piLicenceLimitee: e.target.value})} placeholder="Droit d'utilisation limit√© √† l'ex√©cution du contrat..." className="min-h-[60px]" /></div>
                    <div><Label>Restitution du mat√©riel marketing</Label><Textarea value={agenceData.piRestitutionMateriel} onChange={(e) => setAgenceData({...agenceData, piRestitutionMateriel: e.target.value})} placeholder="Restitution √† la fin du contrat..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 13. DONN√âES PERSONNELLES / RGPD */}
                <div className="space-y-4 p-4 bg-purple-50/50 rounded-lg border border-purple-200">
                  <h4 className="font-semibold text-lg text-purple-700">1Ô∏è‚É£3Ô∏è‚É£ Donn√©es personnelles / RGPD</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Statut de l'agent *</Label>
                      <RadioGroup value={agenceData.rgpdStatutAgent} onValueChange={(v) => setAgenceData({...agenceData, rgpdStatutAgent: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="responsable" id="rgpd-resp" /><Label htmlFor="rgpd-resp">Responsable de traitement</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="sous-traitant" id="rgpd-st" /><Label htmlFor="rgpd-st">Sous-traitant</Label></div>
                      </RadioGroup>
                    </div>
                    <div><Label>Donn√©es trait√©es</Label><Textarea value={agenceData.rgpdDonneesTraitees} onChange={(e) => setAgenceData({...agenceData, rgpdDonneesTraitees: e.target.value})} placeholder="Types de donn√©es collect√©es..." className="min-h-[60px]" /></div>
                    <div><Label>Finalit√©s</Label><Textarea value={agenceData.rgpdFinalites} onChange={(e) => setAgenceData({...agenceData, rgpdFinalites: e.target.value})} placeholder="Objectifs du traitement..." className="min-h-[60px]" /></div>
                    <div><Label>Dur√©es de conservation</Label><Input value={agenceData.rgpdDurees} onChange={(e) => setAgenceData({...agenceData, rgpdDurees: e.target.value})} placeholder="Ex: 3 ans apr√®s fin de relation" /></div>
                    <div><Label>Mesures de s√©curit√©</Label><Textarea value={agenceData.rgpdMesuresSecurite} onChange={(e) => setAgenceData({...agenceData, rgpdMesuresSecurite: e.target.value})} placeholder="Chiffrement, acc√®s restreints..." className="min-h-[60px]" /></div>
                    <div><Label>DPO du mandant (si applicable)</Label><Input value={agenceData.rgpdDPO} onChange={(e) => setAgenceData({...agenceData, rgpdDPO: e.target.value})} placeholder="Nom et contact du DPO" /></div>
                  </div>
                </div>
                
                {/* 14. DUR√âE & R√âSILIATION */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£4Ô∏è‚É£ Dur√©e & R√©siliation</h4>
                  <div className="space-y-3">
                    <div>
                      <Label>Type de dur√©e *</Label>
                      <RadioGroup value={agenceData.dureeDeterminee} onValueChange={(v) => setAgenceData({...agenceData, dureeDeterminee: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="determinee" id="dur-det" /><Label htmlFor="dur-det">Dur√©e d√©termin√©e</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="indeterminee" id="dur-ind" /><Label htmlFor="dur-ind">Dur√©e ind√©termin√©e</Label></div>
                      </RadioGroup>
                    </div>
                    {agenceData.dureeDeterminee === 'determinee' && (
                      <div><Label>Dur√©e initiale</Label><Input value={agenceData.dureeInitiale} onChange={(e) => setAgenceData({...agenceData, dureeInitiale: e.target.value})} placeholder="Ex: 2 ans" /></div>
                    )}
                    <div>
                      <Label>Reconduction</Label>
                      <RadioGroup value={agenceData.dureeReconduction} onValueChange={(v) => setAgenceData({...agenceData, dureeReconduction: v})}>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="tacite" id="rec-tac" /><Label htmlFor="rec-tac">Tacite</Label></div>
                        <div className="flex items-center space-x-2"><RadioGroupItem value="expresse" id="rec-exp" /><Label htmlFor="rec-exp">Expresse</Label></div>
                      </RadioGroup>
                    </div>
                    <div className="p-3 bg-orange-50 rounded border border-orange-200">
                      <p className="text-xs text-orange-700 font-semibold">‚ö†Ô∏è Pr√©avis l√©gaux OBLIGATOIRES (Code de commerce L134-12) :</p>
                      <ul className="text-xs text-orange-700 mt-1 ml-4 list-disc">
                        <li>1√®re ann√©e : 1 mois minimum</li>
                        <li>2√®me ann√©e : 2 mois minimum</li>
                        <li>3√®me ann√©e et + : 3 mois minimum</li>
                      </ul>
                    </div>
                    <div className="grid grid-cols-3 gap-3">
                      <div><Label>Pr√©avis 1√®re ann√©e</Label><Input value="1 mois" disabled /></div>
                      <div><Label>Pr√©avis 2√®me ann√©e</Label><Input value="2 mois" disabled /></div>
                      <div><Label>Pr√©avis 3√®me ann√©e et +</Label><Input value="3 mois et plus" disabled /></div>
                    </div>
                    <div><Label>R√©siliation imm√©diate (cas limitatifs)</Label>
                      <div className="mt-2 space-y-2">
                        <div className="flex items-center space-x-2">
                          <Checkbox checked={agenceData.resiliationFauteGrave} onCheckedChange={(v) => setAgenceData({...agenceData, resiliationFauteGrave: !!v})} id="res-faute" disabled />
                          <Label htmlFor="res-faute" className="font-normal">Faute grave ‚úÖ</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <Checkbox checked={agenceData.resiliationNonRespect} onCheckedChange={(v) => setAgenceData({...agenceData, resiliationNonRespect: !!v})} id="res-nonresp" disabled />
                          <Label htmlFor="res-nonresp" className="font-normal">Non-respect obligations contractuelles ‚úÖ</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <Checkbox checked={agenceData.resiliationCessation} onCheckedChange={(v) => setAgenceData({...agenceData, resiliationCessation: !!v})} id="res-cess" disabled />
                          <Label htmlFor="res-cess" className="font-normal">Cessation d'activit√© du mandant ‚úÖ</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <Checkbox checked={agenceData.resiliationLiquidation} onCheckedChange={(v) => setAgenceData({...agenceData, resiliationLiquidation: !!v})} id="res-liq" disabled />
                          <Label htmlFor="res-liq" className="font-normal">Liquidation judiciaire ‚úÖ</Label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                {/* 15. INDEMNIT√â L√âGALE FIN DE CONTRAT */}
                <div className="space-y-4 p-4 bg-orange-50 rounded-lg border border-orange-300">
                  <h4 className="font-semibold text-lg text-orange-700">1Ô∏è‚É£5Ô∏è‚É£ Indemnit√© l√©gale de fin de contrat ‚ö†Ô∏è OBLIGATOIRE !!!</h4>
                  <div className="p-3 bg-orange-100 rounded border border-orange-400">
                    <p className="text-sm text-orange-800 font-semibold">üö® √âL√âMENT CL√â du contrat d'agent commercial</p>
                    <p className="text-xs text-orange-700 mt-1">Indemnit√© g√©n√©ralement fix√©e √† 2 ann√©es de commissions (sauf faute grave). C'est une obligation l√©gale imp√©rative (L134-12 Code de commerce).</p>
                  </div>
                  <div className="space-y-3">
                    <div><Label>Montant de l'indemnit√©</Label><Input value={agenceData.indemniteMontant} onChange={(e) => setAgenceData({...agenceData, indemniteMontant: e.target.value})} placeholder="Ex: 2 ann√©es de commissions moyennes" disabled /></div>
                    <div className="flex items-center space-x-2">
                      <Checkbox checked={agenceData.indemniteSaufFauteGrave} onCheckedChange={(v) => setAgenceData({...agenceData, indemniteSaufFauteGrave: !!v})} id="ind-faute" disabled />
                      <Label htmlFor="ind-faute" className="font-normal">Sauf en cas de faute grave de l'agent ‚úÖ</Label>
                    </div>
                    <div><Label>D√©lai de paiement</Label><Textarea value={agenceData.indemniteDelai} onChange={(e) => setAgenceData({...agenceData, indemniteDelai: e.target.value})} placeholder="Dans un d√©lai raisonnable apr√®s la fin du contrat..." className="min-h-[60px]" /></div>
                  </div>
                </div>
                
                {/* 16. FORMALIT√âS & ANNEXES */}
                <div className="space-y-4 p-4 bg-blue-50/50 rounded-lg border border-blue-200">
                  <h4 className="font-semibold text-lg text-blue-700">1Ô∏è‚É£6Ô∏è‚É£ Formalit√©s & Annexes</h4>
                  <div className="space-y-2">
                    <div className="flex items-center space-x-2">
                      <Checkbox checked={agenceData.annexeTarifs} onCheckedChange={(v) => setAgenceData({...agenceData, annexeTarifs: !!v})} id="ann-tarifs" />
                      <Label htmlFor="ann-tarifs" className="font-normal">Annexe : Tarifs et prix publics</Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox checked={agenceData.annexeCatalogue} onCheckedChange={(v) => setAgenceData({...agenceData, annexeCatalogue: !!v})} id="ann-cat" />
                      <Label htmlFor="ann-cat" className="font-normal">Annexe : Catalogue produits</Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox checked={agenceData.annexePolitiqueCommerciale} onCheckedChange={(v) => setAgenceData({...agenceData, annexePolitiqueCommerciale: !!v})} id="ann-pol" />
                      <Label htmlFor="ann-pol" className="font-normal">Annexe : Politique commerciale</Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox checked={agenceData.annexeFichesProduits} onCheckedChange={(v) => setAgenceData({...agenceData, annexeFichesProduits: !!v})} id="ann-fiches" />
                      <Label htmlFor="ann-fiches" className="font-normal">Annexe : Fiches produits</Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox checked={agenceData.annexeReporting} onCheckedChange={(v) => setAgenceData({...agenceData, annexeReporting: !!v})} id="ann-rep" />
                      <Label htmlFor="ann-rep" className="font-normal">Annexe : Mod√®le de reporting</Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox checked={agenceData.annexeHistorique} onCheckedChange={(v) => setAgenceData({...agenceData, annexeHistorique: !!v})} id="ann-hist" />
                      <Label htmlFor="ann-hist" className="font-normal">Annexe : Historique des commissions</Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox checked={agenceData.annexeRSAC} onCheckedChange={(v) => setAgenceData({...agenceData, annexeRSAC: !!v})} id="ann-rsac" />
                      <Label htmlFor="ann-rsac" className="font-normal">Annexe : Extrait RSAC de l'agent</Label>
                    </div>
                  </div>
                </div>
                
                {/* 17. PI√àCES JUSTIFICATIVES */}
                <div className="space-y-4 p-4 bg-green-50/50 rounded-lg border border-green-200">
                  <h4 className="font-semibold text-lg text-green-700">1Ô∏è‚É£7Ô∏è‚É£ Pi√®ces justificatives requises</h4>
                  <div className="space-y-4">
                    <div className="space-y-3">
                      <p className="text-sm font-semibold">C√¥t√© mandant :</p>
                      <SingleFileUpload label="Extrait Kbis" file={agenceMandantKbisFile} onFileChange={setAgenceMandantKbisFile} role="avocat" />
                      <SingleFileUpload label="Politique commerciale" file={agenceMandantPolitiqueFile} onFileChange={setAgenceMandantPolitiqueFile} role="avocat" />
                      <SingleFileUpload label="Catalogue" file={agenceMandantCatalogueFile} onFileChange={setAgenceMandantCatalogueFile} role="avocat" />
                      <SingleFileUpload label="Grille tarifaire" file={agenceMandantTarifsFile} onFileChange={setAgenceMandantTarifsFile} role="avocat" />
                    </div>
                    <div className="space-y-3">
                      <p className="text-sm font-semibold">C√¥t√© agent commercial :</p>
                      <SingleFileUpload label="Extrait Kbis RSAC (obligatoire)" file={agenceAgentRSACFile} onFileChange={setAgenceAgentRSACFile} role="avocat" required />
                      <SingleFileUpload label="Attestation RC Pro" file={agenceAgentRCProFile} onFileChange={setAgenceAgentRCProFile} role="avocat" />
                      <SingleFileUpload label="Pi√®ce d'identit√© si personne physique" file={agenceAgentIdentiteFile} onFileChange={setAgenceAgentIdentiteFile} role="avocat" />
                    </div>
                    <div className="space-y-2">
                      <p className="text-sm font-semibold">Annexes g√©n√©rales :</p>
                      <MultiFileUpload files={agenceAnnexesFiles} setFiles={setAgenceAnnexesFiles} label="Autres annexes (plusieurs fichiers possibles)" role="avocat" />
                    </div>
                  </div>
                </div>

              </div>
            )}

            {/* Formulaire g√©n√©rique pour tous les autres types de contrats */}
            {!["Compromis de vente / Promesse unilat√©rale de vente", "Acte de vente immobili√®re", "Bail d'habitation vide", "Bail d'habitation meubl√©", "Bail commercial / professionnel", "Convention d'indivision", "Mainlev√©e d'hypoth√®que", "Contrat de mariage (r√©gimes matrimoniaux)", "PACS (convention + enregistrement)", "Donation entre √©poux", "Donation simple (parent ‚Üí enfant, etc.)", "Testament authentique ou mystique", "Changement de r√©gime matrimonial", "D√©claration de succession", "Acte de notori√©t√©", "Partage successoral", "Procuration authentique", "Mandat de protection future", "Attestation de propri√©t√© immobili√®re", "Quitus / reconnaissance de dette", "Acte de cession de parts sociales", "Contrat de prestation de services", "Contrat de vente B2B / distribution", "Conditions G√©n√©rales de Vente (CGV)", "Contrat d'agence commerciale", "Contrat de franchise", "Contrat de partenariat / coop√©ration", "Contrat de sous-traitance", "NDA (Accord de confidentialit√©)", "Cession de marque / cession de droits de propri√©t√© intellectuelle", "Contrat de travail (CDD/CDI)", "Convention de stage", "Rupture conventionnelle", "Avenants au contrat de travail", "Accords de confidentialit√© employ√©", "Politique RGPD interne (annexes)", "√âtat des lieux (annexe)", "Mise en demeure de payer le loyer / autres obligations", "Pacte de concubinage", "Convention parentale", "Reconnaissance de dettes", "Mandat de protection future sous seing priv√©", "Testament olographe + accompagnement au d√©p√¥t", "Contrat de cession de droits d'auteur", "Licence logicielle", "Contrat de d√©veloppement web / application", "Politique de confidentialit√© / mentions l√©gales / RGPD"].includes(pendingContractType) && !(pendingContractType.includes("CGU") && pendingContractType.toLowerCase().includes("saas")) && !pendingContractType.includes("agence commerciale") && (
              <div className="space-y-4">
                <h3 className="font-semibold text-lg border-b pb-2">üë§ Client concern√©</h3>
                <div className="space-y-2">
                  <Label>S√©lectionner le client</Label>
                  <Select 
                    value={selectedClientId}
                    onValueChange={(value) => {
                      setSelectedClientId(value);
                      const client = clients.find(c => c.id === value);
                      if (client) {
                        setGenericDescription(`Contrat pour ${client.prenom} ${client.nom}`);
                      }
                    }}
                  >
                    <SelectTrigger>
                      <SelectValue placeholder="Choisir un client" />
                    </SelectTrigger>
                    <SelectContent>
                      {clients.map((client) => (
                        <SelectItem key={client.id} value={client.id}>
                          {client.prenom} {client.nom}
                        </SelectItem>
                      ))}
                    </SelectContent>
                  </Select>
                </div>

                <div className="space-y-2">
                  <Label>Description du contrat</Label>
                  <textarea 
                    value={genericDescription}
                    onChange={(e) => setGenericDescription(e.target.value)}
                    placeholder="D√©crivez bri√®vement le contrat..."
                    className="w-full min-h-[100px] p-2 border rounded-md"
                  />
                </div>
              </div>
            )}

          </div>

          <div className="flex justify-end gap-3 mt-6 pt-4 border-t">
            <Button 
              type="button"
              variant="outline"
              className={role === 'notaire' ? 'border-orange-600 text-orange-600 hover:text-orange-600 hover:bg-orange-50' : 'border-blue-600 text-blue-600 hover:text-blue-600 hover:bg-blue-50'}
              onClick={(e) => {
                e.preventDefault();
                e.stopPropagation();
                setShowQuestionDialog(false);
              }}
            >
              Annuler
            </Button>
            <Button 
              type="button"
              className={role === 'notaire' ? 'bg-orange-600 hover:bg-orange-700' : 'bg-blue-600 hover:bg-blue-700'}
              onClick={(e) => {
                e.preventDefault();
                e.stopPropagation();
                if (pendingContractType === "Compromis de vente / Promesse unilat√©rale de vente") {
                  handleQuestionnaireSubmit();
                } else if (pendingContractType === "Acte de vente immobili√®re") {
                  handleActeVenteSubmit();
                } else if (pendingContractType === "Bail d'habitation vide" || pendingContractType === "Bail d'habitation meubl√©") {
                  handleBailHabitationSubmit();
                } else if (pendingContractType === "Bail commercial / professionnel") {
                  handleBailCommercialSubmit();
                } else if (pendingContractType === "Convention d'indivision") {
                  handleIndivisionSubmit();
                } else if (pendingContractType === "Mainlev√©e d'hypoth√®que") {
                  handleMainleveeSubmit();
                } else if (pendingContractType === "Contrat de mariage (r√©gimes matrimoniaux)") {
                  handleContratMariageSubmit();
                } else if (pendingContractType === "PACS (convention + enregistrement)") {
                  handlePacsSubmit();
                } else if (pendingContractType === "Donation entre √©poux") {
                  handleDonationEntreEpouxSubmit();
                } else if (pendingContractType === "Donation simple (parent ‚Üí enfant, etc.)") {
                  handleDonationSimpleSubmit();
                } else if (pendingContractType === "Testament authentique ou mystique") {
                  handleTestamentSubmit();
                } else if (pendingContractType === "Changement de r√©gime matrimonial") {
                  handleChangementRegimeSubmit();
                } else if (pendingContractType === "D√©claration de succession") {
                  handleSuccessionSubmit();
                } else if (pendingContractType === "Acte de notori√©t√©") {
                  handleActeNotorieteSubmit();
                } else if (pendingContractType === "Partage successoral") {
                  handlePartageSuccessoralSubmit();
                } else if (pendingContractType === "Procuration authentique") {
                  handleProcurationSubmit();
                } else if (pendingContractType === "Mandat de protection future") {
                  handleMandatProtectionSubmit();
                } else if (pendingContractType === "Attestation de propri√©t√© immobili√®re") {
                  handleAttestationSubmit();
                } else if (pendingContractType === "Quitus / reconnaissance de dette") {
                  handleQuitusDetteSubmit();
                } else if (pendingContractType === "Acte de cession de parts sociales") {
                  handleCessionPartsSubmit();
                } else if (pendingContractType.includes("CGU") && pendingContractType.toLowerCase().includes("saas")) {
                  handleCGUSubmit();
                } else if (pendingContractType.includes("agence commerciale")) {
                  handleAgenceCommercialeSubmit();
                } else if (["Contrat de prestation de services", "Contrat de vente B2B / distribution", "Conditions G√©n√©rales de Vente (CGV)", "Contrat de franchise", "Contrat de partenariat / coop√©ration", "Contrat de sous-traitance", "NDA (Accord de confidentialit√©)", "Cession de marque / cession de droits de propri√©t√© intellectuelle", "Contrat de travail (CDD/CDI)", "Convention de stage", "Rupture conventionnelle", "Avenants au contrat de travail", "Accords de confidentialit√© employ√©", "Politique RGPD interne (annexes)", "√âtat des lieux (annexe)", "Mise en demeure de payer le loyer / autres obligations", "Pacte de concubinage", "Convention parentale", "Reconnaissance de dettes", "Mandat de protection future sous seing priv√©", "Testament olographe + accompagnement au d√©p√¥t", "Contrat de cession de droits d'auteur", "Licence logicielle", "Contrat de d√©veloppement web / application", "Politique de confidentialit√© / mentions l√©gales / RGPD"].includes(pendingContractType)) {
                  handleGenericContractSubmit();
                } else {
                  // Pour tous les autres types, utiliser le formulaire g√©n√©rique
                  handleGenericContractSubmit();
                }
              }}
            >
              Cr√©er le contrat
            </Button>
          </div>
        </DialogContent>
      </Dialog>
    </AppLayout>
  );
}
